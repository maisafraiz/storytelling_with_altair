<!DOCTYPE html>

<html lang="en">
<head><meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Storytelling! with Altair</title><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<style type="text/css">
    pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: var(--jp-cell-editor-active-background) }
.highlight { background: var(--jp-cell-editor-background); color: var(--jp-mirror-editor-variable-color) }
.highlight .c { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment */
.highlight .err { color: var(--jp-mirror-editor-error-color) } /* Error */
.highlight .k { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword */
.highlight .o { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator */
.highlight .p { color: var(--jp-mirror-editor-punctuation-color) } /* Punctuation */
.highlight .ch { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Multiline */
.highlight .cp { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Single */
.highlight .cs { color: var(--jp-mirror-editor-comment-color); font-style: italic } /* Comment.Special */
.highlight .kc { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: var(--jp-mirror-editor-keyword-color); font-weight: bold } /* Keyword.Type */
.highlight .m { color: var(--jp-mirror-editor-number-color) } /* Literal.Number */
.highlight .s { color: var(--jp-mirror-editor-string-color) } /* Literal.String */
.highlight .ow { color: var(--jp-mirror-editor-operator-color); font-weight: bold } /* Operator.Word */
.highlight .pm { color: var(--jp-mirror-editor-punctuation-color) } /* Punctuation.Marker */
.highlight .w { color: var(--jp-mirror-editor-variable-color) } /* Text.Whitespace */
.highlight .mb { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Bin */
.highlight .mf { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Float */
.highlight .mh { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Hex */
.highlight .mi { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer */
.highlight .mo { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Oct */
.highlight .sa { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Affix */
.highlight .sb { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Backtick */
.highlight .sc { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Char */
.highlight .dl { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Delimiter */
.highlight .sd { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Doc */
.highlight .s2 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Double */
.highlight .se { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Escape */
.highlight .sh { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Heredoc */
.highlight .si { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Interpol */
.highlight .sx { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Other */
.highlight .sr { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Regex */
.highlight .s1 { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Single */
.highlight .ss { color: var(--jp-mirror-editor-string-color) } /* Literal.String.Symbol */
.highlight .il { color: var(--jp-mirror-editor-number-color) } /* Literal.Number.Integer.Long */
  </style>
<style type="text/css">
/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*
 * Mozilla scrollbar styling
 */

/* use standard opaque scrollbars for most nodes */
[data-jp-theme-scrollbars='true'] {
  scrollbar-color: rgb(var(--jp-scrollbar-thumb-color))
    var(--jp-scrollbar-background-color);
}

/* for code nodes, use a transparent style of scrollbar. These selectors
 * will match lower in the tree, and so will override the above */
[data-jp-theme-scrollbars='true'] .CodeMirror-hscrollbar,
[data-jp-theme-scrollbars='true'] .CodeMirror-vscrollbar {
  scrollbar-color: rgba(var(--jp-scrollbar-thumb-color), 0.5) transparent;
}

/* tiny scrollbar */

.jp-scrollbar-tiny {
  scrollbar-color: rgba(var(--jp-scrollbar-thumb-color), 0.5) transparent;
  scrollbar-width: thin;
}

/* tiny scrollbar */

.jp-scrollbar-tiny::-webkit-scrollbar,
.jp-scrollbar-tiny::-webkit-scrollbar-corner {
  background-color: transparent;
  height: 4px;
  width: 4px;
}

.jp-scrollbar-tiny::-webkit-scrollbar-thumb {
  background: rgba(var(--jp-scrollbar-thumb-color), 0.5);
}

.jp-scrollbar-tiny::-webkit-scrollbar-track:horizontal {
  border-left: 0 solid transparent;
  border-right: 0 solid transparent;
}

.jp-scrollbar-tiny::-webkit-scrollbar-track:vertical {
  border-top: 0 solid transparent;
  border-bottom: 0 solid transparent;
}

/*
 * Lumino
 */

.lm-ScrollBar[data-orientation='horizontal'] {
  min-height: 16px;
  max-height: 16px;
  min-width: 45px;
  border-top: 1px solid #a0a0a0;
}

.lm-ScrollBar[data-orientation='vertical'] {
  min-width: 16px;
  max-width: 16px;
  min-height: 45px;
  border-left: 1px solid #a0a0a0;
}

.lm-ScrollBar-button {
  background-color: #f0f0f0;
  background-position: center center;
  min-height: 15px;
  max-height: 15px;
  min-width: 15px;
  max-width: 15px;
}

.lm-ScrollBar-button:hover {
  background-color: #dadada;
}

.lm-ScrollBar-button.lm-mod-active {
  background-color: #cdcdcd;
}

.lm-ScrollBar-track {
  background: #f0f0f0;
}

.lm-ScrollBar-thumb {
  background: #cdcdcd;
}

.lm-ScrollBar-thumb:hover {
  background: #bababa;
}

.lm-ScrollBar-thumb.lm-mod-active {
  background: #a0a0a0;
}

.lm-ScrollBar[data-orientation='horizontal'] .lm-ScrollBar-thumb {
  height: 100%;
  min-width: 15px;
  border-left: 1px solid #a0a0a0;
  border-right: 1px solid #a0a0a0;
}

.lm-ScrollBar[data-orientation='vertical'] .lm-ScrollBar-thumb {
  width: 100%;
  min-height: 15px;
  border-top: 1px solid #a0a0a0;
  border-bottom: 1px solid #a0a0a0;
}

.lm-ScrollBar[data-orientation='horizontal']
  .lm-ScrollBar-button[data-action='decrement'] {
  background-image: var(--jp-icon-caret-left);
  background-size: 17px;
}

.lm-ScrollBar[data-orientation='horizontal']
  .lm-ScrollBar-button[data-action='increment'] {
  background-image: var(--jp-icon-caret-right);
  background-size: 17px;
}

.lm-ScrollBar[data-orientation='vertical']
  .lm-ScrollBar-button[data-action='decrement'] {
  background-image: var(--jp-icon-caret-up);
  background-size: 17px;
}

.lm-ScrollBar[data-orientation='vertical']
  .lm-ScrollBar-button[data-action='increment'] {
  background-image: var(--jp-icon-caret-down);
  background-size: 17px;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-Widget {
  box-sizing: border-box;
  position: relative;
  overflow: hidden;
}

.lm-Widget.lm-mod-hidden {
  display: none !important;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.lm-AccordionPanel[data-orientation='horizontal'] > .lm-AccordionPanel-title {
  /* Title is rotated for horizontal accordion panel using CSS */
  display: block;
  transform-origin: top left;
  transform: rotate(-90deg) translate(-100%);
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-CommandPalette {
  display: flex;
  flex-direction: column;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-CommandPalette-search {
  flex: 0 0 auto;
}

.lm-CommandPalette-content {
  flex: 1 1 auto;
  margin: 0;
  padding: 0;
  min-height: 0;
  overflow: auto;
  list-style-type: none;
}

.lm-CommandPalette-header {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

.lm-CommandPalette-item {
  display: flex;
  flex-direction: row;
}

.lm-CommandPalette-itemIcon {
  flex: 0 0 auto;
}

.lm-CommandPalette-itemContent {
  flex: 1 1 auto;
  overflow: hidden;
}

.lm-CommandPalette-itemShortcut {
  flex: 0 0 auto;
}

.lm-CommandPalette-itemLabel {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

.lm-close-icon {
  border: 1px solid transparent;
  background-color: transparent;
  position: absolute;
  z-index: 1;
  right: 3%;
  top: 0;
  bottom: 0;
  margin: auto;
  padding: 7px 0;
  display: none;
  vertical-align: middle;
  outline: 0;
  cursor: pointer;
}
.lm-close-icon:after {
  content: 'X';
  display: block;
  width: 15px;
  height: 15px;
  text-align: center;
  color: #000;
  font-weight: normal;
  font-size: 12px;
  cursor: pointer;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-DockPanel {
  z-index: 0;
}

.lm-DockPanel-widget {
  z-index: 0;
}

.lm-DockPanel-tabBar {
  z-index: 1;
}

.lm-DockPanel-handle {
  z-index: 2;
}

.lm-DockPanel-handle.lm-mod-hidden {
  display: none !important;
}

.lm-DockPanel-handle:after {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  content: '';
}

.lm-DockPanel-handle[data-orientation='horizontal'] {
  cursor: ew-resize;
}

.lm-DockPanel-handle[data-orientation='vertical'] {
  cursor: ns-resize;
}

.lm-DockPanel-handle[data-orientation='horizontal']:after {
  left: 50%;
  min-width: 8px;
  transform: translateX(-50%);
}

.lm-DockPanel-handle[data-orientation='vertical']:after {
  top: 50%;
  min-height: 8px;
  transform: translateY(-50%);
}

.lm-DockPanel-overlay {
  z-index: 3;
  box-sizing: border-box;
  pointer-events: none;
}

.lm-DockPanel-overlay.lm-mod-hidden {
  display: none !important;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-Menu {
  z-index: 10000;
  position: absolute;
  white-space: nowrap;
  overflow-x: hidden;
  overflow-y: auto;
  outline: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-Menu-content {
  margin: 0;
  padding: 0;
  display: table;
  list-style-type: none;
}

.lm-Menu-item {
  display: table-row;
}

.lm-Menu-item.lm-mod-hidden,
.lm-Menu-item.lm-mod-collapsed {
  display: none !important;
}

.lm-Menu-itemIcon,
.lm-Menu-itemSubmenuIcon {
  display: table-cell;
  text-align: center;
}

.lm-Menu-itemLabel {
  display: table-cell;
  text-align: left;
}

.lm-Menu-itemShortcut {
  display: table-cell;
  text-align: right;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-MenuBar {
  outline: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-MenuBar-content {
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: row;
  list-style-type: none;
}

.lm-MenuBar-item {
  box-sizing: border-box;
}

.lm-MenuBar-itemIcon,
.lm-MenuBar-itemLabel {
  display: inline-block;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-ScrollBar {
  display: flex;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-ScrollBar[data-orientation='horizontal'] {
  flex-direction: row;
}

.lm-ScrollBar[data-orientation='vertical'] {
  flex-direction: column;
}

.lm-ScrollBar-button {
  box-sizing: border-box;
  flex: 0 0 auto;
}

.lm-ScrollBar-track {
  box-sizing: border-box;
  position: relative;
  overflow: hidden;
  flex: 1 1 auto;
}

.lm-ScrollBar-thumb {
  box-sizing: border-box;
  position: absolute;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-SplitPanel-child {
  z-index: 0;
}

.lm-SplitPanel-handle {
  z-index: 1;
}

.lm-SplitPanel-handle.lm-mod-hidden {
  display: none !important;
}

.lm-SplitPanel-handle:after {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  content: '';
}

.lm-SplitPanel[data-orientation='horizontal'] > .lm-SplitPanel-handle {
  cursor: ew-resize;
}

.lm-SplitPanel[data-orientation='vertical'] > .lm-SplitPanel-handle {
  cursor: ns-resize;
}

.lm-SplitPanel[data-orientation='horizontal'] > .lm-SplitPanel-handle:after {
  left: 50%;
  min-width: 8px;
  transform: translateX(-50%);
}

.lm-SplitPanel[data-orientation='vertical'] > .lm-SplitPanel-handle:after {
  top: 50%;
  min-height: 8px;
  transform: translateY(-50%);
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-TabBar {
  display: flex;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.lm-TabBar[data-orientation='horizontal'] {
  flex-direction: row;
  align-items: flex-end;
}

.lm-TabBar[data-orientation='vertical'] {
  flex-direction: column;
  align-items: flex-end;
}

.lm-TabBar-content {
  margin: 0;
  padding: 0;
  display: flex;
  flex: 1 1 auto;
  list-style-type: none;
}

.lm-TabBar[data-orientation='horizontal'] > .lm-TabBar-content {
  flex-direction: row;
}

.lm-TabBar[data-orientation='vertical'] > .lm-TabBar-content {
  flex-direction: column;
}

.lm-TabBar-tab {
  display: flex;
  flex-direction: row;
  box-sizing: border-box;
  overflow: hidden;
  touch-action: none; /* Disable native Drag/Drop */
}

.lm-TabBar-tabIcon,
.lm-TabBar-tabCloseIcon {
  flex: 0 0 auto;
}

.lm-TabBar-tabLabel {
  flex: 1 1 auto;
  overflow: hidden;
  white-space: nowrap;
}

.lm-TabBar-tabInput {
  user-select: all;
  width: 100%;
  box-sizing: border-box;
}

.lm-TabBar-tab.lm-mod-hidden {
  display: none !important;
}

.lm-TabBar-addButton.lm-mod-hidden {
  display: none !important;
}

.lm-TabBar.lm-mod-dragging .lm-TabBar-tab {
  position: relative;
}

.lm-TabBar.lm-mod-dragging[data-orientation='horizontal'] .lm-TabBar-tab {
  left: 0;
  transition: left 150ms ease;
}

.lm-TabBar.lm-mod-dragging[data-orientation='vertical'] .lm-TabBar-tab {
  top: 0;
  transition: top 150ms ease;
}

.lm-TabBar.lm-mod-dragging .lm-TabBar-tab.lm-mod-dragging {
  transition: none;
}

.lm-TabBar-tabLabel .lm-TabBar-tabInput {
  user-select: all;
  width: 100%;
  box-sizing: border-box;
  background: inherit;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-TabPanel-tabBar {
  z-index: 1;
}

.lm-TabPanel-stackedPanel {
  z-index: 0;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-Collapse {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}

.jp-Collapse-header {
  padding: 1px 12px;
  background-color: var(--jp-layout-color1);
  border-bottom: solid var(--jp-border-width) var(--jp-border-color2);
  color: var(--jp-ui-font-color1);
  cursor: pointer;
  display: flex;
  align-items: center;
  font-size: var(--jp-ui-font-size0);
  font-weight: 600;
  text-transform: uppercase;
  user-select: none;
}

.jp-Collapser-icon {
  height: 16px;
}

.jp-Collapse-header-collapsed .jp-Collapser-icon {
  transform: rotate(-90deg);
  margin: auto 0;
}

.jp-Collapser-title {
  line-height: 25px;
}

.jp-Collapse-contents {
  padding: 0 12px;
  background-color: var(--jp-layout-color1);
  color: var(--jp-ui-font-color1);
  overflow: auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/* This file was auto-generated by ensureUiComponents() in @jupyterlab/buildutils */

/**
 * (DEPRECATED) Support for consuming icons as CSS background images
 */

/* Icons urls */

:root {
  --jp-icon-add-above: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzEzN18xOTQ5MikiPgo8cGF0aCBjbGFzcz0ianAtaWNvbjMiIGQ9Ik00Ljc1IDQuOTMwNjZINi42MjVWNi44MDU2NkM2LjYyNSA3LjAxMTkxIDYuNzkzNzUgNy4xODA2NiA3IDcuMTgwNjZDNy4yMDYyNSA3LjE4MDY2IDcuMzc1IDcuMDExOTEgNy4zNzUgNi44MDU2NlY0LjkzMDY2SDkuMjVDOS40NTYyNSA0LjkzMDY2IDkuNjI1IDQuNzYxOTEgOS42MjUgNC41NTU2NkM5LjYyNSA0LjM0OTQxIDkuNDU2MjUgNC4xODA2NiA5LjI1IDQuMTgwNjZINy4zNzVWMi4zMDU2NkM3LjM3NSAyLjA5OTQxIDcuMjA2MjUgMS45MzA2NiA3IDEuOTMwNjZDNi43OTM3NSAxLjkzMDY2IDYuNjI1IDIuMDk5NDEgNi42MjUgMi4zMDU2NlY0LjE4MDY2SDQuNzVDNC41NDM3NSA0LjE4MDY2IDQuMzc1IDQuMzQ5NDEgNC4zNzUgNC41NTU2NkM0LjM3NSA0Ljc2MTkxIDQuNTQzNzUgNC45MzA2NiA0Ljc1IDQuOTMwNjZaIiBmaWxsPSIjNjE2MTYxIiBzdHJva2U9IiM2MTYxNjEiIHN0cm9rZS13aWR0aD0iMC43Ii8+CjwvZz4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTExLjUgOS41VjExLjVMMi41IDExLjVWOS41TDExLjUgOS41Wk0xMiA4QzEyLjU1MjMgOCAxMyA4LjQ0NzcyIDEzIDlWMTJDMTMgMTIuNTUyMyAxMi41NTIzIDEzIDEyIDEzTDIgMTNDMS40NDc3MiAxMyAxIDEyLjU1MjMgMSAxMlY5QzEgOC40NDc3MiAxLjQ0NzcxIDggMiA4TDEyIDhaIiBmaWxsPSIjNjE2MTYxIi8+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzEzN18xOTQ5MiI+CjxyZWN0IGNsYXNzPSJqcC1pY29uMyIgd2lkdGg9IjYiIGhlaWdodD0iNiIgZmlsbD0id2hpdGUiIHRyYW5zZm9ybT0ibWF0cml4KC0xIDAgMCAxIDEwIDEuNTU1NjYpIi8+CjwvY2xpcFBhdGg+CjwvZGVmcz4KPC9zdmc+Cg==);
  --jp-icon-add-below: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzEzN18xOTQ5OCkiPgo8cGF0aCBjbGFzcz0ianAtaWNvbjMiIGQ9Ik05LjI1IDEwLjA2OTNMNy4zNzUgMTAuMDY5M0w3LjM3NSA4LjE5NDM0QzcuMzc1IDcuOTg4MDkgNy4yMDYyNSA3LjgxOTM0IDcgNy44MTkzNEM2Ljc5Mzc1IDcuODE5MzQgNi42MjUgNy45ODgwOSA2LjYyNSA4LjE5NDM0TDYuNjI1IDEwLjA2OTNMNC43NSAxMC4wNjkzQzQuNTQzNzUgMTAuMDY5MyA0LjM3NSAxMC4yMzgxIDQuMzc1IDEwLjQ0NDNDNC4zNzUgMTAuNjUwNiA0LjU0Mzc1IDEwLjgxOTMgNC43NSAxMC44MTkzTDYuNjI1IDEwLjgxOTNMNi42MjUgMTIuNjk0M0M2LjYyNSAxMi45MDA2IDYuNzkzNzUgMTMuMDY5MyA3IDEzLjA2OTNDNy4yMDYyNSAxMy4wNjkzIDcuMzc1IDEyLjkwMDYgNy4zNzUgMTIuNjk0M0w3LjM3NSAxMC44MTkzTDkuMjUgMTAuODE5M0M5LjQ1NjI1IDEwLjgxOTMgOS42MjUgMTAuNjUwNiA5LjYyNSAxMC40NDQzQzkuNjI1IDEwLjIzODEgOS40NTYyNSAxMC4wNjkzIDkuMjUgMTAuMDY5M1oiIGZpbGw9IiM2MTYxNjEiIHN0cm9rZT0iIzYxNjE2MSIgc3Ryb2tlLXdpZHRoPSIwLjciLz4KPC9nPgo8cGF0aCBjbGFzcz0ianAtaWNvbjMiIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMi41IDUuNUwyLjUgMy41TDExLjUgMy41TDExLjUgNS41TDIuNSA1LjVaTTIgN0MxLjQ0NzcyIDcgMSA2LjU1MjI4IDEgNkwxIDNDMSAyLjQ0NzcyIDEuNDQ3NzIgMiAyIDJMMTIgMkMxMi41NTIzIDIgMTMgMi40NDc3MiAxMyAzTDEzIDZDMTMgNi41NTIyOSAxMi41NTIzIDcgMTIgN0wyIDdaIiBmaWxsPSIjNjE2MTYxIi8+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzEzN18xOTQ5OCI+CjxyZWN0IGNsYXNzPSJqcC1pY29uMyIgd2lkdGg9IjYiIGhlaWdodD0iNiIgZmlsbD0id2hpdGUiIHRyYW5zZm9ybT0ibWF0cml4KDEgMS43NDg0NmUtMDcgMS43NDg0NmUtMDcgLTEgNCAxMy40NDQzKSIvPgo8L2NsaXBQYXRoPgo8L2RlZnM+Cjwvc3ZnPgo=);
  --jp-icon-add: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE5IDEzaC02djZoLTJ2LTZINXYtMmg2VjVoMnY2aDZ2MnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-bell: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE2IDE2IiB2ZXJzaW9uPSIxLjEiPgogICA8cGF0aCBjbGFzcz0ianAtaWNvbjIganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjMzMzMzMzIgogICAgICBkPSJtOCAwLjI5Yy0xLjQgMC0yLjcgMC43My0zLjYgMS44LTEuMiAxLjUtMS40IDMuNC0xLjUgNS4yLTAuMTggMi4yLTAuNDQgNC0yLjMgNS4zbDAuMjggMS4zaDVjMC4wMjYgMC42NiAwLjMyIDEuMSAwLjcxIDEuNSAwLjg0IDAuNjEgMiAwLjYxIDIuOCAwIDAuNTItMC40IDAuNi0xIDAuNzEtMS41aDVsMC4yOC0xLjNjLTEuOS0wLjk3LTIuMi0zLjMtMi4zLTUuMy0wLjEzLTEuOC0wLjI2LTMuNy0xLjUtNS4yLTAuODUtMS0yLjItMS44LTMuNi0xLjh6bTAgMS40YzAuODggMCAxLjkgMC41NSAyLjUgMS4zIDAuODggMS4xIDEuMSAyLjcgMS4yIDQuNCAwLjEzIDEuNyAwLjIzIDMuNiAxLjMgNS4yaC0xMGMxLjEtMS42IDEuMi0zLjQgMS4zLTUuMiAwLjEzLTEuNyAwLjMtMy4zIDEuMi00LjQgMC41OS0wLjcyIDEuNi0xLjMgMi41LTEuM3ptLTAuNzQgMTJoMS41Yy0wLjAwMTUgMC4yOCAwLjAxNSAwLjc5LTAuNzQgMC43OS0wLjczIDAuMDAxNi0wLjcyLTAuNTMtMC43NC0wLjc5eiIgLz4KPC9zdmc+Cg==);
  --jp-icon-bug-dot: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiM2MTYxNjEiPgogICAgICAgIDxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTcuMTkgOEgyMFYxMEgxNy45MUMxNy45NiAxMC4zMyAxOCAxMC42NiAxOCAxMVYxMkgyMFYxNEgxOC41SDE4VjE0LjAyNzVDMTUuNzUgMTQuMjc2MiAxNCAxNi4xODM3IDE0IDE4LjVDMTQgMTkuMjA4IDE0LjE2MzUgMTkuODc3OSAxNC40NTQ5IDIwLjQ3MzlDMTMuNzA2MyAyMC44MTE3IDEyLjg3NTcgMjEgMTIgMjFDOS43OCAyMSA3Ljg1IDE5Ljc5IDYuODEgMThINFYxNkg2LjA5QzYuMDQgMTUuNjcgNiAxNS4zNCA2IDE1VjE0SDRWMTJINlYxMUM2IDEwLjY2IDYuMDQgMTAuMzMgNi4wOSAxMEg0VjhINi44MUM3LjI2IDcuMjIgNy44OCA2LjU1IDguNjIgNi4wNEw3IDQuNDFMOC40MSAzTDEwLjU5IDUuMTdDMTEuMDQgNS4wNiAxMS41MSA1IDEyIDVDMTIuNDkgNSAxMi45NiA1LjA2IDEzLjQyIDUuMTdMMTUuNTkgM0wxNyA0LjQxTDE1LjM3IDYuMDRDMTYuMTIgNi41NSAxNi43NCA3LjIyIDE3LjE5IDhaTTEwIDE2SDE0VjE0SDEwVjE2Wk0xMCAxMkgxNFYxMEgxMFYxMloiIGZpbGw9IiM2MTYxNjEiLz4KICAgICAgICA8cGF0aCBkPSJNMjIgMTguNUMyMiAyMC40MzMgMjAuNDMzIDIyIDE4LjUgMjJDMTYuNTY3IDIyIDE1IDIwLjQzMyAxNSAxOC41QzE1IDE2LjU2NyAxNi41NjcgMTUgMTguNSAxNUMyMC40MzMgMTUgMjIgMTYuNTY3IDIyIDE4LjVaIiBmaWxsPSIjNjE2MTYxIi8+CiAgICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-bug: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik0yMCA4aC0yLjgxYy0uNDUtLjc4LTEuMDctMS40NS0xLjgyLTEuOTZMMTcgNC40MSAxNS41OSAzbC0yLjE3IDIuMTdDMTIuOTYgNS4wNiAxMi40OSA1IDEyIDVjLS40OSAwLS45Ni4wNi0xLjQxLjE3TDguNDEgMyA3IDQuNDFsMS42MiAxLjYzQzcuODggNi41NSA3LjI2IDcuMjIgNi44MSA4SDR2MmgyLjA5Yy0uMDUuMzMtLjA5LjY2LS4wOSAxdjFINHYyaDJ2MWMwIC4zNC4wNC42Ny4wOSAxSDR2MmgyLjgxYzEuMDQgMS43OSAyLjk3IDMgNS4xOSAzczQuMTUtMS4yMSA1LjE5LTNIMjB2LTJoLTIuMDljLjA1LS4zMy4wOS0uNjYuMDktMXYtMWgydi0yaC0ydi0xYzAtLjM0LS4wNC0uNjctLjA5LTFIMjBWOHptLTYgOGgtNHYtMmg0djJ6bTAtNGgtNHYtMmg0djJ6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-build: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE0LjkgMTcuNDVDMTYuMjUgMTcuNDUgMTcuMzUgMTYuMzUgMTcuMzUgMTVDMTcuMzUgMTMuNjUgMTYuMjUgMTIuNTUgMTQuOSAxMi41NUMxMy41NCAxMi41NSAxMi40NSAxMy42NSAxMi40NSAxNUMxMi40NSAxNi4zNSAxMy41NCAxNy40NSAxNC45IDE3LjQ1Wk0yMC4xIDE1LjY4TDIxLjU4IDE2Ljg0QzIxLjcxIDE2Ljk1IDIxLjc1IDE3LjEzIDIxLjY2IDE3LjI5TDIwLjI2IDE5LjcxQzIwLjE3IDE5Ljg2IDIwIDE5LjkyIDE5LjgzIDE5Ljg2TDE4LjA5IDE5LjE2QzE3LjczIDE5LjQ0IDE3LjMzIDE5LjY3IDE2LjkxIDE5Ljg1TDE2LjY0IDIxLjdDMTYuNjIgMjEuODcgMTYuNDcgMjIgMTYuMyAyMkgxMy41QzEzLjMyIDIyIDEzLjE4IDIxLjg3IDEzLjE1IDIxLjdMMTIuODkgMTkuODVDMTIuNDYgMTkuNjcgMTIuMDcgMTkuNDQgMTEuNzEgMTkuMTZMOS45NjAwMiAxOS44NkM5LjgxMDAyIDE5LjkyIDkuNjIwMDIgMTkuODYgOS41NDAwMiAxOS43MUw4LjE0MDAyIDE3LjI5QzguMDUwMDIgMTcuMTMgOC4wOTAwMiAxNi45NSA4LjIyMDAyIDE2Ljg0TDkuNzAwMDIgMTUuNjhMOS42NTAwMSAxNUw5LjcwMDAyIDE0LjMxTDguMjIwMDIgMTMuMTZDOC4wOTAwMiAxMy4wNSA4LjA1MDAyIDEyLjg2IDguMTQwMDIgMTIuNzFMOS41NDAwMiAxMC4yOUM5LjYyMDAyIDEwLjEzIDkuODEwMDIgMTAuMDcgOS45NjAwMiAxMC4xM0wxMS43MSAxMC44NEMxMi4wNyAxMC41NiAxMi40NiAxMC4zMiAxMi44OSAxMC4xNUwxMy4xNSA4LjI4OTk4QzEzLjE4IDguMTI5OTggMTMuMzIgNy45OTk5OCAxMy41IDcuOTk5OThIMTYuM0MxNi40NyA3Ljk5OTk4IDE2LjYyIDguMTI5OTggMTYuNjQgOC4yODk5OEwxNi45MSAxMC4xNUMxNy4zMyAxMC4zMiAxNy43MyAxMC41NiAxOC4wOSAxMC44NEwxOS44MyAxMC4xM0MyMCAxMC4wNyAyMC4xNyAxMC4xMyAyMC4yNiAxMC4yOUwyMS42NiAxMi43MUMyMS43NSAxMi44NiAyMS43MSAxMy4wNSAyMS41OCAxMy4xNkwyMC4xIDE0LjMxTDIwLjE1IDE1TDIwLjEgMTUuNjhaIi8+CiAgICA8cGF0aCBkPSJNNy4zMjk2NiA3LjQ0NDU0QzguMDgzMSA3LjAwOTU0IDguMzM5MzIgNi4wNTMzMiA3LjkwNDMyIDUuMjk5ODhDNy40NjkzMiA0LjU0NjQzIDYuNTA4MSA0LjI4MTU2IDUuNzU0NjYgNC43MTY1NkM1LjM5MTc2IDQuOTI2MDggNS4xMjY5NSA1LjI3MTE4IDUuMDE4NDkgNS42NzU5NEM0LjkxMDA0IDYuMDgwNzEgNC45NjY4MiA2LjUxMTk4IDUuMTc2MzQgNi44NzQ4OEM1LjYxMTM0IDcuNjI4MzIgNi41NzYyMiA3Ljg3OTU0IDcuMzI5NjYgNy40NDQ1NFpNOS42NTcxOCA0Ljc5NTkzTDEwLjg2NzIgNC45NTE3OUMxMC45NjI4IDQuOTc3NDEgMTEuMDQwMiA1LjA3MTMzIDExLjAzODIgNS4xODc5M0wxMS4wMzg4IDYuOTg4OTNDMTEuMDQ1NSA3LjEwMDU0IDEwLjk2MTYgNy4xOTUxOCAxMC44NTUgNy4yMTA1NEw5LjY2MDAxIDcuMzgwODNMOS4yMzkxNSA4LjEzMTg4TDkuNjY5NjEgOS4yNTc0NUM5LjcwNzI5IDkuMzYyNzEgOS42NjkzNCA5LjQ3Njk5IDkuNTc0MDggOS41MzE5OUw4LjAxNTIzIDEwLjQzMkM3LjkxMTMxIDEwLjQ5MiA3Ljc5MzM3IDEwLjQ2NzcgNy43MjEwNSAxMC4zODI0TDYuOTg3NDggOS40MzE4OEw2LjEwOTMxIDkuNDMwODNMNS4zNDcwNCAxMC4zOTA1QzUuMjg5MDkgMTAuNDcwMiA1LjE3MzgzIDEwLjQ5MDUgNS4wNzE4NyAxMC40MzM5TDMuNTEyNDUgOS41MzI5M0MzLjQxMDQ5IDkuNDc2MzMgMy4zNzY0NyA5LjM1NzQxIDMuNDEwNzUgOS4yNTY3OUwzLjg2MzQ3IDguMTQwOTNMMy42MTc0OSA3Ljc3NDg4TDMuNDIzNDcgNy4zNzg4M0wyLjIzMDc1IDcuMjEyOTdDMi4xMjY0NyA3LjE5MjM1IDIuMDQwNDkgNy4xMDM0MiAyLjA0MjQ1IDYuOTg2ODJMMi4wNDE4NyA1LjE4NTgyQzIuMDQzODMgNS4wNjkyMiAyLjExOTA5IDQuOTc5NTggMi4yMTcwNCA0Ljk2OTIyTDMuNDIwNjUgNC43OTM5M0wzLjg2NzQ5IDQuMDI3ODhMMy40MTEwNSAyLjkxNzMxQzMuMzczMzcgMi44MTIwNCAzLjQxMTMxIDIuNjk3NzYgMy41MTUyMyAyLjYzNzc2TDUuMDc0MDggMS43Mzc3NkM1LjE2OTM0IDEuNjgyNzYgNS4yODcyOSAxLjcwNzA0IDUuMzU5NjEgMS43OTIzMUw2LjExOTE1IDIuNzI3ODhMNi45ODAwMSAyLjczODkzTDcuNzI0OTYgMS43ODkyMkM3Ljc5MTU2IDEuNzA0NTggNy45MTU0OCAxLjY3OTIyIDguMDA4NzkgMS43NDA4Mkw5LjU2ODIxIDIuNjQxODJDOS42NzAxNyAyLjY5ODQyIDkuNzEyODUgMi44MTIzNCA5LjY4NzIzIDIuOTA3OTdMOS4yMTcxOCA0LjAzMzgzTDkuNDYzMTYgNC4zOTk4OEw5LjY1NzE4IDQuNzk1OTNaIi8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-caret-down-empty-thin: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iPgoJCTxwb2x5Z29uIGNsYXNzPSJzdDEiIHBvaW50cz0iOS45LDEzLjYgMy42LDcuNCA0LjQsNi42IDkuOSwxMi4yIDE1LjQsNi43IDE2LjEsNy40ICIvPgoJPC9nPgo8L3N2Zz4K);
  --jp-icon-caret-down-empty: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiIHNoYXBlLXJlbmRlcmluZz0iZ2VvbWV0cmljUHJlY2lzaW9uIj4KICAgIDxwYXRoIGQ9Ik01LjIsNS45TDksOS43bDMuOC0zLjhsMS4yLDEuMmwtNC45LDVsLTQuOS01TDUuMiw1Ljl6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-caret-down: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiIHNoYXBlLXJlbmRlcmluZz0iZ2VvbWV0cmljUHJlY2lzaW9uIj4KICAgIDxwYXRoIGQ9Ik01LjIsNy41TDksMTEuMmwzLjgtMy44SDUuMnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-caret-left: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iPgoJCTxwYXRoIGQ9Ik0xMC44LDEyLjhMNy4xLDlsMy44LTMuOGwwLDcuNkgxMC44eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-caret-right: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiIHNoYXBlLXJlbmRlcmluZz0iZ2VvbWV0cmljUHJlY2lzaW9uIj4KICAgIDxwYXRoIGQ9Ik03LjIsNS4yTDEwLjksOWwtMy44LDMuOFY1LjJINy4yeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-caret-up-empty-thin: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iPgoJCTxwb2x5Z29uIGNsYXNzPSJzdDEiIHBvaW50cz0iMTUuNCwxMy4zIDkuOSw3LjcgNC40LDEzLjIgMy42LDEyLjUgOS45LDYuMyAxNi4xLDEyLjYgIi8+Cgk8L2c+Cjwvc3ZnPgo=);
  --jp-icon-caret-up: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSIgc2hhcGUtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iPgoJCTxwYXRoIGQ9Ik01LjIsMTAuNUw5LDYuOGwzLjgsMy44SDUuMnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-case-sensitive: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KICA8ZyBjbGFzcz0ianAtaWNvbjIiIGZpbGw9IiM0MTQxNDEiPgogICAgPHJlY3QgeD0iMiIgeT0iMiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+CiAgPC9nPgogIDxnIGNsYXNzPSJqcC1pY29uLWFjY2VudDIiIGZpbGw9IiNGRkYiPgogICAgPHBhdGggZD0iTTcuNiw4aDAuOWwzLjUsOGgtMS4xTDEwLDE0SDZsLTAuOSwySDRMNy42LDh6IE04LDkuMUw2LjQsMTNoMy4yTDgsOS4xeiIvPgogICAgPHBhdGggZD0iTTE2LjYsOS44Yy0wLjIsMC4xLTAuNCwwLjEtMC43LDAuMWMtMC4yLDAtMC40LTAuMS0wLjYtMC4yYy0wLjEtMC4xLTAuMi0wLjQtMC4yLTAuNyBjLTAuMywwLjMtMC42LDAuNS0wLjksMC43Yy0wLjMsMC4xLTAuNywwLjItMS4xLDAuMmMtMC4zLDAtMC41LDAtMC43LTAuMWMtMC4yLTAuMS0wLjQtMC4yLTAuNi0wLjNjLTAuMi0wLjEtMC4zLTAuMy0wLjQtMC41IGMtMC4xLTAuMi0wLjEtMC40LTAuMS0wLjdjMC0wLjMsMC4xLTAuNiwwLjItMC44YzAuMS0wLjIsMC4zLTAuNCwwLjQtMC41QzEyLDcsMTIuMiw2LjksMTIuNSw2LjhjMC4yLTAuMSwwLjUtMC4xLDAuNy0wLjIgYzAuMy0wLjEsMC41LTAuMSwwLjctMC4xYzAuMiwwLDAuNC0wLjEsMC42LTAuMWMwLjIsMCwwLjMtMC4xLDAuNC0wLjJjMC4xLTAuMSwwLjItMC4yLDAuMi0wLjRjMC0xLTEuMS0xLTEuMy0xIGMtMC40LDAtMS40LDAtMS40LDEuMmgtMC45YzAtMC40LDAuMS0wLjcsMC4yLTFjMC4xLTAuMiwwLjMtMC40LDAuNS0wLjZjMC4yLTAuMiwwLjUtMC4zLDAuOC0wLjNDMTMuMyw0LDEzLjYsNCwxMy45LDQgYzAuMywwLDAuNSwwLDAuOCwwLjFjMC4zLDAsMC41LDAuMSwwLjcsMC4yYzAuMiwwLjEsMC40LDAuMywwLjUsMC41QzE2LDUsMTYsNS4yLDE2LDUuNnYyLjljMCwwLjIsMCwwLjQsMCwwLjUgYzAsMC4xLDAuMSwwLjIsMC4zLDAuMmMwLjEsMCwwLjIsMCwwLjMsMFY5Ljh6IE0xNS4yLDYuOWMtMS4yLDAuNi0zLjEsMC4yLTMuMSwxLjRjMCwxLjQsMy4xLDEsMy4xLTAuNVY2Ljl6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-check: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik05IDE2LjE3TDQuODMgMTJsLTEuNDIgMS40MUw5IDE5IDIxIDdsLTEuNDEtMS40MXoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-circle-empty: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEyIDJDNi40NyAyIDIgNi40NyAyIDEyczQuNDcgMTAgMTAgMTAgMTAtNC40NyAxMC0xMFMxNy41MyAyIDEyIDJ6bTAgMThjLTQuNDEgMC04LTMuNTktOC04czMuNTktOCA4LTggOCAzLjU5IDggOC0zLjU5IDgtOCA4eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-circle: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTggMTgiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPGNpcmNsZSBjeD0iOSIgY3k9IjkiIHI9IjgiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-clear: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8bWFzayBpZD0iZG9udXRIb2xlIj4KICAgIDxyZWN0IHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0id2hpdGUiIC8+CiAgICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSI4IiBmaWxsPSJibGFjayIvPgogIDwvbWFzaz4KCiAgPGcgY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxyZWN0IGhlaWdodD0iMTgiIHdpZHRoPSIyIiB4PSIxMSIgeT0iMyIgdHJhbnNmb3JtPSJyb3RhdGUoMzE1LCAxMiwgMTIpIi8+CiAgICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgbWFzaz0idXJsKCNkb251dEhvbGUpIi8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-close: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbi1ub25lIGpwLWljb24tc2VsZWN0YWJsZS1pbnZlcnNlIGpwLWljb24zLWhvdmVyIiBmaWxsPSJub25lIj4KICAgIDxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjExIi8+CiAgPC9nPgoKICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIGpwLWljb24tYWNjZW50Mi1ob3ZlciIgZmlsbD0iIzYxNjE2MSI+CiAgICA8cGF0aCBkPSJNMTkgNi40MUwxNy41OSA1IDEyIDEwLjU5IDYuNDEgNSA1IDYuNDEgMTAuNTkgMTIgNSAxNy41OSA2LjQxIDE5IDEyIDEzLjQxIDE3LjU5IDE5IDE5IDE3LjU5IDEzLjQxIDEyeiIvPgogIDwvZz4KCiAgPGcgY2xhc3M9ImpwLWljb24tbm9uZSBqcC1pY29uLWJ1c3kiIGZpbGw9Im5vbmUiPgogICAgPGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iNyIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-code-check: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBzaGFwZS1yZW5kZXJpbmc9Imdlb21ldHJpY1ByZWNpc2lvbiI+CiAgICA8cGF0aCBkPSJNNi41OSwzLjQxTDIsOEw2LjU5LDEyLjZMOCwxMS4xOEw0LjgyLDhMOCw0LjgyTDYuNTksMy40MU0xMi40MSwzLjQxTDExLDQuODJMMTQuMTgsOEwxMSwxMS4xOEwxMi40MSwxMi42TDE3LDhMMTIuNDEsMy40MU0yMS41OSwxMS41OUwxMy41LDE5LjY4TDkuODMsMTZMOC40MiwxNy40MUwxMy41LDIyLjVMMjMsMTNMMjEuNTksMTEuNTlaIiAvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-code: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyOCAyOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CgkJPHBhdGggZD0iTTExLjQgMTguNkw2LjggMTRMMTEuNCA5LjRMMTAgOEw0IDE0TDEwIDIwTDExLjQgMTguNlpNMTYuNiAxOC42TDIxLjIgMTRMMTYuNiA5LjRMMTggOEwyNCAxNEwxOCAyMEwxNi42IDE4LjZWMTguNloiLz4KCTwvZz4KPC9zdmc+Cg==);
  --jp-icon-collapse-all: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGgKICAgICAgICAgICAgZD0iTTggMmMxIDAgMTEgMCAxMiAwczIgMSAyIDJjMCAxIDAgMTEgMCAxMnMwIDItMiAyQzIwIDE0IDIwIDQgMjAgNFMxMCA0IDYgNGMwLTIgMS0yIDItMnoiIC8+CiAgICAgICAgPHBhdGgKICAgICAgICAgICAgZD0iTTE4IDhjMC0xLTEtMi0yLTJTNSA2IDQgNnMtMiAxLTIgMmMwIDEgMCAxMSAwIDEyczEgMiAyIDJjMSAwIDExIDAgMTIgMHMyLTEgMi0yYzAtMSAwLTExIDAtMTJ6bS0yIDB2MTJINFY4eiIgLz4KICAgICAgICA8cGF0aCBkPSJNNiAxM3YyaDh2LTJ6IiAvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-console: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwMCAyMDAiPgogIDxnIGNsYXNzPSJqcC1jb25zb2xlLWljb24tYmFja2dyb3VuZC1jb2xvciBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiMwMjg4RDEiPgogICAgPHBhdGggZD0iTTIwIDE5LjhoMTYwdjE1OS45SDIweiIvPgogIDwvZz4KICA8ZyBjbGFzcz0ianAtY29uc29sZS1pY29uLWNvbG9yIGpwLWljb24tc2VsZWN0YWJsZS1pbnZlcnNlIiBmaWxsPSIjZmZmIj4KICAgIDxwYXRoIGQ9Ik0xMDUgMTI3LjNoNDB2MTIuOGgtNDB6TTUxLjEgNzdMNzQgOTkuOWwtMjMuMyAyMy4zIDEwLjUgMTAuNSAyMy4zLTIzLjNMOTUgOTkuOSA4NC41IDg5LjQgNjEuNiA2Ni41eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-copy: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTggMTgiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTExLjksMUgzLjJDMi40LDEsMS43LDEuNywxLjcsMi41djEwLjJoMS41VjIuNWg4LjdWMXogTTE0LjEsMy45aC04Yy0wLjgsMC0xLjUsMC43LTEuNSwxLjV2MTAuMmMwLDAuOCwwLjcsMS41LDEuNSwxLjVoOCBjMC44LDAsMS41LTAuNywxLjUtMS41VjUuNEMxNS41LDQuNiwxNC45LDMuOSwxNC4xLDMuOXogTTE0LjEsMTUuNWgtOFY1LjRoOFYxNS41eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-copyright: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCI+CiAgPGcgY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik0xMS44OCw5LjE0YzEuMjgsMC4wNiwxLjYxLDEuMTUsMS42MywxLjY2aDEuNzljLTAuMDgtMS45OC0xLjQ5LTMuMTktMy40NS0zLjE5QzkuNjQsNy42MSw4LDksOCwxMi4xNCBjMCwxLjk0LDAuOTMsNC4yNCwzLjg0LDQuMjRjMi4yMiwwLDMuNDEtMS42NSwzLjQ0LTIuOTVoLTEuNzljLTAuMDMsMC41OS0wLjQ1LDEuMzgtMS42MywxLjQ0QzEwLjU1LDE0LjgzLDEwLDEzLjgxLDEwLDEyLjE0IEMxMCw5LjI1LDExLjI4LDkuMTYsMTEuODgsOS4xNHogTTEyLDJDNi40OCwyLDIsNi40OCwyLDEyczQuNDgsMTAsMTAsMTBzMTAtNC40OCwxMC0xMFMxNy41MiwyLDEyLDJ6IE0xMiwyMGMtNC40MSwwLTgtMy41OS04LTggczMuNTktOCw4LThzOCwzLjU5LDgsOFMxNi40MSwyMCwxMiwyMHoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-cut: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTkuNjQgNy42NGMuMjMtLjUuMzYtMS4wNS4zNi0xLjY0IDAtMi4yMS0xLjc5LTQtNC00UzIgMy43OSAyIDZzMS43OSA0IDQgNGMuNTkgMCAxLjE0LS4xMyAxLjY0LS4zNkwxMCAxMmwtMi4zNiAyLjM2QzcuMTQgMTQuMTMgNi41OSAxNCA2IDE0Yy0yLjIxIDAtNCAxLjc5LTQgNHMxLjc5IDQgNCA0IDQtMS43OSA0LTRjMC0uNTktLjEzLTEuMTQtLjM2LTEuNjRMMTIgMTRsNyA3aDN2LTFMOS42NCA3LjY0ek02IDhjLTEuMSAwLTItLjg5LTItMnMuOS0yIDItMiAyIC44OSAyIDItLjkgMi0yIDJ6bTAgMTJjLTEuMSAwLTItLjg5LTItMnMuOS0yIDItMiAyIC44OSAyIDItLjkgMi0yIDJ6bTYtNy41Yy0uMjggMC0uNS0uMjItLjUtLjVzLjIyLS41LjUtLjUuNS4yMi41LjUtLjIyLjUtLjUuNXpNMTkgM2wtNiA2IDIgMiA3LTdWM3oiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-delete: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE2cHgiIGhlaWdodD0iMTZweCI+CiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIiAvPgogICAgPHBhdGggY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjI2MjYyIiBkPSJNNiAxOWMwIDEuMS45IDIgMiAyaDhjMS4xIDAgMi0uOSAyLTJWN0g2djEyek0xOSA0aC0zLjVsLTEtMWgtNWwtMSAxSDV2MmgxNFY0eiIgLz4KPC9zdmc+Cg==);
  --jp-icon-download: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE5IDloLTRWM0g5djZINWw3IDcgNy03ek01IDE4djJoMTR2LTJINXoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-duplicate: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIuNzk5OTggMC44NzVIOC44OTU4MkM5LjIwMDYxIDAuODc1IDkuNDQ5OTggMS4xMzkxNCA5LjQ0OTk4IDEuNDYxOThDOS40NDk5OCAxLjc4NDgyIDkuMjAwNjEgMi4wNDg5NiA4Ljg5NTgyIDIuMDQ4OTZIMy4zNTQxNUMzLjA0OTM2IDIuMDQ4OTYgMi43OTk5OCAyLjMxMzEgMi43OTk5OCAyLjYzNTk0VjkuNjc5NjlDMi43OTk5OCAxMC4wMDI1IDIuNTUwNjEgMTAuMjY2NyAyLjI0NTgyIDEwLjI2NjdDMS45NDEwMyAxMC4yNjY3IDEuNjkxNjUgMTAuMDAyNSAxLjY5MTY1IDkuNjc5NjlWMi4wNDg5NkMxLjY5MTY1IDEuNDAzMjggMi4xOTA0IDAuODc1IDIuNzk5OTggMC44NzVaTTUuMzY2NjUgMTEuOVY0LjU1SDExLjA4MzNWMTEuOUg1LjM2NjY1Wk00LjE0MTY1IDQuMTQxNjdDNC4xNDE2NSAzLjY5MDYzIDQuNTA3MjggMy4zMjUgNC45NTgzMiAzLjMyNUgxMS40OTE3QzExLjk0MjcgMy4zMjUgMTIuMzA4MyAzLjY5MDYzIDEyLjMwODMgNC4xNDE2N1YxMi4zMDgzQzEyLjMwODMgMTIuNzU5NCAxMS45NDI3IDEzLjEyNSAxMS40OTE3IDEzLjEyNUg0Ljk1ODMyQzQuNTA3MjggMTMuMTI1IDQuMTQxNjUgMTIuNzU5NCA0LjE0MTY1IDEyLjMwODNWNC4xNDE2N1oiIGZpbGw9IiM2MTYxNjEiLz4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBkPSJNOS40MzU3NCA4LjI2NTA3SDguMzY0MzFWOS4zMzY1QzguMzY0MzEgOS40NTQzNSA4LjI2Nzg4IDkuNTUwNzggOC4xNTAwMiA5LjU1MDc4QzguMDMyMTcgOS41NTA3OCA3LjkzNTc0IDkuNDU0MzUgNy45MzU3NCA5LjMzNjVWOC4yNjUwN0g2Ljg2NDMxQzYuNzQ2NDUgOC4yNjUwNyA2LjY1MDAyIDguMTY4NjQgNi42NTAwMiA4LjA1MDc4QzYuNjUwMDIgNy45MzI5MiA2Ljc0NjQ1IDcuODM2NSA2Ljg2NDMxIDcuODM2NUg3LjkzNTc0VjYuNzY1MDdDNy45MzU3NCA2LjY0NzIxIDguMDMyMTcgNi41NTA3OCA4LjE1MDAyIDYuNTUwNzhDOC4yNjc4OCA2LjU1MDc4IDguMzY0MzEgNi42NDcyMSA4LjM2NDMxIDYuNzY1MDdWNy44MzY1SDkuNDM1NzRDOS41NTM2IDcuODM2NSA5LjY1MDAyIDcuOTMyOTIgOS42NTAwMiA4LjA1MDc4QzkuNjUwMDIgOC4xNjg2NCA5LjU1MzYgOC4yNjUwNyA5LjQzNTc0IDguMjY1MDdaIiBmaWxsPSIjNjE2MTYxIiBzdHJva2U9IiM2MTYxNjEiIHN0cm9rZS13aWR0aD0iMC41Ii8+Cjwvc3ZnPgo=);
  --jp-icon-edit: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTMgMTcuMjVWMjFoMy43NUwxNy44MSA5Ljk0bC0zLjc1LTMuNzVMMyAxNy4yNXpNMjAuNzEgNy4wNGMuMzktLjM5LjM5LTEuMDIgMC0xLjQxbC0yLjM0LTIuMzRjLS4zOS0uMzktMS4wMi0uMzktMS40MSAwbC0xLjgzIDEuODMgMy43NSAzLjc1IDEuODMtMS44M3oiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-ellipses: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPGNpcmNsZSBjeD0iNSIgY3k9IjEyIiByPSIyIi8+CiAgICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIyIi8+CiAgICA8Y2lyY2xlIGN4PSIxOSIgY3k9IjEyIiByPSIyIi8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-error: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KPGcgY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjE2MTYxIj48Y2lyY2xlIGN4PSIxMiIgY3k9IjE5IiByPSIyIi8+PHBhdGggZD0iTTEwIDNoNHYxMmgtNHoiLz48L2c+CjxwYXRoIGZpbGw9Im5vbmUiIGQ9Ik0wIDBoMjR2MjRIMHoiLz4KPC9zdmc+Cg==);
  --jp-icon-expand-all: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGgKICAgICAgICAgICAgZD0iTTggMmMxIDAgMTEgMCAxMiAwczIgMSAyIDJjMCAxIDAgMTEgMCAxMnMwIDItMiAyQzIwIDE0IDIwIDQgMjAgNFMxMCA0IDYgNGMwLTIgMS0yIDItMnoiIC8+CiAgICAgICAgPHBhdGgKICAgICAgICAgICAgZD0iTTE4IDhjMC0xLTEtMi0yLTJTNSA2IDQgNnMtMiAxLTIgMmMwIDEgMCAxMSAwIDEyczEgMiAyIDJjMSAwIDExIDAgMTIgMHMyLTEgMi0yYzAtMSAwLTExIDAtMTJ6bS0yIDB2MTJINFY4eiIgLz4KICAgICAgICA8cGF0aCBkPSJNMTEgMTBIOXYzSDZ2MmgzdjNoMnYtM2gzdi0yaC0zeiIgLz4KICAgIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-extension: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTIwLjUgMTFIMTlWN2MwLTEuMS0uOS0yLTItMmgtNFYzLjVDMTMgMi4xMiAxMS44OCAxIDEwLjUgMVM4IDIuMTIgOCAzLjVWNUg0Yy0xLjEgMC0xLjk5LjktMS45OSAydjMuOEgzLjVjMS40OSAwIDIuNyAxLjIxIDIuNyAyLjdzLTEuMjEgMi43LTIuNyAyLjdIMlYyMGMwIDEuMS45IDIgMiAyaDMuOHYtMS41YzAtMS40OSAxLjIxLTIuNyAyLjctMi43IDEuNDkgMCAyLjcgMS4yMSAyLjcgMi43VjIySDE3YzEuMSAwIDItLjkgMi0ydi00aDEuNWMxLjM4IDAgMi41LTEuMTIgMi41LTIuNVMyMS44OCAxMSAyMC41IDExeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-fast-forward: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTQgMThsOC41LTZMNCA2djEyem05LTEydjEybDguNS02TDEzIDZ6Ii8+CiAgICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-file-upload: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTkgMTZoNnYtNmg0bC03LTctNyA3aDR6bS00IDJoMTR2Mkg1eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-file: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMTkuMyA4LjJsLTUuNS01LjVjLS4zLS4zLS43LS41LTEuMi0uNUgzLjljLS44LjEtMS42LjktMS42IDEuOHYxNC4xYzAgLjkuNyAxLjYgMS42IDEuNmgxNC4yYy45IDAgMS42LS43IDEuNi0xLjZWOS40Yy4xLS41LS4xLS45LS40LTEuMnptLTUuOC0zLjNsMy40IDMuNmgtMy40VjQuOXptMy45IDEyLjdINC43Yy0uMSAwLS4yIDAtLjItLjJWNC43YzAtLjIuMS0uMy4yLS4zaDcuMnY0LjRzMCAuOC4zIDEuMWMuMy4zIDEuMS4zIDEuMS4zaDQuM3Y3LjJzLS4xLjItLjIuMnoiLz4KPC9zdmc+Cg==);
  --jp-icon-filter-dot: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiNGRkYiPgogICAgPHBhdGggZD0iTTE0LDEyVjE5Ljg4QzE0LjA0LDIwLjE4IDEzLjk0LDIwLjUgMTMuNzEsMjAuNzFDMTMuMzIsMjEuMSAxMi42OSwyMS4xIDEyLjMsMjAuNzFMMTAuMjksMTguN0MxMC4wNiwxOC40NyA5Ljk2LDE4LjE2IDEwLDE3Ljg3VjEySDkuOTdMNC4yMSw0LjYyQzMuODcsNC4xOSAzLjk1LDMuNTYgNC4zOCwzLjIyQzQuNTcsMy4wOCA0Ljc4LDMgNSwzVjNIMTlWM0MxOS4yMiwzIDE5LjQzLDMuMDggMTkuNjIsMy4yMkMyMC4wNSwzLjU2IDIwLjEzLDQuMTkgMTkuNzksNC42MkwxNC4wMywxMkgxNFoiIC8+CiAgPC9nPgogIDxnIGNsYXNzPSJqcC1pY29uLWRvdCIgZmlsbD0iI0ZGRiI+CiAgICA8Y2lyY2xlIGN4PSIxOCIgY3k9IjE3IiByPSIzIj48L2NpcmNsZT4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-filter-list: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEwIDE4aDR2LTJoLTR2MnpNMyA2djJoMThWNkgzem0zIDdoMTJ2LTJINnYyeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-filter: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiNGRkYiPgogICAgPHBhdGggZD0iTTE0LDEyVjE5Ljg4QzE0LjA0LDIwLjE4IDEzLjk0LDIwLjUgMTMuNzEsMjAuNzFDMTMuMzIsMjEuMSAxMi42OSwyMS4xIDEyLjMsMjAuNzFMMTAuMjksMTguN0MxMC4wNiwxOC40NyA5Ljk2LDE4LjE2IDEwLDE3Ljg3VjEySDkuOTdMNC4yMSw0LjYyQzMuODcsNC4xOSAzLjk1LDMuNTYgNC4zOCwzLjIyQzQuNTcsMy4wOCA0Ljc4LDMgNSwzVjNIMTlWM0MxOS4yMiwzIDE5LjQzLDMuMDggMTkuNjIsMy4yMkMyMC4wNSwzLjU2IDIwLjEzLDQuMTkgMTkuNzksNC42MkwxNC4wMywxMkgxNFoiIC8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-folder-favorite: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgZmlsbD0iIzAwMDAwMCI+CiAgPHBhdGggZD0iTTAgMGgyNHYyNEgwVjB6IiBmaWxsPSJub25lIi8+PHBhdGggY2xhc3M9ImpwLWljb24zIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzYxNjE2MSIgZD0iTTIwIDZoLThsLTItMkg0Yy0xLjEgMC0yIC45LTIgMnYxMmMwIDEuMS45IDIgMiAyaDE2YzEuMSAwIDItLjkgMi0yVjhjMC0xLjEtLjktMi0yLTJ6bS0yLjA2IDExTDE1IDE1LjI4IDEyLjA2IDE3bC43OC0zLjMzLTIuNTktMi4yNCAzLjQxLS4yOUwxNSA4bDEuMzQgMy4xNCAzLjQxLjI5LTIuNTkgMi4yNC43OCAzLjMzeiIvPgo8L3N2Zz4K);
  --jp-icon-folder: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMTAgNEg0Yy0xLjEgMC0xLjk5LjktMS45OSAyTDIgMThjMCAxLjEuOSAyIDIgMmgxNmMxLjEgMCAyLS45IDItMlY4YzAtMS4xLS45LTItMi0yaC04bC0yLTJ6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-home: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgZmlsbD0iIzAwMDAwMCI+CiAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGNsYXNzPSJqcC1pY29uMyBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiM2MTYxNjEiIGQ9Ik0xMCAyMHYtNmg0djZoNXYtOGgzTDEyIDMgMiAxMmgzdjh6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-html5: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDUxMiA1MTIiPgogIDxwYXRoIGNsYXNzPSJqcC1pY29uMCBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiMwMDAiIGQ9Ik0xMDguNCAwaDIzdjIyLjhoMjEuMlYwaDIzdjY5aC0yM1Y0NmgtMjF2MjNoLTIzLjJNMjA2IDIzaC0yMC4zVjBoNjMuN3YyM0gyMjl2NDZoLTIzbTUzLjUtNjloMjQuMWwxNC44IDI0LjNMMzEzLjIgMGgyNC4xdjY5aC0yM1YzNC44bC0xNi4xIDI0LjgtMTYuMS0yNC44VjY5aC0yMi42bTg5LjItNjloMjN2NDYuMmgzMi42VjY5aC01NS42Ii8+CiAgPHBhdGggY2xhc3M9ImpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iI2U0NGQyNiIgZD0iTTEwNy42IDQ3MWwtMzMtMzcwLjRoMzYyLjhsLTMzIDM3MC4yTDI1NS43IDUxMiIvPgogIDxwYXRoIGNsYXNzPSJqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiNmMTY1MjkiIGQ9Ik0yNTYgNDgwLjVWMTMxaDE0OC4zTDM3NiA0NDciLz4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1zZWxlY3RhYmxlLWludmVyc2UiIGZpbGw9IiNlYmViZWIiIGQ9Ik0xNDIgMTc2LjNoMTE0djQ1LjRoLTY0LjJsNC4yIDQ2LjVoNjB2NDUuM0gxNTQuNG0yIDIyLjhIMjAybDMuMiAzNi4zIDUwLjggMTMuNnY0Ny40bC05My4yLTI2Ii8+CiAgPHBhdGggY2xhc3M9ImpwLWljb24tc2VsZWN0YWJsZS1pbnZlcnNlIiBmaWxsPSIjZmZmIiBkPSJNMzY5LjYgMTc2LjNIMjU1Ljh2NDUuNGgxMDkuNm0tNC4xIDQ2LjVIMjU1Ljh2NDUuNGg1NmwtNS4zIDU5LTUwLjcgMTMuNnY0Ny4ybDkzLTI1LjgiLz4KPC9zdmc+Cg==);
  --jp-icon-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1icmFuZDQganAtaWNvbi1zZWxlY3RhYmxlLWludmVyc2UiIGZpbGw9IiNGRkYiIGQ9Ik0yLjIgMi4yaDE3LjV2MTcuNUgyLjJ6Ii8+CiAgPHBhdGggY2xhc3M9ImpwLWljb24tYnJhbmQwIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzNGNTFCNSIgZD0iTTIuMiAyLjJ2MTcuNWgxNy41bC4xLTE3LjVIMi4yem0xMi4xIDIuMmMxLjIgMCAyLjIgMSAyLjIgMi4ycy0xIDIuMi0yLjIgMi4yLTIuMi0xLTIuMi0yLjIgMS0yLjIgMi4yLTIuMnpNNC40IDE3LjZsMy4zLTguOCAzLjMgNi42IDIuMi0zLjIgNC40IDUuNEg0LjR6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-info: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDUwLjk3OCA1MC45NzgiPgoJPGcgY2xhc3M9ImpwLWljb24zIiBmaWxsPSIjNjE2MTYxIj4KCQk8cGF0aCBkPSJNNDMuNTIsNy40NThDMzguNzExLDIuNjQ4LDMyLjMwNywwLDI1LjQ4OSwwQzE4LjY3LDAsMTIuMjY2LDIuNjQ4LDcuNDU4LDcuNDU4CgkJCWMtOS45NDMsOS45NDEtOS45NDMsMjYuMTE5LDAsMzYuMDYyYzQuODA5LDQuODA5LDExLjIxMiw3LjQ1NiwxOC4wMzEsNy40NThjMCwwLDAuMDAxLDAsMC4wMDIsMAoJCQljNi44MTYsMCwxMy4yMjEtMi42NDgsMTguMDI5LTcuNDU4YzQuODA5LTQuODA5LDcuNDU3LTExLjIxMiw3LjQ1Ny0xOC4wM0M1MC45NzcsMTguNjcsNDguMzI4LDEyLjI2Niw0My41Miw3LjQ1OHoKCQkJIE00Mi4xMDYsNDIuMTA1Yy00LjQzMiw0LjQzMS0xMC4zMzIsNi44NzItMTYuNjE1LDYuODcyaC0wLjAwMmMtNi4yODUtMC4wMDEtMTIuMTg3LTIuNDQxLTE2LjYxNy02Ljg3MgoJCQljLTkuMTYyLTkuMTYzLTkuMTYyLTI0LjA3MSwwLTMzLjIzM0MxMy4zMDMsNC40NCwxOS4yMDQsMiwyNS40ODksMmM2LjI4NCwwLDEyLjE4NiwyLjQ0LDE2LjYxNyw2Ljg3MgoJCQljNC40MzEsNC40MzEsNi44NzEsMTAuMzMyLDYuODcxLDE2LjYxN0M0OC45NzcsMzEuNzcyLDQ2LjUzNiwzNy42NzUsNDIuMTA2LDQyLjEwNXoiLz4KCQk8cGF0aCBkPSJNMjMuNTc4LDMyLjIxOGMtMC4wMjMtMS43MzQsMC4xNDMtMy4wNTksMC40OTYtMy45NzJjMC4zNTMtMC45MTMsMS4xMS0xLjk5NywyLjI3Mi0zLjI1MwoJCQljMC40NjgtMC41MzYsMC45MjMtMS4wNjIsMS4zNjctMS41NzVjMC42MjYtMC43NTMsMS4xMDQtMS40NzgsMS40MzYtMi4xNzVjMC4zMzEtMC43MDcsMC40OTUtMS41NDEsMC40OTUtMi41CgkJCWMwLTEuMDk2LTAuMjYtMi4wODgtMC43NzktMi45NzljLTAuNTY1LTAuODc5LTEuNTAxLTEuMzM2LTIuODA2LTEuMzY5Yy0xLjgwMiwwLjA1Ny0yLjk4NSwwLjY2Ny0zLjU1LDEuODMyCgkJCWMtMC4zMDEsMC41MzUtMC41MDMsMS4xNDEtMC42MDcsMS44MTRjLTAuMTM5LDAuNzA3LTAuMjA3LDEuNDMyLTAuMjA3LDIuMTc0aC0yLjkzN2MtMC4wOTEtMi4yMDgsMC40MDctNC4xMTQsMS40OTMtNS43MTkKCQkJYzEuMDYyLTEuNjQsMi44NTUtMi40ODEsNS4zNzgtMi41MjdjMi4xNiwwLjAyMywzLjg3NCwwLjYwOCw1LjE0MSwxLjc1OGMxLjI3OCwxLjE2LDEuOTI5LDIuNzY0LDEuOTUsNC44MTEKCQkJYzAsMS4xNDItMC4xMzcsMi4xMTEtMC40MSwyLjkxMWMtMC4zMDksMC44NDUtMC43MzEsMS41OTMtMS4yNjgsMi4yNDNjLTAuNDkyLDAuNjUtMS4wNjgsMS4zMTgtMS43MywyLjAwMgoJCQljLTAuNjUsMC42OTctMS4zMTMsMS40NzktMS45ODcsMi4zNDZjLTAuMjM5LDAuMzc3LTAuNDI5LDAuNzc3LTAuNTY1LDEuMTk5Yy0wLjE2LDAuOTU5LTAuMjE3LDEuOTUxLTAuMTcxLDIuOTc5CgkJCUMyNi41ODksMzIuMjE4LDIzLjU3OCwzMi4yMTgsMjMuNTc4LDMyLjIxOHogTTIzLjU3OCwzOC4yMnYtMy40ODRoMy4wNzZ2My40ODRIMjMuNTc4eiIvPgoJPC9nPgo8L3N2Zz4K);
  --jp-icon-inspector: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaW5zcGVjdG9yLWljb24tY29sb3IganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMjAgNEg0Yy0xLjEgMC0xLjk5LjktMS45OSAyTDIgMThjMCAxLjEuOSAyIDIgMmgxNmMxLjEgMCAyLS45IDItMlY2YzAtMS4xLS45LTItMi0yem0tNSAxNEg0di00aDExdjR6bTAtNUg0VjloMTF2NHptNSA1aC00VjloNHY5eiIvPgo8L3N2Zz4K);
  --jp-icon-json: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8ZyBjbGFzcz0ianAtanNvbi1pY29uLWNvbG9yIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iI0Y5QTgyNSI+CiAgICA8cGF0aCBkPSJNMjAuMiAxMS44Yy0xLjYgMC0xLjcuNS0xLjcgMSAwIC40LjEuOS4xIDEuMy4xLjUuMS45LjEgMS4zIDAgMS43LTEuNCAyLjMtMy41IDIuM2gtLjl2LTEuOWguNWMxLjEgMCAxLjQgMCAxLjQtLjggMC0uMyAwLS42LS4xLTEgMC0uNC0uMS0uOC0uMS0xLjIgMC0xLjMgMC0xLjggMS4zLTItMS4zLS4yLTEuMy0uNy0xLjMtMiAwLS40LjEtLjguMS0xLjIuMS0uNC4xLS43LjEtMSAwLS44LS40LS43LTEuNC0uOGgtLjVWNC4xaC45YzIuMiAwIDMuNS43IDMuNSAyLjMgMCAuNC0uMS45LS4xIDEuMy0uMS41LS4xLjktLjEgMS4zIDAgLjUuMiAxIDEuNyAxdjEuOHpNMS44IDEwLjFjMS42IDAgMS43LS41IDEuNy0xIDAtLjQtLjEtLjktLjEtMS4zLS4xLS41LS4xLS45LS4xLTEuMyAwLTEuNiAxLjQtMi4zIDMuNS0yLjNoLjl2MS45aC0uNWMtMSAwLTEuNCAwLTEuNC44IDAgLjMgMCAuNi4xIDEgMCAuMi4xLjYuMSAxIDAgMS4zIDAgMS44LTEuMyAyQzYgMTEuMiA2IDExLjcgNiAxM2MwIC40LS4xLjgtLjEgMS4yLS4xLjMtLjEuNy0uMSAxIDAgLjguMy44IDEuNC44aC41djEuOWgtLjljLTIuMSAwLTMuNS0uNi0zLjUtMi4zIDAtLjQuMS0uOS4xLTEuMy4xLS41LjEtLjkuMS0xLjMgMC0uNS0uMi0xLTEuNy0xdi0xLjl6Ii8+CiAgICA8Y2lyY2xlIGN4PSIxMSIgY3k9IjEzLjgiIHI9IjIuMSIvPgogICAgPGNpcmNsZSBjeD0iMTEiIGN5PSI4LjIiIHI9IjIuMSIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-julia: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDMyNSAzMDAiPgogIDxnIGNsYXNzPSJqcC1icmFuZDAganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjY2IzYzMzIj4KICAgIDxwYXRoIGQ9Ik0gMTUwLjg5ODQzOCAyMjUgQyAxNTAuODk4NDM4IDI2Ni40MjE4NzUgMTE3LjMyMDMxMiAzMDAgNzUuODk4NDM4IDMwMCBDIDM0LjQ3NjU2MiAzMDAgMC44OTg0MzggMjY2LjQyMTg3NSAwLjg5ODQzOCAyMjUgQyAwLjg5ODQzOCAxODMuNTc4MTI1IDM0LjQ3NjU2MiAxNTAgNzUuODk4NDM4IDE1MCBDIDExNy4zMjAzMTIgMTUwIDE1MC44OTg0MzggMTgzLjU3ODEyNSAxNTAuODk4NDM4IDIyNSIvPgogIDwvZz4KICA8ZyBjbGFzcz0ianAtYnJhbmQwIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzM4OTgyNiI+CiAgICA8cGF0aCBkPSJNIDIzNy41IDc1IEMgMjM3LjUgMTE2LjQyMTg3NSAyMDMuOTIxODc1IDE1MCAxNjIuNSAxNTAgQyAxMjEuMDc4MTI1IDE1MCA4Ny41IDExNi40MjE4NzUgODcuNSA3NSBDIDg3LjUgMzMuNTc4MTI1IDEyMS4wNzgxMjUgMCAxNjIuNSAwIEMgMjAzLjkyMTg3NSAwIDIzNy41IDMzLjU3ODEyNSAyMzcuNSA3NSIvPgogIDwvZz4KICA8ZyBjbGFzcz0ianAtYnJhbmQwIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzk1NThiMiI+CiAgICA8cGF0aCBkPSJNIDMyNC4xMDE1NjIgMjI1IEMgMzI0LjEwMTU2MiAyNjYuNDIxODc1IDI5MC41MjM0MzggMzAwIDI0OS4xMDE1NjIgMzAwIEMgMjA3LjY3OTY4OCAzMDAgMTc0LjEwMTU2MiAyNjYuNDIxODc1IDE3NC4xMDE1NjIgMjI1IEMgMTc0LjEwMTU2MiAxODMuNTc4MTI1IDIwNy42Nzk2ODggMTUwIDI0OS4xMDE1NjIgMTUwIEMgMjkwLjUyMzQzOCAxNTAgMzI0LjEwMTU2MiAxODMuNTc4MTI1IDMyNC4xMDE1NjIgMjI1Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-jupyter-favicon: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUyIiBoZWlnaHQ9IjE2NSIgdmlld0JveD0iMCAwIDE1MiAxNjUiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgPGcgY2xhc3M9ImpwLWp1cHl0ZXItaWNvbi1jb2xvciIgZmlsbD0iI0YzNzcyNiI+CiAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjA3ODk0NywgMTEwLjU4MjkyNykiIGQ9Ik03NS45NDIyODQyLDI5LjU4MDQ1NjEgQzQzLjMwMjM5NDcsMjkuNTgwNDU2MSAxNC43OTY3ODMyLDE3LjY1MzQ2MzQgMCwwIEM1LjUxMDgzMjExLDE1Ljg0MDY4MjkgMTUuNzgxNTM4OSwyOS41NjY3NzMyIDI5LjM5MDQ5NDcsMzkuMjc4NDE3MSBDNDIuOTk5Nyw0OC45ODk4NTM3IDU5LjI3MzcsNTQuMjA2NzgwNSA3NS45NjA1Nzg5LDU0LjIwNjc4MDUgQzkyLjY0NzQ1NzksNTQuMjA2NzgwNSAxMDguOTIxNDU4LDQ4Ljk4OTg1MzcgMTIyLjUzMDY2MywzOS4yNzg0MTcxIEMxMzYuMTM5NDUzLDI5LjU2Njc3MzIgMTQ2LjQxMDI4NCwxNS44NDA2ODI5IDE1MS45MjExNTgsMCBDMTM3LjA4Nzg2OCwxNy42NTM0NjM0IDEwOC41ODI1ODksMjkuNTgwNDU2MSA3NS45NDIyODQyLDI5LjU4MDQ1NjEgTDc1Ljk0MjI4NDIsMjkuNTgwNDU2MSBaIiAvPgogICAgPHBhdGggdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMzczNjgsIDAuNzA0ODc4KSIgZD0iTTc1Ljk3ODQ1NzksMjQuNjI2NDA3MyBDMTA4LjYxODc2MywyNC42MjY0MDczIDEzNy4xMjQ0NTgsMzYuNTUzNDQxNSAxNTEuOTIxMTU4LDU0LjIwNjc4MDUgQzE0Ni40MTAyODQsMzguMzY2MjIyIDEzNi4xMzk0NTMsMjQuNjQwMTMxNyAxMjIuNTMwNjYzLDE0LjkyODQ4NzggQzEwOC45MjE0NTgsNS4yMTY4NDM5IDkyLjY0NzQ1NzksMCA3NS45NjA1Nzg5LDAgQzU5LjI3MzcsMCA0Mi45OTk3LDUuMjE2ODQzOSAyOS4zOTA0OTQ3LDE0LjkyODQ4NzggQzE1Ljc4MTUzODksMjQuNjQwMTMxNyA1LjUxMDgzMjExLDM4LjM2NjIyMiAwLDU0LjIwNjc4MDUgQzE0LjgzMzA4MTYsMzYuNTg5OTI5MyA0My4zMzg1Njg0LDI0LjYyNjQwNzMgNzUuOTc4NDU3OSwyNC42MjY0MDczIEw3NS45Nzg0NTc5LDI0LjYyNjQwNzMgWiIgLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-jupyter: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzkiIGhlaWdodD0iNTEiIHZpZXdCb3g9IjAgMCAzOSA1MSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTYzOCAtMjI4MSkiPgogICAgIDxnIGNsYXNzPSJqcC1qdXB5dGVyLWljb24tY29sb3IiIGZpbGw9IiNGMzc3MjYiPgogICAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjM5Ljc0IDIzMTEuOTgpIiBkPSJNIDE4LjI2NDYgNy4xMzQxMUMgMTAuNDE0NSA3LjEzNDExIDMuNTU4NzIgNC4yNTc2IDAgMEMgMS4zMjUzOSAzLjgyMDQgMy43OTU1NiA3LjEzMDgxIDcuMDY4NiA5LjQ3MzAzQyAxMC4zNDE3IDExLjgxNTIgMTQuMjU1NyAxMy4wNzM0IDE4LjI2OSAxMy4wNzM0QyAyMi4yODIzIDEzLjA3MzQgMjYuMTk2MyAxMS44MTUyIDI5LjQ2OTQgOS40NzMwM0MgMzIuNzQyNCA3LjEzMDgxIDM1LjIxMjYgMy44MjA0IDM2LjUzOCAwQyAzMi45NzA1IDQuMjU3NiAyNi4xMTQ4IDcuMTM0MTEgMTguMjY0NiA3LjEzNDExWiIvPgogICAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjM5LjczIDIyODUuNDgpIiBkPSJNIDE4LjI3MzMgNS45MzkzMUMgMjYuMTIzNSA1LjkzOTMxIDMyLjk3OTMgOC44MTU4MyAzNi41MzggMTMuMDczNEMgMzUuMjEyNiA5LjI1MzAzIDMyLjc0MjQgNS45NDI2MiAyOS40Njk0IDMuNjAwNEMgMjYuMTk2MyAxLjI1ODE4IDIyLjI4MjMgMCAxOC4yNjkgMEMgMTQuMjU1NyAwIDEwLjM0MTcgMS4yNTgxOCA3LjA2ODYgMy42MDA0QyAzLjc5NTU2IDUuOTQyNjIgMS4zMjUzOSA5LjI1MzAzIDAgMTMuMDczNEMgMy41Njc0NSA4LjgyNDYzIDEwLjQyMzIgNS45MzkzMSAxOC4yNzMzIDUuOTM5MzFaIi8+CiAgICA8L2c+CiAgICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjY5LjMgMjI4MS4zMSkiIGQ9Ik0gNS44OTM1MyAyLjg0NEMgNS45MTg4OSAzLjQzMTY1IDUuNzcwODUgNC4wMTM2NyA1LjQ2ODE1IDQuNTE2NDVDIDUuMTY1NDUgNS4wMTkyMiA0LjcyMTY4IDUuNDIwMTUgNC4xOTI5OSA1LjY2ODUxQyAzLjY2NDMgNS45MTY4OCAzLjA3NDQ0IDYuMDAxNTEgMi40OTgwNSA1LjkxMTcxQyAxLjkyMTY2IDUuODIxOSAxLjM4NDYzIDUuNTYxNyAwLjk1NDg5OCA1LjE2NDAxQyAwLjUyNTE3IDQuNzY2MzMgMC4yMjIwNTYgNC4yNDkwMyAwLjA4MzkwMzcgMy42Nzc1N0MgLTAuMDU0MjQ4MyAzLjEwNjExIC0wLjAyMTIzIDIuNTA2MTcgMC4xNzg3ODEgMS45NTM2NEMgMC4zNzg3OTMgMS40MDExIDAuNzM2ODA5IDAuOTIwODE3IDEuMjA3NTQgMC41NzM1MzhDIDEuNjc4MjYgMC4yMjYyNTkgMi4yNDA1NSAwLjAyNzU5MTkgMi44MjMyNiAwLjAwMjY3MjI5QyAzLjYwMzg5IC0wLjAzMDcxMTUgNC4zNjU3MyAwLjI0OTc4OSA0Ljk0MTQyIDAuNzgyNTUxQyA1LjUxNzExIDEuMzE1MzEgNS44NTk1NiAyLjA1Njc2IDUuODkzNTMgMi44NDRaIi8+CiAgICAgIDxwYXRoIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2MzkuOCAyMzIzLjgxKSIgZD0iTSA3LjQyNzg5IDMuNTgzMzhDIDcuNDYwMDggNC4zMjQzIDcuMjczNTUgNS4wNTgxOSA2Ljg5MTkzIDUuNjkyMTNDIDYuNTEwMzEgNi4zMjYwNyA1Ljk1MDc1IDYuODMxNTYgNS4yODQxMSA3LjE0NDZDIDQuNjE3NDcgNy40NTc2MyAzLjg3MzcxIDcuNTY0MTQgMy4xNDcwMiA3LjQ1MDYzQyAyLjQyMDMyIDcuMzM3MTIgMS43NDMzNiA3LjAwODcgMS4yMDE4NCA2LjUwNjk1QyAwLjY2MDMyOCA2LjAwNTIgMC4yNzg2MSA1LjM1MjY4IDAuMTA1MDE3IDQuNjMyMDJDIC0wLjA2ODU3NTcgMy45MTEzNSAtMC4wMjYyMzYxIDMuMTU0OTQgMC4yMjY2NzUgMi40NTg1NkMgMC40Nzk1ODcgMS43NjIxNyAwLjkzMTY5NyAxLjE1NzEzIDEuNTI1NzYgMC43MjAwMzNDIDIuMTE5ODMgMC4yODI5MzUgMi44MjkxNCAwLjAzMzQzOTUgMy41NjM4OSAwLjAwMzEzMzQ0QyA0LjU0NjY3IC0wLjAzNzQwMzMgNS41MDUyOSAwLjMxNjcwNiA2LjIyOTYxIDAuOTg3ODM1QyA2Ljk1MzkzIDEuNjU4OTYgNy4zODQ4NCAyLjU5MjM1IDcuNDI3ODkgMy41ODMzOEwgNy40Mjc4OSAzLjU4MzM4WiIvPgogICAgICA8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjM4LjM2IDIyODYuMDYpIiBkPSJNIDIuMjc0NzEgNC4zOTYyOUMgMS44NDM2MyA0LjQxNTA4IDEuNDE2NzEgNC4zMDQ0NSAxLjA0Nzk5IDQuMDc4NDNDIDAuNjc5MjY4IDMuODUyNCAwLjM4NTMyOCAzLjUyMTE0IDAuMjAzMzcxIDMuMTI2NTZDIDAuMDIxNDEzNiAyLjczMTk4IC0wLjA0MDM3OTggMi4yOTE4MyAwLjAyNTgxMTYgMS44NjE4MUMgMC4wOTIwMDMxIDEuNDMxOCAwLjI4MzIwNCAxLjAzMTI2IDAuNTc1MjEzIDAuNzEwODgzQyAwLjg2NzIyMiAwLjM5MDUxIDEuMjQ2OTEgMC4xNjQ3MDggMS42NjYyMiAwLjA2MjA1OTJDIDIuMDg1NTMgLTAuMDQwNTg5NyAyLjUyNTYxIC0wLjAxNTQ3MTQgMi45MzA3NiAwLjEzNDIzNUMgMy4zMzU5MSAwLjI4Mzk0MSAzLjY4NzkyIDAuNTUxNTA1IDMuOTQyMjIgMC45MDMwNkMgNC4xOTY1MiAxLjI1NDYyIDQuMzQxNjkgMS42NzQzNiA0LjM1OTM1IDIuMTA5MTZDIDQuMzgyOTkgMi42OTEwNyA0LjE3Njc4IDMuMjU4NjkgMy43ODU5NyAzLjY4NzQ2QyAzLjM5NTE2IDQuMTE2MjQgMi44NTE2NiA0LjM3MTE2IDIuMjc0NzEgNC4zOTYyOUwgMi4yNzQ3MSA0LjM5NjI5WiIvPgogICAgPC9nPgogIDwvZz4+Cjwvc3ZnPgo=);
  --jp-icon-jupyterlab-wordmark: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAiIHZpZXdCb3g9IjAgMCAxODYwLjggNDc1Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjIiIGZpbGw9IiM0RTRFNEUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ4MC4xMzY0MDEsIDY0LjI3MTQ5MykiPgogICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDU4Ljg3NTU2NikiPgogICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjA4NzYwMywgMC4xNDAyOTQpIj4KICAgICAgICA8cGF0aCBkPSJNLTQyNi45LDE2OS44YzAsNDguNy0zLjcsNjQuNy0xMy42LDc2LjRjLTEwLjgsMTAtMjUsMTUuNS0zOS43LDE1LjVsMy43LDI5IGMyMi44LDAuMyw0NC44LTcuOSw2MS45LTIzLjFjMTcuOC0xOC41LDI0LTQ0LjEsMjQtODMuM1YwSC00Mjd2MTcwLjFMLTQyNi45LDE2OS44TC00MjYuOSwxNjkuOHoiLz4KICAgICAgPC9nPgogICAgPC9nPgogICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTU1LjA0NTI5NiwgNTYuODM3MTA0KSI+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEuNTYyNDUzLCAxLjc5OTg0MikiPgogICAgICAgIDxwYXRoIGQ9Ik0tMzEyLDE0OGMwLDIxLDAsMzkuNSwxLjcsNTUuNGgtMzEuOGwtMi4xLTMzLjNoLTAuOGMtNi43LDExLjYtMTYuNCwyMS4zLTI4LDI3LjkgYy0xMS42LDYuNi0yNC44LDEwLTM4LjIsOS44Yy0zMS40LDAtNjktMTcuNy02OS04OVYwaDM2LjR2MTEyLjdjMCwzOC43LDExLjYsNjQuNyw0NC42LDY0LjdjMTAuMy0wLjIsMjAuNC0zLjUsMjguOS05LjQgYzguNS01LjksMTUuMS0xNC4zLDE4LjktMjMuOWMyLjItNi4xLDMuMy0xMi41LDMuMy0xOC45VjAuMmgzNi40VjE0OEgtMzEyTC0zMTIsMTQ4eiIvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzOTAuMDEzMzIyLCA1My40Nzk2MzgpIj4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMS43MDY0NTgsIDAuMjMxNDI1KSI+CiAgICAgICAgPHBhdGggZD0iTS00NzguNiw3MS40YzAtMjYtMC44LTQ3LTEuNy02Ni43aDMyLjdsMS43LDM0LjhoMC44YzcuMS0xMi41LDE3LjUtMjIuOCwzMC4xLTI5LjcgYzEyLjUtNywyNi43LTEwLjMsNDEtOS44YzQ4LjMsMCw4NC43LDQxLjcsODQuNywxMDMuM2MwLDczLjEtNDMuNywxMDkuMi05MSwxMDkuMmMtMTIuMSwwLjUtMjQuMi0yLjItMzUtNy44IGMtMTAuOC01LjYtMTkuOS0xMy45LTI2LjYtMjQuMmgtMC44VjI5MWgtMzZ2LTIyMEwtNDc4LjYsNzEuNEwtNDc4LjYsNzEuNHogTS00NDIuNiwxMjUuNmMwLjEsNS4xLDAuNiwxMC4xLDEuNywxNS4xIGMzLDEyLjMsOS45LDIzLjMsMTkuOCwzMS4xYzkuOSw3LjgsMjIuMSwxMi4xLDM0LjcsMTIuMWMzOC41LDAsNjAuNy0zMS45LDYwLjctNzguNWMwLTQwLjctMjEuMS03NS42LTU5LjUtNzUuNiBjLTEyLjksMC40LTI1LjMsNS4xLTM1LjMsMTMuNGMtOS45LDguMy0xNi45LDE5LjctMTkuNiwzMi40Yy0xLjUsNC45LTIuMywxMC0yLjUsMTUuMVYxMjUuNkwtNDQyLjYsMTI1LjZMLTQ0Mi42LDEyNS42eiIvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2MDYuNzQwNzI2LCA1Ni44MzcxMDQpIj4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC43NTEyMjYsIDEuOTg5Mjk5KSI+CiAgICAgICAgPHBhdGggZD0iTS00NDAuOCwwbDQzLjcsMTIwLjFjNC41LDEzLjQsOS41LDI5LjQsMTIuOCw0MS43aDAuOGMzLjctMTIuMiw3LjktMjcuNywxMi44LTQyLjQgbDM5LjctMTE5LjJoMzguNUwtMzQ2LjksMTQ1Yy0yNiw2OS43LTQzLjcsMTA1LjQtNjguNiwxMjcuMmMtMTIuNSwxMS43LTI3LjksMjAtNDQuNiwyMy45bC05LjEtMzEuMSBjMTEuNy0zLjksMjIuNS0xMC4xLDMxLjgtMTguMWMxMy4yLTExLjEsMjMuNy0yNS4yLDMwLjYtNDEuMmMxLjUtMi44LDIuNS01LjcsMi45LTguOGMtMC4zLTMuMy0xLjItNi42LTIuNS05LjdMLTQ4MC4yLDAuMSBoMzkuN0wtNDQwLjgsMEwtNDQwLjgsMHoiLz4KICAgICAgPC9nPgogICAgPC9nPgogICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoODIyLjc0ODEwNCwgMC4wMDAwMDApIj4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMS40NjQwNTAsIDAuMzc4OTE0KSI+CiAgICAgICAgPHBhdGggZD0iTS00MTMuNywwdjU4LjNoNTJ2MjguMmgtNTJWMTk2YzAsMjUsNywzOS41LDI3LjMsMzkuNWM3LjEsMC4xLDE0LjItMC43LDIxLjEtMi41IGwxLjcsMjcuN2MtMTAuMywzLjctMjEuMyw1LjQtMzIuMiw1Yy03LjMsMC40LTE0LjYtMC43LTIxLjMtMy40Yy02LjgtMi43LTEyLjktNi44LTE3LjktMTIuMWMtMTAuMy0xMC45LTE0LjEtMjktMTQuMS01Mi45IFY4Ni41aC0zMVY1OC4zaDMxVjkuNkwtNDEzLjcsMEwtNDEzLjcsMHoiLz4KICAgICAgPC9nPgogICAgPC9nPgogICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOTc0LjQzMzI4NiwgNTMuNDc5NjM4KSI+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuOTkwMDM0LCAwLjYxMDMzOSkiPgogICAgICAgIDxwYXRoIGQ9Ik0tNDQ1LjgsMTEzYzAuOCw1MCwzMi4yLDcwLjYsNjguNiw3MC42YzE5LDAuNiwzNy45LTMsNTUuMy0xMC41bDYuMiwyNi40IGMtMjAuOSw4LjktNDMuNSwxMy4xLTY2LjIsMTIuNmMtNjEuNSwwLTk4LjMtNDEuMi05OC4zLTEwMi41Qy00ODAuMiw0OC4yLTQ0NC43LDAtMzg2LjUsMGM2NS4yLDAsODIuNyw1OC4zLDgyLjcsOTUuNyBjLTAuMSw1LjgtMC41LDExLjUtMS4yLDE3LjJoLTE0MC42SC00NDUuOEwtNDQ1LjgsMTEzeiBNLTMzOS4yLDg2LjZjMC40LTIzLjUtOS41LTYwLjEtNTAuNC02MC4xIGMtMzYuOCwwLTUyLjgsMzQuNC01NS43LDYwLjFILTMzOS4yTC0zMzkuMiw4Ni42TC0zMzkuMiw4Ni42eiIvPgogICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjAxLjk2MTA1OCwgNTMuNDc5NjM4KSI+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEuMTc5NjQwLCAwLjcwNTA2OCkiPgogICAgICAgIDxwYXRoIGQ9Ik0tNDc4LjYsNjhjMC0yMy45LTAuNC00NC41LTEuNy02My40aDMxLjhsMS4yLDM5LjloMS43YzkuMS0yNy4zLDMxLTQ0LjUsNTUuMy00NC41IGMzLjUtMC4xLDcsMC40LDEwLjMsMS4ydjM0LjhjLTQuMS0wLjktOC4yLTEuMy0xMi40LTEuMmMtMjUuNiwwLTQzLjcsMTkuNy00OC43LDQ3LjRjLTEsNS43LTEuNiwxMS41LTEuNywxNy4ydjEwOC4zaC0zNlY2OCBMLTQ3OC42LDY4eiIvPgogICAgICA8L2c+CiAgICA8L2c+CiAgPC9nPgoKICA8ZyBjbGFzcz0ianAtaWNvbi13YXJuMCIgZmlsbD0iI0YzNzcyNiI+CiAgICA8cGF0aCBkPSJNMTM1Mi4zLDMyNi4yaDM3VjI4aC0zN1YzMjYuMnogTTE2MDQuOCwzMjYuMmMtMi41LTEzLjktMy40LTMxLjEtMy40LTQ4Ljd2LTc2IGMwLTQwLjctMTUuMS04My4xLTc3LjMtODMuMWMtMjUuNiwwLTUwLDcuMS02Ni44LDE4LjFsOC40LDI0LjRjMTQuMy05LjIsMzQtMTUuMSw1My0xNS4xYzQxLjYsMCw0Ni4yLDMwLjIsNDYuMiw0N3Y0LjIgYy03OC42LTAuNC0xMjIuMywyNi41LTEyMi4zLDc1LjZjMCwyOS40LDIxLDU4LjQsNjIuMiw1OC40YzI5LDAsNTAuOS0xNC4zLDYyLjItMzAuMmgxLjNsMi45LDI1LjZIMTYwNC44eiBNMTU2NS43LDI1Ny43IGMwLDMuOC0wLjgsOC0yLjEsMTEuOGMtNS45LDE3LjItMjIuNywzNC00OS4yLDM0Yy0xOC45LDAtMzQuOS0xMS4zLTM0LjktMzUuM2MwLTM5LjUsNDUuOC00Ni42LDg2LjItNDUuOFYyNTcuN3ogTTE2OTguNSwzMjYuMiBsMS43LTMzLjZoMS4zYzE1LjEsMjYuOSwzOC43LDM4LjIsNjguMSwzOC4yYzQ1LjQsMCw5MS4yLTM2LjEsOTEuMi0xMDguOGMwLjQtNjEuNy0zNS4zLTEwMy43LTg1LjctMTAzLjcgYy0zMi44LDAtNTYuMywxNC43LTY5LjMsMzcuNGgtMC44VjI4aC0zNi42djI0NS43YzAsMTguMS0wLjgsMzguNi0xLjcsNTIuNUgxNjk4LjV6IE0xNzA0LjgsMjA4LjJjMC01LjksMS4zLTEwLjksMi4xLTE1LjEgYzcuNi0yOC4xLDMxLjEtNDUuNCw1Ni4zLTQ1LjRjMzkuNSwwLDYwLjUsMzQuOSw2MC41LDc1LjZjMCw0Ni42LTIzLjEsNzguMS02MS44LDc4LjFjLTI2LjksMC00OC4zLTE3LjYtNTUuNS00My4zIGMtMC44LTQuMi0xLjctOC44LTEuNy0xMy40VjIwOC4yeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-kernel: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiIgZmlsbD0iIzYxNjE2MSIgZD0iTTE1IDlIOXY2aDZWOXptLTIgNGgtMnYtMmgydjJ6bTgtMlY5aC0yVjdjMC0xLjEtLjktMi0yLTJoLTJWM2gtMnYyaC0yVjNIOXYySDdjLTEuMSAwLTIgLjktMiAydjJIM3YyaDJ2MkgzdjJoMnYyYzAgMS4xLjkgMiAyIDJoMnYyaDJ2LTJoMnYyaDJ2LTJoMmMxLjEgMCAyLS45IDItMnYtMmgydi0yaC0ydi0yaDJ6bS00IDZIN1Y3aDEwdjEweiIvPgo8L3N2Zz4K);
  --jp-icon-keyboard: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMjAgNUg0Yy0xLjEgMC0xLjk5LjktMS45OSAyTDIgMTdjMCAxLjEuOSAyIDIgMmgxNmMxLjEgMCAyLS45IDItMlY3YzAtMS4xLS45LTItMi0yem0tOSAzaDJ2MmgtMlY4em0wIDNoMnYyaC0ydi0yek04IDhoMnYySDhWOHptMCAzaDJ2Mkg4di0yem0tMSAySDV2LTJoMnYyem0wLTNINVY4aDJ2MnptOSA3SDh2LTJoOHYyem0wLTRoLTJ2LTJoMnYyem0wLTNoLTJWOGgydjJ6bTMgM2gtMnYtMmgydjJ6bTAtM2gtMlY4aDJ2MnoiLz4KPC9zdmc+Cg==);
  --jp-icon-launch: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMzIgMzIiIHdpZHRoPSIzMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik0yNiwyOEg2YTIuMDAyNywyLjAwMjcsMCwwLDEtMi0yVjZBMi4wMDI3LDIuMDAyNywwLDAsMSw2LDRIMTZWNkg2VjI2SDI2VjE2aDJWMjZBMi4wMDI3LDIuMDAyNywwLDAsMSwyNiwyOFoiLz4KICAgIDxwb2x5Z29uIHBvaW50cz0iMjAgMiAyMCA0IDI2LjU4NiA0IDE4IDEyLjU4NiAxOS40MTQgMTQgMjggNS40MTQgMjggMTIgMzAgMTIgMzAgMiAyMCAyIi8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-launcher: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMTkgMTlINVY1aDdWM0g1YTIgMiAwIDAwLTIgMnYxNGEyIDIgMCAwMDIgMmgxNGMxLjEgMCAyLS45IDItMnYtN2gtMnY3ek0xNCAzdjJoMy41OWwtOS44MyA5LjgzIDEuNDEgMS40MUwxOSA2LjQxVjEwaDJWM2gtN3oiLz4KPC9zdmc+Cg==);
  --jp-icon-line-form: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxwYXRoIGZpbGw9IndoaXRlIiBkPSJNNS44OCA0LjEyTDEzLjc2IDEybC03Ljg4IDcuODhMOCAyMmwxMC0xMEw4IDJ6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-link: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTMuOSAxMmMwLTEuNzEgMS4zOS0zLjEgMy4xLTMuMWg0VjdIN2MtMi43NiAwLTUgMi4yNC01IDVzMi4yNCA1IDUgNWg0di0xLjlIN2MtMS43MSAwLTMuMS0xLjM5LTMuMS0zLjF6TTggMTNoOHYtMkg4djJ6bTktNmgtNHYxLjloNGMxLjcxIDAgMy4xIDEuMzkgMy4xIDMuMXMtMS4zOSAzLjEtMy4xIDMuMWgtNFYxN2g0YzIuNzYgMCA1LTIuMjQgNS01cy0yLjI0LTUtNS01eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-list: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiM2MTYxNjEiIGQ9Ik0xOSA1djE0SDVWNWgxNG0xLjEtMkgzLjljLS41IDAtLjkuNC0uOS45djE2LjJjMCAuNC40LjkuOS45aDE2LjJjLjQgMCAuOS0uNS45LS45VjMuOWMwLS41LS41LS45LS45LS45ek0xMSA3aDZ2MmgtNlY3em0wIDRoNnYyaC02di0yem0wIDRoNnYyaC02ek03IDdoMnYySDd6bTAgNGgydjJIN3ptMCA0aDJ2Mkg3eiIvPgo8L3N2Zz4K);
  --jp-icon-markdown: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1jb250cmFzdDAganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjN0IxRkEyIiBkPSJNNSAxNC45aDEybC02LjEgNnptOS40LTYuOGMwLTEuMy0uMS0yLjktLjEtNC41LS40IDEuNC0uOSAyLjktMS4zIDQuM2wtMS4zIDQuM2gtMkw4LjUgNy45Yy0uNC0xLjMtLjctMi45LTEtNC4zLS4xIDEuNi0uMSAzLjItLjIgNC42TDcgMTIuNEg0LjhsLjctMTFoMy4zTDEwIDVjLjQgMS4yLjcgMi43IDEgMy45LjMtMS4yLjctMi42IDEtMy45bDEuMi0zLjdoMy4zbC42IDExaC0yLjRsLS4zLTQuMnoiLz4KPC9zdmc+Cg==);
  --jp-icon-move-down: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBkPSJNMTIuNDcxIDcuNTI4OTlDMTIuNzYzMiA3LjIzNjg0IDEyLjc2MzIgNi43NjMxNiAxMi40NzEgNi40NzEwMVY2LjQ3MTAxQzEyLjE3OSA2LjE3OTA1IDExLjcwNTcgNi4xNzg4NCAxMS40MTM1IDYuNDcwNTRMNy43NSAxMC4xMjc1VjEuNzVDNy43NSAxLjMzNTc5IDcuNDE0MjEgMSA3IDFWMUM2LjU4NTc5IDEgNi4yNSAxLjMzNTc5IDYuMjUgMS43NVYxMC4xMjc1TDIuNTk3MjYgNi40NjgyMkMyLjMwMzM4IDYuMTczODEgMS44MjY0MSA2LjE3MzU5IDEuNTMyMjYgNi40Njc3NFY2LjQ2Nzc0QzEuMjM4MyA2Ljc2MTcgMS4yMzgzIDcuMjM4MyAxLjUzMjI2IDcuNTMyMjZMNi4yOTI4OSAxMi4yOTI5QzYuNjgzNDIgMTIuNjgzNCA3LjMxNjU4IDEyLjY4MzQgNy43MDcxMSAxMi4yOTI5TDEyLjQ3MSA3LjUyODk5WiIgZmlsbD0iIzYxNjE2MSIvPgo8L3N2Zz4K);
  --jp-icon-move-up: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggY2xhc3M9ImpwLWljb24zIiBkPSJNMS41Mjg5OSA2LjQ3MTAxQzEuMjM2ODQgNi43NjMxNiAxLjIzNjg0IDcuMjM2ODQgMS41Mjg5OSA3LjUyODk5VjcuNTI4OTlDMS44MjA5NSA3LjgyMDk1IDIuMjk0MjYgNy44MjExNiAyLjU4NjQ5IDcuNTI5NDZMNi4yNSAzLjg3MjVWMTIuMjVDNi4yNSAxMi42NjQyIDYuNTg1NzkgMTMgNyAxM1YxM0M3LjQxNDIxIDEzIDcuNzUgMTIuNjY0MiA3Ljc1IDEyLjI1VjMuODcyNUwxMS40MDI3IDcuNTMxNzhDMTEuNjk2NiA3LjgyNjE5IDEyLjE3MzYgNy44MjY0MSAxMi40Njc3IDcuNTMyMjZWNy41MzIyNkMxMi43NjE3IDcuMjM4MyAxMi43NjE3IDYuNzYxNyAxMi40Njc3IDYuNDY3NzRMNy43MDcxMSAxLjcwNzExQzcuMzE2NTggMS4zMTY1OCA2LjY4MzQyIDEuMzE2NTggNi4yOTI4OSAxLjcwNzExTDEuNTI4OTkgNi40NzEwMVoiIGZpbGw9IiM2MTYxNjEiLz4KPC9zdmc+Cg==);
  --jp-icon-new-folder: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTIwIDZoLThsLTItMkg0Yy0xLjExIDAtMS45OS44OS0xLjk5IDJMMiAxOGMwIDEuMTEuODkgMiAyIDJoMTZjMS4xMSAwIDItLjg5IDItMlY4YzAtMS4xMS0uODktMi0yLTJ6bS0xIDhoLTN2M2gtMnYtM2gtM3YtMmgzVjloMnYzaDN2MnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-not-trusted: url(data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI1IDI1Ij4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiIgc3Ryb2tlPSIjMzMzMzMzIiBzdHJva2Utd2lkdGg9IjIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMgMykiIGQ9Ik0xLjg2MDk0IDExLjQ0MDlDMC44MjY0NDggOC43NzAyNyAwLjg2Mzc3OSA2LjA1NzY0IDEuMjQ5MDcgNC4xOTkzMkMyLjQ4MjA2IDMuOTMzNDcgNC4wODA2OCAzLjQwMzQ3IDUuNjAxMDIgMi44NDQ5QzcuMjM1NDkgMi4yNDQ0IDguODU2NjYgMS41ODE1IDkuOTg3NiAxLjA5NTM5QzExLjA1OTcgMS41ODM0MSAxMi42MDk0IDIuMjQ0NCAxNC4yMTggMi44NDMzOUMxNS43NTAzIDMuNDEzOTQgMTcuMzk5NSAzLjk1MjU4IDE4Ljc1MzkgNC4yMTM4NUMxOS4xMzY0IDYuMDcxNzcgMTkuMTcwOSA4Ljc3NzIyIDE4LjEzOSAxMS40NDA5QzE3LjAzMDMgMTQuMzAzMiAxNC42NjY4IDE3LjE4NDQgOS45OTk5OSAxOC45MzU0QzUuMzMzMTkgMTcuMTg0NCAyLjk2OTY4IDE0LjMwMzIgMS44NjA5NCAxMS40NDA5WiIvPgogICAgPHBhdGggY2xhc3M9ImpwLWljb24yIiBzdHJva2U9IiMzMzMzMzMiIHN0cm9rZS13aWR0aD0iMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOS4zMTU5MiA5LjMyMDMxKSIgZD0iTTcuMzY4NDIgMEwwIDcuMzY0NzkiLz4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiIgc3Ryb2tlPSIjMzMzMzMzIiBzdHJva2Utd2lkdGg9IjIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDkuMzE1OTIgMTYuNjgzNikgc2NhbGUoMSAtMSkiIGQ9Ik03LjM2ODQyIDBMMCA3LjM2NDc5Ii8+Cjwvc3ZnPgo=);
  --jp-icon-notebook: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8ZyBjbGFzcz0ianAtbm90ZWJvb2staWNvbi1jb2xvciBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiNFRjZDMDAiPgogICAgPHBhdGggZD0iTTE4LjcgMy4zdjE1LjRIMy4zVjMuM2gxNS40bTEuNS0xLjVIMS44djE4LjNoMTguM2wuMS0xOC4zeiIvPgogICAgPHBhdGggZD0iTTE2LjUgMTYuNWwtNS40LTQuMy01LjYgNC4zdi0xMWgxMXoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-numbering: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyOCAyOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CgkJPHBhdGggZD0iTTQgMTlINlYxOS41SDVWMjAuNUg2VjIxSDRWMjJIN1YxOEg0VjE5Wk01IDEwSDZWNkg0VjdINVYxMFpNNCAxM0g1LjhMNCAxNS4xVjE2SDdWMTVINS4yTDcgMTIuOVYxMkg0VjEzWk05IDdWOUgyM1Y3SDlaTTkgMjFIMjNWMTlIOVYyMVpNOSAxNUgyM1YxM0g5VjE1WiIvPgoJPC9nPgo8L3N2Zz4K);
  --jp-icon-offline-bolt: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE2Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEyIDIuMDJjLTUuNTEgMC05Ljk4IDQuNDctOS45OCA5Ljk4czQuNDcgOS45OCA5Ljk4IDkuOTggOS45OC00LjQ3IDkuOTgtOS45OFMxNy41MSAyLjAyIDEyIDIuMDJ6TTExLjQ4IDIwdi02LjI2SDhMMTMgNHY2LjI2aDMuMzVMMTEuNDggMjB6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-palette: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE4IDEzVjIwSDRWNkg5LjAyQzkuMDcgNS4yOSA5LjI0IDQuNjIgOS41IDRINEMyLjkgNCAyIDQuOSAyIDZWMjBDMiAyMS4xIDIuOSAyMiA0IDIySDE4QzE5LjEgMjIgMjAgMjEuMSAyMCAyMFYxNUwxOCAxM1pNMTkuMyA4Ljg5QzE5Ljc0IDguMTkgMjAgNy4zOCAyMCA2LjVDMjAgNC4wMSAxNy45OSAyIDE1LjUgMkMxMy4wMSAyIDExIDQuMDEgMTEgNi41QzExIDguOTkgMTMuMDEgMTEgMTUuNDkgMTFDMTYuMzcgMTEgMTcuMTkgMTAuNzQgMTcuODggMTAuM0wyMSAxMy40MkwyMi40MiAxMkwxOS4zIDguODlaTTE1LjUgOUMxNC4xMiA5IDEzIDcuODggMTMgNi41QzEzIDUuMTIgMTQuMTIgNCAxNS41IDRDMTYuODggNCAxOCA1LjEyIDE4IDYuNUMxOCA3Ljg4IDE2Ljg4IDkgMTUuNSA5WiIvPgogICAgPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00IDZIOS4wMTg5NEM5LjAwNjM5IDYuMTY1MDIgOSA2LjMzMTc2IDkgNi41QzkgOC44MTU3NyAxMC4yMTEgMTAuODQ4NyAxMi4wMzQzIDEySDlWMTRIMTZWMTIuOTgxMUMxNi41NzAzIDEyLjkzNzcgMTcuMTIgMTIuODIwNyAxNy42Mzk2IDEyLjYzOTZMMTggMTNWMjBINFY2Wk04IDhINlYxMEg4VjhaTTYgMTJIOFYxNEg2VjEyWk04IDE2SDZWMThIOFYxNlpNOSAxNkgxNlYxOEg5VjE2WiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-paste: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTE5IDJoLTQuMThDMTQuNC44NCAxMy4zIDAgMTIgMGMtMS4zIDAtMi40Ljg0LTIuODIgMkg1Yy0xLjEgMC0yIC45LTIgMnYxNmMwIDEuMS45IDIgMiAyaDE0YzEuMSAwIDItLjkgMi0yVjRjMC0xLjEtLjktMi0yLTJ6bS03IDBjLjU1IDAgMSAuNDUgMSAxcy0uNDUgMS0xIDEtMS0uNDUtMS0xIC40NS0xIDEtMXptNyAxOEg1VjRoMnYzaDEwVjRoMnYxNnoiLz4KICAgIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-pdf: url(data:image/svg+xml;base64,PHN2ZwogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMiAyMiIgd2lkdGg9IjE2Ij4KICAgIDxwYXRoIHRyYW5zZm9ybT0icm90YXRlKDQ1KSIgY2xhc3M9ImpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iI0ZGMkEyQSIKICAgICAgIGQ9Im0gMjIuMzQ0MzY5LC0zLjAxNjM2NDIgaCA1LjYzODYwNCB2IDEuNTc5MjQzMyBoIC0zLjU0OTIyNyB2IDEuNTA4NjkyOTkgaCAzLjMzNzU3NiBWIDEuNjUwODE1NCBoIC0zLjMzNzU3NiB2IDMuNDM1MjYxMyBoIC0yLjA4OTM3NyB6IG0gLTcuMTM2NDQ0LDEuNTc5MjQzMyB2IDQuOTQzOTU0MyBoIDAuNzQ4OTIgcSAxLjI4MDc2MSwwIDEuOTUzNzAzLC0wLjYzNDk1MzUgMC42NzgzNjksLTAuNjM0OTUzNSAwLjY3ODM2OSwtMS44NDUxNjQxIDAsLTEuMjA0NzgzNTUgLTAuNjcyOTQyLC0xLjgzNDMxMDExIC0wLjY3Mjk0MiwtMC42Mjk1MjY1OSAtMS45NTkxMywtMC42Mjk1MjY1OSB6IG0gLTIuMDg5Mzc3LC0xLjU3OTI0MzMgaCAyLjIwMzM0MyBxIDEuODQ1MTY0LDAgMi43NDYwMzksMC4yNjU5MjA3IDAuOTA2MzAxLDAuMjYwNDkzNyAxLjU1MjEwOCwwLjg5MDAyMDMgMC41Njk4MywwLjU0ODEyMjMgMC44NDY2MDUsMS4yNjQ0ODAwNiAwLjI3Njc3NCwwLjcxNjM1NzgxIDAuMjc2Nzc0LDEuNjIyNjU4OTQgMCwwLjkxNzE1NTEgLTAuMjc2Nzc0LDEuNjM4OTM5OSAtMC4yNzY3NzUsMC43MTYzNTc4IC0wLjg0NjYwNSwxLjI2NDQ4IC0wLjY1MTIzNCwwLjYyOTUyNjYgLTEuNTYyOTYyLDAuODk1NDQ3MyAtMC45MTE3MjgsMC4yNjA0OTM3IC0yLjczNTE4NSwwLjI2MDQ5MzcgaCAtMi4yMDMzNDMgeiBtIC04LjE0NTg1NjUsMCBoIDMuNDY3ODIzIHEgMS41NDY2ODE2LDAgMi4zNzE1Nzg1LDAuNjg5MjIzIDAuODMwMzI0LDAuNjgzNzk2MSAwLjgzMDMyNCwxLjk1MzcwMzE0IDAsMS4yNzUzMzM5NyAtMC44MzAzMjQsMS45NjQ1NTcwNiBRIDkuOTg3MTk2MSwyLjI3NDkxNSA4LjQ0MDUxNDUsMi4yNzQ5MTUgSCA3LjA2MjA2ODQgViA1LjA4NjA3NjcgSCA0Ljk3MjY5MTUgWiBtIDIuMDg5Mzc2OSwxLjUxNDExOTkgdiAyLjI2MzAzOTQzIGggMS4xNTU5NDEgcSAwLjYwNzgxODgsMCAwLjkzODg2MjksLTAuMjkzMDU1NDcgMC4zMzEwNDQxLC0wLjI5ODQ4MjQxIDAuMzMxMDQ0MSwtMC44NDExNzc3MiAwLC0wLjU0MjY5NTMxIC0wLjMzMTA0NDEsLTAuODM1NzUwNzQgLTAuMzMxMDQ0MSwtMC4yOTMwNTU1IC0wLjkzODg2MjksLTAuMjkzMDU1NSB6IgovPgo8L3N2Zz4K);
  --jp-icon-python: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iLTEwIC0xMCAxMzEuMTYxMzYxNjk0MzM1OTQgMTMyLjM4ODk5OTkzODk2NDg0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjMzA2OTk4IiBkPSJNIDU0LjkxODc4NSw5LjE5Mjc0MjFlLTQgQyA1MC4zMzUxMzIsMC4wMjIyMTcyNyA0NS45NTc4NDYsMC40MTMxMzY5NyA0Mi4xMDYyODUsMS4wOTQ2NjkzIDMwLjc2MDA2OSwzLjA5OTE3MzEgMjguNzAwMDM2LDcuMjk0NzcxNCAyOC43MDAwMzUsMTUuMDMyMTY5IHYgMTAuMjE4NzUgaCAyNi44MTI1IHYgMy40MDYyNSBoIC0yNi44MTI1IC0xMC4wNjI1IGMgLTcuNzkyNDU5LDAgLTE0LjYxNTc1ODgsNC42ODM3MTcgLTE2Ljc0OTk5OTgsMTMuNTkzNzUgLTIuNDYxODE5OTgsMTAuMjEyOTY2IC0yLjU3MTAxNTA4LDE2LjU4NjAyMyAwLDI3LjI1IDEuOTA1OTI4Myw3LjkzNzg1MiA2LjQ1NzU0MzIsMTMuNTkzNzQ4IDE0LjI0OTk5OTgsMTMuNTkzNzUgaCA5LjIxODc1IHYgLTEyLjI1IGMgMCwtOC44NDk5MDIgNy42NTcxNDQsLTE2LjY1NjI0OCAxNi43NSwtMTYuNjU2MjUgaCAyNi43ODEyNSBjIDcuNDU0OTUxLDAgMTMuNDA2MjUzLC02LjEzODE2NCAxMy40MDYyNSwtMTMuNjI1IHYgLTI1LjUzMTI1IGMgMCwtNy4yNjYzMzg2IC02LjEyOTk4LC0xMi43MjQ3NzcxIC0xMy40MDYyNSwtMTMuOTM3NDk5NyBDIDY0LjI4MTU0OCwwLjMyNzk0Mzk3IDU5LjUwMjQzOCwtMC4wMjAzNzkwMyA1NC45MTg3ODUsOS4xOTI3NDIxZS00IFogbSAtMTQuNSw4LjIxODc1MDEyNTc5IGMgMi43Njk1NDcsMCA1LjAzMTI1LDIuMjk4NjQ1NiA1LjAzMTI1LDUuMTI0OTk5NiAtMmUtNiwyLjgxNjMzNiAtMi4yNjE3MDMsNS4wOTM3NSAtNS4wMzEyNSw1LjA5Mzc1IC0yLjc3OTQ3NiwtMWUtNiAtNS4wMzEyNSwtMi4yNzc0MTUgLTUuMDMxMjUsLTUuMDkzNzUgLTEwZS03LC0yLjgyNjM1MyAyLjI1MTc3NCwtNS4xMjQ5OTk2IDUuMDMxMjUsLTUuMTI0OTk5NiB6Ii8+CiAgPHBhdGggY2xhc3M9ImpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iI2ZmZDQzYiIgZD0ibSA4NS42Mzc1MzUsMjguNjU3MTY5IHYgMTEuOTA2MjUgYyAwLDkuMjMwNzU1IC03LjgyNTg5NSwxNi45OTk5OTkgLTE2Ljc1LDE3IGggLTI2Ljc4MTI1IGMgLTcuMzM1ODMzLDAgLTEzLjQwNjI0OSw2LjI3ODQ4MyAtMTMuNDA2MjUsMTMuNjI1IHYgMjUuNTMxMjQ3IGMgMCw3LjI2NjM0NCA2LjMxODU4OCwxMS41NDAzMjQgMTMuNDA2MjUsMTMuNjI1MDA0IDguNDg3MzMxLDIuNDk1NjEgMTYuNjI2MjM3LDIuOTQ2NjMgMjYuNzgxMjUsMCA2Ljc1MDE1NSwtMS45NTQzOSAxMy40MDYyNTMsLTUuODg3NjEgMTMuNDA2MjUsLTEzLjYyNTAwNCBWIDg2LjUwMDkxOSBoIC0yNi43ODEyNSB2IC0zLjQwNjI1IGggMjYuNzgxMjUgMTMuNDA2MjU0IGMgNy43OTI0NjEsMCAxMC42OTYyNTEsLTUuNDM1NDA4IDEzLjQwNjI0MSwtMTMuNTkzNzUgMi43OTkzMywtOC4zOTg4ODYgMi42ODAyMiwtMTYuNDc1Nzc2IDAsLTI3LjI1IC0xLjkyNTc4LC03Ljc1NzQ0MSAtNS42MDM4NywtMTMuNTkzNzUgLTEzLjQwNjI0MSwtMTMuNTkzNzUgeiBtIC0xNS4wNjI1LDY0LjY1NjI1IGMgMi43Nzk0NzgsM2UtNiA1LjAzMTI1LDIuMjc3NDE3IDUuMDMxMjUsNS4wOTM3NDcgLTJlLTYsMi44MjYzNTQgLTIuMjUxNzc1LDUuMTI1MDA0IC01LjAzMTI1LDUuMTI1MDA0IC0yLjc2OTU1LDAgLTUuMDMxMjUsLTIuMjk4NjUgLTUuMDMxMjUsLTUuMTI1MDA0IDJlLTYsLTIuODE2MzMgMi4yNjE2OTcsLTUuMDkzNzQ3IDUuMDMxMjUsLTUuMDkzNzQ3IHoiLz4KPC9zdmc+Cg==);
  --jp-icon-r-kernel: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1jb250cmFzdDMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjMjE5NkYzIiBkPSJNNC40IDIuNWMxLjItLjEgMi45LS4zIDQuOS0uMyAyLjUgMCA0LjEuNCA1LjIgMS4zIDEgLjcgMS41IDEuOSAxLjUgMy41IDAgMi0xLjQgMy41LTIuOSA0LjEgMS4yLjQgMS43IDEuNiAyLjIgMyAuNiAxLjkgMSAzLjkgMS4zIDQuNmgtMy44Yy0uMy0uNC0uOC0xLjctMS4yLTMuN3MtMS4yLTIuNi0yLjYtMi42aC0uOXY2LjRINC40VjIuNXptMy43IDYuOWgxLjRjMS45IDAgMi45LS45IDIuOS0yLjNzLTEtMi4zLTIuOC0yLjNjLS43IDAtMS4zIDAtMS42LjJ2NC41aC4xdi0uMXoiLz4KPC9zdmc+Cg==);
  --jp-icon-react: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMTUwIDE1MCA1NDEuOSAyOTUuMyI+CiAgPGcgY2xhc3M9ImpwLWljb24tYnJhbmQyIGpwLWljb24tc2VsZWN0YWJsZSIgZmlsbD0iIzYxREFGQiI+CiAgICA8cGF0aCBkPSJNNjY2LjMgMjk2LjVjMC0zMi41LTQwLjctNjMuMy0xMDMuMS04Mi40IDE0LjQtNjMuNiA4LTExNC4yLTIwLjItMTMwLjQtNi41LTMuOC0xNC4xLTUuNi0yMi40LTUuNnYyMi4zYzQuNiAwIDguMy45IDExLjQgMi42IDEzLjYgNy44IDE5LjUgMzcuNSAxNC45IDc1LjctMS4xIDkuNC0yLjkgMTkuMy01LjEgMjkuNC0xOS42LTQuOC00MS04LjUtNjMuNS0xMC45LTEzLjUtMTguNS0yNy41LTM1LjMtNDEuNi01MCAzMi42LTMwLjMgNjMuMi00Ni45IDg0LTQ2LjlWNzhjLTI3LjUgMC02My41IDE5LjYtOTkuOSA1My42LTM2LjQtMzMuOC03Mi40LTUzLjItOTkuOS01My4ydjIyLjNjMjAuNyAwIDUxLjQgMTYuNSA4NCA0Ni42LTE0IDE0LjctMjggMzEuNC00MS4zIDQ5LjktMjIuNiAyLjQtNDQgNi4xLTYzLjYgMTEtMi4zLTEwLTQtMTkuNy01LjItMjktNC43LTM4LjIgMS4xLTY3LjkgMTQuNi03NS44IDMtMS44IDYuOS0yLjYgMTEuNS0yLjZWNzguNWMtOC40IDAtMTYgMS44LTIyLjYgNS42LTI4LjEgMTYuMi0zNC40IDY2LjctMTkuOSAxMzAuMS02Mi4yIDE5LjItMTAyLjcgNDkuOS0xMDIuNyA4Mi4zIDAgMzIuNSA0MC43IDYzLjMgMTAzLjEgODIuNC0xNC40IDYzLjYtOCAxMTQuMiAyMC4yIDEzMC40IDYuNSAzLjggMTQuMSA1LjYgMjIuNSA1LjYgMjcuNSAwIDYzLjUtMTkuNiA5OS45LTUzLjYgMzYuNCAzMy44IDcyLjQgNTMuMiA5OS45IDUzLjIgOC40IDAgMTYtMS44IDIyLjYtNS42IDI4LjEtMTYuMiAzNC40LTY2LjcgMTkuOS0xMzAuMSA2Mi0xOS4xIDEwMi41LTQ5LjkgMTAyLjUtODIuM3ptLTEzMC4yLTY2LjdjLTMuNyAxMi45LTguMyAyNi4yLTEzLjUgMzkuNS00LjEtOC04LjQtMTYtMTMuMS0yNC00LjYtOC05LjUtMTUuOC0xNC40LTIzLjQgMTQuMiAyLjEgMjcuOSA0LjcgNDEgNy45em0tNDUuOCAxMDYuNWMtNy44IDEzLjUtMTUuOCAyNi4zLTI0LjEgMzguMi0xNC45IDEuMy0zMCAyLTQ1LjIgMi0xNS4xIDAtMzAuMi0uNy00NS0xLjktOC4zLTExLjktMTYuNC0yNC42LTI0LjItMzgtNy42LTEzLjEtMTQuNS0yNi40LTIwLjgtMzkuOCA2LjItMTMuNCAxMy4yLTI2LjggMjAuNy0zOS45IDcuOC0xMy41IDE1LjgtMjYuMyAyNC4xLTM4LjIgMTQuOS0xLjMgMzAtMiA0NS4yLTIgMTUuMSAwIDMwLjIuNyA0NSAxLjkgOC4zIDExLjkgMTYuNCAyNC42IDI0LjIgMzggNy42IDEzLjEgMTQuNSAyNi40IDIwLjggMzkuOC02LjMgMTMuNC0xMy4yIDI2LjgtMjAuNyAzOS45em0zMi4zLTEzYzUuNCAxMy40IDEwIDI2LjggMTMuOCAzOS44LTEzLjEgMy4yLTI2LjkgNS45LTQxLjIgOCA0LjktNy43IDkuOC0xNS42IDE0LjQtMjMuNyA0LjYtOCA4LjktMTYuMSAxMy0yNC4xek00MjEuMiA0MzBjLTkuMy05LjYtMTguNi0yMC4zLTI3LjgtMzIgOSAuNCAxOC4yLjcgMjcuNS43IDkuNCAwIDE4LjctLjIgMjcuOC0uNy05IDExLjctMTguMyAyMi40LTI3LjUgMzJ6bS03NC40LTU4LjljLTE0LjItMi4xLTI3LjktNC43LTQxLTcuOSAzLjctMTIuOSA4LjMtMjYuMiAxMy41LTM5LjUgNC4xIDggOC40IDE2IDEzLjEgMjQgNC43IDggOS41IDE1LjggMTQuNCAyMy40ek00MjAuNyAxNjNjOS4zIDkuNiAxOC42IDIwLjMgMjcuOCAzMi05LS40LTE4LjItLjctMjcuNS0uNy05LjQgMC0xOC43LjItMjcuOC43IDktMTEuNyAxOC4zLTIyLjQgMjcuNS0zMnptLTc0IDU4LjljLTQuOSA3LjctOS44IDE1LjYtMTQuNCAyMy43LTQuNiA4LTguOSAxNi0xMyAyNC01LjQtMTMuNC0xMC0yNi44LTEzLjgtMzkuOCAxMy4xLTMuMSAyNi45LTUuOCA0MS4yLTcuOXptLTkwLjUgMTI1LjJjLTM1LjQtMTUuMS01OC4zLTM0LjktNTguMy01MC42IDAtMTUuNyAyMi45LTM1LjYgNTguMy01MC42IDguNi0zLjcgMTgtNyAyNy43LTEwLjEgNS43IDE5LjYgMTMuMiA0MCAyMi41IDYwLjktOS4yIDIwLjgtMTYuNiA0MS4xLTIyLjIgNjAuNi05LjktMy4xLTE5LjMtNi41LTI4LTEwLjJ6TTMxMCA0OTBjLTEzLjYtNy44LTE5LjUtMzcuNS0xNC45LTc1LjcgMS4xLTkuNCAyLjktMTkuMyA1LjEtMjkuNCAxOS42IDQuOCA0MSA4LjUgNjMuNSAxMC45IDEzLjUgMTguNSAyNy41IDM1LjMgNDEuNiA1MC0zMi42IDMwLjMtNjMuMiA0Ni45LTg0IDQ2LjktNC41LS4xLTguMy0xLTExLjMtMi43em0yMzcuMi03Ni4yYzQuNyAzOC4yLTEuMSA2Ny45LTE0LjYgNzUuOC0zIDEuOC02LjkgMi42LTExLjUgMi42LTIwLjcgMC01MS40LTE2LjUtODQtNDYuNiAxNC0xNC43IDI4LTMxLjQgNDEuMy00OS45IDIyLjYtMi40IDQ0LTYuMSA2My42LTExIDIuMyAxMC4xIDQuMSAxOS44IDUuMiAyOS4xem0zOC41LTY2LjdjLTguNiAzLjctMTggNy0yNy43IDEwLjEtNS43LTE5LjYtMTMuMi00MC0yMi41LTYwLjkgOS4yLTIwLjggMTYuNi00MS4xIDIyLjItNjAuNiA5LjkgMy4xIDE5LjMgNi41IDI4LjEgMTAuMiAzNS40IDE1LjEgNTguMyAzNC45IDU4LjMgNTAuNi0uMSAxNS43LTIzIDM1LjYtNTguNCA1MC42ek0zMjAuOCA3OC40eiIvPgogICAgPGNpcmNsZSBjeD0iNDIwLjkiIGN5PSIyOTYuNSIgcj0iNDUuNyIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-redo: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE2Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTE4LjQgMTAuNkMxNi41NSA4Ljk5IDE0LjE1IDggMTEuNSA4Yy00LjY1IDAtOC41OCAzLjAzLTkuOTYgNy4yMkwzLjkgMTZjMS4wNS0zLjE5IDQuMDUtNS41IDcuNi01LjUgMS45NSAwIDMuNzMuNzIgNS4xMiAxLjg4TDEzIDE2aDlWN2wtMy42IDMuNnoiLz4KICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-refresh: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDE4IDE4Ij4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTkgMTMuNWMtMi40OSAwLTQuNS0yLjAxLTQuNS00LjVTNi41MSA0LjUgOSA0LjVjMS4yNCAwIDIuMzYuNTIgMy4xNyAxLjMzTDEwIDhoNVYzbC0xLjc2IDEuNzZDMTIuMTUgMy42OCAxMC42NiAzIDkgMyA1LjY5IDMgMy4wMSA1LjY5IDMuMDEgOVM1LjY5IDE1IDkgMTVjMi45NyAwIDUuNDMtMi4xNiA1LjktNWgtMS41MmMtLjQ2IDItMi4yNCAzLjUtNC4zOCAzLjV6Ii8+CiAgICA8L2c+Cjwvc3ZnPgo=);
  --jp-icon-regex: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KICA8ZyBjbGFzcz0ianAtaWNvbjIiIGZpbGw9IiM0MTQxNDEiPgogICAgPHJlY3QgeD0iMiIgeT0iMiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+CiAgPC9nPgoKICA8ZyBjbGFzcz0ianAtaWNvbi1hY2NlbnQyIiBmaWxsPSIjRkZGIj4KICAgIDxjaXJjbGUgY2xhc3M9InN0MiIgY3g9IjUuNSIgY3k9IjE0LjUiIHI9IjEuNSIvPgogICAgPHJlY3QgeD0iMTIiIHk9IjQiIGNsYXNzPSJzdDIiIHdpZHRoPSIxIiBoZWlnaHQ9IjgiLz4KICAgIDxyZWN0IHg9IjguNSIgeT0iNy41IiB0cmFuc2Zvcm09Im1hdHJpeCgwLjg2NiAtMC41IDAuNSAwLjg2NiAtMi4zMjU1IDcuMzIxOSkiIGNsYXNzPSJzdDIiIHdpZHRoPSI4IiBoZWlnaHQ9IjEiLz4KICAgIDxyZWN0IHg9IjEyIiB5PSI0IiB0cmFuc2Zvcm09Im1hdHJpeCgwLjUgLTAuODY2IDAuODY2IDAuNSAtMC42Nzc5IDE0LjgyNTIpIiBjbGFzcz0ic3QyIiB3aWR0aD0iMSIgaGVpZ2h0PSI4Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-run: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTggNXYxNGwxMS03eiIvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-running: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDUxMiA1MTIiPgogIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICA8cGF0aCBkPSJNMjU2IDhDMTE5IDggOCAxMTkgOCAyNTZzMTExIDI0OCAyNDggMjQ4IDI0OC0xMTEgMjQ4LTI0OFMzOTMgOCAyNTYgOHptOTYgMzI4YzAgOC44LTcuMiAxNi0xNiAxNkgxNzZjLTguOCAwLTE2LTcuMi0xNi0xNlYxNzZjMC04LjggNy4yLTE2IDE2LTE2aDE2MGM4LjggMCAxNiA3LjIgMTYgMTZ2MTYweiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-save: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTE3IDNINWMtMS4xMSAwLTIgLjktMiAydjE0YzAgMS4xLjg5IDIgMiAyaDE0YzEuMSAwIDItLjkgMi0yVjdsLTQtNHptLTUgMTZjLTEuNjYgMC0zLTEuMzQtMy0zczEuMzQtMyAzLTMgMyAxLjM0IDMgMy0xLjM0IDMtMyAzem0zLTEwSDVWNWgxMHY0eiIvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-search: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTggMTgiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEyLjEsMTAuOWgtMC43bC0wLjItMC4yYzAuOC0wLjksMS4zLTIuMiwxLjMtMy41YzAtMy0yLjQtNS40LTUuNC01LjRTMS44LDQuMiwxLjgsNy4xczIuNCw1LjQsNS40LDUuNCBjMS4zLDAsMi41LTAuNSwzLjUtMS4zbDAuMiwwLjJ2MC43bDQuMSw0LjFsMS4yLTEuMkwxMi4xLDEwLjl6IE03LjEsMTAuOWMtMi4xLDAtMy43LTEuNy0zLjctMy43czEuNy0zLjcsMy43LTMuN3MzLjcsMS43LDMuNywzLjcgUzkuMiwxMC45LDcuMSwxMC45eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-settings: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIiBkPSJNMTkuNDMgMTIuOThjLjA0LS4zMi4wNy0uNjQuMDctLjk4cy0uMDMtLjY2LS4wNy0uOThsMi4xMS0xLjY1Yy4xOS0uMTUuMjQtLjQyLjEyLS42NGwtMi0zLjQ2Yy0uMTItLjIyLS4zOS0uMy0uNjEtLjIybC0yLjQ5IDFjLS41Mi0uNC0xLjA4LS43My0xLjY5LS45OGwtLjM4LTIuNjVBLjQ4OC40ODggMCAwMDE0IDJoLTRjLS4yNSAwLS40Ni4xOC0uNDkuNDJsLS4zOCAyLjY1Yy0uNjEuMjUtMS4xNy41OS0xLjY5Ljk4bC0yLjQ5LTFjLS4yMy0uMDktLjQ5IDAtLjYxLjIybC0yIDMuNDZjLS4xMy4yMi0uMDcuNDkuMTIuNjRsMi4xMSAxLjY1Yy0uMDQuMzItLjA3LjY1LS4wNy45OHMuMDMuNjYuMDcuOThsLTIuMTEgMS42NWMtLjE5LjE1LS4yNC40Mi0uMTIuNjRsMiAzLjQ2Yy4xMi4yMi4zOS4zLjYxLjIybDIuNDktMWMuNTIuNCAxLjA4LjczIDEuNjkuOThsLjM4IDIuNjVjLjAzLjI0LjI0LjQyLjQ5LjQyaDRjLjI1IDAgLjQ2LS4xOC40OS0uNDJsLjM4LTIuNjVjLjYxLS4yNSAxLjE3LS41OSAxLjY5LS45OGwyLjQ5IDFjLjIzLjA5LjQ5IDAgLjYxLS4yMmwyLTMuNDZjLjEyLS4yMi4wNy0uNDktLjEyLS42NGwtMi4xMS0xLjY1ek0xMiAxNS41Yy0xLjkzIDAtMy41LTEuNTctMy41LTMuNXMxLjU3LTMuNSAzLjUtMy41IDMuNSAxLjU3IDMuNSAzLjUtMS41NyAzLjUtMy41IDMuNXoiLz4KPC9zdmc+Cg==);
  --jp-icon-share: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTSAxOCAyIEMgMTYuMzU0OTkgMiAxNSAzLjM1NDk5MDQgMTUgNSBDIDE1IDUuMTkwOTUyOSAxNS4wMjE3OTEgNS4zNzcxMjI0IDE1LjA1NjY0MSA1LjU1ODU5MzggTCA3LjkyMTg3NSA5LjcyMDcwMzEgQyA3LjM5ODUzOTkgOS4yNzc4NTM5IDYuNzMyMDc3MSA5IDYgOSBDIDQuMzU0OTkwNCA5IDMgMTAuMzU0OTkgMyAxMiBDIDMgMTMuNjQ1MDEgNC4zNTQ5OTA0IDE1IDYgMTUgQyA2LjczMjA3NzEgMTUgNy4zOTg1Mzk5IDE0LjcyMjE0NiA3LjkyMTg3NSAxNC4yNzkyOTcgTCAxNS4wNTY2NDEgMTguNDM5NDUzIEMgMTUuMDIxNTU1IDE4LjYyMTUxNCAxNSAxOC44MDgzODYgMTUgMTkgQyAxNSAyMC42NDUwMSAxNi4zNTQ5OSAyMiAxOCAyMiBDIDE5LjY0NTAxIDIyIDIxIDIwLjY0NTAxIDIxIDE5IEMgMjEgMTcuMzU0OTkgMTkuNjQ1MDEgMTYgMTggMTYgQyAxNy4yNjc0OCAxNiAxNi42MDE1OTMgMTYuMjc5MzI4IDE2LjA3ODEyNSAxNi43MjI2NTYgTCA4Ljk0MzM1OTQgMTIuNTU4NTk0IEMgOC45NzgyMDk1IDEyLjM3NzEyMiA5IDEyLjE5MDk1MyA5IDEyIEMgOSAxMS44MDkwNDcgOC45NzgyMDk1IDExLjYyMjg3OCA4Ljk0MzM1OTQgMTEuNDQxNDA2IEwgMTYuMDc4MTI1IDcuMjc5Mjk2OSBDIDE2LjYwMTQ2IDcuNzIyMTQ2MSAxNy4yNjc5MjMgOCAxOCA4IEMgMTkuNjQ1MDEgOCAyMSA2LjY0NTAwOTYgMjEgNSBDIDIxIDMuMzU0OTkwNCAxOS42NDUwMSAyIDE4IDIgeiBNIDE4IDQgQyAxOC41NjQxMjkgNCAxOSA0LjQzNTg3MDYgMTkgNSBDIDE5IDUuNTY0MTI5NCAxOC41NjQxMjkgNiAxOCA2IEMgMTcuNDM1ODcxIDYgMTcgNS41NjQxMjk0IDE3IDUgQyAxNyA0LjQzNTg3MDYgMTcuNDM1ODcxIDQgMTggNCB6IE0gNiAxMSBDIDYuNTY0MTI5NCAxMSA3IDExLjQzNTg3MSA3IDEyIEMgNyAxMi41NjQxMjkgNi41NjQxMjk0IDEzIDYgMTMgQyA1LjQzNTg3MDYgMTMgNSAxMi41NjQxMjkgNSAxMiBDIDUgMTEuNDM1ODcxIDUuNDM1ODcwNiAxMSA2IDExIHogTSAxOCAxOCBDIDE4LjU2NDEyOSAxOCAxOSAxOC40MzU4NzEgMTkgMTkgQyAxOSAxOS41NjQxMjkgMTguNTY0MTI5IDIwIDE4IDIwIEMgMTcuNDM1ODcxIDIwIDE3IDE5LjU2NDEyOSAxNyAxOSBDIDE3IDE4LjQzNTg3MSAxNy40MzU4NzEgMTggMTggMTggeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-spreadsheet: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8cGF0aCBjbGFzcz0ianAtaWNvbi1jb250cmFzdDEganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNENBRjUwIiBkPSJNMi4yIDIuMnYxNy42aDE3LjZWMi4ySDIuMnptMTUuNCA3LjdoLTUuNVY0LjRoNS41djUuNXpNOS45IDQuNHY1LjVINC40VjQuNGg1LjV6bS01LjUgNy43aDUuNXY1LjVINC40di01LjV6bTcuNyA1LjV2LTUuNWg1LjV2NS41aC01LjV6Ii8+Cjwvc3ZnPgo=);
  --jp-icon-stop: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPgogICAgICAgIDxwYXRoIGQ9Ik02IDZoMTJ2MTJINnoiLz4KICAgIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-tab: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTIxIDNIM2MtMS4xIDAtMiAuOS0yIDJ2MTRjMCAxLjEuOSAyIDIgMmgxOGMxLjEgMCAyLS45IDItMlY1YzAtMS4xLS45LTItMi0yem0wIDE2SDNWNWgxMHY0aDh2MTB6Ii8+CiAgPC9nPgo8L3N2Zz4K);
  --jp-icon-table-rows: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPgogICAgICAgIDxwYXRoIGQ9Ik0yMSw4SDNWNGgxOFY4eiBNMjEsMTBIM3Y0aDE4VjEweiBNMjEsMTZIM3Y0aDE4VjE2eiIvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-tag: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCA0MyAyOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KCTxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CgkJPHBhdGggZD0iTTI4LjgzMzIgMTIuMzM0TDMyLjk5OTggMTYuNTAwN0wzNy4xNjY1IDEyLjMzNEgyOC44MzMyWiIvPgoJCTxwYXRoIGQ9Ik0xNi4yMDk1IDIxLjYxMDRDMTUuNjg3MyAyMi4xMjk5IDE0Ljg0NDMgMjIuMTI5OSAxNC4zMjQ4IDIxLjYxMDRMNi45ODI5IDE0LjcyNDVDNi41NzI0IDE0LjMzOTQgNi4wODMxMyAxMy42MDk4IDYuMDQ3ODYgMTMuMDQ4MkM1Ljk1MzQ3IDExLjUyODggNi4wMjAwMiA4LjYxOTQ0IDYuMDY2MjEgNy4wNzY5NUM2LjA4MjgxIDYuNTE0NzcgNi41NTU0OCA2LjA0MzQ3IDcuMTE4MDQgNi4wMzA1NUM5LjA4ODYzIDUuOTg0NzMgMTMuMjYzOCA1LjkzNTc5IDEzLjY1MTggNi4zMjQyNUwyMS43MzY5IDEzLjYzOUMyMi4yNTYgMTQuMTU4NSAyMS43ODUxIDE1LjQ3MjQgMjEuMjYyIDE1Ljk5NDZMMTYuMjA5NSAyMS42MTA0Wk05Ljc3NTg1IDguMjY1QzkuMzM1NTEgNy44MjU2NiA4LjYyMzUxIDcuODI1NjYgOC4xODI4IDguMjY1QzcuNzQzNDYgOC43MDU3MSA3Ljc0MzQ2IDkuNDE3MzMgOC4xODI4IDkuODU2NjdDOC42MjM4MiAxMC4yOTY0IDkuMzM1ODIgMTAuMjk2NCA5Ljc3NTg1IDkuODU2NjdDMTAuMjE1NiA5LjQxNzMzIDEwLjIxNTYgOC43MDUzMyA5Ljc3NTg1IDguMjY1WiIvPgoJPC9nPgo8L3N2Zz4K);
  --jp-icon-terminal: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0IiA+CiAgICA8cmVjdCBjbGFzcz0ianAtdGVybWluYWwtaWNvbi1iYWNrZ3JvdW5kLWNvbG9yIGpwLWljb24tc2VsZWN0YWJsZSIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyIDIpIiBmaWxsPSIjMzMzMzMzIi8+CiAgICA8cGF0aCBjbGFzcz0ianAtdGVybWluYWwtaWNvbi1jb2xvciBqcC1pY29uLXNlbGVjdGFibGUtaW52ZXJzZSIgZD0iTTUuMDU2NjQgOC43NjE3MkM1LjA1NjY0IDguNTk3NjYgNS4wMzEyNSA4LjQ1MzEyIDQuOTgwNDcgOC4zMjgxMkM0LjkzMzU5IDguMTk5MjIgNC44NTU0NyA4LjA4MjAzIDQuNzQ2MDkgNy45NzY1NkM0LjY0MDYyIDcuODcxMDkgNC41IDcuNzc1MzkgNC4zMjQyMiA3LjY4OTQ1QzQuMTUyMzQgNy41OTk2MSAzLjk0MzM2IDcuNTExNzIgMy42OTcyNyA3LjQyNTc4QzMuMzAyNzMgNy4yODUxNiAyLjk0MzM2IDcuMTM2NzIgMi42MTkxNCA2Ljk4MDQ3QzIuMjk0OTIgNi44MjQyMiAyLjAxNzU4IDYuNjQyNTggMS43ODcxMSA2LjQzNTU1QzEuNTYwNTUgNi4yMjg1MiAxLjM4NDc3IDUuOTg4MjggMS4yNTk3NyA1LjcxNDg0QzEuMTM0NzcgNS40Mzc1IDEuMDcyMjcgNS4xMDkzOCAxLjA3MjI3IDQuNzMwNDdDMS4wNzIyNyA0LjM5ODQ0IDEuMTI4OTEgNC4wOTU3IDEuMjQyMTkgMy44MjIyN0MxLjM1NTQ3IDMuNTQ0OTIgMS41MTU2MiAzLjMwNDY5IDEuNzIyNjYgMy4xMDE1NkMxLjkyOTY5IDIuODk4NDQgMi4xNzk2OSAyLjczNDM3IDIuNDcyNjYgMi42MDkzOEMyLjc2NTYyIDIuNDg0MzggMy4wOTE4IDIuNDA0MyAzLjQ1MTE3IDIuMzY5MTRWMS4xMDkzOEg0LjM4ODY3VjIuMzgwODZDNC43NDAyMyAyLjQyNzczIDUuMDU2NjQgMi41MjM0NCA1LjMzNzg5IDIuNjY3OTdDNS42MTkxNCAyLjgxMjUgNS44NTc0MiAzLjAwMTk1IDYuMDUyNzMgMy4yMzYzM0M2LjI1MTk1IDMuNDY2OCA2LjQwNDMgMy43NDAyMyA2LjUwOTc3IDQuMDU2NjRDNi42MTkxNCA0LjM2OTE0IDYuNjczODMgNC43MjA3IDYuNjczODMgNS4xMTEzM0g1LjA0NDkyQzUuMDQ0OTIgNC42Mzg2NyA0LjkzNzUgNC4yODEyNSA0LjcyMjY2IDQuMDM5MDZDNC41MDc4MSAzLjc5Mjk3IDQuMjE2OCAzLjY2OTkyIDMuODQ5NjEgMy42Njk5MkMzLjY1MDM5IDMuNjY5OTIgMy40NzY1NiAzLjY5NzI3IDMuMzI4MTIgMy43NTE5NUMzLjE4MzU5IDMuODAyNzMgMy4wNjQ0NSAzLjg3Njk1IDIuOTcwNyAzLjk3NDYxQzIuODc2OTUgNC4wNjgzNiAyLjgwNjY0IDQuMTc5NjkgMi43NTk3NyA0LjMwODU5QzIuNzE2OCA0LjQzNzUgMi42OTUzMSA0LjU3ODEyIDIuNjk1MzEgNC43MzA0N0MyLjY5NTMxIDQuODgyODEgMi43MTY4IDUuMDE5NTMgMi43NTk3NyA1LjE0MDYyQzIuODA2NjQgNS4yNTc4MSAyLjg4MjgxIDUuMzY3MTkgMi45ODgyOCA1LjQ2ODc1QzMuMDk3NjYgNS41NzAzMSAzLjI0MDIzIDUuNjY3OTcgMy40MTYwMiA1Ljc2MTcyQzMuNTkxOCA1Ljg1MTU2IDMuODEwNTUgNS45NDMzNiA0LjA3MjI3IDYuMDM3MTFDNC40NjY4IDYuMTg1NTUgNC44MjQyMiA2LjMzOTg0IDUuMTQ0NTMgNi41QzUuNDY0ODQgNi42NTYyNSA1LjczODI4IDYuODM5ODQgNS45NjQ4NCA3LjA1MDc4QzYuMTk1MzEgNy4yNTc4MSA2LjM3MTA5IDcuNSA2LjQ5MjE5IDcuNzc3MzRDNi42MTcxOSA4LjA1MDc4IDYuNjc5NjkgOC4zNzUgNi42Nzk2OSA4Ljc1QzYuNjc5NjkgOS4wOTM3NSA2LjYyMzA1IDkuNDA0MyA2LjUwOTc3IDkuNjgxNjRDNi4zOTY0OCA5Ljk1NTA4IDYuMjM0MzggMTAuMTkxNCA2LjAyMzQ0IDEwLjM5MDZDNS44MTI1IDEwLjU4OTggNS41NTg1OSAxMC43NSA1LjI2MTcyIDEwLjg3MTFDNC45NjQ4NCAxMC45ODgzIDQuNjMyODEgMTEuMDY0NSA0LjI2NTYyIDExLjA5OTZWMTIuMjQ4SDMuMzMzOThWMTEuMDk5NkMzLjAwMTk1IDExLjA2ODQgMi42Nzk2OSAxMC45OTYxIDIuMzY3MTkgMTAuODgyOEMyLjA1NDY5IDEwLjc2NTYgMS43NzczNCAxMC41OTc3IDEuNTM1MTYgMTAuMzc4OUMxLjI5Njg4IDEwLjE2MDIgMS4xMDU0NyA5Ljg4NDc3IDAuOTYwOTM4IDkuNTUyNzNDMC44MTY0MDYgOS4yMTY4IDAuNzQ0MTQxIDguODE0NDUgMC43NDQxNDEgOC4zNDU3SDIuMzc4OTFDMi4zNzg5MSA4LjYyNjk1IDIuNDE5OTIgOC44NjMyOCAyLjUwMTk1IDkuMDU0NjlDMi41ODM5OCA5LjI0MjE5IDIuNjg5NDUgOS4zOTI1OCAyLjgxODM2IDkuNTA1ODZDMi45NTExNyA5LjYxNTIzIDMuMTAxNTYgOS42OTMzNiAzLjI2OTUzIDkuNzQwMjNDMy40Mzc1IDkuNzg3MTEgMy42MDkzOCA5LjgxMDU1IDMuNzg1MTYgOS44MTA1NUM0LjIwMzEyIDkuODEwNTUgNC41MTk1MyA5LjcxMjg5IDQuNzM0MzggOS41MTc1OEM0Ljk0OTIyIDkuMzIyMjcgNS4wNTY2NCA5LjA3MDMxIDUuMDU2NjQgOC43NjE3MlpNMTMuNDE4IDEyLjI3MTVIOC4wNzQyMlYxMUgxMy40MThWMTIuMjcxNVoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMuOTUyNjQgNikiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=);
  --jp-icon-text-editor: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8cGF0aCBjbGFzcz0ianAtdGV4dC1lZGl0b3ItaWNvbi1jb2xvciBqcC1pY29uLXNlbGVjdGFibGUiIGZpbGw9IiM2MTYxNjEiIGQ9Ik0xNSAxNUgzdjJoMTJ2LTJ6bTAtOEgzdjJoMTJWN3pNMyAxM2gxOHYtMkgzdjJ6bTAgOGgxOHYtMkgzdjJ6TTMgM3YyaDE4VjNIM3oiLz4KPC9zdmc+Cg==);
  --jp-icon-toc: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij4KICA8ZyBjbGFzcz0ianAtaWNvbjMganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjNjE2MTYxIj4KICAgIDxwYXRoIGQ9Ik03LDVIMjFWN0g3VjVNNywxM1YxMUgyMVYxM0g3TTQsNC41QTEuNSwxLjUgMCAwLDEgNS41LDZBMS41LDEuNSAwIDAsMSA0LDcuNUExLjUsMS41IDAgMCwxIDIuNSw2QTEuNSwxLjUgMCAwLDEgNCw0LjVNNCwxMC41QTEuNSwxLjUgMCAwLDEgNS41LDEyQTEuNSwxLjUgMCAwLDEgNCwxMy41QTEuNSwxLjUgMCAwLDEgMi41LDEyQTEuNSwxLjUgMCAwLDEgNCwxMC41TTcsMTlWMTdIMjFWMTlIN000LDE2LjVBMS41LDEuNSAwIDAsMSA1LjUsMThBMS41LDEuNSAwIDAsMSA0LDE5LjVBMS41LDEuNSAwIDAsMSAyLjUsMThBMS41LDEuNSAwIDAsMSA0LDE2LjVaIiAvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-tree-view: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxnIGNsYXNzPSJqcC1pY29uMyIgZmlsbD0iIzYxNjE2MSI+CiAgICAgICAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPgogICAgICAgIDxwYXRoIGQ9Ik0yMiAxMVYzaC03djNIOVYzSDJ2OGg3VjhoMnYxMGg0djNoN3YtOGgtN3YzaC0yVjhoMnYzeiIvPgogICAgPC9nPgo8L3N2Zz4K);
  --jp-icon-trusted: url(data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDI0IDI1Ij4KICAgIDxwYXRoIGNsYXNzPSJqcC1pY29uMiIgc3Ryb2tlPSIjMzMzMzMzIiBzdHJva2Utd2lkdGg9IjIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIgMykiIGQ9Ik0xLjg2MDk0IDExLjQ0MDlDMC44MjY0NDggOC43NzAyNyAwLjg2Mzc3OSA2LjA1NzY0IDEuMjQ5MDcgNC4xOTkzMkMyLjQ4MjA2IDMuOTMzNDcgNC4wODA2OCAzLjQwMzQ3IDUuNjAxMDIgMi44NDQ5QzcuMjM1NDkgMi4yNDQ0IDguODU2NjYgMS41ODE1IDkuOTg3NiAxLjA5NTM5QzExLjA1OTcgMS41ODM0MSAxMi42MDk0IDIuMjQ0NCAxNC4yMTggMi44NDMzOUMxNS43NTAzIDMuNDEzOTQgMTcuMzk5NSAzLjk1MjU4IDE4Ljc1MzkgNC4yMTM4NUMxOS4xMzY0IDYuMDcxNzcgMTkuMTcwOSA4Ljc3NzIyIDE4LjEzOSAxMS40NDA5QzE3LjAzMDMgMTQuMzAzMiAxNC42NjY4IDE3LjE4NDQgOS45OTk5OSAxOC45MzU0QzUuMzMzMiAxNy4xODQ0IDIuOTY5NjggMTQuMzAzMiAxLjg2MDk0IDExLjQ0MDlaIi8+CiAgICA8cGF0aCBjbGFzcz0ianAtaWNvbjIiIGZpbGw9IiMzMzMzMzMiIHN0cm9rZT0iIzMzMzMzMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOCA5Ljg2NzE5KSIgZD0iTTIuODYwMTUgNC44NjUzNUwwLjcyNjU0OSAyLjk5OTU5TDAgMy42MzA0NUwyLjg2MDE1IDYuMTMxNTdMOCAwLjYzMDg3Mkw3LjI3ODU3IDBMMi44NjAxNSA0Ljg2NTM1WiIvPgo8L3N2Zz4K);
  --jp-icon-undo: url(data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTEyLjUgOGMtMi42NSAwLTUuMDUuOTktNi45IDIuNkwyIDd2OWg5bC0zLjYyLTMuNjJjMS4zOS0xLjE2IDMuMTYtMS44OCA1LjEyLTEuODggMy41NCAwIDYuNTUgMi4zMSA3LjYgNS41bDIuMzctLjc4QzIxLjA4IDExLjAzIDE3LjE1IDggMTIuNSA4eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-user: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZyBjbGFzcz0ianAtaWNvbjMiIGZpbGw9IiM2MTYxNjEiPgogICAgPHBhdGggZD0iTTE2IDdhNCA0IDAgMTEtOCAwIDQgNCAwIDAxOCAwek0xMiAxNGE3IDcgMCAwMC03IDdoMTRhNyA3IDAgMDAtNy03eiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-users: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDM2IDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogPGcgY2xhc3M9ImpwLWljb24zIiB0cmFuc2Zvcm09Im1hdHJpeCgxLjczMjcgMCAwIDEuNzMyNyAtMy42MjgyIC4wOTk1NzcpIiBmaWxsPSIjNjE2MTYxIj4KICA8cGF0aCB0cmFuc2Zvcm09Im1hdHJpeCgxLjUsMCwwLDEuNSwwLC02KSIgZD0ibTEyLjE4NiA3LjUwOThjLTEuMDUzNSAwLTEuOTc1NyAwLjU2NjUtMi40Nzg1IDEuNDEwMiAwLjc1MDYxIDAuMzEyNzcgMS4zOTc0IDAuODI2NDggMS44NzMgMS40NzI3aDMuNDg2M2MwLTEuNTkyLTEuMjg4OS0yLjg4MjgtMi44ODA5LTIuODgyOHoiLz4KICA8cGF0aCBkPSJtMjAuNDY1IDIuMzg5NWEyLjE4ODUgMi4xODg1IDAgMCAxLTIuMTg4NCAyLjE4ODUgMi4xODg1IDIuMTg4NSAwIDAgMS0yLjE4ODUtMi4xODg1IDIuMTg4NSAyLjE4ODUgMCAwIDEgMi4xODg1LTIuMTg4NSAyLjE4ODUgMi4xODg1IDAgMCAxIDIuMTg4NCAyLjE4ODV6Ii8+CiAgPHBhdGggdHJhbnNmb3JtPSJtYXRyaXgoMS41LDAsMCwxLjUsMCwtNikiIGQ9Im0zLjU4OTggOC40MjE5Yy0xLjExMjYgMC0yLjAxMzcgMC45MDExMS0yLjAxMzcgMi4wMTM3aDIuODE0NWMwLjI2Nzk3LTAuMzczMDkgMC41OTA3LTAuNzA0MzUgMC45NTg5OC0wLjk3ODUyLTAuMzQ0MzMtMC42MTY4OC0xLjAwMzEtMS4wMzUyLTEuNzU5OC0xLjAzNTJ6Ii8+CiAgPHBhdGggZD0ibTYuOTE1NCA0LjYyM2ExLjUyOTQgMS41Mjk0IDAgMCAxLTEuNTI5NCAxLjUyOTQgMS41Mjk0IDEuNTI5NCAwIDAgMS0xLjUyOTQtMS41Mjk0IDEuNTI5NCAxLjUyOTQgMCAwIDEgMS41Mjk0LTEuNTI5NCAxLjUyOTQgMS41Mjk0IDAgMCAxIDEuNTI5NCAxLjUyOTR6Ii8+CiAgPHBhdGggZD0ibTYuMTM1IDEzLjUzNWMwLTMuMjM5MiAyLjYyNTktNS44NjUgNS44NjUtNS44NjUgMy4yMzkyIDAgNS44NjUgMi42MjU5IDUuODY1IDUuODY1eiIvPgogIDxjaXJjbGUgY3g9IjEyIiBjeT0iMy43Njg1IiByPSIyLjk2ODUiLz4KIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-vega: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8ZyBjbGFzcz0ianAtaWNvbjEganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjMjEyMTIxIj4KICAgIDxwYXRoIGQ9Ik0xMC42IDUuNGwyLjItMy4ySDIuMnY3LjNsNC02LjZ6Ii8+CiAgICA8cGF0aCBkPSJNMTUuOCAyLjJsLTQuNCA2LjZMNyA2LjNsLTQuOCA4djUuNWgxNy42VjIuMmgtNHptLTcgMTUuNEg1LjV2LTQuNGgzLjN2NC40em00LjQgMEg5LjhWOS44aDMuNHY3Ljh6bTQuNCAwaC0zLjRWNi41aDMuNHYxMS4xeiIvPgogIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-word: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIwIDIwIj4KIDxnIGNsYXNzPSJqcC1pY29uMiIgZmlsbD0iIzQxNDE0MSI+CiAgPHJlY3QgeD0iMiIgeT0iMiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+CiA8L2c+CiA8ZyBjbGFzcz0ianAtaWNvbi1hY2NlbnQyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSguNDMgLjA0MDEpIiBmaWxsPSIjZmZmIj4KICA8cGF0aCBkPSJtNC4xNCA4Ljc2cTAuMDY4Mi0xLjg5IDIuNDItMS44OSAxLjE2IDAgMS42OCAwLjQyIDAuNTY3IDAuNDEgMC41NjcgMS4xNnYzLjQ3cTAgMC40NjIgMC41MTQgMC40NjIgMC4xMDMgMCAwLjItMC4wMjMxdjAuNzE0cS0wLjM5OSAwLjEwMy0wLjY1MSAwLjEwMy0wLjQ1MiAwLTAuNjkzLTAuMjItMC4yMzEtMC4yLTAuMjg0LTAuNjYyLTAuOTU2IDAuODcyLTIgMC44NzItMC45MDMgMC0xLjQ3LTAuNDcyLTAuNTI1LTAuNDcyLTAuNTI1LTEuMjYgMC0wLjI2MiAwLjA0NTItMC40NzIgMC4wNTY3LTAuMjIgMC4xMTYtMC4zNzggMC4wNjgyLTAuMTY4IDAuMjMxLTAuMzA0IDAuMTU4LTAuMTQ3IDAuMjYyLTAuMjQyIDAuMTE2LTAuMDkxNCAwLjM2OC0wLjE2OCAwLjI2Mi0wLjA5MTQgMC4zOTktMC4xMjYgMC4xMzYtMC4wNDUyIDAuNDcyLTAuMTAzIDAuMzM2LTAuMDU3OCAwLjUwNC0wLjA3OTggMC4xNTgtMC4wMjMxIDAuNTY3LTAuMDc5OCAwLjU1Ni0wLjA2ODIgMC43NzctMC4yMjEgMC4yMi0wLjE1MiAwLjIyLTAuNDQxdi0wLjI1MnEwLTAuNDMtMC4zNTctMC42NjItMC4zMzYtMC4yMzEtMC45NzYtMC4yMzEtMC42NjIgMC0wLjk5OCAwLjI2Mi0wLjMzNiAwLjI1Mi0wLjM5OSAwLjc5OHptMS44OSAzLjY4cTAuNzg4IDAgMS4yNi0wLjQxIDAuNTA0LTAuNDIgMC41MDQtMC45MDN2LTEuMDVxLTAuMjg0IDAuMTM2LTAuODYxIDAuMjMxLTAuNTY3IDAuMDkxNC0wLjk4NyAwLjE1OC0wLjQyIDAuMDY4Mi0wLjc2NiAwLjMyNi0wLjMzNiAwLjI1Mi0wLjMzNiAwLjcwNHQwLjMwNCAwLjcwNCAwLjg2MSAwLjI1MnoiIHN0cm9rZS13aWR0aD0iMS4wNSIvPgogIDxwYXRoIGQ9Im0xMCA0LjU2aDAuOTQ1djMuMTVxMC42NTEtMC45NzYgMS44OS0wLjk3NiAxLjE2IDAgMS44OSAwLjg0IDAuNjgyIDAuODQgMC42ODIgMi4zMSAwIDEuNDctMC43MDQgMi40Mi0wLjcwNCAwLjg4Mi0xLjg5IDAuODgyLTEuMjYgMC0xLjg5LTEuMDJ2MC43NjZoLTAuODV6bTIuNjIgMy4wNHEtMC43NDYgMC0xLjE2IDAuNjQtMC40NTIgMC42My0wLjQ1MiAxLjY4IDAgMS4wNSAwLjQ1MiAxLjY4dDEuMTYgMC42M3EwLjc3NyAwIDEuMjYtMC42MyAwLjQ5NC0wLjY0IDAuNDk0LTEuNjggMC0xLjA1LTAuNDcyLTEuNjgtMC40NjItMC42NC0xLjI2LTAuNjR6IiBzdHJva2Utd2lkdGg9IjEuMDUiLz4KICA8cGF0aCBkPSJtMi43MyAxNS44IDEzLjYgMC4wMDgxYzAuMDA2OSAwIDAtMi42IDAtMi42IDAtMC4wMDc4LTEuMTUgMC0xLjE1IDAtMC4wMDY5IDAtMC4wMDgzIDEuNS0wLjAwODMgMS41LTJlLTMgLTAuMDAxNC0xMS4zLTAuMDAxNC0xMS4zLTAuMDAxNGwtMC4wMDU5Mi0xLjVjMC0wLjAwNzgtMS4xNyAwLjAwMTMtMS4xNyAwLjAwMTN6IiBzdHJva2Utd2lkdGg9Ii45NzUiLz4KIDwvZz4KPC9zdmc+Cg==);
  --jp-icon-yaml: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICA8ZyBjbGFzcz0ianAtaWNvbi1jb250cmFzdDIganAtaWNvbi1zZWxlY3RhYmxlIiBmaWxsPSIjRDgxQjYwIj4KICAgIDxwYXRoIGQ9Ik03LjIgMTguNnYtNS40TDMgNS42aDMuM2wxLjQgMy4xYy4zLjkuNiAxLjYgMSAyLjUuMy0uOC42LTEuNiAxLTIuNWwxLjQtMy4xaDMuNGwtNC40IDcuNnY1LjVsLTIuOS0uMXoiLz4KICAgIDxjaXJjbGUgY2xhc3M9InN0MCIgY3g9IjE3LjYiIGN5PSIxNi41IiByPSIyLjEiLz4KICAgIDxjaXJjbGUgY2xhc3M9InN0MCIgY3g9IjE3LjYiIGN5PSIxMSIgcj0iMi4xIi8+CiAgPC9nPgo8L3N2Zz4K);
}

/* Icon CSS class declarations */

.jp-AddAboveIcon {
  background-image: var(--jp-icon-add-above);
}

.jp-AddBelowIcon {
  background-image: var(--jp-icon-add-below);
}

.jp-AddIcon {
  background-image: var(--jp-icon-add);
}

.jp-BellIcon {
  background-image: var(--jp-icon-bell);
}

.jp-BugDotIcon {
  background-image: var(--jp-icon-bug-dot);
}

.jp-BugIcon {
  background-image: var(--jp-icon-bug);
}

.jp-BuildIcon {
  background-image: var(--jp-icon-build);
}

.jp-CaretDownEmptyIcon {
  background-image: var(--jp-icon-caret-down-empty);
}

.jp-CaretDownEmptyThinIcon {
  background-image: var(--jp-icon-caret-down-empty-thin);
}

.jp-CaretDownIcon {
  background-image: var(--jp-icon-caret-down);
}

.jp-CaretLeftIcon {
  background-image: var(--jp-icon-caret-left);
}

.jp-CaretRightIcon {
  background-image: var(--jp-icon-caret-right);
}

.jp-CaretUpEmptyThinIcon {
  background-image: var(--jp-icon-caret-up-empty-thin);
}

.jp-CaretUpIcon {
  background-image: var(--jp-icon-caret-up);
}

.jp-CaseSensitiveIcon {
  background-image: var(--jp-icon-case-sensitive);
}

.jp-CheckIcon {
  background-image: var(--jp-icon-check);
}

.jp-CircleEmptyIcon {
  background-image: var(--jp-icon-circle-empty);
}

.jp-CircleIcon {
  background-image: var(--jp-icon-circle);
}

.jp-ClearIcon {
  background-image: var(--jp-icon-clear);
}

.jp-CloseIcon {
  background-image: var(--jp-icon-close);
}

.jp-CodeCheckIcon {
  background-image: var(--jp-icon-code-check);
}

.jp-CodeIcon {
  background-image: var(--jp-icon-code);
}

.jp-CollapseAllIcon {
  background-image: var(--jp-icon-collapse-all);
}

.jp-ConsoleIcon {
  background-image: var(--jp-icon-console);
}

.jp-CopyIcon {
  background-image: var(--jp-icon-copy);
}

.jp-CopyrightIcon {
  background-image: var(--jp-icon-copyright);
}

.jp-CutIcon {
  background-image: var(--jp-icon-cut);
}

.jp-DeleteIcon {
  background-image: var(--jp-icon-delete);
}

.jp-DownloadIcon {
  background-image: var(--jp-icon-download);
}

.jp-DuplicateIcon {
  background-image: var(--jp-icon-duplicate);
}

.jp-EditIcon {
  background-image: var(--jp-icon-edit);
}

.jp-EllipsesIcon {
  background-image: var(--jp-icon-ellipses);
}

.jp-ErrorIcon {
  background-image: var(--jp-icon-error);
}

.jp-ExpandAllIcon {
  background-image: var(--jp-icon-expand-all);
}

.jp-ExtensionIcon {
  background-image: var(--jp-icon-extension);
}

.jp-FastForwardIcon {
  background-image: var(--jp-icon-fast-forward);
}

.jp-FileIcon {
  background-image: var(--jp-icon-file);
}

.jp-FileUploadIcon {
  background-image: var(--jp-icon-file-upload);
}

.jp-FilterDotIcon {
  background-image: var(--jp-icon-filter-dot);
}

.jp-FilterIcon {
  background-image: var(--jp-icon-filter);
}

.jp-FilterListIcon {
  background-image: var(--jp-icon-filter-list);
}

.jp-FolderFavoriteIcon {
  background-image: var(--jp-icon-folder-favorite);
}

.jp-FolderIcon {
  background-image: var(--jp-icon-folder);
}

.jp-HomeIcon {
  background-image: var(--jp-icon-home);
}

.jp-Html5Icon {
  background-image: var(--jp-icon-html5);
}

.jp-ImageIcon {
  background-image: var(--jp-icon-image);
}

.jp-InfoIcon {
  background-image: var(--jp-icon-info);
}

.jp-InspectorIcon {
  background-image: var(--jp-icon-inspector);
}

.jp-JsonIcon {
  background-image: var(--jp-icon-json);
}

.jp-JuliaIcon {
  background-image: var(--jp-icon-julia);
}

.jp-JupyterFaviconIcon {
  background-image: var(--jp-icon-jupyter-favicon);
}

.jp-JupyterIcon {
  background-image: var(--jp-icon-jupyter);
}

.jp-JupyterlabWordmarkIcon {
  background-image: var(--jp-icon-jupyterlab-wordmark);
}

.jp-KernelIcon {
  background-image: var(--jp-icon-kernel);
}

.jp-KeyboardIcon {
  background-image: var(--jp-icon-keyboard);
}

.jp-LaunchIcon {
  background-image: var(--jp-icon-launch);
}

.jp-LauncherIcon {
  background-image: var(--jp-icon-launcher);
}

.jp-LineFormIcon {
  background-image: var(--jp-icon-line-form);
}

.jp-LinkIcon {
  background-image: var(--jp-icon-link);
}

.jp-ListIcon {
  background-image: var(--jp-icon-list);
}

.jp-MarkdownIcon {
  background-image: var(--jp-icon-markdown);
}

.jp-MoveDownIcon {
  background-image: var(--jp-icon-move-down);
}

.jp-MoveUpIcon {
  background-image: var(--jp-icon-move-up);
}

.jp-NewFolderIcon {
  background-image: var(--jp-icon-new-folder);
}

.jp-NotTrustedIcon {
  background-image: var(--jp-icon-not-trusted);
}

.jp-NotebookIcon {
  background-image: var(--jp-icon-notebook);
}

.jp-NumberingIcon {
  background-image: var(--jp-icon-numbering);
}

.jp-OfflineBoltIcon {
  background-image: var(--jp-icon-offline-bolt);
}

.jp-PaletteIcon {
  background-image: var(--jp-icon-palette);
}

.jp-PasteIcon {
  background-image: var(--jp-icon-paste);
}

.jp-PdfIcon {
  background-image: var(--jp-icon-pdf);
}

.jp-PythonIcon {
  background-image: var(--jp-icon-python);
}

.jp-RKernelIcon {
  background-image: var(--jp-icon-r-kernel);
}

.jp-ReactIcon {
  background-image: var(--jp-icon-react);
}

.jp-RedoIcon {
  background-image: var(--jp-icon-redo);
}

.jp-RefreshIcon {
  background-image: var(--jp-icon-refresh);
}

.jp-RegexIcon {
  background-image: var(--jp-icon-regex);
}

.jp-RunIcon {
  background-image: var(--jp-icon-run);
}

.jp-RunningIcon {
  background-image: var(--jp-icon-running);
}

.jp-SaveIcon {
  background-image: var(--jp-icon-save);
}

.jp-SearchIcon {
  background-image: var(--jp-icon-search);
}

.jp-SettingsIcon {
  background-image: var(--jp-icon-settings);
}

.jp-ShareIcon {
  background-image: var(--jp-icon-share);
}

.jp-SpreadsheetIcon {
  background-image: var(--jp-icon-spreadsheet);
}

.jp-StopIcon {
  background-image: var(--jp-icon-stop);
}

.jp-TabIcon {
  background-image: var(--jp-icon-tab);
}

.jp-TableRowsIcon {
  background-image: var(--jp-icon-table-rows);
}

.jp-TagIcon {
  background-image: var(--jp-icon-tag);
}

.jp-TerminalIcon {
  background-image: var(--jp-icon-terminal);
}

.jp-TextEditorIcon {
  background-image: var(--jp-icon-text-editor);
}

.jp-TocIcon {
  background-image: var(--jp-icon-toc);
}

.jp-TreeViewIcon {
  background-image: var(--jp-icon-tree-view);
}

.jp-TrustedIcon {
  background-image: var(--jp-icon-trusted);
}

.jp-UndoIcon {
  background-image: var(--jp-icon-undo);
}

.jp-UserIcon {
  background-image: var(--jp-icon-user);
}

.jp-UsersIcon {
  background-image: var(--jp-icon-users);
}

.jp-VegaIcon {
  background-image: var(--jp-icon-vega);
}

.jp-WordIcon {
  background-image: var(--jp-icon-word);
}

.jp-YamlIcon {
  background-image: var(--jp-icon-yaml);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/**
 * (DEPRECATED) Support for consuming icons as CSS background images
 */

.jp-Icon,
.jp-MaterialIcon {
  background-position: center;
  background-repeat: no-repeat;
  background-size: 16px;
  min-width: 16px;
  min-height: 16px;
}

.jp-Icon-cover {
  background-position: center;
  background-repeat: no-repeat;
  background-size: cover;
}

/**
 * (DEPRECATED) Support for specific CSS icon sizes
 */

.jp-Icon-16 {
  background-size: 16px;
  min-width: 16px;
  min-height: 16px;
}

.jp-Icon-18 {
  background-size: 18px;
  min-width: 18px;
  min-height: 18px;
}

.jp-Icon-20 {
  background-size: 20px;
  min-width: 20px;
  min-height: 20px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.lm-TabBar .lm-TabBar-addButton {
  align-items: center;
  display: flex;
  padding: 4px;
  padding-bottom: 5px;
  margin-right: 1px;
  background-color: var(--jp-layout-color2);
}

.lm-TabBar .lm-TabBar-addButton:hover {
  background-color: var(--jp-layout-color1);
}

.lm-DockPanel-tabBar .lm-TabBar-tab {
  width: var(--jp-private-horizontal-tab-width);
}

.lm-DockPanel-tabBar .lm-TabBar-content {
  flex: unset;
}

.lm-DockPanel-tabBar[data-orientation='horizontal'] {
  flex: 1 1 auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/**
 * Support for icons as inline SVG HTMLElements
 */

/* recolor the primary elements of an icon */
.jp-icon0[fill] {
  fill: var(--jp-inverse-layout-color0);
}

.jp-icon1[fill] {
  fill: var(--jp-inverse-layout-color1);
}

.jp-icon2[fill] {
  fill: var(--jp-inverse-layout-color2);
}

.jp-icon3[fill] {
  fill: var(--jp-inverse-layout-color3);
}

.jp-icon4[fill] {
  fill: var(--jp-inverse-layout-color4);
}

.jp-icon0[stroke] {
  stroke: var(--jp-inverse-layout-color0);
}

.jp-icon1[stroke] {
  stroke: var(--jp-inverse-layout-color1);
}

.jp-icon2[stroke] {
  stroke: var(--jp-inverse-layout-color2);
}

.jp-icon3[stroke] {
  stroke: var(--jp-inverse-layout-color3);
}

.jp-icon4[stroke] {
  stroke: var(--jp-inverse-layout-color4);
}

/* recolor the accent elements of an icon */
.jp-icon-accent0[fill] {
  fill: var(--jp-layout-color0);
}

.jp-icon-accent1[fill] {
  fill: var(--jp-layout-color1);
}

.jp-icon-accent2[fill] {
  fill: var(--jp-layout-color2);
}

.jp-icon-accent3[fill] {
  fill: var(--jp-layout-color3);
}

.jp-icon-accent4[fill] {
  fill: var(--jp-layout-color4);
}

.jp-icon-accent0[stroke] {
  stroke: var(--jp-layout-color0);
}

.jp-icon-accent1[stroke] {
  stroke: var(--jp-layout-color1);
}

.jp-icon-accent2[stroke] {
  stroke: var(--jp-layout-color2);
}

.jp-icon-accent3[stroke] {
  stroke: var(--jp-layout-color3);
}

.jp-icon-accent4[stroke] {
  stroke: var(--jp-layout-color4);
}

/* set the color of an icon to transparent */
.jp-icon-none[fill] {
  fill: none;
}

.jp-icon-none[stroke] {
  stroke: none;
}

/* brand icon colors. Same for light and dark */
.jp-icon-brand0[fill] {
  fill: var(--jp-brand-color0);
}

.jp-icon-brand1[fill] {
  fill: var(--jp-brand-color1);
}

.jp-icon-brand2[fill] {
  fill: var(--jp-brand-color2);
}

.jp-icon-brand3[fill] {
  fill: var(--jp-brand-color3);
}

.jp-icon-brand4[fill] {
  fill: var(--jp-brand-color4);
}

.jp-icon-brand0[stroke] {
  stroke: var(--jp-brand-color0);
}

.jp-icon-brand1[stroke] {
  stroke: var(--jp-brand-color1);
}

.jp-icon-brand2[stroke] {
  stroke: var(--jp-brand-color2);
}

.jp-icon-brand3[stroke] {
  stroke: var(--jp-brand-color3);
}

.jp-icon-brand4[stroke] {
  stroke: var(--jp-brand-color4);
}

/* warn icon colors. Same for light and dark */
.jp-icon-warn0[fill] {
  fill: var(--jp-warn-color0);
}

.jp-icon-warn1[fill] {
  fill: var(--jp-warn-color1);
}

.jp-icon-warn2[fill] {
  fill: var(--jp-warn-color2);
}

.jp-icon-warn3[fill] {
  fill: var(--jp-warn-color3);
}

.jp-icon-warn0[stroke] {
  stroke: var(--jp-warn-color0);
}

.jp-icon-warn1[stroke] {
  stroke: var(--jp-warn-color1);
}

.jp-icon-warn2[stroke] {
  stroke: var(--jp-warn-color2);
}

.jp-icon-warn3[stroke] {
  stroke: var(--jp-warn-color3);
}

/* icon colors that contrast well with each other and most backgrounds */
.jp-icon-contrast0[fill] {
  fill: var(--jp-icon-contrast-color0);
}

.jp-icon-contrast1[fill] {
  fill: var(--jp-icon-contrast-color1);
}

.jp-icon-contrast2[fill] {
  fill: var(--jp-icon-contrast-color2);
}

.jp-icon-contrast3[fill] {
  fill: var(--jp-icon-contrast-color3);
}

.jp-icon-contrast0[stroke] {
  stroke: var(--jp-icon-contrast-color0);
}

.jp-icon-contrast1[stroke] {
  stroke: var(--jp-icon-contrast-color1);
}

.jp-icon-contrast2[stroke] {
  stroke: var(--jp-icon-contrast-color2);
}

.jp-icon-contrast3[stroke] {
  stroke: var(--jp-icon-contrast-color3);
}

.jp-icon-dot[fill] {
  fill: var(--jp-warn-color0);
}

.jp-jupyter-icon-color[fill] {
  fill: var(--jp-jupyter-icon-color, var(--jp-warn-color0));
}

.jp-notebook-icon-color[fill] {
  fill: var(--jp-notebook-icon-color, var(--jp-warn-color0));
}

.jp-json-icon-color[fill] {
  fill: var(--jp-json-icon-color, var(--jp-warn-color1));
}

.jp-console-icon-color[fill] {
  fill: var(--jp-console-icon-color, white);
}

.jp-console-icon-background-color[fill] {
  fill: var(--jp-console-icon-background-color, var(--jp-brand-color1));
}

.jp-terminal-icon-color[fill] {
  fill: var(--jp-terminal-icon-color, var(--jp-layout-color2));
}

.jp-terminal-icon-background-color[fill] {
  fill: var(
    --jp-terminal-icon-background-color,
    var(--jp-inverse-layout-color2)
  );
}

.jp-text-editor-icon-color[fill] {
  fill: var(--jp-text-editor-icon-color, var(--jp-inverse-layout-color3));
}

.jp-inspector-icon-color[fill] {
  fill: var(--jp-inspector-icon-color, var(--jp-inverse-layout-color3));
}

/* CSS for icons in selected filebrowser listing items */
.jp-DirListing-item.jp-mod-selected .jp-icon-selectable[fill] {
  fill: #fff;
}

.jp-DirListing-item.jp-mod-selected .jp-icon-selectable-inverse[fill] {
  fill: var(--jp-brand-color1);
}

/* stylelint-disable selector-max-class, selector-max-compound-selectors */

/**
* TODO: come up with non css-hack solution for showing the busy icon on top
*  of the close icon
* CSS for complex behavior of close icon of tabs in the main area tabbar
*/
.lm-DockPanel-tabBar
  .lm-TabBar-tab.lm-mod-closable.jp-mod-dirty
  > .lm-TabBar-tabCloseIcon
  > :not(:hover)
  > .jp-icon3[fill] {
  fill: none;
}

.lm-DockPanel-tabBar
  .lm-TabBar-tab.lm-mod-closable.jp-mod-dirty
  > .lm-TabBar-tabCloseIcon
  > :not(:hover)
  > .jp-icon-busy[fill] {
  fill: var(--jp-inverse-layout-color3);
}

/* stylelint-enable selector-max-class, selector-max-compound-selectors */

/* CSS for icons in status bar */
#jp-main-statusbar .jp-mod-selected .jp-icon-selectable[fill] {
  fill: #fff;
}

#jp-main-statusbar .jp-mod-selected .jp-icon-selectable-inverse[fill] {
  fill: var(--jp-brand-color1);
}

/* special handling for splash icon CSS. While the theme CSS reloads during
   splash, the splash icon can loose theming. To prevent that, we set a
   default for its color variable */
:root {
  --jp-warn-color0: var(--md-orange-700);
}

/* not sure what to do with this one, used in filebrowser listing */
.jp-DragIcon {
  margin-right: 4px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/**
 * Support for alt colors for icons as inline SVG HTMLElements
 */

/* alt recolor the primary elements of an icon */
.jp-icon-alt .jp-icon0[fill] {
  fill: var(--jp-layout-color0);
}

.jp-icon-alt .jp-icon1[fill] {
  fill: var(--jp-layout-color1);
}

.jp-icon-alt .jp-icon2[fill] {
  fill: var(--jp-layout-color2);
}

.jp-icon-alt .jp-icon3[fill] {
  fill: var(--jp-layout-color3);
}

.jp-icon-alt .jp-icon4[fill] {
  fill: var(--jp-layout-color4);
}

.jp-icon-alt .jp-icon0[stroke] {
  stroke: var(--jp-layout-color0);
}

.jp-icon-alt .jp-icon1[stroke] {
  stroke: var(--jp-layout-color1);
}

.jp-icon-alt .jp-icon2[stroke] {
  stroke: var(--jp-layout-color2);
}

.jp-icon-alt .jp-icon3[stroke] {
  stroke: var(--jp-layout-color3);
}

.jp-icon-alt .jp-icon4[stroke] {
  stroke: var(--jp-layout-color4);
}

/* alt recolor the accent elements of an icon */
.jp-icon-alt .jp-icon-accent0[fill] {
  fill: var(--jp-inverse-layout-color0);
}

.jp-icon-alt .jp-icon-accent1[fill] {
  fill: var(--jp-inverse-layout-color1);
}

.jp-icon-alt .jp-icon-accent2[fill] {
  fill: var(--jp-inverse-layout-color2);
}

.jp-icon-alt .jp-icon-accent3[fill] {
  fill: var(--jp-inverse-layout-color3);
}

.jp-icon-alt .jp-icon-accent4[fill] {
  fill: var(--jp-inverse-layout-color4);
}

.jp-icon-alt .jp-icon-accent0[stroke] {
  stroke: var(--jp-inverse-layout-color0);
}

.jp-icon-alt .jp-icon-accent1[stroke] {
  stroke: var(--jp-inverse-layout-color1);
}

.jp-icon-alt .jp-icon-accent2[stroke] {
  stroke: var(--jp-inverse-layout-color2);
}

.jp-icon-alt .jp-icon-accent3[stroke] {
  stroke: var(--jp-inverse-layout-color3);
}

.jp-icon-alt .jp-icon-accent4[stroke] {
  stroke: var(--jp-inverse-layout-color4);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-icon-hoverShow:not(:hover) .jp-icon-hoverShow-content {
  display: none !important;
}

/**
 * Support for hover colors for icons as inline SVG HTMLElements
 */

/**
 * regular colors
 */

/* recolor the primary elements of an icon */
.jp-icon-hover :hover .jp-icon0-hover[fill] {
  fill: var(--jp-inverse-layout-color0);
}

.jp-icon-hover :hover .jp-icon1-hover[fill] {
  fill: var(--jp-inverse-layout-color1);
}

.jp-icon-hover :hover .jp-icon2-hover[fill] {
  fill: var(--jp-inverse-layout-color2);
}

.jp-icon-hover :hover .jp-icon3-hover[fill] {
  fill: var(--jp-inverse-layout-color3);
}

.jp-icon-hover :hover .jp-icon4-hover[fill] {
  fill: var(--jp-inverse-layout-color4);
}

.jp-icon-hover :hover .jp-icon0-hover[stroke] {
  stroke: var(--jp-inverse-layout-color0);
}

.jp-icon-hover :hover .jp-icon1-hover[stroke] {
  stroke: var(--jp-inverse-layout-color1);
}

.jp-icon-hover :hover .jp-icon2-hover[stroke] {
  stroke: var(--jp-inverse-layout-color2);
}

.jp-icon-hover :hover .jp-icon3-hover[stroke] {
  stroke: var(--jp-inverse-layout-color3);
}

.jp-icon-hover :hover .jp-icon4-hover[stroke] {
  stroke: var(--jp-inverse-layout-color4);
}

/* recolor the accent elements of an icon */
.jp-icon-hover :hover .jp-icon-accent0-hover[fill] {
  fill: var(--jp-layout-color0);
}

.jp-icon-hover :hover .jp-icon-accent1-hover[fill] {
  fill: var(--jp-layout-color1);
}

.jp-icon-hover :hover .jp-icon-accent2-hover[fill] {
  fill: var(--jp-layout-color2);
}

.jp-icon-hover :hover .jp-icon-accent3-hover[fill] {
  fill: var(--jp-layout-color3);
}

.jp-icon-hover :hover .jp-icon-accent4-hover[fill] {
  fill: var(--jp-layout-color4);
}

.jp-icon-hover :hover .jp-icon-accent0-hover[stroke] {
  stroke: var(--jp-layout-color0);
}

.jp-icon-hover :hover .jp-icon-accent1-hover[stroke] {
  stroke: var(--jp-layout-color1);
}

.jp-icon-hover :hover .jp-icon-accent2-hover[stroke] {
  stroke: var(--jp-layout-color2);
}

.jp-icon-hover :hover .jp-icon-accent3-hover[stroke] {
  stroke: var(--jp-layout-color3);
}

.jp-icon-hover :hover .jp-icon-accent4-hover[stroke] {
  stroke: var(--jp-layout-color4);
}

/* set the color of an icon to transparent */
.jp-icon-hover :hover .jp-icon-none-hover[fill] {
  fill: none;
}

.jp-icon-hover :hover .jp-icon-none-hover[stroke] {
  stroke: none;
}

/**
 * inverse colors
 */

/* inverse recolor the primary elements of an icon */
.jp-icon-hover.jp-icon-alt :hover .jp-icon0-hover[fill] {
  fill: var(--jp-layout-color0);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon1-hover[fill] {
  fill: var(--jp-layout-color1);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon2-hover[fill] {
  fill: var(--jp-layout-color2);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon3-hover[fill] {
  fill: var(--jp-layout-color3);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon4-hover[fill] {
  fill: var(--jp-layout-color4);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon0-hover[stroke] {
  stroke: var(--jp-layout-color0);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon1-hover[stroke] {
  stroke: var(--jp-layout-color1);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon2-hover[stroke] {
  stroke: var(--jp-layout-color2);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon3-hover[stroke] {
  stroke: var(--jp-layout-color3);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon4-hover[stroke] {
  stroke: var(--jp-layout-color4);
}

/* inverse recolor the accent elements of an icon */
.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent0-hover[fill] {
  fill: var(--jp-inverse-layout-color0);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent1-hover[fill] {
  fill: var(--jp-inverse-layout-color1);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent2-hover[fill] {
  fill: var(--jp-inverse-layout-color2);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent3-hover[fill] {
  fill: var(--jp-inverse-layout-color3);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent4-hover[fill] {
  fill: var(--jp-inverse-layout-color4);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent0-hover[stroke] {
  stroke: var(--jp-inverse-layout-color0);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent1-hover[stroke] {
  stroke: var(--jp-inverse-layout-color1);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent2-hover[stroke] {
  stroke: var(--jp-inverse-layout-color2);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent3-hover[stroke] {
  stroke: var(--jp-inverse-layout-color3);
}

.jp-icon-hover.jp-icon-alt :hover .jp-icon-accent4-hover[stroke] {
  stroke: var(--jp-inverse-layout-color4);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-IFrame {
  width: 100%;
  height: 100%;
}

.jp-IFrame > iframe {
  border: none;
}

/*
When drag events occur, `lm-mod-override-cursor` is added to the body.
Because iframes steal all cursor events, the following two rules are necessary
to suppress pointer events while resize drags are occurring. There may be a
better solution to this problem.
*/
body.lm-mod-override-cursor .jp-IFrame {
  position: relative;
}

body.lm-mod-override-cursor .jp-IFrame::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: transparent;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-HoverBox {
  position: fixed;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-FormGroup-content fieldset {
  border: none;
  padding: 0;
  min-width: 0;
  width: 100%;
}

/* stylelint-disable selector-max-type */

.jp-FormGroup-content fieldset .jp-inputFieldWrapper input,
.jp-FormGroup-content fieldset .jp-inputFieldWrapper select,
.jp-FormGroup-content fieldset .jp-inputFieldWrapper textarea {
  font-size: var(--jp-content-font-size2);
  border-color: var(--jp-input-border-color);
  border-style: solid;
  border-radius: var(--jp-border-radius);
  border-width: 1px;
  padding: 6px 8px;
  background: none;
  color: var(--jp-ui-font-color0);
  height: inherit;
}

.jp-FormGroup-content fieldset input[type='checkbox'] {
  position: relative;
  top: 2px;
  margin-left: 0;
}

.jp-FormGroup-content button.jp-mod-styled {
  cursor: pointer;
}

.jp-FormGroup-content .checkbox label {
  cursor: pointer;
  font-size: var(--jp-content-font-size1);
}

.jp-FormGroup-content .jp-root > fieldset > legend {
  display: none;
}

.jp-FormGroup-content .jp-root > fieldset > p {
  display: none;
}

/** copy of `input.jp-mod-styled:focus` style */
.jp-FormGroup-content fieldset input:focus,
.jp-FormGroup-content fieldset select:focus {
  -moz-outline-radius: unset;
  outline: var(--jp-border-width) solid var(--md-blue-500);
  outline-offset: -1px;
  box-shadow: inset 0 0 4px var(--md-blue-300);
}

.jp-FormGroup-content fieldset input:hover:not(:focus),
.jp-FormGroup-content fieldset select:hover:not(:focus) {
  background-color: var(--jp-border-color2);
}

/* stylelint-enable selector-max-type */

.jp-FormGroup-content .checkbox .field-description {
  /* Disable default description field for checkbox:
   because other widgets do not have description fields,
   we add descriptions to each widget on the field level.
  */
  display: none;
}

.jp-FormGroup-content #root__description {
  display: none;
}

.jp-FormGroup-content .jp-modifiedIndicator {
  width: 5px;
  background-color: var(--jp-brand-color2);
  margin-top: 0;
  margin-left: calc(var(--jp-private-settingeditor-modifier-indent) * -1);
  flex-shrink: 0;
}

.jp-FormGroup-content .jp-modifiedIndicator.jp-errorIndicator {
  background-color: var(--jp-error-color0);
  margin-right: 0.5em;
}

/* RJSF ARRAY style */

.jp-arrayFieldWrapper legend {
  font-size: var(--jp-content-font-size2);
  color: var(--jp-ui-font-color0);
  flex-basis: 100%;
  padding: 4px 0;
  font-weight: var(--jp-content-heading-font-weight);
  border-bottom: 1px solid var(--jp-border-color2);
}

.jp-arrayFieldWrapper .field-description {
  padding: 4px 0;
  white-space: pre-wrap;
}

.jp-arrayFieldWrapper .array-item {
  width: 100%;
  border: 1px solid var(--jp-border-color2);
  border-radius: 4px;
  margin: 4px;
}

.jp-ArrayOperations {
  display: flex;
  margin-left: 8px;
}

.jp-ArrayOperationsButton {
  margin: 2px;
}

.jp-ArrayOperationsButton .jp-icon3[fill] {
  fill: var(--jp-ui-font-color0);
}

button.jp-ArrayOperationsButton.jp-mod-styled:disabled {
  cursor: not-allowed;
  opacity: 0.5;
}

/* RJSF form validation error */

.jp-FormGroup-content .validationErrors {
  color: var(--jp-error-color0);
}

/* Hide panel level error as duplicated the field level error */
.jp-FormGroup-content .panel.errors {
  display: none;
}

/* RJSF normal content (settings-editor) */

.jp-FormGroup-contentNormal {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
}

.jp-FormGroup-contentNormal .jp-FormGroup-contentItem {
  margin-left: 7px;
  color: var(--jp-ui-font-color0);
}

.jp-FormGroup-contentNormal .jp-FormGroup-description {
  flex-basis: 100%;
  padding: 4px 7px;
}

.jp-FormGroup-contentNormal .jp-FormGroup-default {
  flex-basis: 100%;
  padding: 4px 7px;
}

.jp-FormGroup-contentNormal .jp-FormGroup-fieldLabel {
  font-size: var(--jp-content-font-size1);
  font-weight: normal;
  min-width: 120px;
}

.jp-FormGroup-contentNormal fieldset:not(:first-child) {
  margin-left: 7px;
}

.jp-FormGroup-contentNormal .field-array-of-string .array-item {
  /* Display `jp-ArrayOperations` buttons side-by-side with content except
    for small screens where flex-wrap will place them one below the other.
  */
  display: flex;
  align-items: center;
  flex-wrap: wrap;
}

.jp-FormGroup-contentNormal .jp-objectFieldWrapper .form-group {
  padding: 2px 8px 2px var(--jp-private-settingeditor-modifier-indent);
  margin-top: 2px;
}

/* RJSF compact content (metadata-form) */

.jp-FormGroup-content.jp-FormGroup-contentCompact {
  width: 100%;
}

.jp-FormGroup-contentCompact .form-group {
  display: flex;
  padding: 0.5em 0.2em 0.5em 0;
}

.jp-FormGroup-contentCompact
  .jp-FormGroup-compactTitle
  .jp-FormGroup-description {
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color2);
}

.jp-FormGroup-contentCompact .jp-FormGroup-fieldLabel {
  padding-bottom: 0.3em;
}

.jp-FormGroup-contentCompact .jp-inputFieldWrapper .form-control {
  width: 100%;
  box-sizing: border-box;
}

.jp-FormGroup-contentCompact .jp-arrayFieldWrapper .jp-FormGroup-compactTitle {
  padding-bottom: 7px;
}

.jp-FormGroup-contentCompact
  .jp-objectFieldWrapper
  .jp-objectFieldWrapper
  .form-group {
  padding: 2px 8px 2px var(--jp-private-settingeditor-modifier-indent);
  margin-top: 2px;
}

.jp-FormGroup-contentCompact ul.error-detail {
  margin-block-start: 0.5em;
  margin-block-end: 0.5em;
  padding-inline-start: 1em;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-SidePanel {
  display: flex;
  flex-direction: column;
  min-width: var(--jp-sidebar-min-width);
  overflow-y: auto;
  color: var(--jp-ui-font-color1);
  background: var(--jp-layout-color1);
  font-size: var(--jp-ui-font-size1);
}

.jp-SidePanel-header {
  flex: 0 0 auto;
  display: flex;
  border-bottom: var(--jp-border-width) solid var(--jp-border-color2);
  font-size: var(--jp-ui-font-size0);
  font-weight: 600;
  letter-spacing: 1px;
  margin: 0;
  padding: 2px;
  text-transform: uppercase;
}

.jp-SidePanel-toolbar {
  flex: 0 0 auto;
}

.jp-SidePanel-content {
  flex: 1 1 auto;
}

.jp-SidePanel-toolbar,
.jp-AccordionPanel-toolbar {
  height: var(--jp-private-toolbar-height);
}

.jp-SidePanel-toolbar.jp-Toolbar-micro {
  display: none;
}

.lm-AccordionPanel .jp-AccordionPanel-title {
  box-sizing: border-box;
  line-height: 25px;
  margin: 0;
  display: flex;
  align-items: center;
  background: var(--jp-layout-color1);
  color: var(--jp-ui-font-color1);
  border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  box-shadow: var(--jp-toolbar-box-shadow);
  font-size: var(--jp-ui-font-size0);
}

.jp-AccordionPanel-title {
  cursor: pointer;
  user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
  text-transform: uppercase;
}

.lm-AccordionPanel[data-orientation='horizontal'] > .jp-AccordionPanel-title {
  /* Title is rotated for horizontal accordion panel using CSS */
  display: block;
  transform-origin: top left;
  transform: rotate(-90deg) translate(-100%);
}

.jp-AccordionPanel-title .lm-AccordionPanel-titleLabel {
  user-select: none;
  text-overflow: ellipsis;
  white-space: nowrap;
  overflow: hidden;
}

.jp-AccordionPanel-title .lm-AccordionPanel-titleCollapser {
  transform: rotate(-90deg);
  margin: auto 0;
  height: 16px;
}

.jp-AccordionPanel-title.lm-mod-expanded .lm-AccordionPanel-titleCollapser {
  transform: rotate(0deg);
}

.lm-AccordionPanel .jp-AccordionPanel-toolbar {
  background: none;
  box-shadow: none;
  border: none;
  margin-left: auto;
}

.lm-AccordionPanel .lm-SplitPanel-handle:hover {
  background: var(--jp-layout-color3);
}

.jp-text-truncated {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-Spinner {
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background: var(--jp-layout-color0);
  outline: none;
}

.jp-SpinnerContent {
  font-size: 10px;
  margin: 50px auto;
  text-indent: -9999em;
  width: 3em;
  height: 3em;
  border-radius: 50%;
  background: var(--jp-brand-color3);
  background: linear-gradient(
    to right,
    #f37626 10%,
    rgba(255, 255, 255, 0) 42%
  );
  position: relative;
  animation: load3 1s infinite linear, fadeIn 1s;
}

.jp-SpinnerContent::before {
  width: 50%;
  height: 50%;
  background: #f37626;
  border-radius: 100% 0 0;
  position: absolute;
  top: 0;
  left: 0;
  content: '';
}

.jp-SpinnerContent::after {
  background: var(--jp-layout-color0);
  width: 75%;
  height: 75%;
  border-radius: 50%;
  content: '';
  margin: auto;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
}

@keyframes fadeIn {
  0% {
    opacity: 0;
  }

  100% {
    opacity: 1;
  }
}

@keyframes load3 {
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

button.jp-mod-styled {
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color0);
  border: none;
  box-sizing: border-box;
  text-align: center;
  line-height: 32px;
  height: 32px;
  padding: 0 12px;
  letter-spacing: 0.8px;
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
}

input.jp-mod-styled {
  background: var(--jp-input-background);
  height: 28px;
  box-sizing: border-box;
  border: var(--jp-border-width) solid var(--jp-border-color1);
  padding-left: 7px;
  padding-right: 7px;
  font-size: var(--jp-ui-font-size2);
  color: var(--jp-ui-font-color0);
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
}

input[type='checkbox'].jp-mod-styled {
  appearance: checkbox;
  -webkit-appearance: checkbox;
  -moz-appearance: checkbox;
  height: auto;
}

input.jp-mod-styled:focus {
  border: var(--jp-border-width) solid var(--md-blue-500);
  box-shadow: inset 0 0 4px var(--md-blue-300);
}

.jp-select-wrapper {
  display: flex;
  position: relative;
  flex-direction: column;
  padding: 1px;
  background-color: var(--jp-layout-color1);
  box-sizing: border-box;
  margin-bottom: 12px;
}

.jp-select-wrapper:not(.multiple) {
  height: 28px;
}

.jp-select-wrapper.jp-mod-focused select.jp-mod-styled {
  border: var(--jp-border-width) solid var(--jp-input-active-border-color);
  box-shadow: var(--jp-input-box-shadow);
  background-color: var(--jp-input-active-background);
}

select.jp-mod-styled:hover {
  cursor: pointer;
  color: var(--jp-ui-font-color0);
  background-color: var(--jp-input-hover-background);
  box-shadow: inset 0 0 1px rgba(0, 0, 0, 0.5);
}

select.jp-mod-styled {
  flex: 1 1 auto;
  width: 100%;
  font-size: var(--jp-ui-font-size2);
  background: var(--jp-input-background);
  color: var(--jp-ui-font-color0);
  padding: 0 25px 0 8px;
  border: var(--jp-border-width) solid var(--jp-input-border-color);
  border-radius: 0;
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
}

select.jp-mod-styled:not([multiple]) {
  height: 32px;
}

select.jp-mod-styled[multiple] {
  max-height: 200px;
  overflow-y: auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-switch {
  display: flex;
  align-items: center;
  padding-left: 4px;
  padding-right: 4px;
  font-size: var(--jp-ui-font-size1);
  background-color: transparent;
  color: var(--jp-ui-font-color1);
  border: none;
  height: 20px;
}

.jp-switch:hover {
  background-color: var(--jp-layout-color2);
}

.jp-switch-label {
  margin-right: 5px;
  font-family: var(--jp-ui-font-family);
}

.jp-switch-track {
  cursor: pointer;
  background-color: var(--jp-switch-color, var(--jp-border-color1));
  -webkit-transition: 0.4s;
  transition: 0.4s;
  border-radius: 34px;
  height: 16px;
  width: 35px;
  position: relative;
}

.jp-switch-track::before {
  content: '';
  position: absolute;
  height: 10px;
  width: 10px;
  margin: 3px;
  left: 0;
  background-color: var(--jp-ui-inverse-font-color1);
  -webkit-transition: 0.4s;
  transition: 0.4s;
  border-radius: 50%;
}

.jp-switch[aria-checked='true'] .jp-switch-track {
  background-color: var(--jp-switch-true-position-color, var(--jp-warn-color0));
}

.jp-switch[aria-checked='true'] .jp-switch-track::before {
  /* track width (35) - margins (3 + 3) - thumb width (10) */
  left: 19px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

:root {
  --jp-private-toolbar-height: calc(
    28px + var(--jp-border-width)
  ); /* leave 28px for content */
}

.jp-Toolbar {
  color: var(--jp-ui-font-color1);
  flex: 0 0 auto;
  display: flex;
  flex-direction: row;
  border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  box-shadow: var(--jp-toolbar-box-shadow);
  background: var(--jp-toolbar-background);
  min-height: var(--jp-toolbar-micro-height);
  padding: 2px;
  z-index: 8;
  overflow-x: hidden;
}

/* Toolbar items */

.jp-Toolbar > .jp-Toolbar-item.jp-Toolbar-spacer {
  flex-grow: 1;
  flex-shrink: 1;
}

.jp-Toolbar-item.jp-Toolbar-kernelStatus {
  display: inline-block;
  width: 32px;
  background-repeat: no-repeat;
  background-position: center;
  background-size: 16px;
}

.jp-Toolbar > .jp-Toolbar-item {
  flex: 0 0 auto;
  display: flex;
  padding-left: 1px;
  padding-right: 1px;
  font-size: var(--jp-ui-font-size1);
  line-height: var(--jp-private-toolbar-height);
  height: 100%;
}

/* Toolbar buttons */

/* This is the div we use to wrap the react component into a Widget */
div.jp-ToolbarButton {
  color: transparent;
  border: none;
  box-sizing: border-box;
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  padding: 0;
  margin: 0;
}

button.jp-ToolbarButtonComponent {
  background: var(--jp-layout-color1);
  border: none;
  box-sizing: border-box;
  outline: none;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  padding: 0 6px;
  margin: 0;
  height: 24px;
  border-radius: var(--jp-border-radius);
  display: flex;
  align-items: center;
  text-align: center;
  font-size: 14px;
  min-width: unset;
  min-height: unset;
}

button.jp-ToolbarButtonComponent:disabled {
  opacity: 0.4;
}

button.jp-ToolbarButtonComponent > span {
  padding: 0;
  flex: 0 0 auto;
}

button.jp-ToolbarButtonComponent .jp-ToolbarButtonComponent-label {
  font-size: var(--jp-ui-font-size1);
  line-height: 100%;
  padding-left: 2px;
  color: var(--jp-ui-font-color1);
  font-family: var(--jp-ui-font-family);
}

#jp-main-dock-panel[data-mode='single-document']
  .jp-MainAreaWidget
  > .jp-Toolbar.jp-Toolbar-micro {
  padding: 0;
  min-height: 0;
}

#jp-main-dock-panel[data-mode='single-document']
  .jp-MainAreaWidget
  > .jp-Toolbar {
  border: none;
  box-shadow: none;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-WindowedPanel-outer {
  position: relative;
  overflow-y: auto;
}

.jp-WindowedPanel-inner {
  position: relative;
}

.jp-WindowedPanel-window {
  position: absolute;
  left: 0;
  right: 0;
  overflow: visible;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/* Sibling imports */

body {
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
}

/* Disable native link decoration styles everywhere outside of dialog boxes */
a {
  text-decoration: unset;
  color: unset;
}

a:hover {
  text-decoration: unset;
  color: unset;
}

/* Accessibility for links inside dialog box text */
.jp-Dialog-content a {
  text-decoration: revert;
  color: var(--jp-content-link-color);
}

.jp-Dialog-content a:hover {
  text-decoration: revert;
}

/* Styles for ui-components */
.jp-Button {
  color: var(--jp-ui-font-color2);
  border-radius: var(--jp-border-radius);
  padding: 0 12px;
  font-size: var(--jp-ui-font-size1);

  /* Copy from blueprint 3 */
  display: inline-flex;
  flex-direction: row;
  border: none;
  cursor: pointer;
  align-items: center;
  justify-content: center;
  text-align: left;
  vertical-align: middle;
  min-height: 30px;
  min-width: 30px;
}

.jp-Button:disabled {
  cursor: not-allowed;
}

.jp-Button:empty {
  padding: 0 !important;
}

.jp-Button.jp-mod-small {
  min-height: 24px;
  min-width: 24px;
  font-size: 12px;
  padding: 0 7px;
}

/* Use our own theme for hover styles */
.jp-Button.jp-mod-minimal:hover {
  background-color: var(--jp-layout-color2);
}

.jp-Button.jp-mod-minimal {
  background: none;
}

.jp-InputGroup {
  display: block;
  position: relative;
}

.jp-InputGroup input {
  box-sizing: border-box;
  border: none;
  border-radius: 0;
  background-color: transparent;
  color: var(--jp-ui-font-color0);
  box-shadow: inset 0 0 0 var(--jp-border-width) var(--jp-input-border-color);
  padding-bottom: 0;
  padding-top: 0;
  padding-left: 10px;
  padding-right: 28px;
  position: relative;
  width: 100%;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  font-size: 14px;
  font-weight: 400;
  height: 30px;
  line-height: 30px;
  outline: none;
  vertical-align: middle;
}

.jp-InputGroup input:focus {
  box-shadow: inset 0 0 0 var(--jp-border-width)
      var(--jp-input-active-box-shadow-color),
    inset 0 0 0 3px var(--jp-input-active-box-shadow-color);
}

.jp-InputGroup input:disabled {
  cursor: not-allowed;
  resize: block;
  background-color: var(--jp-layout-color2);
  color: var(--jp-ui-font-color2);
}

.jp-InputGroup input:disabled ~ span {
  cursor: not-allowed;
  color: var(--jp-ui-font-color2);
}

.jp-InputGroup input::placeholder,
input::placeholder {
  color: var(--jp-ui-font-color2);
}

.jp-InputGroupAction {
  position: absolute;
  bottom: 1px;
  right: 0;
  padding: 6px;
}

.jp-HTMLSelect.jp-DefaultStyle select {
  background-color: initial;
  border: none;
  border-radius: 0;
  box-shadow: none;
  color: var(--jp-ui-font-color0);
  display: block;
  font-size: var(--jp-ui-font-size1);
  font-family: var(--jp-ui-font-family);
  height: 24px;
  line-height: 14px;
  padding: 0 25px 0 10px;
  text-align: left;
  -moz-appearance: none;
  -webkit-appearance: none;
}

.jp-HTMLSelect.jp-DefaultStyle select:disabled {
  background-color: var(--jp-layout-color2);
  color: var(--jp-ui-font-color2);
  cursor: not-allowed;
  resize: block;
}

.jp-HTMLSelect.jp-DefaultStyle select:disabled ~ span {
  cursor: not-allowed;
}

/* Use our own theme for hover and option styles */
/* stylelint-disable-next-line selector-max-type */
.jp-HTMLSelect.jp-DefaultStyle select:hover,
.jp-HTMLSelect.jp-DefaultStyle select > option {
  background-color: var(--jp-layout-color2);
  color: var(--jp-ui-font-color0);
}

select {
  box-sizing: border-box;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Styles
|----------------------------------------------------------------------------*/

.jp-StatusBar-Widget {
  display: flex;
  align-items: center;
  background: var(--jp-layout-color2);
  min-height: var(--jp-statusbar-height);
  justify-content: space-between;
  padding: 0 10px;
}

.jp-StatusBar-Left {
  display: flex;
  align-items: center;
  flex-direction: row;
}

.jp-StatusBar-Middle {
  display: flex;
  align-items: center;
}

.jp-StatusBar-Right {
  display: flex;
  align-items: center;
  flex-direction: row-reverse;
}

.jp-StatusBar-Item {
  max-height: var(--jp-statusbar-height);
  margin: 0 2px;
  height: var(--jp-statusbar-height);
  white-space: nowrap;
  text-overflow: ellipsis;
  color: var(--jp-ui-font-color1);
  padding: 0 6px;
}

.jp-mod-highlighted:hover {
  background-color: var(--jp-layout-color3);
}

.jp-mod-clicked {
  background-color: var(--jp-brand-color1);
}

.jp-mod-clicked:hover {
  background-color: var(--jp-brand-color0);
}

.jp-mod-clicked .jp-StatusBar-TextItem {
  color: var(--jp-ui-inverse-font-color1);
}

.jp-StatusBar-HoverItem {
  box-shadow: '0px 4px 4px rgba(0, 0, 0, 0.25)';
}

.jp-StatusBar-TextItem {
  font-size: var(--jp-ui-font-size1);
  font-family: var(--jp-ui-font-family);
  line-height: 24px;
  color: var(--jp-ui-font-color1);
}

.jp-StatusBar-GroupItem {
  display: flex;
  align-items: center;
  flex-direction: row;
}

.jp-Statusbar-ProgressCircle svg {
  display: block;
  margin: 0 auto;
  width: 16px;
  height: 24px;
  align-self: normal;
}

.jp-Statusbar-ProgressCircle path {
  fill: var(--jp-inverse-layout-color3);
}

.jp-Statusbar-ProgressBar-progress-bar {
  height: 10px;
  width: 100px;
  border: solid 0.25px var(--jp-brand-color2);
  border-radius: 3px;
  overflow: hidden;
  align-self: center;
}

.jp-Statusbar-ProgressBar-progress-bar > div {
  background-color: var(--jp-brand-color2);
  background-image: linear-gradient(
    -45deg,
    rgba(255, 255, 255, 0.2) 25%,
    transparent 25%,
    transparent 50%,
    rgba(255, 255, 255, 0.2) 50%,
    rgba(255, 255, 255, 0.2) 75%,
    transparent 75%,
    transparent
  );
  background-size: 40px 40px;
  float: left;
  width: 0%;
  height: 100%;
  font-size: 12px;
  line-height: 14px;
  color: #fff;
  text-align: center;
  animation: jp-Statusbar-ExecutionTime-progress-bar 2s linear infinite;
}

.jp-Statusbar-ProgressBar-progress-bar p {
  color: var(--jp-ui-font-color1);
  font-family: var(--jp-ui-font-family);
  font-size: var(--jp-ui-font-size1);
  line-height: 10px;
  width: 100px;
}

@keyframes jp-Statusbar-ExecutionTime-progress-bar {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 40px 40px;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

:root {
  --jp-private-commandpalette-search-height: 28px;
}

/*-----------------------------------------------------------------------------
| Overall styles
|----------------------------------------------------------------------------*/

.lm-CommandPalette {
  padding-bottom: 0;
  color: var(--jp-ui-font-color1);
  background: var(--jp-layout-color1);

  /* This is needed so that all font sizing of children done in ems is
   * relative to this base size */
  font-size: var(--jp-ui-font-size1);
}

/*-----------------------------------------------------------------------------
| Modal variant
|----------------------------------------------------------------------------*/

.jp-ModalCommandPalette {
  position: absolute;
  z-index: 10000;
  top: 38px;
  left: 30%;
  margin: 0;
  padding: 4px;
  width: 40%;
  box-shadow: var(--jp-elevation-z4);
  border-radius: 4px;
  background: var(--jp-layout-color0);
}

.jp-ModalCommandPalette .lm-CommandPalette {
  max-height: 40vh;
}

.jp-ModalCommandPalette .lm-CommandPalette .lm-close-icon::after {
  display: none;
}

.jp-ModalCommandPalette .lm-CommandPalette .lm-CommandPalette-header {
  display: none;
}

.jp-ModalCommandPalette .lm-CommandPalette .lm-CommandPalette-item {
  margin-left: 4px;
  margin-right: 4px;
}

.jp-ModalCommandPalette
  .lm-CommandPalette
  .lm-CommandPalette-item.lm-mod-disabled {
  display: none;
}

/*-----------------------------------------------------------------------------
| Search
|----------------------------------------------------------------------------*/

.lm-CommandPalette-search {
  padding: 4px;
  background-color: var(--jp-layout-color1);
  z-index: 2;
}

.lm-CommandPalette-wrapper {
  overflow: overlay;
  padding: 0 9px;
  background-color: var(--jp-input-active-background);
  height: 30px;
  box-shadow: inset 0 0 0 var(--jp-border-width) var(--jp-input-border-color);
}

.lm-CommandPalette.lm-mod-focused .lm-CommandPalette-wrapper {
  box-shadow: inset 0 0 0 1px var(--jp-input-active-box-shadow-color),
    inset 0 0 0 3px var(--jp-input-active-box-shadow-color);
}

.jp-SearchIconGroup {
  color: white;
  background-color: var(--jp-brand-color1);
  position: absolute;
  top: 4px;
  right: 4px;
  padding: 5px 5px 1px;
}

.jp-SearchIconGroup svg {
  height: 20px;
  width: 20px;
}

.jp-SearchIconGroup .jp-icon3[fill] {
  fill: var(--jp-layout-color0);
}

.lm-CommandPalette-input {
  background: transparent;
  width: calc(100% - 18px);
  float: left;
  border: none;
  outline: none;
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color0);
  line-height: var(--jp-private-commandpalette-search-height);
}

.lm-CommandPalette-input::-webkit-input-placeholder,
.lm-CommandPalette-input::-moz-placeholder,
.lm-CommandPalette-input:-ms-input-placeholder {
  color: var(--jp-ui-font-color2);
  font-size: var(--jp-ui-font-size1);
}

/*-----------------------------------------------------------------------------
| Results
|----------------------------------------------------------------------------*/

.lm-CommandPalette-header:first-child {
  margin-top: 0;
}

.lm-CommandPalette-header {
  border-bottom: solid var(--jp-border-width) var(--jp-border-color2);
  color: var(--jp-ui-font-color1);
  cursor: pointer;
  display: flex;
  font-size: var(--jp-ui-font-size0);
  font-weight: 600;
  letter-spacing: 1px;
  margin-top: 8px;
  padding: 8px 0 8px 12px;
  text-transform: uppercase;
}

.lm-CommandPalette-header.lm-mod-active {
  background: var(--jp-layout-color2);
}

.lm-CommandPalette-header > mark {
  background-color: transparent;
  font-weight: bold;
  color: var(--jp-ui-font-color1);
}

.lm-CommandPalette-item {
  padding: 4px 12px 4px 4px;
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  font-weight: 400;
  display: flex;
}

.lm-CommandPalette-item.lm-mod-disabled {
  color: var(--jp-ui-font-color2);
}

.lm-CommandPalette-item.lm-mod-active {
  color: var(--jp-ui-inverse-font-color1);
  background: var(--jp-brand-color1);
}

.lm-CommandPalette-item.lm-mod-active .lm-CommandPalette-itemLabel > mark {
  color: var(--jp-ui-inverse-font-color0);
}

.lm-CommandPalette-item.lm-mod-active .jp-icon-selectable[fill] {
  fill: var(--jp-layout-color0);
}

.lm-CommandPalette-item.lm-mod-active:hover:not(.lm-mod-disabled) {
  color: var(--jp-ui-inverse-font-color1);
  background: var(--jp-brand-color1);
}

.lm-CommandPalette-item:hover:not(.lm-mod-active):not(.lm-mod-disabled) {
  background: var(--jp-layout-color2);
}

.lm-CommandPalette-itemContent {
  overflow: hidden;
}

.lm-CommandPalette-itemLabel > mark {
  color: var(--jp-ui-font-color0);
  background-color: transparent;
  font-weight: bold;
}

.lm-CommandPalette-item.lm-mod-disabled mark {
  color: var(--jp-ui-font-color2);
}

.lm-CommandPalette-item .lm-CommandPalette-itemIcon {
  margin: 0 4px 0 0;
  position: relative;
  width: 16px;
  top: 2px;
  flex: 0 0 auto;
}

.lm-CommandPalette-item.lm-mod-disabled .lm-CommandPalette-itemIcon {
  opacity: 0.6;
}

.lm-CommandPalette-item .lm-CommandPalette-itemShortcut {
  flex: 0 0 auto;
}

.lm-CommandPalette-itemCaption {
  display: none;
}

.lm-CommandPalette-content {
  background-color: var(--jp-layout-color1);
}

.lm-CommandPalette-content:empty::after {
  content: 'No results';
  margin: auto;
  margin-top: 20px;
  width: 100px;
  display: block;
  font-size: var(--jp-ui-font-size2);
  font-family: var(--jp-ui-font-family);
  font-weight: lighter;
}

.lm-CommandPalette-emptyMessage {
  text-align: center;
  margin-top: 24px;
  line-height: 1.32;
  padding: 0 8px;
  color: var(--jp-content-font-color3);
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-Dialog {
  position: absolute;
  z-index: 10000;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  top: 0;
  left: 0;
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  background: var(--jp-dialog-background);
}

.jp-Dialog-content {
  display: flex;
  flex-direction: column;
  margin-left: auto;
  margin-right: auto;
  background: var(--jp-layout-color1);
  padding: 24px 24px 12px;
  min-width: 300px;
  min-height: 150px;
  max-width: 1000px;
  max-height: 500px;
  box-sizing: border-box;
  box-shadow: var(--jp-elevation-z20);
  word-wrap: break-word;
  border-radius: var(--jp-border-radius);

  /* This is needed so that all font sizing of children done in ems is
   * relative to this base size */
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color1);
  resize: both;
}

.jp-Dialog-content.jp-Dialog-content-small {
  max-width: 500px;
}

.jp-Dialog-button {
  overflow: visible;
}

button.jp-Dialog-button:focus {
  outline: 1px solid var(--jp-brand-color1);
  outline-offset: 4px;
  -moz-outline-radius: 0;
}

button.jp-Dialog-button:focus::-moz-focus-inner {
  border: 0;
}

button.jp-Dialog-button.jp-mod-styled.jp-mod-accept:focus,
button.jp-Dialog-button.jp-mod-styled.jp-mod-warn:focus,
button.jp-Dialog-button.jp-mod-styled.jp-mod-reject:focus {
  outline-offset: 4px;
  -moz-outline-radius: 0;
}

button.jp-Dialog-button.jp-mod-styled.jp-mod-accept:focus {
  outline: 1px solid var(--jp-accept-color-normal, var(--jp-brand-color1));
}

button.jp-Dialog-button.jp-mod-styled.jp-mod-warn:focus {
  outline: 1px solid var(--jp-warn-color-normal, var(--jp-error-color1));
}

button.jp-Dialog-button.jp-mod-styled.jp-mod-reject:focus {
  outline: 1px solid var(--jp-reject-color-normal, var(--md-grey-600));
}

button.jp-Dialog-close-button {
  padding: 0;
  height: 100%;
  min-width: unset;
  min-height: unset;
}

.jp-Dialog-header {
  display: flex;
  justify-content: space-between;
  flex: 0 0 auto;
  padding-bottom: 12px;
  font-size: var(--jp-ui-font-size3);
  font-weight: 400;
  color: var(--jp-ui-font-color1);
}

.jp-Dialog-body {
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  font-size: var(--jp-ui-font-size1);
  background: var(--jp-layout-color1);
  color: var(--jp-ui-font-color1);
  overflow: auto;
}

.jp-Dialog-footer {
  display: flex;
  flex-direction: row;
  justify-content: flex-end;
  align-items: center;
  flex: 0 0 auto;
  margin-left: -12px;
  margin-right: -12px;
  padding: 12px;
}

.jp-Dialog-checkbox {
  padding-right: 5px;
}

.jp-Dialog-checkbox > input:focus-visible {
  outline: 1px solid var(--jp-input-active-border-color);
  outline-offset: 1px;
}

.jp-Dialog-spacer {
  flex: 1 1 auto;
}

.jp-Dialog-title {
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

.jp-Dialog-body > .jp-select-wrapper {
  width: 100%;
}

.jp-Dialog-body > button {
  padding: 0 16px;
}

.jp-Dialog-body > label {
  line-height: 1.4;
  color: var(--jp-ui-font-color0);
}

.jp-Dialog-button.jp-mod-styled:not(:last-child) {
  margin-right: 12px;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-Input-Boolean-Dialog {
  flex-direction: row-reverse;
  align-items: end;
  width: 100%;
}

.jp-Input-Boolean-Dialog > label {
  flex: 1 1 auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-MainAreaWidget > :focus {
  outline: none;
}

.jp-MainAreaWidget .jp-MainAreaWidget-error {
  padding: 6px;
}

.jp-MainAreaWidget .jp-MainAreaWidget-error > pre {
  width: auto;
  padding: 10px;
  background: var(--jp-error-color3);
  border: var(--jp-border-width) solid var(--jp-error-color1);
  border-radius: var(--jp-border-radius);
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  white-space: pre-wrap;
  word-wrap: break-word;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/**
 * google-material-color v1.2.6
 * https://github.com/danlevan/google-material-color
 */
:root {
  --md-red-50: #ffebee;
  --md-red-100: #ffcdd2;
  --md-red-200: #ef9a9a;
  --md-red-300: #e57373;
  --md-red-400: #ef5350;
  --md-red-500: #f44336;
  --md-red-600: #e53935;
  --md-red-700: #d32f2f;
  --md-red-800: #c62828;
  --md-red-900: #b71c1c;
  --md-red-A100: #ff8a80;
  --md-red-A200: #ff5252;
  --md-red-A400: #ff1744;
  --md-red-A700: #d50000;
  --md-pink-50: #fce4ec;
  --md-pink-100: #f8bbd0;
  --md-pink-200: #f48fb1;
  --md-pink-300: #f06292;
  --md-pink-400: #ec407a;
  --md-pink-500: #e91e63;
  --md-pink-600: #d81b60;
  --md-pink-700: #c2185b;
  --md-pink-800: #ad1457;
  --md-pink-900: #880e4f;
  --md-pink-A100: #ff80ab;
  --md-pink-A200: #ff4081;
  --md-pink-A400: #f50057;
  --md-pink-A700: #c51162;
  --md-purple-50: #f3e5f5;
  --md-purple-100: #e1bee7;
  --md-purple-200: #ce93d8;
  --md-purple-300: #ba68c8;
  --md-purple-400: #ab47bc;
  --md-purple-500: #9c27b0;
  --md-purple-600: #8e24aa;
  --md-purple-700: #7b1fa2;
  --md-purple-800: #6a1b9a;
  --md-purple-900: #4a148c;
  --md-purple-A100: #ea80fc;
  --md-purple-A200: #e040fb;
  --md-purple-A400: #d500f9;
  --md-purple-A700: #a0f;
  --md-deep-purple-50: #ede7f6;
  --md-deep-purple-100: #d1c4e9;
  --md-deep-purple-200: #b39ddb;
  --md-deep-purple-300: #9575cd;
  --md-deep-purple-400: #7e57c2;
  --md-deep-purple-500: #673ab7;
  --md-deep-purple-600: #5e35b1;
  --md-deep-purple-700: #512da8;
  --md-deep-purple-800: #4527a0;
  --md-deep-purple-900: #311b92;
  --md-deep-purple-A100: #b388ff;
  --md-deep-purple-A200: #7c4dff;
  --md-deep-purple-A400: #651fff;
  --md-deep-purple-A700: #6200ea;
  --md-indigo-50: #e8eaf6;
  --md-indigo-100: #c5cae9;
  --md-indigo-200: #9fa8da;
  --md-indigo-300: #7986cb;
  --md-indigo-400: #5c6bc0;
  --md-indigo-500: #3f51b5;
  --md-indigo-600: #3949ab;
  --md-indigo-700: #303f9f;
  --md-indigo-800: #283593;
  --md-indigo-900: #1a237e;
  --md-indigo-A100: #8c9eff;
  --md-indigo-A200: #536dfe;
  --md-indigo-A400: #3d5afe;
  --md-indigo-A700: #304ffe;
  --md-blue-50: #e3f2fd;
  --md-blue-100: #bbdefb;
  --md-blue-200: #90caf9;
  --md-blue-300: #64b5f6;
  --md-blue-400: #42a5f5;
  --md-blue-500: #2196f3;
  --md-blue-600: #1e88e5;
  --md-blue-700: #1976d2;
  --md-blue-800: #1565c0;
  --md-blue-900: #0d47a1;
  --md-blue-A100: #82b1ff;
  --md-blue-A200: #448aff;
  --md-blue-A400: #2979ff;
  --md-blue-A700: #2962ff;
  --md-light-blue-50: #e1f5fe;
  --md-light-blue-100: #b3e5fc;
  --md-light-blue-200: #81d4fa;
  --md-light-blue-300: #4fc3f7;
  --md-light-blue-400: #29b6f6;
  --md-light-blue-500: #03a9f4;
  --md-light-blue-600: #039be5;
  --md-light-blue-700: #0288d1;
  --md-light-blue-800: #0277bd;
  --md-light-blue-900: #01579b;
  --md-light-blue-A100: #80d8ff;
  --md-light-blue-A200: #40c4ff;
  --md-light-blue-A400: #00b0ff;
  --md-light-blue-A700: #0091ea;
  --md-cyan-50: #e0f7fa;
  --md-cyan-100: #b2ebf2;
  --md-cyan-200: #80deea;
  --md-cyan-300: #4dd0e1;
  --md-cyan-400: #26c6da;
  --md-cyan-500: #00bcd4;
  --md-cyan-600: #00acc1;
  --md-cyan-700: #0097a7;
  --md-cyan-800: #00838f;
  --md-cyan-900: #006064;
  --md-cyan-A100: #84ffff;
  --md-cyan-A200: #18ffff;
  --md-cyan-A400: #00e5ff;
  --md-cyan-A700: #00b8d4;
  --md-teal-50: #e0f2f1;
  --md-teal-100: #b2dfdb;
  --md-teal-200: #80cbc4;
  --md-teal-300: #4db6ac;
  --md-teal-400: #26a69a;
  --md-teal-500: #009688;
  --md-teal-600: #00897b;
  --md-teal-700: #00796b;
  --md-teal-800: #00695c;
  --md-teal-900: #004d40;
  --md-teal-A100: #a7ffeb;
  --md-teal-A200: #64ffda;
  --md-teal-A400: #1de9b6;
  --md-teal-A700: #00bfa5;
  --md-green-50: #e8f5e9;
  --md-green-100: #c8e6c9;
  --md-green-200: #a5d6a7;
  --md-green-300: #81c784;
  --md-green-400: #66bb6a;
  --md-green-500: #4caf50;
  --md-green-600: #43a047;
  --md-green-700: #388e3c;
  --md-green-800: #2e7d32;
  --md-green-900: #1b5e20;
  --md-green-A100: #b9f6ca;
  --md-green-A200: #69f0ae;
  --md-green-A400: #00e676;
  --md-green-A700: #00c853;
  --md-light-green-50: #f1f8e9;
  --md-light-green-100: #dcedc8;
  --md-light-green-200: #c5e1a5;
  --md-light-green-300: #aed581;
  --md-light-green-400: #9ccc65;
  --md-light-green-500: #8bc34a;
  --md-light-green-600: #7cb342;
  --md-light-green-700: #689f38;
  --md-light-green-800: #558b2f;
  --md-light-green-900: #33691e;
  --md-light-green-A100: #ccff90;
  --md-light-green-A200: #b2ff59;
  --md-light-green-A400: #76ff03;
  --md-light-green-A700: #64dd17;
  --md-lime-50: #f9fbe7;
  --md-lime-100: #f0f4c3;
  --md-lime-200: #e6ee9c;
  --md-lime-300: #dce775;
  --md-lime-400: #d4e157;
  --md-lime-500: #cddc39;
  --md-lime-600: #c0ca33;
  --md-lime-700: #afb42b;
  --md-lime-800: #9e9d24;
  --md-lime-900: #827717;
  --md-lime-A100: #f4ff81;
  --md-lime-A200: #eeff41;
  --md-lime-A400: #c6ff00;
  --md-lime-A700: #aeea00;
  --md-yellow-50: #fffde7;
  --md-yellow-100: #fff9c4;
  --md-yellow-200: #fff59d;
  --md-yellow-300: #fff176;
  --md-yellow-400: #ffee58;
  --md-yellow-500: #ffeb3b;
  --md-yellow-600: #fdd835;
  --md-yellow-700: #fbc02d;
  --md-yellow-800: #f9a825;
  --md-yellow-900: #f57f17;
  --md-yellow-A100: #ffff8d;
  --md-yellow-A200: #ff0;
  --md-yellow-A400: #ffea00;
  --md-yellow-A700: #ffd600;
  --md-amber-50: #fff8e1;
  --md-amber-100: #ffecb3;
  --md-amber-200: #ffe082;
  --md-amber-300: #ffd54f;
  --md-amber-400: #ffca28;
  --md-amber-500: #ffc107;
  --md-amber-600: #ffb300;
  --md-amber-700: #ffa000;
  --md-amber-800: #ff8f00;
  --md-amber-900: #ff6f00;
  --md-amber-A100: #ffe57f;
  --md-amber-A200: #ffd740;
  --md-amber-A400: #ffc400;
  --md-amber-A700: #ffab00;
  --md-orange-50: #fff3e0;
  --md-orange-100: #ffe0b2;
  --md-orange-200: #ffcc80;
  --md-orange-300: #ffb74d;
  --md-orange-400: #ffa726;
  --md-orange-500: #ff9800;
  --md-orange-600: #fb8c00;
  --md-orange-700: #f57c00;
  --md-orange-800: #ef6c00;
  --md-orange-900: #e65100;
  --md-orange-A100: #ffd180;
  --md-orange-A200: #ffab40;
  --md-orange-A400: #ff9100;
  --md-orange-A700: #ff6d00;
  --md-deep-orange-50: #fbe9e7;
  --md-deep-orange-100: #ffccbc;
  --md-deep-orange-200: #ffab91;
  --md-deep-orange-300: #ff8a65;
  --md-deep-orange-400: #ff7043;
  --md-deep-orange-500: #ff5722;
  --md-deep-orange-600: #f4511e;
  --md-deep-orange-700: #e64a19;
  --md-deep-orange-800: #d84315;
  --md-deep-orange-900: #bf360c;
  --md-deep-orange-A100: #ff9e80;
  --md-deep-orange-A200: #ff6e40;
  --md-deep-orange-A400: #ff3d00;
  --md-deep-orange-A700: #dd2c00;
  --md-brown-50: #efebe9;
  --md-brown-100: #d7ccc8;
  --md-brown-200: #bcaaa4;
  --md-brown-300: #a1887f;
  --md-brown-400: #8d6e63;
  --md-brown-500: #795548;
  --md-brown-600: #6d4c41;
  --md-brown-700: #5d4037;
  --md-brown-800: #4e342e;
  --md-brown-900: #3e2723;
  --md-grey-50: #fafafa;
  --md-grey-100: #f5f5f5;
  --md-grey-200: #eee;
  --md-grey-300: #e0e0e0;
  --md-grey-400: #bdbdbd;
  --md-grey-500: #9e9e9e;
  --md-grey-600: #757575;
  --md-grey-700: #616161;
  --md-grey-800: #424242;
  --md-grey-900: #212121;
  --md-blue-grey-50: #eceff1;
  --md-blue-grey-100: #cfd8dc;
  --md-blue-grey-200: #b0bec5;
  --md-blue-grey-300: #90a4ae;
  --md-blue-grey-400: #78909c;
  --md-blue-grey-500: #607d8b;
  --md-blue-grey-600: #546e7a;
  --md-blue-grey-700: #455a64;
  --md-blue-grey-800: #37474f;
  --md-blue-grey-900: #263238;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2017, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| RenderedText
|----------------------------------------------------------------------------*/

:root {
  /* This is the padding value to fill the gaps between lines containing spans with background color. */
  --jp-private-code-span-padding: calc(
    (var(--jp-code-line-height) - 1) * var(--jp-code-font-size) / 2
  );
}

.jp-RenderedText {
  text-align: left;
  padding-left: var(--jp-code-padding);
  line-height: var(--jp-code-line-height);
  font-family: var(--jp-code-font-family);
}

.jp-RenderedText pre,
.jp-RenderedJavaScript pre,
.jp-RenderedHTMLCommon pre {
  color: var(--jp-content-font-color1);
  font-size: var(--jp-code-font-size);
  border: none;
  margin: 0;
  padding: 0;
}

.jp-RenderedText pre a:link {
  text-decoration: none;
  color: var(--jp-content-link-color);
}

.jp-RenderedText pre a:hover {
  text-decoration: underline;
  color: var(--jp-content-link-color);
}

.jp-RenderedText pre a:visited {
  text-decoration: none;
  color: var(--jp-content-link-color);
}

/* console foregrounds and backgrounds */
.jp-RenderedText pre .ansi-black-fg {
  color: #3e424d;
}

.jp-RenderedText pre .ansi-red-fg {
  color: #e75c58;
}

.jp-RenderedText pre .ansi-green-fg {
  color: #00a250;
}

.jp-RenderedText pre .ansi-yellow-fg {
  color: #ddb62b;
}

.jp-RenderedText pre .ansi-blue-fg {
  color: #208ffb;
}

.jp-RenderedText pre .ansi-magenta-fg {
  color: #d160c4;
}

.jp-RenderedText pre .ansi-cyan-fg {
  color: #60c6c8;
}

.jp-RenderedText pre .ansi-white-fg {
  color: #c5c1b4;
}

.jp-RenderedText pre .ansi-black-bg {
  background-color: #3e424d;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-red-bg {
  background-color: #e75c58;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-green-bg {
  background-color: #00a250;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-yellow-bg {
  background-color: #ddb62b;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-blue-bg {
  background-color: #208ffb;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-magenta-bg {
  background-color: #d160c4;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-cyan-bg {
  background-color: #60c6c8;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-white-bg {
  background-color: #c5c1b4;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-black-intense-fg {
  color: #282c36;
}

.jp-RenderedText pre .ansi-red-intense-fg {
  color: #b22b31;
}

.jp-RenderedText pre .ansi-green-intense-fg {
  color: #007427;
}

.jp-RenderedText pre .ansi-yellow-intense-fg {
  color: #b27d12;
}

.jp-RenderedText pre .ansi-blue-intense-fg {
  color: #0065ca;
}

.jp-RenderedText pre .ansi-magenta-intense-fg {
  color: #a03196;
}

.jp-RenderedText pre .ansi-cyan-intense-fg {
  color: #258f8f;
}

.jp-RenderedText pre .ansi-white-intense-fg {
  color: #a1a6b2;
}

.jp-RenderedText pre .ansi-black-intense-bg {
  background-color: #282c36;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-red-intense-bg {
  background-color: #b22b31;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-green-intense-bg {
  background-color: #007427;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-yellow-intense-bg {
  background-color: #b27d12;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-blue-intense-bg {
  background-color: #0065ca;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-magenta-intense-bg {
  background-color: #a03196;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-cyan-intense-bg {
  background-color: #258f8f;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-white-intense-bg {
  background-color: #a1a6b2;
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-default-inverse-fg {
  color: var(--jp-ui-inverse-font-color0);
}

.jp-RenderedText pre .ansi-default-inverse-bg {
  background-color: var(--jp-inverse-layout-color0);
  padding: var(--jp-private-code-span-padding) 0;
}

.jp-RenderedText pre .ansi-bold {
  font-weight: bold;
}

.jp-RenderedText pre .ansi-underline {
  text-decoration: underline;
}

.jp-RenderedText[data-mime-type='application/vnd.jupyter.stderr'] {
  background: var(--jp-rendermime-error-background);
  padding-top: var(--jp-code-padding);
}

/*-----------------------------------------------------------------------------
| RenderedLatex
|----------------------------------------------------------------------------*/

.jp-RenderedLatex {
  color: var(--jp-content-font-color1);
  font-size: var(--jp-content-font-size1);
  line-height: var(--jp-content-line-height);
}

/* Left-justify outputs.*/
.jp-OutputArea-output.jp-RenderedLatex {
  padding: var(--jp-code-padding);
  text-align: left;
}

/*-----------------------------------------------------------------------------
| RenderedHTML
|----------------------------------------------------------------------------*/

.jp-RenderedHTMLCommon {
  color: var(--jp-content-font-color1);
  font-family: var(--jp-content-font-family);
  font-size: var(--jp-content-font-size1);
  line-height: var(--jp-content-line-height);

  /* Give a bit more R padding on Markdown text to keep line lengths reasonable */
  padding-right: 20px;
}

.jp-RenderedHTMLCommon em {
  font-style: italic;
}

.jp-RenderedHTMLCommon strong {
  font-weight: bold;
}

.jp-RenderedHTMLCommon u {
  text-decoration: underline;
}

.jp-RenderedHTMLCommon a:link {
  text-decoration: none;
  color: var(--jp-content-link-color);
}

.jp-RenderedHTMLCommon a:hover {
  text-decoration: underline;
  color: var(--jp-content-link-color);
}

.jp-RenderedHTMLCommon a:visited {
  text-decoration: none;
  color: var(--jp-content-link-color);
}

/* Headings */

.jp-RenderedHTMLCommon h1,
.jp-RenderedHTMLCommon h2,
.jp-RenderedHTMLCommon h3,
.jp-RenderedHTMLCommon h4,
.jp-RenderedHTMLCommon h5,
.jp-RenderedHTMLCommon h6 {
  line-height: var(--jp-content-heading-line-height);
  font-weight: var(--jp-content-heading-font-weight);
  font-style: normal;
  margin: var(--jp-content-heading-margin-top) 0
    var(--jp-content-heading-margin-bottom) 0;
}

.jp-RenderedHTMLCommon h1:first-child,
.jp-RenderedHTMLCommon h2:first-child,
.jp-RenderedHTMLCommon h3:first-child,
.jp-RenderedHTMLCommon h4:first-child,
.jp-RenderedHTMLCommon h5:first-child,
.jp-RenderedHTMLCommon h6:first-child {
  margin-top: calc(0.5 * var(--jp-content-heading-margin-top));
}

.jp-RenderedHTMLCommon h1:last-child,
.jp-RenderedHTMLCommon h2:last-child,
.jp-RenderedHTMLCommon h3:last-child,
.jp-RenderedHTMLCommon h4:last-child,
.jp-RenderedHTMLCommon h5:last-child,
.jp-RenderedHTMLCommon h6:last-child {
  margin-bottom: calc(0.5 * var(--jp-content-heading-margin-bottom));
}

.jp-RenderedHTMLCommon h1 {
  font-size: var(--jp-content-font-size5);
}

.jp-RenderedHTMLCommon h2 {
  font-size: var(--jp-content-font-size4);
}

.jp-RenderedHTMLCommon h3 {
  font-size: var(--jp-content-font-size3);
}

.jp-RenderedHTMLCommon h4 {
  font-size: var(--jp-content-font-size2);
}

.jp-RenderedHTMLCommon h5 {
  font-size: var(--jp-content-font-size1);
}

.jp-RenderedHTMLCommon h6 {
  font-size: var(--jp-content-font-size0);
}

/* Lists */

/* stylelint-disable selector-max-type, selector-max-compound-selectors */

.jp-RenderedHTMLCommon ul:not(.list-inline),
.jp-RenderedHTMLCommon ol:not(.list-inline) {
  padding-left: 2em;
}

.jp-RenderedHTMLCommon ul {
  list-style: disc;
}

.jp-RenderedHTMLCommon ul ul {
  list-style: square;
}

.jp-RenderedHTMLCommon ul ul ul {
  list-style: circle;
}

.jp-RenderedHTMLCommon ol {
  list-style: decimal;
}

.jp-RenderedHTMLCommon ol ol {
  list-style: upper-alpha;
}

.jp-RenderedHTMLCommon ol ol ol {
  list-style: lower-alpha;
}

.jp-RenderedHTMLCommon ol ol ol ol {
  list-style: lower-roman;
}

.jp-RenderedHTMLCommon ol ol ol ol ol {
  list-style: decimal;
}

.jp-RenderedHTMLCommon ol,
.jp-RenderedHTMLCommon ul {
  margin-bottom: 1em;
}

.jp-RenderedHTMLCommon ul ul,
.jp-RenderedHTMLCommon ul ol,
.jp-RenderedHTMLCommon ol ul,
.jp-RenderedHTMLCommon ol ol {
  margin-bottom: 0;
}

/* stylelint-enable selector-max-type, selector-max-compound-selectors */

.jp-RenderedHTMLCommon hr {
  color: var(--jp-border-color2);
  background-color: var(--jp-border-color1);
  margin-top: 1em;
  margin-bottom: 1em;
}

.jp-RenderedHTMLCommon > pre {
  margin: 1.5em 2em;
}

.jp-RenderedHTMLCommon pre,
.jp-RenderedHTMLCommon code {
  border: 0;
  background-color: var(--jp-layout-color0);
  color: var(--jp-content-font-color1);
  font-family: var(--jp-code-font-family);
  font-size: inherit;
  line-height: var(--jp-code-line-height);
  padding: 0;
  white-space: pre-wrap;
}

.jp-RenderedHTMLCommon :not(pre) > code {
  background-color: var(--jp-layout-color2);
  padding: 1px 5px;
}

/* Tables */

.jp-RenderedHTMLCommon table {
  border-collapse: collapse;
  border-spacing: 0;
  border: none;
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  table-layout: fixed;
  margin-left: auto;
  margin-bottom: 1em;
  margin-right: auto;
}

.jp-RenderedHTMLCommon thead {
  border-bottom: var(--jp-border-width) solid var(--jp-border-color1);
  vertical-align: bottom;
}

.jp-RenderedHTMLCommon td,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon tr {
  vertical-align: middle;
  padding: 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}

.jp-RenderedMarkdown.jp-RenderedHTMLCommon td,
.jp-RenderedMarkdown.jp-RenderedHTMLCommon th {
  max-width: none;
}

:not(.jp-RenderedMarkdown).jp-RenderedHTMLCommon td,
:not(.jp-RenderedMarkdown).jp-RenderedHTMLCommon th,
:not(.jp-RenderedMarkdown).jp-RenderedHTMLCommon tr {
  text-align: right;
}

.jp-RenderedHTMLCommon th {
  font-weight: bold;
}

.jp-RenderedHTMLCommon tbody tr:nth-child(odd) {
  background: var(--jp-layout-color0);
}

.jp-RenderedHTMLCommon tbody tr:nth-child(even) {
  background: var(--jp-rendermime-table-row-background);
}

.jp-RenderedHTMLCommon tbody tr:hover {
  background: var(--jp-rendermime-table-row-hover-background);
}

.jp-RenderedHTMLCommon p {
  text-align: left;
  margin: 0;
  margin-bottom: 1em;
}

.jp-RenderedHTMLCommon img {
  -moz-force-broken-image-icon: 1;
}

/* Restrict to direct children as other images could be nested in other content. */
.jp-RenderedHTMLCommon > img {
  display: block;
  margin-left: 0;
  margin-right: 0;
  margin-bottom: 1em;
}

/* Change color behind transparent images if they need it... */
[data-jp-theme-light='false'] .jp-RenderedImage img.jp-needs-light-background {
  background-color: var(--jp-inverse-layout-color1);
}

[data-jp-theme-light='true'] .jp-RenderedImage img.jp-needs-dark-background {
  background-color: var(--jp-inverse-layout-color1);
}

.jp-RenderedHTMLCommon img,
.jp-RenderedImage img,
.jp-RenderedHTMLCommon svg,
.jp-RenderedSVG svg {
  max-width: 100%;
  height: auto;
}

.jp-RenderedHTMLCommon img.jp-mod-unconfined,
.jp-RenderedImage img.jp-mod-unconfined,
.jp-RenderedHTMLCommon svg.jp-mod-unconfined,
.jp-RenderedSVG svg.jp-mod-unconfined {
  max-width: none;
}

.jp-RenderedHTMLCommon .alert {
  padding: var(--jp-notebook-padding);
  border: var(--jp-border-width) solid transparent;
  border-radius: var(--jp-border-radius);
  margin-bottom: 1em;
}

.jp-RenderedHTMLCommon .alert-info {
  color: var(--jp-info-color0);
  background-color: var(--jp-info-color3);
  border-color: var(--jp-info-color2);
}

.jp-RenderedHTMLCommon .alert-info hr {
  border-color: var(--jp-info-color3);
}

.jp-RenderedHTMLCommon .alert-info > p:last-child,
.jp-RenderedHTMLCommon .alert-info > ul:last-child {
  margin-bottom: 0;
}

.jp-RenderedHTMLCommon .alert-warning {
  color: var(--jp-warn-color0);
  background-color: var(--jp-warn-color3);
  border-color: var(--jp-warn-color2);
}

.jp-RenderedHTMLCommon .alert-warning hr {
  border-color: var(--jp-warn-color3);
}

.jp-RenderedHTMLCommon .alert-warning > p:last-child,
.jp-RenderedHTMLCommon .alert-warning > ul:last-child {
  margin-bottom: 0;
}

.jp-RenderedHTMLCommon .alert-success {
  color: var(--jp-success-color0);
  background-color: var(--jp-success-color3);
  border-color: var(--jp-success-color2);
}

.jp-RenderedHTMLCommon .alert-success hr {
  border-color: var(--jp-success-color3);
}

.jp-RenderedHTMLCommon .alert-success > p:last-child,
.jp-RenderedHTMLCommon .alert-success > ul:last-child {
  margin-bottom: 0;
}

.jp-RenderedHTMLCommon .alert-danger {
  color: var(--jp-error-color0);
  background-color: var(--jp-error-color3);
  border-color: var(--jp-error-color2);
}

.jp-RenderedHTMLCommon .alert-danger hr {
  border-color: var(--jp-error-color3);
}

.jp-RenderedHTMLCommon .alert-danger > p:last-child,
.jp-RenderedHTMLCommon .alert-danger > ul:last-child {
  margin-bottom: 0;
}

.jp-RenderedHTMLCommon blockquote {
  margin: 1em 2em;
  padding: 0 1em;
  border-left: 5px solid var(--jp-border-color2);
}

a.jp-InternalAnchorLink {
  visibility: hidden;
  margin-left: 8px;
  color: var(--md-blue-800);
}

h1:hover .jp-InternalAnchorLink,
h2:hover .jp-InternalAnchorLink,
h3:hover .jp-InternalAnchorLink,
h4:hover .jp-InternalAnchorLink,
h5:hover .jp-InternalAnchorLink,
h6:hover .jp-InternalAnchorLink {
  visibility: visible;
}

.jp-RenderedHTMLCommon kbd {
  background-color: var(--jp-rendermime-table-row-background);
  border: 1px solid var(--jp-border-color0);
  border-bottom-color: var(--jp-border-color2);
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25);
  display: inline-block;
  font-size: var(--jp-ui-font-size0);
  line-height: 1em;
  padding: 0.2em 0.5em;
}

/* Most direct children of .jp-RenderedHTMLCommon have a margin-bottom of 1.0.
 * At the bottom of cells this is a bit too much as there is also spacing
 * between cells. Going all the way to 0 gets too tight between markdown and
 * code cells.
 */
.jp-RenderedHTMLCommon > *:last-child {
  margin-bottom: 0.5em;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Copyright (c) 2014-2017, PhosphorJS Contributors
|
| Distributed under the terms of the BSD 3-Clause License.
|
| The full license is in the file LICENSE, distributed with this software.
|----------------------------------------------------------------------------*/

.lm-cursor-backdrop {
  position: fixed;
  width: 200px;
  height: 200px;
  margin-top: -100px;
  margin-left: -100px;
  will-change: transform;
  z-index: 100;
}

.lm-mod-drag-image {
  will-change: transform;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-lineFormSearch {
  padding: 4px 12px;
  background-color: var(--jp-layout-color2);
  box-shadow: var(--jp-toolbar-box-shadow);
  z-index: 2;
  font-size: var(--jp-ui-font-size1);
}

.jp-lineFormCaption {
  font-size: var(--jp-ui-font-size0);
  line-height: var(--jp-ui-font-size1);
  margin-top: 4px;
  color: var(--jp-ui-font-color0);
}

.jp-baseLineForm {
  border: none;
  border-radius: 0;
  position: absolute;
  background-size: 16px;
  background-repeat: no-repeat;
  background-position: center;
  outline: none;
}

.jp-lineFormButtonContainer {
  top: 4px;
  right: 8px;
  height: 24px;
  padding: 0 12px;
  width: 12px;
}

.jp-lineFormButtonIcon {
  top: 0;
  right: 0;
  background-color: var(--jp-brand-color1);
  height: 100%;
  width: 100%;
  box-sizing: border-box;
  padding: 4px 6px;
}

.jp-lineFormButton {
  top: 0;
  right: 0;
  background-color: transparent;
  height: 100%;
  width: 100%;
  box-sizing: border-box;
}

.jp-lineFormWrapper {
  overflow: hidden;
  padding: 0 8px;
  border: 1px solid var(--jp-border-color0);
  background-color: var(--jp-input-active-background);
  height: 22px;
}

.jp-lineFormWrapperFocusWithin {
  border: var(--jp-border-width) solid var(--md-blue-500);
  box-shadow: inset 0 0 4px var(--md-blue-300);
}

.jp-lineFormInput {
  background: transparent;
  width: 200px;
  height: 100%;
  border: none;
  outline: none;
  color: var(--jp-ui-font-color0);
  line-height: 28px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) 2014-2016, Jupyter Development Team.
|
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-JSONEditor {
  display: flex;
  flex-direction: column;
  width: 100%;
}

.jp-JSONEditor-host {
  flex: 1 1 auto;
  border: var(--jp-border-width) solid var(--jp-input-border-color);
  border-radius: 0;
  background: var(--jp-layout-color0);
  min-height: 50px;
  padding: 1px;
}

.jp-JSONEditor.jp-mod-error .jp-JSONEditor-host {
  border-color: red;
  outline-color: red;
}

.jp-JSONEditor-header {
  display: flex;
  flex: 1 0 auto;
  padding: 0 0 0 12px;
}

.jp-JSONEditor-header label {
  flex: 0 0 auto;
}

.jp-JSONEditor-commitButton {
  height: 16px;
  width: 16px;
  background-size: 18px;
  background-repeat: no-repeat;
  background-position: center;
}

.jp-JSONEditor-host.jp-mod-focused {
  background-color: var(--jp-input-active-background);
  border: 1px solid var(--jp-input-active-border-color);
  box-shadow: var(--jp-input-box-shadow);
}

.jp-Editor.jp-mod-dropTarget {
  border: var(--jp-border-width) solid var(--jp-input-active-border-color);
  box-shadow: var(--jp-input-box-shadow);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/
.jp-DocumentSearch-input {
  border: none;
  outline: none;
  color: var(--jp-ui-font-color0);
  font-size: var(--jp-ui-font-size1);
  background-color: var(--jp-layout-color0);
  font-family: var(--jp-ui-font-family);
  padding: 2px 1px;
  resize: none;
}

.jp-DocumentSearch-overlay {
  position: absolute;
  background-color: var(--jp-toolbar-background);
  border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  border-left: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  top: 0;
  right: 0;
  z-index: 7;
  min-width: 405px;
  padding: 2px;
  font-size: var(--jp-ui-font-size1);

  --jp-private-document-search-button-height: 20px;
}

.jp-DocumentSearch-overlay button {
  background-color: var(--jp-toolbar-background);
  outline: 0;
}

.jp-DocumentSearch-overlay button:hover {
  background-color: var(--jp-layout-color2);
}

.jp-DocumentSearch-overlay button:active {
  background-color: var(--jp-layout-color3);
}

.jp-DocumentSearch-overlay-row {
  display: flex;
  align-items: center;
  margin-bottom: 2px;
}

.jp-DocumentSearch-button-content {
  display: inline-block;
  cursor: pointer;
  box-sizing: border-box;
  width: 100%;
  height: 100%;
}

.jp-DocumentSearch-button-content svg {
  width: 100%;
  height: 100%;
}

.jp-DocumentSearch-input-wrapper {
  border: var(--jp-border-width) solid var(--jp-border-color0);
  display: flex;
  background-color: var(--jp-layout-color0);
  margin: 2px;
}

.jp-DocumentSearch-input-wrapper:focus-within {
  border-color: var(--jp-cell-editor-active-border-color);
}

.jp-DocumentSearch-toggle-wrapper,
.jp-DocumentSearch-button-wrapper {
  all: initial;
  overflow: hidden;
  display: inline-block;
  border: none;
  box-sizing: border-box;
}

.jp-DocumentSearch-toggle-wrapper {
  width: 14px;
  height: 14px;
}

.jp-DocumentSearch-button-wrapper {
  width: var(--jp-private-document-search-button-height);
  height: var(--jp-private-document-search-button-height);
}

.jp-DocumentSearch-toggle-wrapper:focus,
.jp-DocumentSearch-button-wrapper:focus {
  outline: var(--jp-border-width) solid
    var(--jp-cell-editor-active-border-color);
  outline-offset: -1px;
}

.jp-DocumentSearch-toggle-wrapper,
.jp-DocumentSearch-button-wrapper,
.jp-DocumentSearch-button-content:focus {
  outline: none;
}

.jp-DocumentSearch-toggle-placeholder {
  width: 5px;
}

.jp-DocumentSearch-input-button::before {
  display: block;
  padding-top: 100%;
}

.jp-DocumentSearch-input-button-off {
  opacity: var(--jp-search-toggle-off-opacity);
}

.jp-DocumentSearch-input-button-off:hover {
  opacity: var(--jp-search-toggle-hover-opacity);
}

.jp-DocumentSearch-input-button-on {
  opacity: var(--jp-search-toggle-on-opacity);
}

.jp-DocumentSearch-index-counter {
  padding-left: 10px;
  padding-right: 10px;
  user-select: none;
  min-width: 35px;
  display: inline-block;
}

.jp-DocumentSearch-up-down-wrapper {
  display: inline-block;
  padding-right: 2px;
  margin-left: auto;
  white-space: nowrap;
}

.jp-DocumentSearch-spacer {
  margin-left: auto;
}

.jp-DocumentSearch-up-down-wrapper button {
  outline: 0;
  border: none;
  width: var(--jp-private-document-search-button-height);
  height: var(--jp-private-document-search-button-height);
  vertical-align: middle;
  margin: 1px 5px 2px;
}

.jp-DocumentSearch-up-down-button:hover {
  background-color: var(--jp-layout-color2);
}

.jp-DocumentSearch-up-down-button:active {
  background-color: var(--jp-layout-color3);
}

.jp-DocumentSearch-filter-button {
  border-radius: var(--jp-border-radius);
}

.jp-DocumentSearch-filter-button:hover {
  background-color: var(--jp-layout-color2);
}

.jp-DocumentSearch-filter-button-enabled {
  background-color: var(--jp-layout-color2);
}

.jp-DocumentSearch-filter-button-enabled:hover {
  background-color: var(--jp-layout-color3);
}

.jp-DocumentSearch-search-options {
  padding: 0 8px;
  margin-left: 3px;
  width: 100%;
  display: grid;
  justify-content: start;
  grid-template-columns: 1fr 1fr;
  align-items: center;
  justify-items: stretch;
}

.jp-DocumentSearch-search-filter-disabled {
  color: var(--jp-ui-font-color2);
}

.jp-DocumentSearch-search-filter {
  display: flex;
  align-items: center;
  user-select: none;
}

.jp-DocumentSearch-regex-error {
  color: var(--jp-error-color0);
}

.jp-DocumentSearch-replace-button-wrapper {
  overflow: hidden;
  display: inline-block;
  box-sizing: border-box;
  border: var(--jp-border-width) solid var(--jp-border-color0);
  margin: auto 2px;
  padding: 1px 4px;
  height: calc(var(--jp-private-document-search-button-height) + 2px);
}

.jp-DocumentSearch-replace-button-wrapper:focus {
  border: var(--jp-border-width) solid var(--jp-cell-editor-active-border-color);
}

.jp-DocumentSearch-replace-button {
  display: inline-block;
  text-align: center;
  cursor: pointer;
  box-sizing: border-box;
  color: var(--jp-ui-font-color1);

  /* height - 2 * (padding of wrapper) */
  line-height: calc(var(--jp-private-document-search-button-height) - 2px);
  width: 100%;
  height: 100%;
}

.jp-DocumentSearch-replace-button:focus {
  outline: none;
}

.jp-DocumentSearch-replace-wrapper-class {
  margin-left: 14px;
  display: flex;
}

.jp-DocumentSearch-replace-toggle {
  border: none;
  background-color: var(--jp-toolbar-background);
  border-radius: var(--jp-border-radius);
}

.jp-DocumentSearch-replace-toggle:hover {
  background-color: var(--jp-layout-color2);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.cm-editor {
  line-height: var(--jp-code-line-height);
  font-size: var(--jp-code-font-size);
  font-family: var(--jp-code-font-family);
  border: 0;
  border-radius: 0;
  height: auto;

  /* Changed to auto to autogrow */
}

.cm-editor pre {
  padding: 0 var(--jp-code-padding);
}

.jp-CodeMirrorEditor[data-type='inline'] .cm-dialog {
  background-color: var(--jp-layout-color0);
  color: var(--jp-content-font-color1);
}

.jp-CodeMirrorEditor {
  cursor: text;
}

/* When zoomed out 67% and 33% on a screen of 1440 width x 900 height */
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .jp-CodeMirrorEditor[data-type='inline'] .cm-cursor {
    border-left: var(--jp-code-cursor-width1) solid
      var(--jp-editor-cursor-color);
  }
}

/* When zoomed out less than 33% */
@media screen and (min-width: 4320px) {
  .jp-CodeMirrorEditor[data-type='inline'] .cm-cursor {
    border-left: var(--jp-code-cursor-width2) solid
      var(--jp-editor-cursor-color);
  }
}

.cm-editor.jp-mod-readOnly .cm-cursor {
  display: none;
}

.jp-CollaboratorCursor {
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: none;
  border-bottom: 3px solid;
  background-clip: content-box;
  margin-left: -5px;
  margin-right: -5px;
}

.cm-searching,
.cm-searching span {
  /* `.cm-searching span`: we need to override syntax highlighting */
  background-color: var(--jp-search-unselected-match-background-color);
  color: var(--jp-search-unselected-match-color);
}

.cm-searching::selection,
.cm-searching span::selection {
  background-color: var(--jp-search-unselected-match-background-color);
  color: var(--jp-search-unselected-match-color);
}

.jp-current-match > .cm-searching,
.jp-current-match > .cm-searching span,
.cm-searching > .jp-current-match,
.cm-searching > .jp-current-match span {
  background-color: var(--jp-search-selected-match-background-color);
  color: var(--jp-search-selected-match-color);
}

.jp-current-match > .cm-searching::selection,
.cm-searching > .jp-current-match::selection,
.jp-current-match > .cm-searching span::selection {
  background-color: var(--jp-search-selected-match-background-color);
  color: var(--jp-search-selected-match-color);
}

.cm-trailingspace {
  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAYAAAB4ka1VAAAAsElEQVQIHQGlAFr/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7+r3zKmT0/+pk9P/7+r3zAAAAAAAAAAABAAAAAAAAAAA6OPzM+/q9wAAAAAA6OPzMwAAAAAAAAAAAgAAAAAAAAAAGR8NiRQaCgAZIA0AGR8NiQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQyoYJ/SY80UAAAAASUVORK5CYII=);
  background-position: center left;
  background-repeat: repeat-x;
}

.jp-CollaboratorCursor-hover {
  position: absolute;
  z-index: 1;
  transform: translateX(-50%);
  color: white;
  border-radius: 3px;
  padding-left: 4px;
  padding-right: 4px;
  padding-top: 1px;
  padding-bottom: 1px;
  text-align: center;
  font-size: var(--jp-ui-font-size1);
  white-space: nowrap;
}

.jp-CodeMirror-ruler {
  border-left: 1px dashed var(--jp-border-color2);
}

/* Styles for shared cursors (remote cursor locations and selected ranges) */
.jp-CodeMirrorEditor .cm-ySelectionCaret {
  position: relative;
  border-left: 1px solid black;
  margin-left: -1px;
  margin-right: -1px;
  box-sizing: border-box;
}

.jp-CodeMirrorEditor .cm-ySelectionCaret > .cm-ySelectionInfo {
  white-space: nowrap;
  position: absolute;
  top: -1.15em;
  padding-bottom: 0.05em;
  left: -1px;
  font-size: 0.95em;
  font-family: var(--jp-ui-font-family);
  font-weight: bold;
  line-height: normal;
  user-select: none;
  color: white;
  padding-left: 2px;
  padding-right: 2px;
  z-index: 101;
  transition: opacity 0.3s ease-in-out;
}

.jp-CodeMirrorEditor .cm-ySelectionInfo {
  transition-delay: 0.7s;
  opacity: 0;
}

.jp-CodeMirrorEditor .cm-ySelectionCaret:hover > .cm-ySelectionInfo {
  opacity: 1;
  transition-delay: 0s;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-MimeDocument {
  outline: none;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

:root {
  --jp-private-filebrowser-button-height: 28px;
  --jp-private-filebrowser-button-width: 48px;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-FileBrowser .jp-SidePanel-content {
  display: flex;
  flex-direction: column;
}

.jp-FileBrowser-toolbar.jp-Toolbar {
  flex-wrap: wrap;
  row-gap: 12px;
  border-bottom: none;
  height: auto;
  margin: 8px 12px 0;
  box-shadow: none;
  padding: 0;
  justify-content: flex-start;
}

.jp-FileBrowser-Panel {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
}

.jp-BreadCrumbs {
  flex: 0 0 auto;
  margin: 8px 12px;
}

.jp-BreadCrumbs-item {
  margin: 0 2px;
  padding: 0 2px;
  border-radius: var(--jp-border-radius);
  cursor: pointer;
}

.jp-BreadCrumbs-item:hover {
  background-color: var(--jp-layout-color2);
}

.jp-BreadCrumbs-item:first-child {
  margin-left: 0;
}

.jp-BreadCrumbs-item.jp-mod-dropTarget {
  background-color: var(--jp-brand-color2);
  opacity: 0.7;
}

/*-----------------------------------------------------------------------------
| Buttons
|----------------------------------------------------------------------------*/

.jp-FileBrowser-toolbar > .jp-Toolbar-item {
  flex: 0 0 auto;
  padding-left: 0;
  padding-right: 2px;
  align-items: center;
  height: unset;
}

.jp-FileBrowser-toolbar > .jp-Toolbar-item .jp-ToolbarButtonComponent {
  width: 40px;
}

/*-----------------------------------------------------------------------------
| Other styles
|----------------------------------------------------------------------------*/

.jp-FileDialog.jp-mod-conflict input {
  color: var(--jp-error-color1);
}

.jp-FileDialog .jp-new-name-title {
  margin-top: 12px;
}

.jp-LastModified-hidden {
  display: none;
}

.jp-FileSize-hidden {
  display: none;
}

.jp-FileBrowser .lm-AccordionPanel > h3:first-child {
  display: none;
}

/*-----------------------------------------------------------------------------
| DirListing
|----------------------------------------------------------------------------*/

.jp-DirListing {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  outline: 0;
}

.jp-DirListing-header {
  flex: 0 0 auto;
  display: flex;
  flex-direction: row;
  align-items: center;
  overflow: hidden;
  border-top: var(--jp-border-width) solid var(--jp-border-color2);
  border-bottom: var(--jp-border-width) solid var(--jp-border-color1);
  box-shadow: var(--jp-toolbar-box-shadow);
  z-index: 2;
}

.jp-DirListing-headerItem {
  padding: 4px 12px 2px;
  font-weight: 500;
}

.jp-DirListing-headerItem:hover {
  background: var(--jp-layout-color2);
}

.jp-DirListing-headerItem.jp-id-name {
  flex: 1 0 84px;
}

.jp-DirListing-headerItem.jp-id-modified {
  flex: 0 0 112px;
  border-left: var(--jp-border-width) solid var(--jp-border-color2);
  text-align: right;
}

.jp-DirListing-headerItem.jp-id-filesize {
  flex: 0 0 75px;
  border-left: var(--jp-border-width) solid var(--jp-border-color2);
  text-align: right;
}

.jp-id-narrow {
  display: none;
  flex: 0 0 5px;
  padding: 4px;
  border-left: var(--jp-border-width) solid var(--jp-border-color2);
  text-align: right;
  color: var(--jp-border-color2);
}

.jp-DirListing-narrow .jp-id-narrow {
  display: block;
}

.jp-DirListing-narrow .jp-id-modified,
.jp-DirListing-narrow .jp-DirListing-itemModified {
  display: none;
}

.jp-DirListing-headerItem.jp-mod-selected {
  font-weight: 600;
}

/* increase specificity to override bundled default */
.jp-DirListing-content {
  flex: 1 1 auto;
  margin: 0;
  padding: 0;
  list-style-type: none;
  overflow: auto;
  background-color: var(--jp-layout-color1);
}

.jp-DirListing-content mark {
  color: var(--jp-ui-font-color0);
  background-color: transparent;
  font-weight: bold;
}

.jp-DirListing-content .jp-DirListing-item.jp-mod-selected mark {
  color: var(--jp-ui-inverse-font-color0);
}

/* Style the directory listing content when a user drops a file to upload */
.jp-DirListing.jp-mod-native-drop .jp-DirListing-content {
  outline: 5px dashed rgba(128, 128, 128, 0.5);
  outline-offset: -10px;
  cursor: copy;
}

.jp-DirListing-item {
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 4px 12px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.jp-DirListing-checkboxWrapper {
  /* Increases hit area of checkbox. */
  padding: 4px;
}

.jp-DirListing-header
  .jp-DirListing-checkboxWrapper
  + .jp-DirListing-headerItem {
  padding-left: 4px;
}

.jp-DirListing-content .jp-DirListing-checkboxWrapper {
  position: relative;
  left: -4px;
  margin: -4px 0 -4px -8px;
}

.jp-DirListing-checkboxWrapper.jp-mod-visible {
  visibility: visible;
}

/* For devices that support hovering, hide checkboxes until hovered, selected...
*/
@media (hover: hover) {
  .jp-DirListing-checkboxWrapper {
    visibility: hidden;
  }

  .jp-DirListing-item:hover .jp-DirListing-checkboxWrapper,
  .jp-DirListing-item.jp-mod-selected .jp-DirListing-checkboxWrapper {
    visibility: visible;
  }
}

.jp-DirListing-item[data-is-dot] {
  opacity: 75%;
}

.jp-DirListing-item.jp-mod-selected {
  color: var(--jp-ui-inverse-font-color1);
  background: var(--jp-brand-color1);
}

.jp-DirListing-item.jp-mod-dropTarget {
  background: var(--jp-brand-color3);
}

.jp-DirListing-item:hover:not(.jp-mod-selected) {
  background: var(--jp-layout-color2);
}

.jp-DirListing-itemIcon {
  flex: 0 0 20px;
  margin-right: 4px;
}

.jp-DirListing-itemText {
  flex: 1 0 64px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  user-select: none;
}

.jp-DirListing-itemText:focus {
  outline-width: 2px;
  outline-color: var(--jp-inverse-layout-color1);
  outline-style: solid;
  outline-offset: 1px;
}

.jp-DirListing-item.jp-mod-selected .jp-DirListing-itemText:focus {
  outline-color: var(--jp-layout-color1);
}

.jp-DirListing-itemModified {
  flex: 0 0 125px;
  text-align: right;
}

.jp-DirListing-itemFileSize {
  flex: 0 0 90px;
  text-align: right;
}

.jp-DirListing-editor {
  flex: 1 0 64px;
  outline: none;
  border: none;
  color: var(--jp-ui-font-color1);
  background-color: var(--jp-layout-color1);
}

.jp-DirListing-item.jp-mod-running .jp-DirListing-itemIcon::before {
  color: var(--jp-success-color1);
  content: '\25CF';
  font-size: 8px;
  position: absolute;
  left: -8px;
}

.jp-DirListing-item.jp-mod-running.jp-mod-selected
  .jp-DirListing-itemIcon::before {
  color: var(--jp-ui-inverse-font-color1);
}

.jp-DirListing-item.lm-mod-drag-image,
.jp-DirListing-item.jp-mod-selected.lm-mod-drag-image {
  font-size: var(--jp-ui-font-size1);
  padding-left: 4px;
  margin-left: 4px;
  width: 160px;
  background-color: var(--jp-ui-inverse-font-color2);
  box-shadow: var(--jp-elevation-z2);
  border-radius: 0;
  color: var(--jp-ui-font-color1);
  transform: translateX(-40%) translateY(-58%);
}

.jp-Document {
  min-width: 120px;
  min-height: 120px;
  outline: none;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Main OutputArea
| OutputArea has a list of Outputs
|----------------------------------------------------------------------------*/

.jp-OutputArea {
  overflow-y: auto;
}

.jp-OutputArea-child {
  display: table;
  table-layout: fixed;
  width: 100%;
  overflow: hidden;
}

.jp-OutputPrompt {
  width: var(--jp-cell-prompt-width);
  color: var(--jp-cell-outprompt-font-color);
  font-family: var(--jp-cell-prompt-font-family);
  padding: var(--jp-code-padding);
  letter-spacing: var(--jp-cell-prompt-letter-spacing);
  line-height: var(--jp-code-line-height);
  font-size: var(--jp-code-font-size);
  border: var(--jp-border-width) solid transparent;
  opacity: var(--jp-cell-prompt-opacity);

  /* Right align prompt text, don't wrap to handle large prompt numbers */
  text-align: right;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;

  /* Disable text selection */
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.jp-OutputArea-prompt {
  display: table-cell;
  vertical-align: top;
}

.jp-OutputArea-output {
  display: table-cell;
  width: 100%;
  height: auto;
  overflow: auto;
  user-select: text;
  -moz-user-select: text;
  -webkit-user-select: text;
  -ms-user-select: text;
}

.jp-OutputArea .jp-RenderedText {
  padding-left: 1ch;
}

/**
 * Prompt overlay.
 */

.jp-OutputArea-promptOverlay {
  position: absolute;
  top: 0;
  width: var(--jp-cell-prompt-width);
  height: 100%;
  opacity: 0.5;
}

.jp-OutputArea-promptOverlay:hover {
  background: var(--jp-layout-color2);
  box-shadow: inset 0 0 1px var(--jp-inverse-layout-color0);
  cursor: zoom-out;
}

.jp-mod-outputsScrolled .jp-OutputArea-promptOverlay:hover {
  cursor: zoom-in;
}

/**
 * Isolated output.
 */
.jp-OutputArea-output.jp-mod-isolated {
  width: 100%;
  display: block;
}

/*
When drag events occur, `lm-mod-override-cursor` is added to the body.
Because iframes steal all cursor events, the following two rules are necessary
to suppress pointer events while resize drags are occurring. There may be a
better solution to this problem.
*/
body.lm-mod-override-cursor .jp-OutputArea-output.jp-mod-isolated {
  position: relative;
}

body.lm-mod-override-cursor .jp-OutputArea-output.jp-mod-isolated::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: transparent;
}

/* pre */

.jp-OutputArea-output pre {
  border: none;
  margin: 0;
  padding: 0;
  overflow-x: auto;
  overflow-y: auto;
  word-break: break-all;
  word-wrap: break-word;
  white-space: pre-wrap;
}

/* tables */

.jp-OutputArea-output.jp-RenderedHTMLCommon table {
  margin-left: 0;
  margin-right: 0;
}

/* description lists */

.jp-OutputArea-output dl,
.jp-OutputArea-output dt,
.jp-OutputArea-output dd {
  display: block;
}

.jp-OutputArea-output dl {
  width: 100%;
  overflow: hidden;
  padding: 0;
  margin: 0;
}

.jp-OutputArea-output dt {
  font-weight: bold;
  float: left;
  width: 20%;
  padding: 0;
  margin: 0;
}

.jp-OutputArea-output dd {
  float: left;
  width: 80%;
  padding: 0;
  margin: 0;
}

.jp-TrimmedOutputs pre {
  background: var(--jp-layout-color3);
  font-size: calc(var(--jp-code-font-size) * 1.4);
  text-align: center;
  text-transform: uppercase;
}

/* Hide the gutter in case of
 *  - nested output areas (e.g. in the case of output widgets)
 *  - mirrored output areas
 */
.jp-OutputArea .jp-OutputArea .jp-OutputArea-prompt {
  display: none;
}

/* Hide empty lines in the output area, for instance due to cleared widgets */
.jp-OutputArea-prompt:empty {
  padding: 0;
  border: 0;
}

/*-----------------------------------------------------------------------------
| executeResult is added to any Output-result for the display of the object
| returned by a cell
|----------------------------------------------------------------------------*/

.jp-OutputArea-output.jp-OutputArea-executeResult {
  margin-left: 0;
  width: 100%;
}

/* Text output with the Out[] prompt needs a top padding to match the
 * alignment of the Out[] prompt itself.
 */
.jp-OutputArea-executeResult .jp-RenderedText.jp-OutputArea-output {
  padding-top: var(--jp-code-padding);
  border-top: var(--jp-border-width) solid transparent;
}

/*-----------------------------------------------------------------------------
| The Stdin output
|----------------------------------------------------------------------------*/

.jp-Stdin-prompt {
  color: var(--jp-content-font-color0);
  padding-right: var(--jp-code-padding);
  vertical-align: baseline;
  flex: 0 0 auto;
}

.jp-Stdin-input {
  font-family: var(--jp-code-font-family);
  font-size: inherit;
  color: inherit;
  background-color: inherit;
  width: 42%;
  min-width: 200px;

  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;

  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0 0.25em;
  margin: 0 0.25em;
  flex: 0 0 70%;
}

.jp-Stdin-input::placeholder {
  opacity: 0;
}

.jp-Stdin-input:focus {
  box-shadow: none;
}

.jp-Stdin-input:focus::placeholder {
  opacity: 1;
}

/*-----------------------------------------------------------------------------
| Output Area View
|----------------------------------------------------------------------------*/

.jp-LinkedOutputView .jp-OutputArea {
  height: 100%;
  display: block;
}

.jp-LinkedOutputView .jp-OutputArea-output:only-child {
  height: 100%;
}

/*-----------------------------------------------------------------------------
| Printing
|----------------------------------------------------------------------------*/

@media print {
  .jp-OutputArea-child {
    break-inside: avoid-page;
  }
}

/*-----------------------------------------------------------------------------
| Mobile
|----------------------------------------------------------------------------*/
@media only screen and (max-width: 760px) {
  .jp-OutputPrompt {
    display: table-row;
    text-align: left;
  }

  .jp-OutputArea-child .jp-OutputArea-output {
    display: table-row;
    margin-left: var(--jp-notebook-padding);
  }
}

/* Trimmed outputs warning */
.jp-TrimmedOutputs > a {
  margin: 10px;
  text-decoration: none;
  cursor: pointer;
}

.jp-TrimmedOutputs > a:hover {
  text-decoration: none;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Table of Contents
|----------------------------------------------------------------------------*/

:root {
  --jp-private-toc-active-width: 4px;
}

.jp-TableOfContents {
  display: flex;
  flex-direction: column;
  background: var(--jp-layout-color1);
  color: var(--jp-ui-font-color1);
  font-size: var(--jp-ui-font-size1);
  height: 100%;
}

.jp-TableOfContents-placeholder {
  text-align: center;
}

.jp-TableOfContents-placeholderContent {
  color: var(--jp-content-font-color2);
  padding: 8px;
}

.jp-TableOfContents-placeholderContent > h3 {
  margin-bottom: var(--jp-content-heading-margin-bottom);
}

.jp-TableOfContents .jp-SidePanel-content {
  overflow-y: auto;
}

.jp-TableOfContents-tree {
  margin: 4px;
}

.jp-TableOfContents ol {
  list-style-type: none;
}

/* stylelint-disable-next-line selector-max-type */
.jp-TableOfContents li > ol {
  /* Align left border with triangle icon center */
  padding-left: 11px;
}

.jp-TableOfContents-content {
  /* left margin for the active heading indicator */
  margin: 0 0 0 var(--jp-private-toc-active-width);
  padding: 0;
  background-color: var(--jp-layout-color1);
}

.jp-tocItem {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.jp-tocItem-heading {
  display: flex;
  cursor: pointer;
}

.jp-tocItem-heading:hover {
  background-color: var(--jp-layout-color2);
}

.jp-tocItem-content {
  display: block;
  padding: 4px 0;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow-x: hidden;
}

.jp-tocItem-collapser {
  height: 20px;
  margin: 2px 2px 0;
  padding: 0;
  background: none;
  border: none;
  cursor: pointer;
}

.jp-tocItem-collapser:hover {
  background-color: var(--jp-layout-color3);
}

/* Active heading indicator */

.jp-tocItem-heading::before {
  content: ' ';
  background: transparent;
  width: var(--jp-private-toc-active-width);
  height: 24px;
  position: absolute;
  left: 0;
  border-radius: var(--jp-border-radius);
}

.jp-tocItem-heading.jp-tocItem-active::before {
  background-color: var(--jp-brand-color1);
}

.jp-tocItem-heading:hover.jp-tocItem-active::before {
  background: var(--jp-brand-color0);
  opacity: 1;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

.jp-Collapser {
  flex: 0 0 var(--jp-cell-collapser-width);
  padding: 0;
  margin: 0;
  border: none;
  outline: none;
  background: transparent;
  border-radius: var(--jp-border-radius);
  opacity: 1;
}

.jp-Collapser-child {
  display: block;
  width: 100%;
  box-sizing: border-box;

  /* height: 100% doesn't work because the height of its parent is computed from content */
  position: absolute;
  top: 0;
  bottom: 0;
}

/*-----------------------------------------------------------------------------
| Printing
|----------------------------------------------------------------------------*/

/*
Hiding collapsers in print mode.

Note: input and output wrappers have "display: block" propery in print mode.
*/

@media print {
  .jp-Collapser {
    display: none;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Header/Footer
|----------------------------------------------------------------------------*/

/* Hidden by zero height by default */
.jp-CellHeader,
.jp-CellFooter {
  height: 0;
  width: 100%;
  padding: 0;
  margin: 0;
  border: none;
  outline: none;
  background: transparent;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Input
|----------------------------------------------------------------------------*/

/* All input areas */
.jp-InputArea {
  display: table;
  table-layout: fixed;
  width: 100%;
  overflow: hidden;
}

.jp-InputArea-editor {
  display: table-cell;
  overflow: hidden;
  vertical-align: top;

  /* This is the non-active, default styling */
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  border-radius: 0;
  background: var(--jp-cell-editor-background);
}

.jp-InputPrompt {
  display: table-cell;
  vertical-align: top;
  width: var(--jp-cell-prompt-width);
  color: var(--jp-cell-inprompt-font-color);
  font-family: var(--jp-cell-prompt-font-family);
  padding: var(--jp-code-padding);
  letter-spacing: var(--jp-cell-prompt-letter-spacing);
  opacity: var(--jp-cell-prompt-opacity);
  line-height: var(--jp-code-line-height);
  font-size: var(--jp-code-font-size);
  border: var(--jp-border-width) solid transparent;

  /* Right align prompt text, don't wrap to handle large prompt numbers */
  text-align: right;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;

  /* Disable text selection */
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

/*-----------------------------------------------------------------------------
| Mobile
|----------------------------------------------------------------------------*/
@media only screen and (max-width: 760px) {
  .jp-InputArea-editor {
    display: table-row;
    margin-left: var(--jp-notebook-padding);
  }

  .jp-InputPrompt {
    display: table-row;
    text-align: left;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Placeholder
|----------------------------------------------------------------------------*/

.jp-Placeholder {
  display: table;
  table-layout: fixed;
  width: 100%;
}

.jp-Placeholder-prompt {
  display: table-cell;
  box-sizing: border-box;
}

.jp-Placeholder-content {
  display: table-cell;
  padding: 4px 6px;
  border: 1px solid transparent;
  border-radius: 0;
  background: none;
  box-sizing: border-box;
  cursor: pointer;
}

.jp-Placeholder-contentContainer {
  display: flex;
}

.jp-Placeholder-content:hover,
.jp-InputPlaceholder > .jp-Placeholder-content:hover {
  border-color: var(--jp-layout-color3);
}

.jp-Placeholder-content .jp-MoreHorizIcon {
  width: 32px;
  height: 16px;
  border: 1px solid transparent;
  border-radius: var(--jp-border-radius);
}

.jp-Placeholder-content .jp-MoreHorizIcon:hover {
  border: 1px solid var(--jp-border-color1);
  box-shadow: 0 0 2px 0 rgba(0, 0, 0, 0.25);
  background-color: var(--jp-layout-color0);
}

.jp-PlaceholderText {
  white-space: nowrap;
  overflow-x: hidden;
  color: var(--jp-inverse-layout-color3);
  font-family: var(--jp-code-font-family);
}

.jp-InputPlaceholder > .jp-Placeholder-content {
  border-color: var(--jp-cell-editor-border-color);
  background: var(--jp-cell-editor-background);
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Private CSS variables
|----------------------------------------------------------------------------*/

:root {
  --jp-private-cell-scrolling-output-offset: 5px;
}

/*-----------------------------------------------------------------------------
| Cell
|----------------------------------------------------------------------------*/

.jp-Cell {
  padding: var(--jp-cell-padding);
  margin: 0;
  border: none;
  outline: none;
  background: transparent;
}

/*-----------------------------------------------------------------------------
| Common input/output
|----------------------------------------------------------------------------*/

.jp-Cell-inputWrapper,
.jp-Cell-outputWrapper {
  display: flex;
  flex-direction: row;
  padding: 0;
  margin: 0;

  /* Added to reveal the box-shadow on the input and output collapsers. */
  overflow: visible;
}

/* Only input/output areas inside cells */
.jp-Cell-inputArea,
.jp-Cell-outputArea {
  flex: 1 1 auto;
}

/*-----------------------------------------------------------------------------
| Collapser
|----------------------------------------------------------------------------*/

/* Make the output collapser disappear when there is not output, but do so
 * in a manner that leaves it in the layout and preserves its width.
 */
.jp-Cell.jp-mod-noOutputs .jp-Cell-outputCollapser {
  border: none !important;
  background: transparent !important;
}

.jp-Cell:not(.jp-mod-noOutputs) .jp-Cell-outputCollapser {
  min-height: var(--jp-cell-collapser-min-height);
}

/*-----------------------------------------------------------------------------
| Output
|----------------------------------------------------------------------------*/

/* Put a space between input and output when there IS output */
.jp-Cell:not(.jp-mod-noOutputs) .jp-Cell-outputWrapper {
  margin-top: 5px;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-Cell-outputArea {
  overflow-y: auto;
  max-height: 24em;
  margin-left: var(--jp-private-cell-scrolling-output-offset);
  resize: vertical;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-Cell-outputArea[style*='height'] {
  max-height: unset;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-Cell-outputArea::after {
  content: ' ';
  box-shadow: inset 0 0 6px 2px rgb(0 0 0 / 30%);
  width: 100%;
  height: 100%;
  position: sticky;
  bottom: 0;
  top: 0;
  margin-top: -50%;
  float: left;
  display: block;
  pointer-events: none;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-OutputArea-child {
  padding-top: 6px;
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-OutputArea-prompt {
  width: calc(
    var(--jp-cell-prompt-width) - var(--jp-private-cell-scrolling-output-offset)
  );
}

.jp-CodeCell.jp-mod-outputsScrolled .jp-OutputArea-promptOverlay {
  left: calc(-1 * var(--jp-private-cell-scrolling-output-offset));
}

/*-----------------------------------------------------------------------------
| CodeCell
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| MarkdownCell
|----------------------------------------------------------------------------*/

.jp-MarkdownOutput {
  display: table-cell;
  width: 100%;
  margin-top: 0;
  margin-bottom: 0;
  padding-left: var(--jp-code-padding);
}

.jp-MarkdownOutput.jp-RenderedHTMLCommon {
  overflow: auto;
}

/* collapseHeadingButton (show always if hiddenCellsButton is _not_ shown) */
.jp-collapseHeadingButton {
  display: flex;
  min-height: var(--jp-cell-collapser-min-height);
  font-size: var(--jp-code-font-size);
  position: absolute;
  background-color: transparent;
  background-size: 25px;
  background-repeat: no-repeat;
  background-position-x: center;
  background-position-y: top;
  background-image: var(--jp-icon-caret-down);
  right: 0;
  top: 0;
  bottom: 0;
}

.jp-collapseHeadingButton.jp-mod-collapsed {
  background-image: var(--jp-icon-caret-right);
}

/*
 set the container font size to match that of content
 so that the nested collapse buttons have the right size
*/
.jp-MarkdownCell .jp-InputPrompt {
  font-size: var(--jp-content-font-size1);
}

/*
  Align collapseHeadingButton with cell top header
  The font sizes are identical to the ones in packages/rendermime/style/base.css
*/
.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='1'] {
  font-size: var(--jp-content-font-size5);
  background-position-y: calc(0.3 * var(--jp-content-font-size5));
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='2'] {
  font-size: var(--jp-content-font-size4);
  background-position-y: calc(0.3 * var(--jp-content-font-size4));
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='3'] {
  font-size: var(--jp-content-font-size3);
  background-position-y: calc(0.3 * var(--jp-content-font-size3));
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='4'] {
  font-size: var(--jp-content-font-size2);
  background-position-y: calc(0.3 * var(--jp-content-font-size2));
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='5'] {
  font-size: var(--jp-content-font-size1);
  background-position-y: top;
}

.jp-mod-rendered .jp-collapseHeadingButton[data-heading-level='6'] {
  font-size: var(--jp-content-font-size0);
  background-position-y: top;
}

/* collapseHeadingButton (show only on (hover,active) if hiddenCellsButton is shown) */
.jp-Notebook.jp-mod-showHiddenCellsButton .jp-collapseHeadingButton {
  display: none;
}

.jp-Notebook.jp-mod-showHiddenCellsButton
  :is(.jp-MarkdownCell:hover, .jp-mod-active)
  .jp-collapseHeadingButton {
  display: flex;
}

/* showHiddenCellsButton (only show if jp-mod-showHiddenCellsButton is set, which
is a consequence of the showHiddenCellsButton option in Notebook Settings)*/
.jp-Notebook.jp-mod-showHiddenCellsButton .jp-showHiddenCellsButton {
  margin-left: calc(var(--jp-cell-prompt-width) + 2 * var(--jp-code-padding));
  margin-top: var(--jp-code-padding);
  border: 1px solid var(--jp-border-color2);
  background-color: var(--jp-border-color3) !important;
  color: var(--jp-content-font-color0) !important;
  display: flex;
}

.jp-Notebook.jp-mod-showHiddenCellsButton .jp-showHiddenCellsButton:hover {
  background-color: var(--jp-border-color2) !important;
}

.jp-showHiddenCellsButton {
  display: none;
}

/*-----------------------------------------------------------------------------
| Printing
|----------------------------------------------------------------------------*/

/*
Using block instead of flex to allow the use of the break-inside CSS property for
cell outputs.
*/

@media print {
  .jp-Cell-inputWrapper,
  .jp-Cell-outputWrapper {
    display: block;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

:root {
  --jp-notebook-toolbar-padding: 2px 5px 2px 2px;
}

/*-----------------------------------------------------------------------------

/*-----------------------------------------------------------------------------
| Styles
|----------------------------------------------------------------------------*/

.jp-NotebookPanel-toolbar {
  padding: var(--jp-notebook-toolbar-padding);

  /* disable paint containment from lumino 2.0 default strict CSS containment */
  contain: style size !important;
}

.jp-Toolbar-item.jp-Notebook-toolbarCellType .jp-select-wrapper.jp-mod-focused {
  border: none;
  box-shadow: none;
}

.jp-Notebook-toolbarCellTypeDropdown select {
  height: 24px;
  font-size: var(--jp-ui-font-size1);
  line-height: 14px;
  border-radius: 0;
  display: block;
}

.jp-Notebook-toolbarCellTypeDropdown span {
  top: 5px !important;
}

.jp-Toolbar-responsive-popup {
  position: absolute;
  height: fit-content;
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  justify-content: flex-end;
  border-bottom: var(--jp-border-width) solid var(--jp-toolbar-border-color);
  box-shadow: var(--jp-toolbar-box-shadow);
  background: var(--jp-toolbar-background);
  min-height: var(--jp-toolbar-micro-height);
  padding: var(--jp-notebook-toolbar-padding);
  z-index: 1;
  right: 0;
  top: 0;
}

.jp-Toolbar > .jp-Toolbar-responsive-opener {
  margin-left: auto;
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Variables
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------

/*-----------------------------------------------------------------------------
| Styles
|----------------------------------------------------------------------------*/

.jp-Notebook-ExecutionIndicator {
  position: relative;
  display: inline-block;
  height: 100%;
  z-index: 9997;
}

.jp-Notebook-ExecutionIndicator-tooltip {
  visibility: hidden;
  height: auto;
  width: max-content;
  width: -moz-max-content;
  background-color: var(--jp-layout-color2);
  color: var(--jp-ui-font-color1);
  text-align: justify;
  border-radius: 6px;
  padding: 0 5px;
  position: fixed;
  display: table;
}

.jp-Notebook-ExecutionIndicator-tooltip.up {
  transform: translateX(-50%) translateY(-100%) translateY(-32px);
}

.jp-Notebook-ExecutionIndicator-tooltip.down {
  transform: translateX(calc(-100% + 16px)) translateY(5px);
}

.jp-Notebook-ExecutionIndicator-tooltip.hidden {
  display: none;
}

.jp-Notebook-ExecutionIndicator:hover .jp-Notebook-ExecutionIndicator-tooltip {
  visibility: visible;
}

.jp-Notebook-ExecutionIndicator span {
  font-size: var(--jp-ui-font-size1);
  font-family: var(--jp-ui-font-family);
  color: var(--jp-ui-font-color1);
  line-height: 24px;
  display: block;
}

.jp-Notebook-ExecutionIndicator-progress-bar {
  display: flex;
  justify-content: center;
  height: 100%;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

/*
 * Execution indicator
 */
.jp-tocItem-content::after {
  content: '';

  /* Must be identical to form a circle */
  width: 12px;
  height: 12px;
  background: none;
  border: none;
  position: absolute;
  right: 0;
}

.jp-tocItem-content[data-running='0']::after {
  border-radius: 50%;
  border: var(--jp-border-width) solid var(--jp-inverse-layout-color3);
  background: none;
}

.jp-tocItem-content[data-running='1']::after {
  border-radius: 50%;
  border: var(--jp-border-width) solid var(--jp-inverse-layout-color3);
  background-color: var(--jp-inverse-layout-color3);
}

.jp-tocItem-content[data-running='0'],
.jp-tocItem-content[data-running='1'] {
  margin-right: 12px;
}

/*
 * Copyright (c) Jupyter Development Team.
 * Distributed under the terms of the Modified BSD License.
 */

.jp-Notebook-footer {
  height: 27px;
  margin-left: calc(
    var(--jp-cell-prompt-width) + var(--jp-cell-collapser-width) +
      var(--jp-cell-padding)
  );
  width: calc(
    100% -
      (
        var(--jp-cell-prompt-width) + var(--jp-cell-collapser-width) +
          var(--jp-cell-padding) + var(--jp-cell-padding)
      )
  );
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  color: var(--jp-ui-font-color3);
  margin-top: 6px;
  background: none;
  cursor: pointer;
}

.jp-Notebook-footer:focus {
  border-color: var(--jp-cell-editor-active-border-color);
}

/* For devices that support hovering, hide footer until hover */
@media (hover: hover) {
  .jp-Notebook-footer {
    opacity: 0;
  }

  .jp-Notebook-footer:focus,
  .jp-Notebook-footer:hover {
    opacity: 1;
  }
}

/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| Imports
|----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
| CSS variables
|----------------------------------------------------------------------------*/

:root {
  --jp-side-by-side-output-size: 1fr;
  --jp-side-by-side-resized-cell: var(--jp-side-by-side-output-size);
  --jp-private-notebook-dragImage-width: 304px;
  --jp-private-notebook-dragImage-height: 36px;
  --jp-private-notebook-selected-color: var(--md-blue-400);
  --jp-private-notebook-active-color: var(--md-green-400);
}

/*-----------------------------------------------------------------------------
| Notebook
|----------------------------------------------------------------------------*/

/* stylelint-disable selector-max-class */

.jp-NotebookPanel {
  display: block;
  height: 100%;
}

.jp-NotebookPanel.jp-Document {
  min-width: 240px;
  min-height: 120px;
}

.jp-Notebook {
  padding: var(--jp-notebook-padding);
  outline: none;
  overflow: auto;
  background: var(--jp-layout-color0);
}

.jp-Notebook.jp-mod-scrollPastEnd::after {
  display: block;
  content: '';
  min-height: var(--jp-notebook-scroll-padding);
}

.jp-MainAreaWidget-ContainStrict .jp-Notebook * {
  contain: strict;
}

.jp-Notebook .jp-Cell {
  overflow: visible;
}

.jp-Notebook .jp-Cell .jp-InputPrompt {
  cursor: move;
}

/*-----------------------------------------------------------------------------
| Notebook state related styling
|
| The notebook and cells each have states, here are the possibilities:
|
| - Notebook
|   - Command
|   - Edit
| - Cell
|   - None
|   - Active (only one can be active)
|   - Selected (the cells actions are applied to)
|   - Multiselected (when multiple selected, the cursor)
|   - No outputs
|----------------------------------------------------------------------------*/

/* Command or edit modes */

.jp-Notebook .jp-Cell:not(.jp-mod-active) .jp-InputPrompt {
  opacity: var(--jp-cell-prompt-not-active-opacity);
  color: var(--jp-cell-prompt-not-active-font-color);
}

.jp-Notebook .jp-Cell:not(.jp-mod-active) .jp-OutputPrompt {
  opacity: var(--jp-cell-prompt-not-active-opacity);
  color: var(--jp-cell-prompt-not-active-font-color);
}

/* cell is active */
.jp-Notebook .jp-Cell.jp-mod-active .jp-Collapser {
  background: var(--jp-brand-color1);
}

/* cell is dirty */
.jp-Notebook .jp-Cell.jp-mod-dirty .jp-InputPrompt {
  color: var(--jp-warn-color1);
}

.jp-Notebook .jp-Cell.jp-mod-dirty .jp-InputPrompt::before {
  color: var(--jp-warn-color1);
  content: '';
}

.jp-Notebook .jp-Cell.jp-mod-active.jp-mod-dirty .jp-Collapser {
  background: var(--jp-warn-color1);
}

/* collapser is hovered */
.jp-Notebook .jp-Cell .jp-Collapser:hover {
  box-shadow: var(--jp-elevation-z2);
  background: var(--jp-brand-color1);
  opacity: var(--jp-cell-collapser-not-active-hover-opacity);
}

/* cell is active and collapser is hovered */
.jp-Notebook .jp-Cell.jp-mod-active .jp-Collapser:hover {
  background: var(--jp-brand-color0);
  opacity: 1;
}

/* Command mode */

.jp-Notebook.jp-mod-commandMode .jp-Cell.jp-mod-selected {
  background: var(--jp-notebook-multiselected-color);
}

.jp-Notebook.jp-mod-commandMode
  .jp-Cell.jp-mod-active.jp-mod-selected:not(.jp-mod-multiSelected) {
  background: transparent;
}

/* Edit mode */

.jp-Notebook.jp-mod-editMode .jp-Cell.jp-mod-active .jp-InputArea-editor {
  border: var(--jp-border-width) solid var(--jp-cell-editor-active-border-color);
  box-shadow: var(--jp-input-box-shadow);
  background-color: var(--jp-cell-editor-active-background);
}

/*-----------------------------------------------------------------------------
| Notebook drag and drop
|----------------------------------------------------------------------------*/

.jp-Notebook-cell.jp-mod-dropSource {
  opacity: 0.5;
}

.jp-Notebook-cell.jp-mod-dropTarget,
.jp-Notebook.jp-mod-commandMode
  .jp-Notebook-cell.jp-mod-active.jp-mod-selected.jp-mod-dropTarget {
  border-top-color: var(--jp-private-notebook-selected-color);
  border-top-style: solid;
  border-top-width: 2px;
}

.jp-dragImage {
  display: block;
  flex-direction: row;
  width: var(--jp-private-notebook-dragImage-width);
  height: var(--jp-private-notebook-dragImage-height);
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  background: var(--jp-cell-editor-background);
  overflow: visible;
}

.jp-dragImage-singlePrompt {
  box-shadow: 2px 2px 4px 0 rgba(0, 0, 0, 0.12);
}

.jp-dragImage .jp-dragImage-content {
  flex: 1 1 auto;
  z-index: 2;
  font-size: var(--jp-code-font-size);
  font-family: var(--jp-code-font-family);
  line-height: var(--jp-code-line-height);
  padding: var(--jp-code-padding);
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  background: var(--jp-cell-editor-background-color);
  color: var(--jp-content-font-color3);
  text-align: left;
  margin: 4px 4px 4px 0;
}

.jp-dragImage .jp-dragImage-prompt {
  flex: 0 0 auto;
  min-width: 36px;
  color: var(--jp-cell-inprompt-font-color);
  padding: var(--jp-code-padding);
  padding-left: 12px;
  font-family: var(--jp-cell-prompt-font-family);
  letter-spacing: var(--jp-cell-prompt-letter-spacing);
  line-height: 1.9;
  font-size: var(--jp-code-font-size);
  border: var(--jp-border-width) solid transparent;
}

.jp-dragImage-multipleBack {
  z-index: -1;
  position: absolute;
  height: 32px;
  width: 300px;
  top: 8px;
  left: 8px;
  background: var(--jp-layout-color2);
  border: var(--jp-border-width) solid var(--jp-input-border-color);
  box-shadow: 2px 2px 4px 0 rgba(0, 0, 0, 0.12);
}

/*-----------------------------------------------------------------------------
| Cell toolbar
|----------------------------------------------------------------------------*/

.jp-NotebookTools {
  display: block;
  min-width: var(--jp-sidebar-min-width);
  color: var(--jp-ui-font-color1);
  background: var(--jp-layout-color1);

  /* This is needed so that all font sizing of children done in ems is
    * relative to this base size */
  font-size: var(--jp-ui-font-size1);
  overflow: auto;
}

.jp-ActiveCellTool {
  padding: 12px 0;
  display: flex;
}

.jp-ActiveCellTool-Content {
  flex: 1 1 auto;
}

.jp-ActiveCellTool .jp-ActiveCellTool-CellContent {
  background: var(--jp-cell-editor-background);
  border: var(--jp-border-width) solid var(--jp-cell-editor-border-color);
  border-radius: 0;
  min-height: 29px;
}

.jp-ActiveCellTool .jp-InputPrompt {
  min-width: calc(var(--jp-cell-prompt-width) * 0.75);
}

.jp-ActiveCellTool-CellContent > pre {
  padding: 5px 4px;
  margin: 0;
  white-space: normal;
}

.jp-MetadataEditorTool {
  flex-direction: column;
  padding: 12px 0;
}

.jp-RankedPanel > :not(:first-child) {
  margin-top: 12px;
}

.jp-KeySelector select.jp-mod-styled {
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color0);
  border: var(--jp-border-width) solid var(--jp-border-color1);
}

.jp-KeySelector label,
.jp-MetadataEditorTool label,
.jp-NumberSetter label {
  line-height: 1.4;
}

.jp-NotebookTools .jp-select-wrapper {
  margin-top: 4px;
  margin-bottom: 0;
}

.jp-NumberSetter input {
  width: 100%;
  margin-top: 4px;
}

.jp-NotebookTools .jp-Collapse {
  margin-top: 16px;
}

/*-----------------------------------------------------------------------------
| Presentation Mode (.jp-mod-presentationMode)
|----------------------------------------------------------------------------*/

.jp-mod-presentationMode .jp-Notebook {
  --jp-content-font-size1: var(--jp-content-presentation-font-size1);
  --jp-code-font-size: var(--jp-code-presentation-font-size);
}

.jp-mod-presentationMode .jp-Notebook .jp-Cell .jp-InputPrompt,
.jp-mod-presentationMode .jp-Notebook .jp-Cell .jp-OutputPrompt {
  flex: 0 0 110px;
}

/*-----------------------------------------------------------------------------
| Side-by-side Mode (.jp-mod-sideBySide)
|----------------------------------------------------------------------------*/
.jp-mod-sideBySide.jp-Notebook .jp-Notebook-cell {
  margin-top: 3em;
  margin-bottom: 3em;
  margin-left: 5%;
  margin-right: 5%;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell {
  display: grid;
  grid-template-columns: minmax(0, 1fr) min-content minmax(
      0,
      var(--jp-side-by-side-output-size)
    );
  grid-template-rows: auto minmax(0, 1fr) auto;
  grid-template-areas:
    'header header header'
    'input handle output'
    'footer footer footer';
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell.jp-mod-resizedCell {
  grid-template-columns: minmax(0, 1fr) min-content minmax(
      0,
      var(--jp-side-by-side-resized-cell)
    );
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellHeader {
  grid-area: header;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-Cell-inputWrapper {
  grid-area: input;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-Cell-outputWrapper {
  /* overwrite the default margin (no vertical separation needed in side by side move */
  margin-top: 0;
  grid-area: output;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellFooter {
  grid-area: footer;
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellResizeHandle {
  grid-area: handle;
  user-select: none;
  display: block;
  height: 100%;
  cursor: ew-resize;
  padding: 0 var(--jp-cell-padding);
}

.jp-mod-sideBySide.jp-Notebook .jp-CodeCell .jp-CellResizeHandle::after {
  content: '';
  display: block;
  background: var(--jp-border-color2);
  height: 100%;
  width: 5px;
}

.jp-mod-sideBySide.jp-Notebook
  .jp-CodeCell.jp-mod-resizedCell
  .jp-CellResizeHandle::after {
  background: var(--jp-border-color0);
}

.jp-CellResizeHandle {
  display: none;
}

/*-----------------------------------------------------------------------------
| Placeholder
|----------------------------------------------------------------------------*/

.jp-Cell-Placeholder {
  padding-left: 55px;
}

.jp-Cell-Placeholder-wrapper {
  background: #fff;
  border: 1px solid;
  border-color: #e5e6e9 #dfe0e4 #d0d1d5;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  margin: 10px 15px;
}

.jp-Cell-Placeholder-wrapper-inner {
  padding: 15px;
  position: relative;
}

.jp-Cell-Placeholder-wrapper-body {
  background-repeat: repeat;
  background-size: 50% auto;
}

.jp-Cell-Placeholder-wrapper-body div {
  background: #f6f7f8;
  background-image: -webkit-linear-gradient(
    left,
    #f6f7f8 0%,
    #edeef1 20%,
    #f6f7f8 40%,
    #f6f7f8 100%
  );
  background-repeat: no-repeat;
  background-size: 800px 104px;
  height: 104px;
  position: absolute;
  right: 15px;
  left: 15px;
  top: 15px;
}

div.jp-Cell-Placeholder-h1 {
  top: 20px;
  height: 20px;
  left: 15px;
  width: 150px;
}

div.jp-Cell-Placeholder-h2 {
  left: 15px;
  top: 50px;
  height: 10px;
  width: 100px;
}

div.jp-Cell-Placeholder-content-1,
div.jp-Cell-Placeholder-content-2,
div.jp-Cell-Placeholder-content-3 {
  left: 15px;
  right: 15px;
  height: 10px;
}

div.jp-Cell-Placeholder-content-1 {
  top: 100px;
}

div.jp-Cell-Placeholder-content-2 {
  top: 120px;
}

div.jp-Cell-Placeholder-content-3 {
  top: 140px;
}

</style>
<style type="text/css">
/*-----------------------------------------------------------------------------
| Copyright (c) Jupyter Development Team.
| Distributed under the terms of the Modified BSD License.
|----------------------------------------------------------------------------*/

/*
The following CSS variables define the main, public API for styling JupyterLab.
These variables should be used by all plugins wherever possible. In other
words, plugins should not define custom colors, sizes, etc unless absolutely
necessary. This enables users to change the visual theme of JupyterLab
by changing these variables.

Many variables appear in an ordered sequence (0,1,2,3). These sequences
are designed to work well together, so for example, `--jp-border-color1` should
be used with `--jp-layout-color1`. The numbers have the following meanings:

* 0: super-primary, reserved for special emphasis
* 1: primary, most important under normal situations
* 2: secondary, next most important under normal situations
* 3: tertiary, next most important under normal situations

Throughout JupyterLab, we are mostly following principles from Google's
Material Design when selecting colors. We are not, however, following
all of MD as it is not optimized for dense, information rich UIs.
*/

:root {
  /* Elevation
   *
   * We style box-shadows using Material Design's idea of elevation. These particular numbers are taken from here:
   *
   * https://github.com/material-components/material-components-web
   * https://material-components-web.appspot.com/elevation.html
   */

  --jp-shadow-base-lightness: 0;
  --jp-shadow-umbra-color: rgba(
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    0.2
  );
  --jp-shadow-penumbra-color: rgba(
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    0.14
  );
  --jp-shadow-ambient-color: rgba(
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    var(--jp-shadow-base-lightness),
    0.12
  );
  --jp-elevation-z0: none;
  --jp-elevation-z1: 0 2px 1px -1px var(--jp-shadow-umbra-color),
    0 1px 1px 0 var(--jp-shadow-penumbra-color),
    0 1px 3px 0 var(--jp-shadow-ambient-color);
  --jp-elevation-z2: 0 3px 1px -2px var(--jp-shadow-umbra-color),
    0 2px 2px 0 var(--jp-shadow-penumbra-color),
    0 1px 5px 0 var(--jp-shadow-ambient-color);
  --jp-elevation-z4: 0 2px 4px -1px var(--jp-shadow-umbra-color),
    0 4px 5px 0 var(--jp-shadow-penumbra-color),
    0 1px 10px 0 var(--jp-shadow-ambient-color);
  --jp-elevation-z6: 0 3px 5px -1px var(--jp-shadow-umbra-color),
    0 6px 10px 0 var(--jp-shadow-penumbra-color),
    0 1px 18px 0 var(--jp-shadow-ambient-color);
  --jp-elevation-z8: 0 5px 5px -3px var(--jp-shadow-umbra-color),
    0 8px 10px 1px var(--jp-shadow-penumbra-color),
    0 3px 14px 2px var(--jp-shadow-ambient-color);
  --jp-elevation-z12: 0 7px 8px -4px var(--jp-shadow-umbra-color),
    0 12px 17px 2px var(--jp-shadow-penumbra-color),
    0 5px 22px 4px var(--jp-shadow-ambient-color);
  --jp-elevation-z16: 0 8px 10px -5px var(--jp-shadow-umbra-color),
    0 16px 24px 2px var(--jp-shadow-penumbra-color),
    0 6px 30px 5px var(--jp-shadow-ambient-color);
  --jp-elevation-z20: 0 10px 13px -6px var(--jp-shadow-umbra-color),
    0 20px 31px 3px var(--jp-shadow-penumbra-color),
    0 8px 38px 7px var(--jp-shadow-ambient-color);
  --jp-elevation-z24: 0 11px 15px -7px var(--jp-shadow-umbra-color),
    0 24px 38px 3px var(--jp-shadow-penumbra-color),
    0 9px 46px 8px var(--jp-shadow-ambient-color);

  /* Borders
   *
   * The following variables, specify the visual styling of borders in JupyterLab.
   */

  --jp-border-width: 1px;
  --jp-border-color0: var(--md-grey-400);
  --jp-border-color1: var(--md-grey-400);
  --jp-border-color2: var(--md-grey-300);
  --jp-border-color3: var(--md-grey-200);
  --jp-inverse-border-color: var(--md-grey-600);
  --jp-border-radius: 2px;

  /* UI Fonts
   *
   * The UI font CSS variables are used for the typography all of the JupyterLab
   * user interface elements that are not directly user generated content.
   *
   * The font sizing here is done assuming that the body font size of --jp-ui-font-size1
   * is applied to a parent element. When children elements, such as headings, are sized
   * in em all things will be computed relative to that body size.
   */

  --jp-ui-font-scale-factor: 1.2;
  --jp-ui-font-size0: 0.83333em;
  --jp-ui-font-size1: 13px; /* Base font size */
  --jp-ui-font-size2: 1.2em;
  --jp-ui-font-size3: 1.44em;
  --jp-ui-font-family: system-ui, -apple-system, blinkmacsystemfont, 'Segoe UI',
    helvetica, arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji',
    'Segoe UI Symbol';

  /*
   * Use these font colors against the corresponding main layout colors.
   * In a light theme, these go from dark to light.
   */

  /* Defaults use Material Design specification */
  --jp-ui-font-color0: rgba(0, 0, 0, 1);
  --jp-ui-font-color1: rgba(0, 0, 0, 0.87);
  --jp-ui-font-color2: rgba(0, 0, 0, 0.54);
  --jp-ui-font-color3: rgba(0, 0, 0, 0.38);

  /*
   * Use these against the brand/accent/warn/error colors.
   * These will typically go from light to darker, in both a dark and light theme.
   */

  --jp-ui-inverse-font-color0: rgba(255, 255, 255, 1);
  --jp-ui-inverse-font-color1: rgba(255, 255, 255, 1);
  --jp-ui-inverse-font-color2: rgba(255, 255, 255, 0.7);
  --jp-ui-inverse-font-color3: rgba(255, 255, 255, 0.5);

  /* Content Fonts
   *
   * Content font variables are used for typography of user generated content.
   *
   * The font sizing here is done assuming that the body font size of --jp-content-font-size1
   * is applied to a parent element. When children elements, such as headings, are sized
   * in em all things will be computed relative to that body size.
   */

  --jp-content-line-height: 1.6;
  --jp-content-font-scale-factor: 1.2;
  --jp-content-font-size0: 0.83333em;
  --jp-content-font-size1: 14px; /* Base font size */
  --jp-content-font-size2: 1.2em;
  --jp-content-font-size3: 1.44em;
  --jp-content-font-size4: 1.728em;
  --jp-content-font-size5: 2.0736em;

  /* This gives a magnification of about 125% in presentation mode over normal. */
  --jp-content-presentation-font-size1: 17px;
  --jp-content-heading-line-height: 1;
  --jp-content-heading-margin-top: 1.2em;
  --jp-content-heading-margin-bottom: 0.8em;
  --jp-content-heading-font-weight: 500;

  /* Defaults use Material Design specification */
  --jp-content-font-color0: rgba(0, 0, 0, 1);
  --jp-content-font-color1: rgba(0, 0, 0, 0.87);
  --jp-content-font-color2: rgba(0, 0, 0, 0.54);
  --jp-content-font-color3: rgba(0, 0, 0, 0.38);
  --jp-content-link-color: var(--md-blue-900);
  --jp-content-font-family: system-ui, -apple-system, blinkmacsystemfont,
    'Segoe UI', helvetica, arial, sans-serif, 'Apple Color Emoji',
    'Segoe UI Emoji', 'Segoe UI Symbol';

  /*
   * Code Fonts
   *
   * Code font variables are used for typography of code and other monospaces content.
   */

  --jp-code-font-size: 13px;
  --jp-code-line-height: 1.3077; /* 17px for 13px base */
  --jp-code-padding: 5px; /* 5px for 13px base, codemirror highlighting needs integer px value */
  --jp-code-font-family-default: menlo, consolas, 'DejaVu Sans Mono', monospace;
  --jp-code-font-family: var(--jp-code-font-family-default);

  /* This gives a magnification of about 125% in presentation mode over normal. */
  --jp-code-presentation-font-size: 16px;

  /* may need to tweak cursor width if you change font size */
  --jp-code-cursor-width0: 1.4px;
  --jp-code-cursor-width1: 2px;
  --jp-code-cursor-width2: 4px;

  /* Layout
   *
   * The following are the main layout colors use in JupyterLab. In a light
   * theme these would go from light to dark.
   */

  --jp-layout-color0: white;
  --jp-layout-color1: white;
  --jp-layout-color2: var(--md-grey-200);
  --jp-layout-color3: var(--md-grey-400);
  --jp-layout-color4: var(--md-grey-600);

  /* Inverse Layout
   *
   * The following are the inverse layout colors use in JupyterLab. In a light
   * theme these would go from dark to light.
   */

  --jp-inverse-layout-color0: #111;
  --jp-inverse-layout-color1: var(--md-grey-900);
  --jp-inverse-layout-color2: var(--md-grey-800);
  --jp-inverse-layout-color3: var(--md-grey-700);
  --jp-inverse-layout-color4: var(--md-grey-600);

  /* Brand/accent */

  --jp-brand-color0: var(--md-blue-900);
  --jp-brand-color1: var(--md-blue-700);
  --jp-brand-color2: var(--md-blue-300);
  --jp-brand-color3: var(--md-blue-100);
  --jp-brand-color4: var(--md-blue-50);
  --jp-accent-color0: var(--md-green-900);
  --jp-accent-color1: var(--md-green-700);
  --jp-accent-color2: var(--md-green-300);
  --jp-accent-color3: var(--md-green-100);

  /* State colors (warn, error, success, info) */

  --jp-warn-color0: var(--md-orange-900);
  --jp-warn-color1: var(--md-orange-700);
  --jp-warn-color2: var(--md-orange-300);
  --jp-warn-color3: var(--md-orange-100);
  --jp-error-color0: var(--md-red-900);
  --jp-error-color1: var(--md-red-700);
  --jp-error-color2: var(--md-red-300);
  --jp-error-color3: var(--md-red-100);
  --jp-success-color0: var(--md-green-900);
  --jp-success-color1: var(--md-green-700);
  --jp-success-color2: var(--md-green-300);
  --jp-success-color3: var(--md-green-100);
  --jp-info-color0: var(--md-cyan-900);
  --jp-info-color1: var(--md-cyan-700);
  --jp-info-color2: var(--md-cyan-300);
  --jp-info-color3: var(--md-cyan-100);

  /* Cell specific styles */

  --jp-cell-padding: 5px;
  --jp-cell-collapser-width: 8px;
  --jp-cell-collapser-min-height: 20px;
  --jp-cell-collapser-not-active-hover-opacity: 0.6;
  --jp-cell-editor-background: var(--md-grey-100);
  --jp-cell-editor-border-color: var(--md-grey-300);
  --jp-cell-editor-box-shadow: inset 0 0 2px var(--md-blue-300);
  --jp-cell-editor-active-background: var(--jp-layout-color0);
  --jp-cell-editor-active-border-color: var(--jp-brand-color1);
  --jp-cell-prompt-width: 64px;
  --jp-cell-prompt-font-family: var(--jp-code-font-family-default);
  --jp-cell-prompt-letter-spacing: 0;
  --jp-cell-prompt-opacity: 1;
  --jp-cell-prompt-not-active-opacity: 0.5;
  --jp-cell-prompt-not-active-font-color: var(--md-grey-700);

  /* A custom blend of MD grey and blue 600
   * See https://meyerweb.com/eric/tools/color-blend/#546E7A:1E88E5:5:hex */
  --jp-cell-inprompt-font-color: #307fc1;

  /* A custom blend of MD grey and orange 600
   * https://meyerweb.com/eric/tools/color-blend/#546E7A:F4511E:5:hex */
  --jp-cell-outprompt-font-color: #bf5b3d;

  /* Notebook specific styles */

  --jp-notebook-padding: 10px;
  --jp-notebook-select-background: var(--jp-layout-color1);
  --jp-notebook-multiselected-color: var(--md-blue-50);

  /* The scroll padding is calculated to fill enough space at the bottom of the
  notebook to show one single-line cell (with appropriate padding) at the top
  when the notebook is scrolled all the way to the bottom. We also subtract one
  pixel so that no scrollbar appears if we have just one single-line cell in the
  notebook. This padding is to enable a 'scroll past end' feature in a notebook.
  */
  --jp-notebook-scroll-padding: calc(
    100% - var(--jp-code-font-size) * var(--jp-code-line-height) -
      var(--jp-code-padding) - var(--jp-cell-padding) - 1px
  );

  /* Rendermime styles */

  --jp-rendermime-error-background: #fdd;
  --jp-rendermime-table-row-background: var(--md-grey-100);
  --jp-rendermime-table-row-hover-background: var(--md-light-blue-50);

  /* Dialog specific styles */

  --jp-dialog-background: rgba(0, 0, 0, 0.25);

  /* Console specific styles */

  --jp-console-padding: 10px;

  /* Toolbar specific styles */

  --jp-toolbar-border-color: var(--jp-border-color1);
  --jp-toolbar-micro-height: 8px;
  --jp-toolbar-background: var(--jp-layout-color1);
  --jp-toolbar-box-shadow: 0 0 2px 0 rgba(0, 0, 0, 0.24);
  --jp-toolbar-header-margin: 4px 4px 0 4px;
  --jp-toolbar-active-background: var(--md-grey-300);

  /* Statusbar specific styles */

  --jp-statusbar-height: 24px;

  /* Input field styles */

  --jp-input-box-shadow: inset 0 0 2px var(--md-blue-300);
  --jp-input-active-background: var(--jp-layout-color1);
  --jp-input-hover-background: var(--jp-layout-color1);
  --jp-input-background: var(--md-grey-100);
  --jp-input-border-color: var(--jp-inverse-border-color);
  --jp-input-active-border-color: var(--jp-brand-color1);
  --jp-input-active-box-shadow-color: rgba(19, 124, 189, 0.3);

  /* General editor styles */

  --jp-editor-selected-background: #d9d9d9;
  --jp-editor-selected-focused-background: #d7d4f0;
  --jp-editor-cursor-color: var(--jp-ui-font-color0);

  /* Code mirror specific styles */

  --jp-mirror-editor-keyword-color: #008000;
  --jp-mirror-editor-atom-color: #88f;
  --jp-mirror-editor-number-color: #080;
  --jp-mirror-editor-def-color: #00f;
  --jp-mirror-editor-variable-color: var(--md-grey-900);
  --jp-mirror-editor-variable-2-color: rgb(0, 54, 109);
  --jp-mirror-editor-variable-3-color: #085;
  --jp-mirror-editor-punctuation-color: #05a;
  --jp-mirror-editor-property-color: #05a;
  --jp-mirror-editor-operator-color: #a2f;
  --jp-mirror-editor-comment-color: #408080;
  --jp-mirror-editor-string-color: #ba2121;
  --jp-mirror-editor-string-2-color: #708;
  --jp-mirror-editor-meta-color: #a2f;
  --jp-mirror-editor-qualifier-color: #555;
  --jp-mirror-editor-builtin-color: #008000;
  --jp-mirror-editor-bracket-color: #997;
  --jp-mirror-editor-tag-color: #170;
  --jp-mirror-editor-attribute-color: #00c;
  --jp-mirror-editor-header-color: blue;
  --jp-mirror-editor-quote-color: #090;
  --jp-mirror-editor-link-color: #00c;
  --jp-mirror-editor-error-color: #f00;
  --jp-mirror-editor-hr-color: #999;

  /*
    RTC user specific colors.
    These colors are used for the cursor, username in the editor,
    and the icon of the user.
  */

  --jp-collaborator-color1: #ffad8e;
  --jp-collaborator-color2: #dac83d;
  --jp-collaborator-color3: #72dd76;
  --jp-collaborator-color4: #00e4d0;
  --jp-collaborator-color5: #45d4ff;
  --jp-collaborator-color6: #e2b1ff;
  --jp-collaborator-color7: #ff9de6;

  /* Vega extension styles */

  --jp-vega-background: white;

  /* Sidebar-related styles */

  --jp-sidebar-min-width: 250px;

  /* Search-related styles */

  --jp-search-toggle-off-opacity: 0.5;
  --jp-search-toggle-hover-opacity: 0.8;
  --jp-search-toggle-on-opacity: 1;
  --jp-search-selected-match-background-color: rgb(245, 200, 0);
  --jp-search-selected-match-color: black;
  --jp-search-unselected-match-background-color: var(
    --jp-inverse-layout-color0
  );
  --jp-search-unselected-match-color: var(--jp-ui-inverse-font-color0);

  /* Icon colors that work well with light or dark backgrounds */
  --jp-icon-contrast-color0: var(--md-purple-600);
  --jp-icon-contrast-color1: var(--md-green-600);
  --jp-icon-contrast-color2: var(--md-pink-600);
  --jp-icon-contrast-color3: var(--md-blue-600);

  /* Button colors */
  --jp-accept-color-normal: var(--md-blue-700);
  --jp-accept-color-hover: var(--md-blue-800);
  --jp-accept-color-active: var(--md-blue-900);
  --jp-warn-color-normal: var(--md-red-700);
  --jp-warn-color-hover: var(--md-red-800);
  --jp-warn-color-active: var(--md-red-900);
  --jp-reject-color-normal: var(--md-grey-600);
  --jp-reject-color-hover: var(--md-grey-700);
  --jp-reject-color-active: var(--md-grey-800);

  /* File or activity icons and switch semantic variables */
  --jp-jupyter-icon-color: #f37626;
  --jp-notebook-icon-color: #f37626;
  --jp-json-icon-color: var(--md-orange-700);
  --jp-console-icon-background-color: var(--md-blue-700);
  --jp-console-icon-color: white;
  --jp-terminal-icon-background-color: var(--md-grey-800);
  --jp-terminal-icon-color: var(--md-grey-200);
  --jp-text-editor-icon-color: var(--md-grey-700);
  --jp-inspector-icon-color: var(--md-grey-700);
  --jp-switch-color: var(--md-grey-400);
  --jp-switch-true-position-color: var(--md-orange-900);
}
</style>
<style type="text/css">
/* Force rendering true colors when outputing to pdf */
* {
  -webkit-print-color-adjust: exact;
}

/* Misc */
a.anchor-link {
  display: none;
}

/* Input area styling */
.jp-InputArea {
  overflow: hidden;
}

.jp-InputArea-editor {
  overflow: hidden;
}

.cm-editor.cm-s-jupyter .highlight pre {
/* weird, but --jp-code-padding defined to be 5px but 4px horizontal padding is hardcoded for pre.cm-line */
  padding: var(--jp-code-padding) 4px;
  margin: 0;

  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
  color: inherit;

}

.jp-OutputArea-output pre {
  line-height: inherit;
  font-family: inherit;
}

.jp-RenderedText pre {
  color: var(--jp-content-font-color1);
  font-size: var(--jp-code-font-size);
}

/* Hiding the collapser by default */
.jp-Collapser {
  display: none;
}

@page {
    margin: 0.5in; /* Margin for each printed piece of paper */
}

@media print {
  .jp-Cell-inputWrapper,
  .jp-Cell-outputWrapper {
    display: block;
  }
}
</style>
<!-- Load mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe"> </script>
<!-- MathJax configuration -->
<script type="text/x-mathjax-config">
    init_mathjax = function() {
        if (window.MathJax) {
        // MathJax loaded
            MathJax.Hub.Config({
                TeX: {
                    equationNumbers: {
                    autoNumber: "AMS",
                    useLabelIds: true
                    }
                },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true,
                    processEnvironments: true
                },
                displayAlign: 'center',
                CommonHTML: {
                    linebreaks: {
                    automatic: true
                    }
                }
            });

            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        }
    }
    init_mathjax();
    </script>
<!-- End of mathjax configuration --><script type="module">
  document.addEventListener("DOMContentLoaded", async () => {
    const diagrams = document.querySelectorAll(".jp-Mermaid > pre.mermaid");
    // do not load mermaidjs if not needed
    if (!diagrams.length) {
      return;
    }
    const mermaid = (await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.0/mermaid.esm.min.mjs")).default;
    const parser = new DOMParser();

    mermaid.initialize({
      maxTextSize: 100000,
      startOnLoad: false,
      fontFamily: window
        .getComputedStyle(document.body)
        .getPropertyValue("--jp-ui-font-family"),
      theme: document.querySelector("body[data-jp-theme-light='true']")
        ? "default"
        : "dark",
    });

    let _nextMermaidId = 0;

    function makeMermaidImage(svg) {
      const img = document.createElement("img");
      const doc = parser.parseFromString(svg, "image/svg+xml");
      const svgEl = doc.querySelector("svg");
      const { maxWidth } = svgEl?.style || {};
      const firstTitle = doc.querySelector("title");
      const firstDesc = doc.querySelector("desc");

      img.setAttribute("src", `data:image/svg+xml,${encodeURIComponent(svg)}`);
      if (maxWidth) {
        img.width = parseInt(maxWidth);
      }
      if (firstTitle) {
        img.setAttribute("alt", firstTitle.textContent);
      }
      if (firstDesc) {
        const caption = document.createElement("figcaption");
        caption.className = "sr-only";
        caption.textContent = firstDesc.textContent;
        return [img, caption];
      }
      return [img];
    }

    async function makeMermaidError(text) {
      let errorMessage = "";
      try {
        await mermaid.parse(text);
      } catch (err) {
        errorMessage = `${err}`;
      }

      const result = document.createElement("details");
      result.className = 'jp-RenderedMermaid-Details';
      const summary = document.createElement("summary");
      summary.className = 'jp-RenderedMermaid-Summary';
      const pre = document.createElement("pre");
      const code = document.createElement("code");
      code.innerText = text;
      pre.appendChild(code);
      summary.appendChild(pre);
      result.appendChild(summary);

      const warning = document.createElement("pre");
      warning.innerText = errorMessage;
      result.appendChild(warning);
      return [result];
    }

    async function renderOneMarmaid(src) {
      const id = `jp-mermaid-${_nextMermaidId++}`;
      const parent = src.parentNode;
      let raw = src.textContent.trim();
      const el = document.createElement("div");
      el.style.visibility = "hidden";
      document.body.appendChild(el);
      let results = null;
      let output = null;
      try {
        const { svg } = await mermaid.render(id, raw, el);
        results = makeMermaidImage(svg);
        output = document.createElement("figure");
        results.map(output.appendChild, output);
      } catch (err) {
        parent.classList.add("jp-mod-warning");
        results = await makeMermaidError(raw);
        output = results[0];
      } finally {
        el.remove();
      }
      parent.classList.add("jp-RenderedMermaid");
      parent.appendChild(output);
    }

    void Promise.all([...diagrams].map(renderOneMarmaid));
  });
</script>
<style>
  .jp-Mermaid:not(.jp-RenderedMermaid) {
    display: none;
  }

  .jp-RenderedMermaid {
    overflow: auto;
    display: flex;
  }

  .jp-RenderedMermaid.jp-mod-warning {
    width: auto;
    padding: 0.5em;
    margin-top: 0.5em;
    border: var(--jp-border-width) solid var(--jp-warn-color2);
    border-radius: var(--jp-border-radius);
    color: var(--jp-ui-font-color1);
    font-size: var(--jp-ui-font-size1);
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .jp-RenderedMermaid figure {
    margin: 0;
    overflow: auto;
    max-width: 100%;
  }

  .jp-RenderedMermaid img {
    max-width: 100%;
  }

  .jp-RenderedMermaid-Details > pre {
    margin-top: 1em;
  }

  .jp-RenderedMermaid-Summary {
    color: var(--jp-warn-color2);
  }

  .jp-RenderedMermaid:not(.jp-mod-warning) pre {
    display: none;
  }

  .jp-RenderedMermaid-Summary > pre {
    display: inline-block;
    white-space: normal;
  }
</style>
<!-- End of mermaid configuration --></head>
<body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
<main>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h1 id="Storytelling-with-Data!-in-Altair">Storytelling with Data! in Altair<a class="anchor-link" href="#Storytelling-with-Data!-in-Altair"></a></h1><h4 id="by-Maisa-de-Oliveira-Fraiz">by Maisa de Oliveira Fraiz<a class="anchor-link" href="#by-Maisa-de-Oliveira-Fraiz"></a></h4>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Introduction">Introduction<a class="anchor-link" href="#Introduction"></a></h2><p>This project aims to replicate the exercises from Cole Nussbaumer Knaflic's book, "Storytelling with Data - Let's Practice!", using <code>Python Altair</code>. Our primary objective is to document the reasoning behind the modifications proposed by the author, while also highlighting the challenges that arise when transitioning from the book's Excel-based approach to programming in a different software environment.</p>
<p><code>Altair</code> was selected for this project due to its declarative syntax, interactivity, grammar of graphics, and compatibility with web formatting tools, while within the user-friendly Python environment. Anticipated challenges include the comparatively smaller documentation and development community of <code>Altair</code> compared to more established libraries like <code>Matplotlib</code>, <code>Seaborn</code>, or <code>Plotly</code>,and seemingly straightforward tasks in Excel that may require multiple iterations to translate effectively into the language.</p>
<p>In addition to the broader objective, this notebook also serves as a personal journey of learning <code>Altair</code>, a syntax that was previously unfamiliar to me. By delving into it, I aim to widen my repertoire in the data visualization field, discovering new ways to create compelling visual representations.</p>
<p>The data for all exercises can be found in the book's official website: <a href="https://www.storytellingwithdata.com/letspractice/downloads">https://www.storytellingwithdata.com/letspractice/downloads</a></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Imports">Imports<a class="anchor-link" href="#Imports"></a></h3><p>These are the libraries necessary to run the code for this project.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># For data manipulation and visualization</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>

<span class="c1"># For animation in Chapter 6 - Exercise 6</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">clear_output</span>

<span class="c1"># For converting .ipynb into .html</span>
<span class="kn">import</span> <span class="nn">keyboard</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">nbconvert</span>
<span class="kn">import</span> <span class="nn">nbformat</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>And these are the versions used.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Python version</span>
<span class="o">!</span><span class="w"> </span>python<span class="w"> </span>--version
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Python 3.11.6
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Library version</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Pandas version: "</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Numpy version: "</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Altair version: "</span> <span class="o">+</span> <span class="n">alt</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Ipywidgets version: "</span> <span class="o">+</span> <span class="n">widgets</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Nbconvert version: "</span> <span class="o">+</span> <span class="n">nbconvert</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Nbformat version: "</span> <span class="o">+</span> <span class="n">nbformat</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>Pandas version: 2.1.2
Numpy version: 1.26.0
Altair version: 5.1.2
Ipywidgets version: 8.1.1
Nbconvert version: 7.11.0
Nbformat version: 5.9.2
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Table-of-Contents">Table of Contents<a class="anchor-link" href="#Table-of-Contents"></a></h2><ul>
<li><a href="#2">Chapter 2</a><ul>
<li><a href="#2.1">Exercise 1</a></li>
<li><a href="#2.4">Exercise 4</a></li>
<li><a href="#2.5">Exercise 5</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li><a href="#3">Chapter 3</a><ul>
<li><a href="#3.2">Exercise 2</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li><a href="#4">Chapter 4</a><ul>
<li><a href="#4.2">Exercise 2</a></li>
<li><a href="#4.3">Exercise 3</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li><a href="#5">Chapter 5</a><ul>
<li><a href="#5.4">Exercise 4 (Inspired)</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<ul>
<li><a href="#6">Chapter 6</a><ul>
<li><a href="#6.6">Exercise 6</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Chapter-2---Choose-an-effective-visual">Chapter 2 - Choose an effective visual<a name="2"></a><a class="anchor-link" href="#Chapter-2---Choose-an-effective-visual"></a></h2><p><em>"When I have some data I need to show, how do I do that in an effective way?"</em> - Cole Nussbaumer Knaflic</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Exercise-2.1---Improve-this-table">Exercise 2.1 - Improve this table<a name="2.1"></a><a class="anchor-link" href="#Exercise-2.1---Improve-this-table"></a></h3><p>For this exercise, we will start with a simple table and work our way into transforming it into different types of commonly used visualizations.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Loading-the-data">Loading the data<a class="anchor-link" href="#Loading-the-data"></a></h4><p>The first problem with the Excel-to-Altair translation arises from the data itself, as it is polluted with titles and texts for readability in Excel. This, however, is not friendly when dealing with Python, so we should be careful when loading it. Alterations like this will happen in all subsequent exercises.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Example of polluted loading</span>

<span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Data\2.1 EXERCISE.xlsx"</span><span class="p">)</span>
<span class="n">table</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[4]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>EXERCISE 2.1</th>
<th>Unnamed: 1</th>
<th>Unnamed: 2</th>
<th>Unnamed: 3</th>
<th>Unnamed: 4</th>
<th>Unnamed: 5</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>NaN</td>
<td>FIG 2.1a</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>3</th>
<td>NaN</td>
<td>New client tier share</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>4</th>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>5</th>
<td>NaN</td>
<td>Tier</td>
<td># of Accounts</td>
<td>% Accounts</td>
<td>Revenue ($M)</td>
<td>% Revenue</td>
</tr>
<tr>
<th>6</th>
<td>NaN</td>
<td>A</td>
<td>77</td>
<td>0.070772</td>
<td>4.675</td>
<td>0.25</td>
</tr>
<tr>
<th>7</th>
<td>NaN</td>
<td>A+</td>
<td>19</td>
<td>0.017463</td>
<td>3.927</td>
<td>0.21</td>
</tr>
<tr>
<th>8</th>
<td>NaN</td>
<td>B</td>
<td>338</td>
<td>0.310662</td>
<td>5.984</td>
<td>0.32</td>
</tr>
<tr>
<th>9</th>
<td>NaN</td>
<td>C</td>
<td>425</td>
<td>0.390625</td>
<td>2.805</td>
<td>0.15</td>
</tr>
<tr>
<th>10</th>
<td>NaN</td>
<td>D</td>
<td>24</td>
<td>0.022059</td>
<td>0.374</td>
<td>0.02</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">del</span> <span class="n">table</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[6]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Right loading</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Data\2.1 EXERCISE.xlsx"</span><span class="p">,</span> <span class="n">usecols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">table</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[6]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Tier</th>
<th># of Accounts</th>
<th>% Accounts</th>
<th>Revenue ($M)</th>
<th>% Revenue</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>A</td>
<td>77</td>
<td>0.070772</td>
<td>4.675</td>
<td>0.25</td>
</tr>
<tr>
<th>1</th>
<td>A+</td>
<td>19</td>
<td>0.017463</td>
<td>3.927</td>
<td>0.21</td>
</tr>
<tr>
<th>2</th>
<td>B</td>
<td>338</td>
<td>0.310662</td>
<td>5.984</td>
<td>0.32</td>
</tr>
<tr>
<th>3</th>
<td>C</td>
<td>425</td>
<td>0.390625</td>
<td>2.805</td>
<td>0.15</td>
</tr>
<tr>
<th>4</th>
<td>D</td>
<td>24</td>
<td>0.022059</td>
<td>0.374</td>
<td>0.02</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Table">Table<a class="anchor-link" href="#Table"></a></h4><p>The initial changes recommended in the book focus on improving the table's readability itself. These changes include reordering the tiers, adding a row to show the total value, incorporating a category called "All others" to account for unmentioned values when the total percentage doesn't add up to 100%, and rounding the numbers while adjusting the percentage format as required.</p>
<p>The following code implements these modifications.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Ordering the tiers</span>

<span class="n">table</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Fixing the percentages</span>

<span class="n">table</span><span class="p">[</span><span class="s1">'% Accounts'</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">'% Accounts'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
<span class="n">table</span><span class="p">[</span><span class="s1">'% Revenue'</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">'% Revenue'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[9]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Calculating and adding "All other" values</span>

<span class="n">other_account_per</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">table</span><span class="p">[</span><span class="s1">'% Accounts'</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">other_revenue_per</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">table</span><span class="p">[</span><span class="s1">'% Revenue'</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">other_account_num</span> <span class="o">=</span> <span class="p">(</span><span class="n">other_account_per</span><span class="o">*</span><span class="n">table</span><span class="p">[</span><span class="s1">'# of Accounts'</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">table</span><span class="p">[</span><span class="s1">'% Accounts'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">other_revenue_num</span> <span class="o">=</span> <span class="p">(</span><span class="n">other_revenue_per</span><span class="o">*</span><span class="n">table</span><span class="p">[</span><span class="s1">'Revenue ($M)'</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">table</span><span class="p">[</span><span class="s1">'% Revenue'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"All other"</span><span class="p">,</span> <span class="n">other_account_num</span><span class="p">,</span> <span class="n">other_account_per</span><span class="p">,</span> <span class="n">other_revenue_num</span><span class="p">,</span> <span class="n">other_revenue_per</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[10]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Since we will not use rounded values or the total row for the graphs,</span>
<span class="c1"># we should create a new variable before making the following alterations</span>

<span class="n">table_charts</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[11]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Adding total values row</span>

<span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Total"</span><span class="p">,</span> <span class="n">table</span><span class="p">[</span><span class="s1">'# of Accounts'</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">table</span><span class="p">[</span><span class="s1">'% Accounts'</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
                        <span class="n">table</span><span class="p">[</span><span class="s1">'Revenue ($M)'</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">table</span><span class="p">[</span><span class="s1">'% Revenue'</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[12]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Rounding the numbers</span>

<span class="n">table</span><span class="p">[</span><span class="s1">'% Accounts'</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">'% Accounts'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">table</span><span class="p">[</span><span class="s1">'Revenue ($M)'</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">'Revenue ($M)'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>The new table is as follows:</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[13]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">table</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[13]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Tier</th>
<th># of Accounts</th>
<th>% Accounts</th>
<th>Revenue ($M)</th>
<th>% Revenue</th>
</tr>
</thead>
<tbody>
<tr>
<th>1</th>
<td>A+</td>
<td>19.0</td>
<td>2</td>
<td>3.9</td>
<td>21.0</td>
</tr>
<tr>
<th>0</th>
<td>A</td>
<td>77.0</td>
<td>7</td>
<td>4.7</td>
<td>25.0</td>
</tr>
<tr>
<th>2</th>
<td>B</td>
<td>338.0</td>
<td>31</td>
<td>6.0</td>
<td>32.0</td>
</tr>
<tr>
<th>3</th>
<td>C</td>
<td>425.0</td>
<td>39</td>
<td>2.8</td>
<td>15.0</td>
</tr>
<tr>
<th>4</th>
<td>D</td>
<td>24.0</td>
<td>2</td>
<td>0.4</td>
<td>2.0</td>
</tr>
<tr>
<th>5</th>
<td>All other</td>
<td>205.0</td>
<td>19</td>
<td>0.9</td>
<td>5.0</td>
</tr>
<tr>
<th>6</th>
<td>Total</td>
<td>1088.0</td>
<td>100</td>
<td>18.7</td>
<td>100.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>or, for even better readability in <code>Python</code>:</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[14]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">"Tier"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[14]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th># of Accounts</th>
<th>% Accounts</th>
<th>Revenue ($M)</th>
<th>% Revenue</th>
</tr>
<tr>
<th>Tier</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>A+</th>
<td>19.0</td>
<td>2</td>
<td>3.9</td>
<td>21.0</td>
</tr>
<tr>
<th>A</th>
<td>77.0</td>
<td>7</td>
<td>4.7</td>
<td>25.0</td>
</tr>
<tr>
<th>B</th>
<td>338.0</td>
<td>31</td>
<td>6.0</td>
<td>32.0</td>
</tr>
<tr>
<th>C</th>
<td>425.0</td>
<td>39</td>
<td>2.8</td>
<td>15.0</td>
</tr>
<tr>
<th>D</th>
<td>24.0</td>
<td>2</td>
<td>0.4</td>
<td>2.0</td>
</tr>
<tr>
<th>All other</th>
<td>205.0</td>
<td>19</td>
<td>0.9</td>
<td>5.0</td>
</tr>
<tr>
<th>Total</th>
<td>1088.0</td>
<td>100</td>
<td>18.7</td>
<td>100.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Some changes were not implemented, such as colors of rows, alignment of text, and embedding graphs into the table, for lack of compatibility with the Pandas DataFrame format. The percentage symbol (%) next to the number in the percentage columns wasn't added since doing this in Python will transform the data from <code>int</code> to <code>string</code>, and therefore is not a recommended approach.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Pie-chart">Pie chart<a class="anchor-link" href="#Pie-chart"></a></h4><p>Considering that percentages depict a fraction of a whole, the next proposal is to employ a pie chart.
Here is the default Altair graph version:</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[15]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Default pie chart</span>

<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table_charts</span><span class="p">)</span><span class="o">.</span><span class="n">mark_arc</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="s2">"% Accounts"</span><span class="p">,</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s1">'Tier'</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[15]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-65ae3f69253b48859dc8eb73b83a8633.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-65ae3f69253b48859dc8eb73b83a8633.vega-embed details,
  #altair-viz-65ae3f69253b48859dc8eb73b83a8633.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-65ae3f69253b48859dc8eb73b83a8633"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-65ae3f69253b48859dc8eb73b83a8633") {
      outputDiv = document.getElementById("altair-viz-65ae3f69253b48859dc8eb73b83a8633");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-35f9124c4b8dd7e8e6a83d69924ed8ee"}, "mark": {"type": "arc"}, "encoding": {"color": {"field": "Tier", "type": "nominal"}, "theta": {"field": "% Accounts", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-35f9124c4b8dd7e8e6a83d69924ed8ee": [{"Tier": "A+", "# of Accounts": 19.0, "% Accounts": 1.7463235294117647, "Revenue ($M)": 3.9269999999999996, "% Revenue": 21.0}, {"Tier": "A", "# of Accounts": 77.0, "% Accounts": 7.077205882352941, "Revenue ($M)": 4.675, "% Revenue": 25.0}, {"Tier": "B", "# of Accounts": 338.0, "% Accounts": 31.066176470588236, "Revenue ($M)": 5.984, "% Revenue": 32.0}, {"Tier": "C", "# of Accounts": 425.0, "% Accounts": 39.0625, "Revenue ($M)": 2.8049999999999997, "% Revenue": 15.0}, {"Tier": "D", "# of Accounts": 24.0, "% Accounts": 2.2058823529411766, "Revenue ($M)": 0.374, "% Revenue": 2.0}, {"Tier": "All other", "# of Accounts": 205.00000000000003, "% Accounts": 18.841911764705884, "Revenue ($M)": 0.935, "% Revenue": 5.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Some of the adjustments needed to bring it closer to the original include reordering the tiers, changing the labels position, altering the color palette, and adding an title.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[16]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">## % of Accounts Pie Chart</span>

<span class="c1"># Creating a base chart with a title, aligned to the left and with normal font weight</span>
<span class="n">base</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">table_charts</span><span class="p">,</span> 
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"</span><span class="si">% o</span><span class="s2">f Total Accounts"</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s1">'start'</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s1">'normal'</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Theta</span><span class="p">(</span><span class="s2">"% Accounts:Q"</span><span class="p">,</span> <span class="n">stack</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span> <span class="c1"># Encoding the angle (theta) for the pie chart</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s1">'Tier'</span><span class="p">,</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span> <span class="c1"># Encoding color based on the 'Tier' field</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Order</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s1">'Tier'</span><span class="p">)</span> <span class="c1"># Ordering the sectors of the pie chart based on the 'Tier' field</span>
<span class="p">)</span>

<span class="c1"># Creating the pie chart with an outer radius of 115</span>
<span class="n">pie</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_arc</span><span class="p">(</span><span class="n">outerRadius</span> <span class="o">=</span> <span class="mi">115</span><span class="p">)</span>

<span class="c1"># Creating text labels for each sector of the pie chart</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">radius</span> <span class="o">=</span> <span class="mi">140</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Tier"</span><span class="p">))</span>

<span class="c1"># Combining the pie chart and text labels</span>
<span class="n">acc_pie</span> <span class="o">=</span> <span class="n">pie</span> <span class="o">+</span> <span class="n">text</span>
<span class="n">acc_pie</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[16]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-ebcb910a477a472b94727f90db566ccd.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-ebcb910a477a472b94727f90db566ccd.vega-embed details,
  #altair-viz-ebcb910a477a472b94727f90db566ccd.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-ebcb910a477a472b94727f90db566ccd"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-ebcb910a477a472b94727f90db566ccd") {
      outputDiv = document.getElementById("altair-viz-ebcb910a477a472b94727f90db566ccd");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": {"type": "arc", "outerRadius": 115}, "encoding": {"color": {"field": "Tier", "legend": null, "type": "nominal"}, "order": {"field": "Tier"}, "theta": {"field": "% Accounts", "stack": true, "type": "quantitative"}}, "title": {"text": "% of Total Accounts", "anchor": "start", "fontWeight": "normal"}}, {"mark": {"type": "text", "radius": 140, "size": 15}, "encoding": {"color": {"field": "Tier", "legend": null, "type": "nominal"}, "order": {"field": "Tier"}, "text": {"field": "Tier", "type": "nominal"}, "theta": {"field": "% Accounts", "stack": true, "type": "quantitative"}}, "title": {"text": "% of Total Accounts", "anchor": "start", "fontWeight": "normal"}}], "data": {"name": "data-35f9124c4b8dd7e8e6a83d69924ed8ee"}, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-35f9124c4b8dd7e8e6a83d69924ed8ee": [{"Tier": "A+", "# of Accounts": 19.0, "% Accounts": 1.7463235294117647, "Revenue ($M)": 3.9269999999999996, "% Revenue": 21.0}, {"Tier": "A", "# of Accounts": 77.0, "% Accounts": 7.077205882352941, "Revenue ($M)": 4.675, "% Revenue": 25.0}, {"Tier": "B", "# of Accounts": 338.0, "% Accounts": 31.066176470588236, "Revenue ($M)": 5.984, "% Revenue": 32.0}, {"Tier": "C", "# of Accounts": 425.0, "% Accounts": 39.0625, "Revenue ($M)": 2.8049999999999997, "% Revenue": 15.0}, {"Tier": "D", "# of Accounts": 24.0, "% Accounts": 2.2058823529411766, "Revenue ($M)": 0.374, "% Revenue": 2.0}, {"Tier": "All other", "# of Accounts": 205.00000000000003, "% Accounts": 18.841911764705884, "Revenue ($M)": 0.935, "% Revenue": 5.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Not informing the data type for the field <code>order</code> makes it so Altair rearranges the <code>Tiers</code> alphabetically instead of using the order provided by dataframe. We can fix this by identifying <code>Tier</code> as Ordered (O).</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[17]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">## % of Accounts Pie Chart</span>

<span class="n">base</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">table_charts</span><span class="p">,</span> 
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"</span><span class="si">% o</span><span class="s2">f Total Accounts"</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s1">'start'</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s1">'normal'</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Theta</span><span class="p">(</span><span class="s2">"% Accounts:Q"</span><span class="p">,</span> <span class="n">stack</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s1">'Tier'</span><span class="p">,</span>
                      <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span>
                          <span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'#4d71bc'</span><span class="p">,</span> <span class="s1">'#5d9bd4'</span><span class="p">,</span> <span class="s1">'#6fae45'</span><span class="p">,</span> <span class="s1">'#febf0f'</span><span class="p">,</span> <span class="s1">'#e77e2d'</span><span class="p">,</span> <span class="s1">'#a6a6a6'</span><span class="p">]</span>
                        <span class="p">),</span> <span class="c1"># Setting custom colors for each sector of the pie chart</span>
                      <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="c1"># So that the colors don't follow the alphabetic order</span>
                      <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
                      <span class="p">),</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Order</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s1">'Tier:O'</span><span class="p">))</span>


<span class="n">pie</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_arc</span><span class="p">(</span><span class="n">outerRadius</span> <span class="o">=</span> <span class="mi">115</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">radius</span> <span class="o">=</span> <span class="mi">140</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Tier"</span><span class="p">))</span>


<span class="n">acc_pie</span> <span class="o">=</span> <span class="n">pie</span> <span class="o">+</span> <span class="n">text</span>
<span class="n">acc_pie</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[17]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-bc8355ae55634ea9bbde3b57d0f89ac2.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-bc8355ae55634ea9bbde3b57d0f89ac2.vega-embed details,
  #altair-viz-bc8355ae55634ea9bbde3b57d0f89ac2.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-bc8355ae55634ea9bbde3b57d0f89ac2"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-bc8355ae55634ea9bbde3b57d0f89ac2") {
      outputDiv = document.getElementById("altair-viz-bc8355ae55634ea9bbde3b57d0f89ac2");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": {"type": "arc", "outerRadius": 115}, "encoding": {"color": {"field": "Tier", "legend": null, "scale": {"range": ["#4d71bc", "#5d9bd4", "#6fae45", "#febf0f", "#e77e2d", "#a6a6a6"]}, "sort": null, "type": "nominal"}, "order": {"field": "Tier:O"}, "theta": {"field": "% Accounts", "stack": true, "type": "quantitative"}}, "title": {"text": "% of Total Accounts", "anchor": "start", "fontWeight": "normal"}}, {"mark": {"type": "text", "radius": 140, "size": 15}, "encoding": {"color": {"field": "Tier", "legend": null, "scale": {"range": ["#4d71bc", "#5d9bd4", "#6fae45", "#febf0f", "#e77e2d", "#a6a6a6"]}, "sort": null, "type": "nominal"}, "order": {"field": "Tier:O"}, "text": {"field": "Tier", "type": "nominal"}, "theta": {"field": "% Accounts", "stack": true, "type": "quantitative"}}, "title": {"text": "% of Total Accounts", "anchor": "start", "fontWeight": "normal"}}], "data": {"name": "data-35f9124c4b8dd7e8e6a83d69924ed8ee"}, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-35f9124c4b8dd7e8e6a83d69924ed8ee": [{"Tier": "A+", "# of Accounts": 19.0, "% Accounts": 1.7463235294117647, "Revenue ($M)": 3.9269999999999996, "% Revenue": 21.0}, {"Tier": "A", "# of Accounts": 77.0, "% Accounts": 7.077205882352941, "Revenue ($M)": 4.675, "% Revenue": 25.0}, {"Tier": "B", "# of Accounts": 338.0, "% Accounts": 31.066176470588236, "Revenue ($M)": 5.984, "% Revenue": 32.0}, {"Tier": "C", "# of Accounts": 425.0, "% Accounts": 39.0625, "Revenue ($M)": 2.8049999999999997, "% Revenue": 15.0}, {"Tier": "D", "# of Accounts": 24.0, "% Accounts": 2.2058823529411766, "Revenue ($M)": 0.374, "% Revenue": 2.0}, {"Tier": "All other", "# of Accounts": 205.00000000000003, "% Accounts": 18.841911764705884, "Revenue ($M)": 0.935, "% Revenue": 5.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Initially, <code>offset</code> was used instead of <code>anchor</code>, manually specifying the title location in the x-axis by pixels.This produces a more replica-like result, as you define the texts to be exactly to the same place as the example. While this approach yields a result that closely mimics the example, we acknowledge that anchoring provides a faster and cleaner solution. The decision has been made to adopt anchoring for the remainder of this project, prioritizing efficiency and universality across all graphs, even if it means sacrificing pinpoint accuracy in text placement.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>The HEX color code values of the palette from the book were acquired through the use of the online tool "Color Picker Online", which is freely accessible at <a href="https://imagecolorpicker.com/">https://imagecolorpicker.com/</a>.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>The pie chart above can now be easily modified to represent the percentage of total revenue.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[18]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># % of Revenue Pie Chart</span>

<span class="n">base</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">table_charts</span><span class="p">,</span> 
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"</span><span class="si">% o</span><span class="s2">f Total Revenue"</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s1">'start'</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s1">'normal'</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Theta</span><span class="p">(</span><span class="s2">"% Revenue:Q"</span><span class="p">,</span> <span class="n">stack</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s1">'Tier'</span><span class="p">,</span>
                      <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span>
                          <span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'#4d71bc'</span><span class="p">,</span> <span class="s1">'#5d9bd4'</span><span class="p">,</span> <span class="s1">'#6fae45'</span><span class="p">,</span> <span class="s1">'#febf0f'</span><span class="p">,</span> <span class="s1">'#e77e2d'</span><span class="p">,</span> <span class="s1">'#a6a6a6'</span><span class="p">]</span>
                        <span class="p">),</span>
                      <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
                      <span class="p">),</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Order</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s1">'Tier:O'</span><span class="p">))</span>


<span class="n">pie</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_arc</span><span class="p">(</span><span class="n">outerRadius</span> <span class="o">=</span> <span class="mi">115</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">radius</span> <span class="o">=</span> <span class="mi">140</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Tier"</span><span class="p">))</span>


<span class="n">rev_pie</span> <span class="o">=</span> <span class="n">pie</span> <span class="o">+</span> <span class="n">text</span>
<span class="n">rev_pie</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[18]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-759dbea026d543d58184e5a7361c4fdc.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-759dbea026d543d58184e5a7361c4fdc.vega-embed details,
  #altair-viz-759dbea026d543d58184e5a7361c4fdc.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-759dbea026d543d58184e5a7361c4fdc"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-759dbea026d543d58184e5a7361c4fdc") {
      outputDiv = document.getElementById("altair-viz-759dbea026d543d58184e5a7361c4fdc");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": {"type": "arc", "outerRadius": 115}, "encoding": {"color": {"field": "Tier", "legend": null, "scale": {"range": ["#4d71bc", "#5d9bd4", "#6fae45", "#febf0f", "#e77e2d", "#a6a6a6"]}, "sort": null, "type": "nominal"}, "order": {"field": "Tier:O"}, "theta": {"field": "% Revenue", "stack": true, "type": "quantitative"}}, "title": {"text": "% of Total Revenue", "anchor": "start", "fontWeight": "normal"}}, {"mark": {"type": "text", "radius": 140, "size": 15}, "encoding": {"color": {"field": "Tier", "legend": null, "scale": {"range": ["#4d71bc", "#5d9bd4", "#6fae45", "#febf0f", "#e77e2d", "#a6a6a6"]}, "sort": null, "type": "nominal"}, "order": {"field": "Tier:O"}, "text": {"field": "Tier", "type": "nominal"}, "theta": {"field": "% Revenue", "stack": true, "type": "quantitative"}}, "title": {"text": "% of Total Revenue", "anchor": "start", "fontWeight": "normal"}}], "data": {"name": "data-35f9124c4b8dd7e8e6a83d69924ed8ee"}, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-35f9124c4b8dd7e8e6a83d69924ed8ee": [{"Tier": "A+", "# of Accounts": 19.0, "% Accounts": 1.7463235294117647, "Revenue ($M)": 3.9269999999999996, "% Revenue": 21.0}, {"Tier": "A", "# of Accounts": 77.0, "% Accounts": 7.077205882352941, "Revenue ($M)": 4.675, "% Revenue": 25.0}, {"Tier": "B", "# of Accounts": 338.0, "% Accounts": 31.066176470588236, "Revenue ($M)": 5.984, "% Revenue": 32.0}, {"Tier": "C", "# of Accounts": 425.0, "% Accounts": 39.0625, "Revenue ($M)": 2.8049999999999997, "% Revenue": 15.0}, {"Tier": "D", "# of Accounts": 24.0, "% Accounts": 2.2058823529411766, "Revenue ($M)": 0.374, "% Revenue": 2.0}, {"Tier": "All other", "# of Accounts": 205.00000000000003, "% Accounts": 18.841911764705884, "Revenue ($M)": 0.935, "% Revenue": 5.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>With both graphs available, we can add them next to each other and include a main title.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[19]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Combining two pie charts using the vertical concatenation operator '|'</span>
<span class="n">pies</span> <span class="o">=</span> <span class="n">acc_pie</span> <span class="o">|</span> <span class="n">rev_pie</span>

<span class="c1"># Setting properties for the combined pie charts</span>
<span class="n">pies</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="s1">'New Client Tier Share'</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">fontSize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>  <span class="c1"># Adding a title with specific offset and font size</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[19]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-308c28ee62224df5a1a85779917e9360.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-308c28ee62224df5a1a85779917e9360.vega-embed details,
  #altair-viz-308c28ee62224df5a1a85779917e9360.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-308c28ee62224df5a1a85779917e9360"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-308c28ee62224df5a1a85779917e9360") {
      outputDiv = document.getElementById("altair-viz-308c28ee62224df5a1a85779917e9360");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "hconcat": [{"layer": [{"mark": {"type": "arc", "outerRadius": 115}, "encoding": {"color": {"field": "Tier", "legend": null, "scale": {"range": ["#4d71bc", "#5d9bd4", "#6fae45", "#febf0f", "#e77e2d", "#a6a6a6"]}, "sort": null, "type": "nominal"}, "order": {"field": "Tier:O"}, "theta": {"field": "% Accounts", "stack": true, "type": "quantitative"}}, "title": {"text": "% of Total Accounts", "anchor": "start", "fontWeight": "normal"}}, {"mark": {"type": "text", "radius": 140, "size": 15}, "encoding": {"color": {"field": "Tier", "legend": null, "scale": {"range": ["#4d71bc", "#5d9bd4", "#6fae45", "#febf0f", "#e77e2d", "#a6a6a6"]}, "sort": null, "type": "nominal"}, "order": {"field": "Tier:O"}, "text": {"field": "Tier", "type": "nominal"}, "theta": {"field": "% Accounts", "stack": true, "type": "quantitative"}}, "title": {"text": "% of Total Accounts", "anchor": "start", "fontWeight": "normal"}}]}, {"layer": [{"mark": {"type": "arc", "outerRadius": 115}, "encoding": {"color": {"field": "Tier", "legend": null, "scale": {"range": ["#4d71bc", "#5d9bd4", "#6fae45", "#febf0f", "#e77e2d", "#a6a6a6"]}, "sort": null, "type": "nominal"}, "order": {"field": "Tier:O"}, "theta": {"field": "% Revenue", "stack": true, "type": "quantitative"}}, "title": {"text": "% of Total Revenue", "anchor": "start", "fontWeight": "normal"}}, {"mark": {"type": "text", "radius": 140, "size": 15}, "encoding": {"color": {"field": "Tier", "legend": null, "scale": {"range": ["#4d71bc", "#5d9bd4", "#6fae45", "#febf0f", "#e77e2d", "#a6a6a6"]}, "sort": null, "type": "nominal"}, "order": {"field": "Tier:O"}, "text": {"field": "Tier", "type": "nominal"}, "theta": {"field": "% Revenue", "stack": true, "type": "quantitative"}}, "title": {"text": "% of Total Revenue", "anchor": "start", "fontWeight": "normal"}}]}], "data": {"name": "data-35f9124c4b8dd7e8e6a83d69924ed8ee"}, "title": {"text": "New Client Tier Share", "fontSize": 20, "offset": 10}, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-35f9124c4b8dd7e8e6a83d69924ed8ee": [{"Tier": "A+", "# of Accounts": 19.0, "% Accounts": 1.7463235294117647, "Revenue ($M)": 3.9269999999999996, "% Revenue": 21.0}, {"Tier": "A", "# of Accounts": 77.0, "% Accounts": 7.077205882352941, "Revenue ($M)": 4.675, "% Revenue": 25.0}, {"Tier": "B", "# of Accounts": 338.0, "% Accounts": 31.066176470588236, "Revenue ($M)": 5.984, "% Revenue": 32.0}, {"Tier": "C", "# of Accounts": 425.0, "% Accounts": 39.0625, "Revenue ($M)": 2.8049999999999997, "% Revenue": 15.0}, {"Tier": "D", "# of Accounts": 24.0, "% Accounts": 2.2058823529411766, "Revenue ($M)": 0.374, "% Revenue": 2.0}, {"Tier": "All other", "# of Accounts": 205.00000000000003, "% Accounts": 18.841911764705884, "Revenue ($M)": 0.935, "% Revenue": 5.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/2_1e.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Pie charts can present readability challenges, as the human eye struggles to differentiate the relative volumes of slices effectively. While adding data percentages next to the slices can enhance comprehension, it may also introduce unnecessary clutter to the visualization.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Bar-chart">Bar chart<a class="anchor-link" href="#Bar-chart"></a></h4><p>The next graph proposed to tackle is a horizontal bar chart. Since now the comparison does not involve angles and are aligned at the start point, discerning the segment's scale is easier.</p>
<p>This is the default representation in Altair:</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[20]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Default altair bar chart</span>

<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table_charts</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Tier'</span><span class="p">),</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'% Accounts'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[20]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-7d2c2259a2b344d7b510f7d1210d1bc4.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-7d2c2259a2b344d7b510f7d1210d1bc4.vega-embed details,
  #altair-viz-7d2c2259a2b344d7b510f7d1210d1bc4.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-7d2c2259a2b344d7b510f7d1210d1bc4"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-7d2c2259a2b344d7b510f7d1210d1bc4") {
      outputDiv = document.getElementById("altair-viz-7d2c2259a2b344d7b510f7d1210d1bc4");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-35f9124c4b8dd7e8e6a83d69924ed8ee"}, "mark": {"type": "bar"}, "encoding": {"x": {"field": "% Accounts", "type": "quantitative"}, "y": {"field": "Tier", "type": "nominal"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-35f9124c4b8dd7e8e6a83d69924ed8ee": [{"Tier": "A+", "# of Accounts": 19.0, "% Accounts": 1.7463235294117647, "Revenue ($M)": 3.9269999999999996, "% Revenue": 21.0}, {"Tier": "A", "# of Accounts": 77.0, "% Accounts": 7.077205882352941, "Revenue ($M)": 4.675, "% Revenue": 25.0}, {"Tier": "B", "# of Accounts": 338.0, "% Accounts": 31.066176470588236, "Revenue ($M)": 5.984, "% Revenue": 32.0}, {"Tier": "C", "# of Accounts": 425.0, "% Accounts": 39.0625, "Revenue ($M)": 2.8049999999999997, "% Revenue": 15.0}, {"Tier": "D", "# of Accounts": 24.0, "% Accounts": 2.2058823529411766, "Revenue ($M)": 0.374, "% Revenue": 2.0}, {"Tier": "All other", "# of Accounts": 205.00000000000003, "% Accounts": 18.841911764705884, "Revenue ($M)": 0.935, "% Revenue": 5.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>The necessary adjustments involve placing the "Tier" label in the upper left corner, displaying values next to the bars instead of using an x-axis, and adding a title while rearranging the tiers.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[21]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Creating a base chart with a title, aligned to the left and with normal font weight</span>
<span class="n">base</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">table_charts</span><span class="p">,</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="s1">'TIER | % OF TOTAL ACCOUNTS'</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s1">'start'</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s1">'normal'</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Tier'</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>  <span class="c1"># Encoding the 'Tier' field on the y-axis, without a specific title</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'% Accounts'</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>  <span class="c1"># Encoding the '% Accounts' field on the x-axis, without axis labels</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Order</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s1">'Tier:O'</span><span class="p">),</span>  <span class="c1"># Ordering the bars based on the 'Tier' field</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"% Accounts"</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">".0f"</span><span class="p">)</span>  <span class="c1"># Displaying the '% Accounts' values as text, formatted to have no decimal places</span>
<span class="p">)</span>

<span class="c1"># Creating the final bar chart by combining the bars and text labels</span>
<span class="n">final_acc</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span> <span class="o">+</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">'left'</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Displaying the final bar chart</span>
<span class="n">final_acc</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[21]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-a6f9cee7cb0547e0845fadc3fa603ec5.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-a6f9cee7cb0547e0845fadc3fa603ec5.vega-embed details,
  #altair-viz-a6f9cee7cb0547e0845fadc3fa603ec5.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-a6f9cee7cb0547e0845fadc3fa603ec5"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-a6f9cee7cb0547e0845fadc3fa603ec5") {
      outputDiv = document.getElementById("altair-viz-a6f9cee7cb0547e0845fadc3fa603ec5");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": {"type": "bar"}, "encoding": {"order": {"field": "Tier:O"}, "text": {"field": "% Accounts", "format": ".0f", "type": "quantitative"}, "x": {"axis": null, "field": "% Accounts", "type": "quantitative"}, "y": {"field": "Tier", "title": null, "type": "nominal"}}, "title": {"text": "TIER | % OF TOTAL ACCOUNTS", "anchor": "start", "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "dx": 2}, "encoding": {"order": {"field": "Tier:O"}, "text": {"field": "% Accounts", "format": ".0f", "type": "quantitative"}, "x": {"axis": null, "field": "% Accounts", "type": "quantitative"}, "y": {"field": "Tier", "title": null, "type": "nominal"}}, "title": {"text": "TIER | % OF TOTAL ACCOUNTS", "anchor": "start", "fontWeight": "normal"}}], "data": {"name": "data-35f9124c4b8dd7e8e6a83d69924ed8ee"}, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-35f9124c4b8dd7e8e6a83d69924ed8ee": [{"Tier": "A+", "# of Accounts": 19.0, "% Accounts": 1.7463235294117647, "Revenue ($M)": 3.9269999999999996, "% Revenue": 21.0}, {"Tier": "A", "# of Accounts": 77.0, "% Accounts": 7.077205882352941, "Revenue ($M)": 4.675, "% Revenue": 25.0}, {"Tier": "B", "# of Accounts": 338.0, "% Accounts": 31.066176470588236, "Revenue ($M)": 5.984, "% Revenue": 32.0}, {"Tier": "C", "# of Accounts": 425.0, "% Accounts": 39.0625, "Revenue ($M)": 2.8049999999999997, "% Revenue": 15.0}, {"Tier": "D", "# of Accounts": 24.0, "% Accounts": 2.2058823529411766, "Revenue ($M)": 0.374, "% Revenue": 2.0}, {"Tier": "All other", "# of Accounts": 205.00000000000003, "% Accounts": 18.841911764705884, "Revenue ($M)": 0.935, "% Revenue": 5.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Adding the <code>order</code> by <code>Tier:O</code> didn't had the same effect as it did on the pie chart. The compatible method for this case is adding a <code>sort</code> keyword in the axis to be sorted.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[22]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">base</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">table_charts</span><span class="p">,</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="s1">'TIER   | % OF TOTAL ACCOUNTS     |'</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s1">'start'</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s1">'normal'</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Tier'</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"A+"</span><span class="p">],</span> <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>  <span class="c1"># Encoding the 'Tier' field on the y-axis, with a specific sorting order</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'% Accounts'</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span> 
    <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"% Accounts"</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s2">".0f"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">final_acc</span> <span class="o">=</span> <span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span> <span class="o">+</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s1">'left'</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">150</span><span class="p">)</span> <span class="c1"># Setting te width</span>
<span class="n">final_acc</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[22]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-aa8c252559ea46969fbe212d2781c697.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-aa8c252559ea46969fbe212d2781c697.vega-embed details,
  #altair-viz-aa8c252559ea46969fbe212d2781c697.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-aa8c252559ea46969fbe212d2781c697"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-aa8c252559ea46969fbe212d2781c697") {
      outputDiv = document.getElementById("altair-viz-aa8c252559ea46969fbe212d2781c697");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": {"type": "bar"}, "encoding": {"text": {"field": "% Accounts", "format": ".0f", "type": "quantitative"}, "x": {"axis": null, "field": "% Accounts", "type": "quantitative"}, "y": {"field": "Tier", "sort": ["A+"], "title": null, "type": "nominal"}}, "title": {"text": "TIER   | % OF TOTAL ACCOUNTS     |", "anchor": "start", "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "dx": 2}, "encoding": {"text": {"field": "% Accounts", "format": ".0f", "type": "quantitative"}, "x": {"axis": null, "field": "% Accounts", "type": "quantitative"}, "y": {"field": "Tier", "sort": ["A+"], "title": null, "type": "nominal"}}, "title": {"text": "TIER   | % OF TOTAL ACCOUNTS     |", "anchor": "start", "fontWeight": "normal"}}], "data": {"name": "data-35f9124c4b8dd7e8e6a83d69924ed8ee"}, "width": 150, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-35f9124c4b8dd7e8e6a83d69924ed8ee": [{"Tier": "A+", "# of Accounts": 19.0, "% Accounts": 1.7463235294117647, "Revenue ($M)": 3.9269999999999996, "% Revenue": 21.0}, {"Tier": "A", "# of Accounts": 77.0, "% Accounts": 7.077205882352941, "Revenue ($M)": 4.675, "% Revenue": 25.0}, {"Tier": "B", "# of Accounts": 338.0, "% Accounts": 31.066176470588236, "Revenue ($M)": 5.984, "% Revenue": 32.0}, {"Tier": "C", "# of Accounts": 425.0, "% Accounts": 39.0625, "Revenue ($M)": 2.8049999999999997, "% Revenue": 15.0}, {"Tier": "D", "# of Accounts": 24.0, "% Accounts": 2.2058823529411766, "Revenue ($M)": 0.374, "% Revenue": 2.0}, {"Tier": "All other", "# of Accounts": 205.00000000000003, "% Accounts": 18.841911764705884, "Revenue ($M)": 0.935, "% Revenue": 5.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Now we do the same for the revenue column. In addition, the y-axis is removed so it isn't repeated when uniting the charts.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[23]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">base</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">table_charts</span><span class="p">,</span> 
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="s1">'% OF TOTAL REVENUE'</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s1">'start'</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s1">'normal'</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Tier'</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"A+"</span><span class="p">])</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'% Revenue'</span><span class="p">)</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"% Revenue"</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s2">".0f"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">final_rev</span> <span class="o">=</span> <span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span> <span class="o">+</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s1">'left'</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">150</span><span class="p">)</span>
<span class="n">final_rev</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[23]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-903b8722eb824bbdbf46a93cae558e03.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-903b8722eb824bbdbf46a93cae558e03.vega-embed details,
  #altair-viz-903b8722eb824bbdbf46a93cae558e03.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-903b8722eb824bbdbf46a93cae558e03"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-903b8722eb824bbdbf46a93cae558e03") {
      outputDiv = document.getElementById("altair-viz-903b8722eb824bbdbf46a93cae558e03");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": {"type": "bar"}, "encoding": {"text": {"field": "% Revenue", "format": ".0f", "type": "quantitative"}, "x": {"axis": null, "field": "% Revenue", "type": "quantitative"}, "y": {"axis": null, "field": "Tier", "sort": ["A+"], "type": "nominal"}}, "title": {"text": "% OF TOTAL REVENUE", "anchor": "start", "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "dx": 2}, "encoding": {"text": {"field": "% Revenue", "format": ".0f", "type": "quantitative"}, "x": {"axis": null, "field": "% Revenue", "type": "quantitative"}, "y": {"axis": null, "field": "Tier", "sort": ["A+"], "type": "nominal"}}, "title": {"text": "% OF TOTAL REVENUE", "anchor": "start", "fontWeight": "normal"}}], "data": {"name": "data-35f9124c4b8dd7e8e6a83d69924ed8ee"}, "width": 150, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-35f9124c4b8dd7e8e6a83d69924ed8ee": [{"Tier": "A+", "# of Accounts": 19.0, "% Accounts": 1.7463235294117647, "Revenue ($M)": 3.9269999999999996, "% Revenue": 21.0}, {"Tier": "A", "# of Accounts": 77.0, "% Accounts": 7.077205882352941, "Revenue ($M)": 4.675, "% Revenue": 25.0}, {"Tier": "B", "# of Accounts": 338.0, "% Accounts": 31.066176470588236, "Revenue ($M)": 5.984, "% Revenue": 32.0}, {"Tier": "C", "# of Accounts": 425.0, "% Accounts": 39.0625, "Revenue ($M)": 2.8049999999999997, "% Revenue": 15.0}, {"Tier": "D", "# of Accounts": 24.0, "% Accounts": 2.2058823529411766, "Revenue ($M)": 0.374, "% Revenue": 2.0}, {"Tier": "All other", "# of Accounts": 205.00000000000003, "% Accounts": 18.841911764705884, "Revenue ($M)": 0.935, "% Revenue": 5.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Similar to the pie chart, we can arrange these graphs side by side and include a main title.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[24]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Combining two charts horizontally using the concatenation operator '|'</span>
<span class="n">hor_bar</span> <span class="o">=</span> <span class="n">final_acc</span> <span class="o">|</span> <span class="n">final_rev</span>

<span class="c1"># Configuring the view of the combined chart, removing strokes</span>
<span class="n">hor_bar</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="s1">'New Client Tier Share'</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s1">'start'</span><span class="p">,</span> <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>  <span class="c1"># Adding title</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[24]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-4ee5b03d19044f0a9735099a7ce95561.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-4ee5b03d19044f0a9735099a7ce95561.vega-embed details,
  #altair-viz-4ee5b03d19044f0a9735099a7ce95561.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-4ee5b03d19044f0a9735099a7ce95561"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-4ee5b03d19044f0a9735099a7ce95561") {
      outputDiv = document.getElementById("altair-viz-4ee5b03d19044f0a9735099a7ce95561");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "hconcat": [{"layer": [{"mark": {"type": "bar"}, "encoding": {"text": {"field": "% Accounts", "format": ".0f", "type": "quantitative"}, "x": {"axis": null, "field": "% Accounts", "type": "quantitative"}, "y": {"field": "Tier", "sort": ["A+"], "title": null, "type": "nominal"}}, "title": {"text": "TIER   | % OF TOTAL ACCOUNTS     |", "anchor": "start", "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "dx": 2}, "encoding": {"text": {"field": "% Accounts", "format": ".0f", "type": "quantitative"}, "x": {"axis": null, "field": "% Accounts", "type": "quantitative"}, "y": {"field": "Tier", "sort": ["A+"], "title": null, "type": "nominal"}}, "title": {"text": "TIER   | % OF TOTAL ACCOUNTS     |", "anchor": "start", "fontWeight": "normal"}}], "width": 150}, {"layer": [{"mark": {"type": "bar"}, "encoding": {"text": {"field": "% Revenue", "format": ".0f", "type": "quantitative"}, "x": {"axis": null, "field": "% Revenue", "type": "quantitative"}, "y": {"axis": null, "field": "Tier", "sort": ["A+"], "type": "nominal"}}, "title": {"text": "% OF TOTAL REVENUE", "anchor": "start", "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "dx": 2}, "encoding": {"text": {"field": "% Revenue", "format": ".0f", "type": "quantitative"}, "x": {"axis": null, "field": "% Revenue", "type": "quantitative"}, "y": {"axis": null, "field": "Tier", "sort": ["A+"], "type": "nominal"}}, "title": {"text": "% OF TOTAL REVENUE", "anchor": "start", "fontWeight": "normal"}}], "width": 150}], "data": {"name": "data-35f9124c4b8dd7e8e6a83d69924ed8ee"}, "title": {"text": "New Client Tier Share", "anchor": "start", "fontSize": 20}, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-35f9124c4b8dd7e8e6a83d69924ed8ee": [{"Tier": "A+", "# of Accounts": 19.0, "% Accounts": 1.7463235294117647, "Revenue ($M)": 3.9269999999999996, "% Revenue": 21.0}, {"Tier": "A", "# of Accounts": 77.0, "% Accounts": 7.077205882352941, "Revenue ($M)": 4.675, "% Revenue": 25.0}, {"Tier": "B", "# of Accounts": 338.0, "% Accounts": 31.066176470588236, "Revenue ($M)": 5.984, "% Revenue": 32.0}, {"Tier": "C", "# of Accounts": 425.0, "% Accounts": 39.0625, "Revenue ($M)": 2.8049999999999997, "% Revenue": 15.0}, {"Tier": "D", "# of Accounts": 24.0, "% Accounts": 2.2058823529411766, "Revenue ($M)": 0.374, "% Revenue": 2.0}, {"Tier": "All other", "# of Accounts": 205.00000000000003, "% Accounts": 18.841911764705884, "Revenue ($M)": 0.935, "% Revenue": 5.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/2_1f.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>In both the pie and bar chart, the labeling beside the value is not in the same position as the examples provided. This discrepancy arises from the fact that adjusting these labels to match the book's examples, with variations in positions (some inside and some outside of the pie), different colors, and even omitting some labels, would be a labor-intensive manual task in Altair. These adjustments are primarily for aesthetic purposes and do not significantly impact readability, in some cases even obscuring the information being presented.</p>
<p>Examples of how to manually define labels will be presented in future exercises.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Horizontal-dual-series-bar-chart">Horizontal dual series bar chart<a class="anchor-link" href="#Horizontal-dual-series-bar-chart"></a></h4><p>The two graphs in the last visualization can be merged into a single grouped bar chart.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[25]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Altair with default settings</span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table_charts</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'value:Q'</span><span class="p">),</span>  <span class="c1"># Encoding the quantitative variable 'value' on the x-axis</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'variable:N'</span><span class="p">),</span>  <span class="c1"># Encoding the nominal variable 'variable' on the y-axis</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
        <span class="s1">'variable:N'</span><span class="p">,</span> 
        <span class="n">legend</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Legend</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">'Metric'</span><span class="p">)</span>
    <span class="p">),</span>  <span class="c1"># Encoding color based on 'variable' with legend title 'Metric'</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Row</span><span class="p">(</span><span class="s1">'Tier:O'</span><span class="p">)</span>  <span class="c1"># Faceting by rows based on the ordinal variable 'Tier'</span>
<span class="p">)</span><span class="o">.</span><span class="n">transform_fold</span><span class="p">(</span>
    <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'% Accounts'</span><span class="p">,</span> <span class="s1">'% Revenue'</span><span class="p">],</span>  <span class="c1"># Transforming the data by folding the specified columns</span>
    <span class="n">as_</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'variable'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">]</span>  <span class="c1"># Renaming the folded columns to 'variable' and 'value'</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[25]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-e4b5d722251f48c0acd5085b2d62f149.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-e4b5d722251f48c0acd5085b2d62f149.vega-embed details,
  #altair-viz-e4b5d722251f48c0acd5085b2d62f149.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-e4b5d722251f48c0acd5085b2d62f149"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-e4b5d722251f48c0acd5085b2d62f149") {
      outputDiv = document.getElementById("altair-viz-e4b5d722251f48c0acd5085b2d62f149");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-35f9124c4b8dd7e8e6a83d69924ed8ee"}, "mark": {"type": "bar"}, "encoding": {"color": {"field": "variable", "legend": {"title": "Metric"}, "type": "nominal"}, "row": {"field": "Tier", "type": "ordinal"}, "x": {"field": "value", "type": "quantitative"}, "y": {"field": "variable", "type": "nominal"}}, "transform": [{"fold": ["% Accounts", "% Revenue"], "as": ["variable", "value"]}], "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-35f9124c4b8dd7e8e6a83d69924ed8ee": [{"Tier": "A+", "# of Accounts": 19.0, "% Accounts": 1.7463235294117647, "Revenue ($M)": 3.9269999999999996, "% Revenue": 21.0}, {"Tier": "A", "# of Accounts": 77.0, "% Accounts": 7.077205882352941, "Revenue ($M)": 4.675, "% Revenue": 25.0}, {"Tier": "B", "# of Accounts": 338.0, "% Accounts": 31.066176470588236, "Revenue ($M)": 5.984, "% Revenue": 32.0}, {"Tier": "C", "# of Accounts": 425.0, "% Accounts": 39.0625, "Revenue ($M)": 2.8049999999999997, "% Revenue": 15.0}, {"Tier": "D", "# of Accounts": 24.0, "% Accounts": 2.2058823529411766, "Revenue ($M)": 0.374, "% Revenue": 2.0}, {"Tier": "All other", "# of Accounts": 205.00000000000003, "% Accounts": 18.841911764705884, "Revenue ($M)": 0.935, "% Revenue": 5.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>The necessary alterations involve removing the grid, adjusting label positions and reducing redundancy, adding a title and subtitle, and changing the color palette.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[26]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Custom settings</span>
<span class="n">merged_hor_bar</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">table_charts</span><span class="p">,</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="s1">'New client tier share'</span><span class="p">,</span> <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>  <span class="c1"># Adding a title with specific font size</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s1">'value:Q'</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"TIER |  % OF TOTAL ACCOUNTS vs REVENUE"</span><span class="p">,</span>  <span class="c1"># Setting a custom title for the x-axis</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="c1"># Remove grid</span>
            <span class="n">orient</span> <span class="o">=</span> <span class="s1">'top'</span><span class="p">,</span> <span class="c1"># Put axis on top</span>
            <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>  <span class="c1"># Setting the label color as gray</span>
            <span class="n">titleColor</span> <span class="o">=</span> <span class="s1">'#888888'</span>  <span class="c1"># Setting the title color as gray</span>
        <span class="p">)</span>
    <span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
        <span class="s1">'variable:N'</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># Removing y-axis title, labels, and ticks</span>
    <span class="p">),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
        <span class="s1">'variable:N'</span><span class="p">,</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Legend</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">'Metric'</span><span class="p">),</span>  <span class="c1"># Adding a legend with a custom title</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'#b4c6e4'</span><span class="p">,</span> <span class="s1">'#4871b7'</span><span class="p">])</span>  <span class="c1"># Setting a custom color range</span>
    <span class="p">),</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Row</span><span class="p">(</span>
        <span class="s1">'Tier:O'</span><span class="p">,</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Header</span><span class="p">(</span><span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">labelAlign</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">),</span>  <span class="c1"># Rotating row labels and aligning to the left</span>
        <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sort</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'A+'</span><span class="p">],</span>  <span class="c1"># Sorting rows based on 'Tier'</span>
        <span class="n">spacing</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Adding spacing between rows</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">transform_fold</span><span class="p">(</span>
    <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'% Accounts'</span><span class="p">,</span> <span class="s1">'% Revenue'</span><span class="p">],</span>  <span class="c1"># Transforming the data by folding the specified columns</span>
    <span class="n">as_</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'variable'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">]</span>  <span class="c1"># Renaming the folded columns to 'variable' and 'value'</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mi">200</span>  <span class="c1"># Setting the width of the chart</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Removing the stroke from the view</span>

<span class="n">merged_hor_bar</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[26]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-ec3f98e92d8848fcb5c26cc5fce95a02.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-ec3f98e92d8848fcb5c26cc5fce95a02.vega-embed details,
  #altair-viz-ec3f98e92d8848fcb5c26cc5fce95a02.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-ec3f98e92d8848fcb5c26cc5fce95a02"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-ec3f98e92d8848fcb5c26cc5fce95a02") {
      outputDiv = document.getElementById("altair-viz-ec3f98e92d8848fcb5c26cc5fce95a02");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "data": {"name": "data-35f9124c4b8dd7e8e6a83d69924ed8ee"}, "mark": {"type": "bar"}, "encoding": {"color": {"field": "variable", "legend": {"title": "Metric"}, "scale": {"range": ["#b4c6e4", "#4871b7"]}, "type": "nominal"}, "row": {"field": "Tier", "header": {"labelAlign": "left", "labelAngle": 0}, "sort": ["A+"], "spacing": 10, "title": null, "type": "ordinal"}, "x": {"axis": {"grid": false, "labelColor": "#888888", "orient": "top", "title": "TIER |  % OF TOTAL ACCOUNTS vs REVENUE", "titleColor": "#888888"}, "field": "value", "type": "quantitative"}, "y": {"axis": {"labels": false, "ticks": false, "title": null}, "field": "variable", "type": "nominal"}}, "title": {"text": "New client tier share", "fontSize": 20}, "transform": [{"fold": ["% Accounts", "% Revenue"], "as": ["variable", "value"]}], "width": 200, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-35f9124c4b8dd7e8e6a83d69924ed8ee": [{"Tier": "A+", "# of Accounts": 19.0, "% Accounts": 1.7463235294117647, "Revenue ($M)": 3.9269999999999996, "% Revenue": 21.0}, {"Tier": "A", "# of Accounts": 77.0, "% Accounts": 7.077205882352941, "Revenue ($M)": 4.675, "% Revenue": 25.0}, {"Tier": "B", "# of Accounts": 338.0, "% Accounts": 31.066176470588236, "Revenue ($M)": 5.984, "% Revenue": 32.0}, {"Tier": "C", "# of Accounts": 425.0, "% Accounts": 39.0625, "Revenue ($M)": 2.8049999999999997, "% Revenue": 15.0}, {"Tier": "D", "# of Accounts": 24.0, "% Accounts": 2.2058823529411766, "Revenue ($M)": 0.374, "% Revenue": 2.0}, {"Tier": "All other", "# of Accounts": 205.00000000000003, "% Accounts": 18.841911764705884, "Revenue ($M)": 0.935, "% Revenue": 5.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/2_1g.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Vertical-bar-chart">Vertical bar chart<a class="anchor-link" href="#Vertical-bar-chart"></a></h4><p>We should can modify the bar chart to be in a vertical orientation. This can be done by switching the y and x axis and the "Row" class to the "Column" class, as well as reorient the labels.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[27]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Creating a vertical bar chart</span>
<span class="n">vert_bar</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">table_charts</span><span class="p">,</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="s1">'New client tier share'</span><span class="p">,</span> <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>  <span class="c1"># Adding a title with specific font size</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
        <span class="s1">'value:Q'</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"% OF TOTAL ACCOUNTS vs REVENUE"</span><span class="p">,</span>  <span class="c1"># Setting a custom title for the y-axis</span>
            <span class="n">titleAlign</span> <span class="o">=</span> <span class="s1">'left'</span><span class="p">,</span>  <span class="c1"># Aligning the title to the left</span>
            <span class="n">titleAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># Setting the title angle to 0 degrees</span>
            <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s1">'end'</span><span class="p">,</span>  <span class="c1"># Anchoring the title to the end</span>
            <span class="n">titleY</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span>  <span class="c1"># Adjusting the title position</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># Turning off grid lines</span>
            <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>  <span class="c1"># Setting the label color to gray</span>
            <span class="n">titleColor</span> <span class="o">=</span> <span class="s1">'#888888'</span>  <span class="c1"># Setting the title color to gray</span>
        <span class="p">)</span>
    <span class="p">),</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s1">'variable:N'</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># Removing x-axis title, labels, and ticks</span>
    <span class="p">),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
        <span class="s1">'variable:N'</span><span class="p">,</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Legend</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">'Metric'</span><span class="p">),</span>  <span class="c1"># Adding a legend with a custom title</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'#b4c6e4'</span><span class="p">,</span> <span class="s1">'#4871b7'</span><span class="p">])</span>  <span class="c1"># Setting a custom color range</span>
    <span class="p">),</span>
    <span class="n">column</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span>
        <span class="s1">'Tier:O'</span><span class="p">,</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Header</span><span class="p">(</span><span class="n">labelOrient</span> <span class="o">=</span> <span class="s1">'bottom'</span><span class="p">,</span> <span class="n">titleOrient</span> <span class="o">=</span> <span class="s2">"bottom"</span><span class="p">,</span> <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">),</span> <span class="c1"># Adjusting column header settings</span>
        <span class="n">sort</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'A+'</span><span class="p">],</span>  <span class="c1"># Sorting columns based on 'Tier'</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">'TIER'</span>  <span class="c1"># Adding a title for the column</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">transform_fold</span><span class="p">(</span>
    <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'% Accounts'</span><span class="p">,</span> <span class="s1">'% Revenue'</span><span class="p">],</span>  <span class="c1"># Transforming the data by folding the specified columns</span>
    <span class="n">as_</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'variable'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">]</span>  <span class="c1"># Renaming the folded columns to 'variable' and 'value'</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Setting the width of the chart</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Removing the stroke from the view</span>

<span class="n">vert_bar</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[27]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-301f38e8336a4adfa8f3b8dff475d96a.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-301f38e8336a4adfa8f3b8dff475d96a.vega-embed details,
  #altair-viz-301f38e8336a4adfa8f3b8dff475d96a.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-301f38e8336a4adfa8f3b8dff475d96a"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-301f38e8336a4adfa8f3b8dff475d96a") {
      outputDiv = document.getElementById("altair-viz-301f38e8336a4adfa8f3b8dff475d96a");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "data": {"name": "data-35f9124c4b8dd7e8e6a83d69924ed8ee"}, "mark": {"type": "bar"}, "encoding": {"color": {"field": "variable", "legend": {"title": "Metric"}, "scale": {"range": ["#b4c6e4", "#4871b7"]}, "type": "nominal"}, "column": {"field": "Tier", "header": {"labelOrient": "bottom", "titleAnchor": "start", "titleOrient": "bottom"}, "sort": ["A+"], "title": "TIER", "type": "ordinal"}, "x": {"axis": {"labels": false, "ticks": false, "title": null}, "field": "variable", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "title": "% OF TOTAL ACCOUNTS vs REVENUE", "titleAlign": "left", "titleAnchor": "end", "titleAngle": 0, "titleColor": "#888888", "titleY": -10}, "field": "value", "type": "quantitative"}}, "title": {"text": "New client tier share", "fontSize": 20}, "transform": [{"fold": ["% Accounts", "% Revenue"], "as": ["variable", "value"]}], "width": 50, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-35f9124c4b8dd7e8e6a83d69924ed8ee": [{"Tier": "A+", "# of Accounts": 19.0, "% Accounts": 1.7463235294117647, "Revenue ($M)": 3.9269999999999996, "% Revenue": 21.0}, {"Tier": "A", "# of Accounts": 77.0, "% Accounts": 7.077205882352941, "Revenue ($M)": 4.675, "% Revenue": 25.0}, {"Tier": "B", "# of Accounts": 338.0, "% Accounts": 31.066176470588236, "Revenue ($M)": 5.984, "% Revenue": 32.0}, {"Tier": "C", "# of Accounts": 425.0, "% Accounts": 39.0625, "Revenue ($M)": 2.8049999999999997, "% Revenue": 15.0}, {"Tier": "D", "# of Accounts": 24.0, "% Accounts": 2.2058823529411766, "Revenue ($M)": 0.374, "% Revenue": 2.0}, {"Tier": "All other", "# of Accounts": 205.00000000000003, "% Accounts": 18.841911764705884, "Revenue ($M)": 0.935, "% Revenue": 5.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/2_1h.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>It's worth noting that titles in Altair do not readily support the option of changing the colors of individual words within them. As a simple solution for the time being, we will retain the legend that effectively indicates which column corresponds to each word.   Future exercises will delve into a more complicated way to tackle this challenge.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>In the code above, we've utilized the <code>transform_fold</code> method to generate the grouped bar chart because our data is structured in the 'wide form', which is the standard Excel format. However, Altair (as well as other visualization languages) is inherently designed to work with 'long form' data. The <code>transform_fold</code> function automates this conversion within the chart, enabling us to create the graph. This approach can obscure the process, making it preferable to perform the data transformation before creating the visualizations.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[28]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Transforms the data to the long-form format</span>

<span class="n">melted_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">table_charts</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Tier'</span><span class="p">],</span> <span class="n">var_name</span> <span class="o">=</span> <span class="s1">'Metric'</span><span class="p">,</span> <span class="n">value_name</span> <span class="o">=</span> <span class="s1">'Value'</span><span class="p">)</span>
<span class="n">melted_table</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[28]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Tier</th>
<th>Metric</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>A+</td>
<td># of Accounts</td>
<td>19.000000</td>
</tr>
<tr>
<th>1</th>
<td>A</td>
<td># of Accounts</td>
<td>77.000000</td>
</tr>
<tr>
<th>2</th>
<td>B</td>
<td># of Accounts</td>
<td>338.000000</td>
</tr>
<tr>
<th>3</th>
<td>C</td>
<td># of Accounts</td>
<td>425.000000</td>
</tr>
<tr>
<th>4</th>
<td>D</td>
<td># of Accounts</td>
<td>24.000000</td>
</tr>
<tr>
<th>5</th>
<td>All other</td>
<td># of Accounts</td>
<td>205.000000</td>
</tr>
<tr>
<th>6</th>
<td>A+</td>
<td>% Accounts</td>
<td>1.746324</td>
</tr>
<tr>
<th>7</th>
<td>A</td>
<td>% Accounts</td>
<td>7.077206</td>
</tr>
<tr>
<th>8</th>
<td>B</td>
<td>% Accounts</td>
<td>31.066176</td>
</tr>
<tr>
<th>9</th>
<td>C</td>
<td>% Accounts</td>
<td>39.062500</td>
</tr>
<tr>
<th>10</th>
<td>D</td>
<td>% Accounts</td>
<td>2.205882</td>
</tr>
<tr>
<th>11</th>
<td>All other</td>
<td>% Accounts</td>
<td>18.841912</td>
</tr>
<tr>
<th>12</th>
<td>A+</td>
<td>Revenue ($M)</td>
<td>3.927000</td>
</tr>
<tr>
<th>13</th>
<td>A</td>
<td>Revenue ($M)</td>
<td>4.675000</td>
</tr>
<tr>
<th>14</th>
<td>B</td>
<td>Revenue ($M)</td>
<td>5.984000</td>
</tr>
<tr>
<th>15</th>
<td>C</td>
<td>Revenue ($M)</td>
<td>2.805000</td>
</tr>
<tr>
<th>16</th>
<td>D</td>
<td>Revenue ($M)</td>
<td>0.374000</td>
</tr>
<tr>
<th>17</th>
<td>All other</td>
<td>Revenue ($M)</td>
<td>0.935000</td>
</tr>
<tr>
<th>18</th>
<td>A+</td>
<td>% Revenue</td>
<td>21.000000</td>
</tr>
<tr>
<th>19</th>
<td>A</td>
<td>% Revenue</td>
<td>25.000000</td>
</tr>
<tr>
<th>20</th>
<td>B</td>
<td>% Revenue</td>
<td>32.000000</td>
</tr>
<tr>
<th>21</th>
<td>C</td>
<td>% Revenue</td>
<td>15.000000</td>
</tr>
<tr>
<th>22</th>
<td>D</td>
<td>% Revenue</td>
<td>2.000000</td>
</tr>
<tr>
<th>23</th>
<td>All other</td>
<td>% Revenue</td>
<td>5.000000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>We can now use this table to remake the bar chart without the <code>transform_fold</code> method.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[29]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Selecting specific rows from the melted table based on the 'Metric' column</span>
<span class="n">selected_rows</span> <span class="o">=</span> <span class="n">melted_table</span><span class="p">[</span><span class="n">melted_table</span><span class="p">[</span><span class="s1">'Metric'</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">'% Accounts'</span><span class="p">,</span> <span class="s1">'% Revenue'</span><span class="p">])]</span>

<span class="n">vert_bar2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">selected_rows</span><span class="p">,</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="s1">'New client tier share'</span><span class="p">,</span> <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>  <span class="c1"># Adding a title with specific font size</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
        <span class="s1">'Value'</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"% OF TOTAL ACCOUNTS vs REVENUE"</span><span class="p">,</span>  <span class="c1"># Setting a custom title for the y-axis</span>
            <span class="n">titleAlign</span> <span class="o">=</span> <span class="s1">'left'</span><span class="p">,</span>  <span class="c1"># Aligning the title to the left</span>
            <span class="n">titleAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># Setting the title angle to 0 degrees</span>
            <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s1">'end'</span><span class="p">,</span>  <span class="c1"># Anchoring the title to the end</span>
            <span class="n">titleY</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span>  <span class="c1"># Adjusting the title position</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># Turning off grid lines</span>
            <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>  <span class="c1"># Setting the label color to gray</span>
            <span class="n">titleColor</span> <span class="o">=</span> <span class="s1">'#888888'</span>  <span class="c1"># Setting the title color to gray</span>
        <span class="p">)</span>
    <span class="p">),</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s1">'Metric'</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># Removing x-axis labels and ticks</span>
    <span class="p">),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
        <span class="s1">'Metric'</span><span class="p">,</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'#b4c6e4'</span><span class="p">,</span> <span class="s1">'#4871b7'</span><span class="p">])</span>  <span class="c1"># Setting a custom color range</span>
    <span class="p">),</span>
    <span class="n">column</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span>
        <span class="s1">'Tier'</span><span class="p">,</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Header</span><span class="p">(</span><span class="n">labelOrient</span><span class="o">=</span><span class="s1">'bottom'</span><span class="p">,</span> <span class="n">titleOrient</span><span class="o">=</span><span class="s2">"bottom"</span><span class="p">,</span> <span class="n">titleAnchor</span><span class="o">=</span><span class="s2">"start"</span><span class="p">),</span>  <span class="c1"># Adjusting column header settings</span>
        <span class="n">sort</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'A+'</span><span class="p">],</span>  <span class="c1"># Sorting columns based on 'Tier'</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">'TIER'</span>  <span class="c1"># Adding a title for the column</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">height</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Setting the height and width of the chart</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Removing the stroke from the view</span>

<span class="n">vert_bar2</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[29]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-d2deb92ad30347089f9af34a80025043.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-d2deb92ad30347089f9af34a80025043.vega-embed details,
  #altair-viz-d2deb92ad30347089f9af34a80025043.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-d2deb92ad30347089f9af34a80025043"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-d2deb92ad30347089f9af34a80025043") {
      outputDiv = document.getElementById("altair-viz-d2deb92ad30347089f9af34a80025043");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "data": {"name": "data-bb1464c1645767b6ef3368e1fe4c14d1"}, "mark": {"type": "bar"}, "encoding": {"color": {"field": "Metric", "scale": {"range": ["#b4c6e4", "#4871b7"]}, "type": "nominal"}, "column": {"field": "Tier", "header": {"labelOrient": "bottom", "titleAnchor": "start", "titleOrient": "bottom"}, "sort": ["A+"], "title": "TIER", "type": "nominal"}, "x": {"axis": {"labels": false, "ticks": false, "title": null}, "field": "Metric", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "title": "% OF TOTAL ACCOUNTS vs REVENUE", "titleAlign": "left", "titleAnchor": "end", "titleAngle": 0, "titleColor": "#888888", "titleY": -10}, "field": "Value", "type": "quantitative"}}, "height": 200, "title": {"text": "New client tier share", "fontSize": 20}, "width": 50, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-bb1464c1645767b6ef3368e1fe4c14d1": [{"Tier": "A+", "Metric": "% Accounts", "Value": 1.7463235294117647}, {"Tier": "A", "Metric": "% Accounts", "Value": 7.077205882352941}, {"Tier": "B", "Metric": "% Accounts", "Value": 31.066176470588236}, {"Tier": "C", "Metric": "% Accounts", "Value": 39.0625}, {"Tier": "D", "Metric": "% Accounts", "Value": 2.2058823529411766}, {"Tier": "All other", "Metric": "% Accounts", "Value": 18.841911764705884}, {"Tier": "A+", "Metric": "% Revenue", "Value": 21.0}, {"Tier": "A", "Metric": "% Revenue", "Value": 25.0}, {"Tier": "B", "Metric": "% Revenue", "Value": 32.0}, {"Tier": "C", "Metric": "% Revenue", "Value": 15.0}, {"Tier": "D", "Metric": "% Revenue", "Value": 2.0}, {"Tier": "All other", "Metric": "% Revenue", "Value": 5.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Bar-chart-with-lines">Bar chart with lines<a class="anchor-link" href="#Bar-chart-with-lines"></a></h4><p>The next proposed graph is an extension of the previous bar chart, featuring the addition of lines to accentuate the endpoints of the columns within the same tier.</p>
<p>However, due to the nature of faceted charts, we encounter an error (<em>ValueError: Faceted charts cannot be layered. Instead, layer the charts before faceting</em>) when attempting to layer it. This issue arises because, in faceted charts, the x-axis structure is altered.</p>
<p>Now that we've transformed our data into long-format, we can work around this problem by creating our graph without using the 'column' method, and thereby, avoiding faceting. Instead of specifying 'x' as 'Metric,' 'y' as 'Value,' 'color' as 'Metric,' and 'column' as 'Tier,' we can redefine 'x' as 'Tier,' 'y' as 'Value,' 'color' as 'Metric,' and introduce 'XOffset' for controlling the horizontal positioning of data points within a group. In essence, 'column' primarily serves to define distinct x-axis categories, while 'XOffset' is employed to manage the horizontal placement of data points within a group.</p>
<p>The following chart incorporates the alterations we discussed and yields a graph that closely resembles the previous one.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[30]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">bar</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">selected_rows</span><span class="p">,</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="s1">'New client tier share'</span><span class="p">,</span> <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s1">'start'</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s1">'Tier'</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">'TIER'</span><span class="p">,</span>  <span class="c1"># Setting a custom title for the x-axis</span>
            <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># Setting the label angle to 0 degrees</span>
            <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>  <span class="c1"># Anchoring the title to the start</span>
            <span class="n">domain</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># Hiding the x-axis domain line</span>
            <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Hiding the x-axis ticks</span>
        <span class="p">),</span>
        <span class="n">sort</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'A+'</span><span class="p">]</span>  <span class="c1"># Sorting x-axis based on 'Tier'</span>
    <span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
        <span class="s1">'Value'</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"% OF TOTAL ACCOUNTS vs REVENUE"</span><span class="p">,</span>  <span class="c1"># Setting a custom title for the y-axis</span>
            <span class="n">titleAlign</span> <span class="o">=</span> <span class="s1">'left'</span><span class="p">,</span>  <span class="c1"># Aligning the title to the left</span>
            <span class="n">titleAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1"># Setting the title angle to 0 degrees</span>
            <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s1">'end'</span><span class="p">,</span>  <span class="c1"># Anchoring the title to the end</span>
            <span class="n">titleY</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span>  <span class="c1"># Adjusting the title position</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># Turning off grid lines</span>
            <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>  <span class="c1"># Setting the label color to gray</span>
            <span class="n">titleColor</span> <span class="o">=</span><span class="s1">' #888888'</span>  <span class="c1"># Setting the title color to gray</span>
        <span class="p">)</span>
    <span class="p">),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
        <span class="s1">'Metric'</span><span class="p">,</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'#b4c6e4'</span><span class="p">,</span> <span class="s1">'#4871b7'</span><span class="p">])</span>  <span class="c1"># Setting a custom color range</span>
    <span class="p">),</span>
    <span class="n">xOffset</span> <span class="o">=</span> <span class="s1">'Metric'</span>  <span class="c1"># Adjusting the x-offset</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">height</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">375</span>  <span class="c1"># Setting the height and width of the chart</span>
<span class="p">)</span>

<span class="n">bar</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Removing the stroke from the view</span>

<span class="n">bar</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[30]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-b5caa07a0e79453ea434bab877f9b04d.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-b5caa07a0e79453ea434bab877f9b04d.vega-embed details,
  #altair-viz-b5caa07a0e79453ea434bab877f9b04d.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-b5caa07a0e79453ea434bab877f9b04d"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-b5caa07a0e79453ea434bab877f9b04d") {
      outputDiv = document.getElementById("altair-viz-b5caa07a0e79453ea434bab877f9b04d");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-bb1464c1645767b6ef3368e1fe4c14d1"}, "mark": {"type": "bar"}, "encoding": {"color": {"field": "Metric", "scale": {"range": ["#b4c6e4", "#4871b7"]}, "type": "nominal"}, "x": {"axis": {"domain": false, "labelAngle": 0, "ticks": false, "title": "TIER", "titleAnchor": "start"}, "field": "Tier", "sort": ["A+"], "type": "nominal"}, "xOffset": {"field": "Metric", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "title": "% OF TOTAL ACCOUNTS vs REVENUE", "titleAlign": "left", "titleAnchor": "end", "titleAngle": 0, "titleColor": " #888888", "titleY": -10}, "field": "Value", "type": "quantitative"}}, "height": 250, "title": {"text": "New client tier share", "anchor": "start", "fontSize": 20}, "width": 375, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-bb1464c1645767b6ef3368e1fe4c14d1": [{"Tier": "A+", "Metric": "% Accounts", "Value": 1.7463235294117647}, {"Tier": "A", "Metric": "% Accounts", "Value": 7.077205882352941}, {"Tier": "B", "Metric": "% Accounts", "Value": 31.066176470588236}, {"Tier": "C", "Metric": "% Accounts", "Value": 39.0625}, {"Tier": "D", "Metric": "% Accounts", "Value": 2.2058823529411766}, {"Tier": "All other", "Metric": "% Accounts", "Value": 18.841911764705884}, {"Tier": "A+", "Metric": "% Revenue", "Value": 21.0}, {"Tier": "A", "Metric": "% Revenue", "Value": 25.0}, {"Tier": "B", "Metric": "% Revenue", "Value": 32.0}, {"Tier": "C", "Metric": "% Revenue", "Value": 15.0}, {"Tier": "D", "Metric": "% Revenue", "Value": 2.0}, {"Tier": "All other", "Metric": "% Revenue", "Value": 5.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Now, we can layer the graph and introduce the lines. It's worth noting that creating the lines in Altair is not a straightforward task and a considerable amount of documentation searching was necessary to achieve it.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[31]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># x, y and y2 do not accept to be defined as "condition", so repetitive code is necessary</span>

<span class="c1"># Create a vertical rule chart for ascending lines</span>
<span class="n">rule_asc</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">selected_rows</span><span class="p">)</span><span class="o">.</span><span class="n">mark_rule</span><span class="p">(</span><span class="n">x2Offset</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">xOffset</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'Tier'</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'A+'</span><span class="p">]),</span>  <span class="c1"># X-axis encoding for 'Tier', sorted in a specific order</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X2</span><span class="p">(</span><span class="s1">'Tier'</span><span class="p">),</span>  <span class="c1"># End point of the rule line</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'min(Value)'</span><span class="p">),</span>  <span class="c1"># Start point of the rule line</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y2</span><span class="p">(</span><span class="s1">'max(Value)'</span><span class="p">),</span>  <span class="c1"># End point of the rule line</span>
    <span class="n">strokeWidth</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>  <span class="c1"># Set the stroke width of the rule line</span>
    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
        <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">==</span> <span class="s1">'A+'</span><span class="p">)</span> <span class="o">|</span>  <span class="c1"># Condition for specific tiers</span>
        <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">==</span> <span class="s1">'A'</span><span class="p">)</span> <span class="o">|</span>   <span class="c1"># to determine opacity settings</span>
        <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">==</span> <span class="s1">'B'</span><span class="p">),</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Opacity set to 1 if condition is met, else 0</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Create a vertical rule chart for descending lines</span>
<span class="n">rule_desc</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">selected_rows</span><span class="p">)</span><span class="o">.</span><span class="n">mark_rule</span><span class="p">(</span><span class="n">x2Offset</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">xOffset</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>
<span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'Tier'</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'A+'</span><span class="p">]),</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X2</span><span class="p">(</span><span class="s1">'Tier'</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'max(Value)'</span><span class="p">),</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y2</span><span class="p">(</span><span class="s1">'min(Value)'</span><span class="p">),</span>
    <span class="n">strokeWidth</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> 
    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
        <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">==</span> <span class="s1">'A+'</span><span class="p">)</span> <span class="o">|</span> 
        <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">==</span> <span class="s1">'A'</span><span class="p">)</span>  <span class="o">|</span>
        <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">==</span> <span class="s1">'B'</span><span class="p">),</span> 
        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Points of % Revenue where % Revenue &gt; % Accounts</span>
<span class="n">points1</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">selected_rows</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">xOffset</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'Tier'</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'A+'</span><span class="p">]),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'max(Value)'</span><span class="p">),</span>
    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
        <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">==</span> <span class="s1">'A+'</span><span class="p">)</span> <span class="o">|</span> 
        <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">==</span> <span class="s1">'A'</span><span class="p">)</span>  <span class="o">|</span>
        <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">==</span> <span class="s1">'B'</span><span class="p">),</span> 
        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Points of % Revenue where % Revenue &lt; % Accounts</span>
<span class="n">points2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">selected_rows</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">xOffset</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'Tier'</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'A+'</span><span class="p">]),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'min(Value)'</span><span class="p">),</span>
    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
        <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">==</span> <span class="s1">'A+'</span><span class="p">)</span> <span class="o">|</span> 
        <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">==</span> <span class="s1">'A'</span><span class="p">)</span>  <span class="o">|</span>
        <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">==</span> <span class="s1">'B'</span><span class="p">),</span> 
        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Points of % Accounts where % Revenue &lt; % Accounts</span>
<span class="n">points3</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">selected_rows</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">xOffset</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'Tier'</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'A+'</span><span class="p">]),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'max(Value)'</span><span class="p">),</span>
    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
        <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">==</span> <span class="s1">'A+'</span><span class="p">)</span> <span class="o">|</span> 
        <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">==</span> <span class="s1">'A'</span><span class="p">)</span>  <span class="o">|</span>
        <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">==</span> <span class="s1">'B'</span><span class="p">),</span> 
        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Points of % Revenue where % Revenue &gt; % Accounts</span>
<span class="n">points4</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">selected_rows</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">xOffset</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'Tier'</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'A+'</span><span class="p">]),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'min(Value)'</span><span class="p">),</span>
    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
        <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">==</span> <span class="s1">'A+'</span><span class="p">)</span> <span class="o">|</span> 
        <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">==</span> <span class="s1">'A'</span><span class="p">)</span>  <span class="o">|</span>
        <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">==</span> <span class="s1">'B'</span><span class="p">),</span> 
        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="n">bar_point</span> <span class="o">=</span> <span class="n">bar</span> <span class="o">+</span> <span class="n">rule_asc</span> <span class="o">+</span> <span class="n">rule_desc</span> <span class="o">+</span> <span class="n">points1</span> <span class="o">+</span> <span class="n">points2</span> <span class="o">+</span> <span class="n">points3</span> <span class="o">+</span> <span class="n">points4</span>
<span class="n">bar_point</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[31]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-42b831d457924360acad8375e33a0580.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-42b831d457924360acad8375e33a0580.vega-embed details,
  #altair-viz-42b831d457924360acad8375e33a0580.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-42b831d457924360acad8375e33a0580"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-42b831d457924360acad8375e33a0580") {
      outputDiv = document.getElementById("altair-viz-42b831d457924360acad8375e33a0580");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "bar"}, "encoding": {"color": {"field": "Metric", "scale": {"range": ["#b4c6e4", "#4871b7"]}, "type": "nominal"}, "x": {"axis": {"domain": false, "labelAngle": 0, "ticks": false, "title": "TIER", "titleAnchor": "start"}, "field": "Tier", "sort": ["A+"], "type": "nominal"}, "xOffset": {"field": "Metric", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "title": "% OF TOTAL ACCOUNTS vs REVENUE", "titleAlign": "left", "titleAnchor": "end", "titleAngle": 0, "titleColor": " #888888", "titleY": -10}, "field": "Value", "type": "quantitative"}}, "title": {"text": "New client tier share", "anchor": "start", "fontSize": 20}}, {"mark": {"type": "rule", "x2Offset": 10, "xOffset": -10}, "encoding": {"opacity": {"condition": {"test": "(((datum.Tier === 'A+') || (datum.Tier === 'A')) || (datum.Tier === 'B'))", "value": 1}, "value": 0}, "strokeWidth": {"value": 2}, "x": {"field": "Tier", "sort": ["A+"], "type": "nominal"}, "x2": {"field": "Tier"}, "y": {"aggregate": "min", "field": "Value", "type": "quantitative"}, "y2": {"aggregate": "max", "field": "Value"}}}, {"mark": {"type": "rule", "x2Offset": 10, "xOffset": -10}, "encoding": {"opacity": {"condition": {"test": "(((datum.Tier === 'A+') || (datum.Tier === 'A')) || (datum.Tier === 'B'))", "value": 0}, "value": 1}, "strokeWidth": {"value": 2}, "x": {"field": "Tier", "sort": ["A+"], "type": "nominal"}, "x2": {"field": "Tier"}, "y": {"aggregate": "max", "field": "Value", "type": "quantitative"}, "y2": {"aggregate": "min", "field": "Value"}}}, {"mark": {"type": "point", "color": "black", "filled": true, "xOffset": 10}, "encoding": {"opacity": {"condition": {"test": "(((datum.Tier === 'A+') || (datum.Tier === 'A')) || (datum.Tier === 'B'))", "value": 1}, "value": 0}, "x": {"field": "Tier", "sort": ["A+"], "type": "nominal"}, "y": {"aggregate": "max", "field": "Value", "type": "quantitative"}}}, {"mark": {"type": "point", "color": "black", "filled": true, "xOffset": 10}, "encoding": {"opacity": {"condition": {"test": "(((datum.Tier === 'A+') || (datum.Tier === 'A')) || (datum.Tier === 'B'))", "value": 0}, "value": 1}, "x": {"field": "Tier", "sort": ["A+"], "type": "nominal"}, "y": {"aggregate": "min", "field": "Value", "type": "quantitative"}}}, {"mark": {"type": "point", "color": "black", "filled": true, "xOffset": -10}, "encoding": {"opacity": {"condition": {"test": "(((datum.Tier === 'A+') || (datum.Tier === 'A')) || (datum.Tier === 'B'))", "value": 0}, "value": 1}, "x": {"field": "Tier", "sort": ["A+"], "type": "nominal"}, "y": {"aggregate": "max", "field": "Value", "type": "quantitative"}}}, {"mark": {"type": "point", "color": "black", "filled": true, "xOffset": -10}, "encoding": {"opacity": {"condition": {"test": "(((datum.Tier === 'A+') || (datum.Tier === 'A')) || (datum.Tier === 'B'))", "value": 1}, "value": 0}, "x": {"field": "Tier", "sort": ["A+"], "type": "nominal"}, "y": {"aggregate": "min", "field": "Value", "type": "quantitative"}}}], "data": {"name": "data-bb1464c1645767b6ef3368e1fe4c14d1"}, "height": 250, "width": 375, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-bb1464c1645767b6ef3368e1fe4c14d1": [{"Tier": "A+", "Metric": "% Accounts", "Value": 1.7463235294117647}, {"Tier": "A", "Metric": "% Accounts", "Value": 7.077205882352941}, {"Tier": "B", "Metric": "% Accounts", "Value": 31.066176470588236}, {"Tier": "C", "Metric": "% Accounts", "Value": 39.0625}, {"Tier": "D", "Metric": "% Accounts", "Value": 2.2058823529411766}, {"Tier": "All other", "Metric": "% Accounts", "Value": 18.841911764705884}, {"Tier": "A+", "Metric": "% Revenue", "Value": 21.0}, {"Tier": "A", "Metric": "% Revenue", "Value": 25.0}, {"Tier": "B", "Metric": "% Revenue", "Value": 32.0}, {"Tier": "C", "Metric": "% Revenue", "Value": 15.0}, {"Tier": "D", "Metric": "% Revenue", "Value": 2.0}, {"Tier": "All other", "Metric": "% Revenue", "Value": 5.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/2_1i.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Lines-only">Lines only<a class="anchor-link" href="#Lines-only"></a></h4><p>With two types of visualizations displaying the same data, the book suggests to eliminate the bars altogether. This can be done without the need to program more graphs:</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[32]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Configure the legend to be disabled (hidden)</span>
<span class="c1"># The 'opacity' configuration is set to 0, making the bars transparent</span>
<span class="n">point</span> <span class="o">=</span> <span class="n">bar_point</span><span class="o">.</span><span class="n">configure_mark</span><span class="p">(</span><span class="n">opacity</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">configure_legend</span><span class="p">(</span><span class="n">disable</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">point</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[32]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-79f4468797454687a7b4d55dab957328.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-79f4468797454687a7b4d55dab957328.vega-embed details,
  #altair-viz-79f4468797454687a7b4d55dab957328.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-79f4468797454687a7b4d55dab957328"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-79f4468797454687a7b4d55dab957328") {
      outputDiv = document.getElementById("altair-viz-79f4468797454687a7b4d55dab957328");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}, "legend": {"disable": true}, "mark": {"opacity": 0}}, "layer": [{"mark": {"type": "bar"}, "encoding": {"color": {"field": "Metric", "scale": {"range": ["#b4c6e4", "#4871b7"]}, "type": "nominal"}, "x": {"axis": {"domain": false, "labelAngle": 0, "ticks": false, "title": "TIER", "titleAnchor": "start"}, "field": "Tier", "sort": ["A+"], "type": "nominal"}, "xOffset": {"field": "Metric", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "title": "% OF TOTAL ACCOUNTS vs REVENUE", "titleAlign": "left", "titleAnchor": "end", "titleAngle": 0, "titleColor": " #888888", "titleY": -10}, "field": "Value", "type": "quantitative"}}, "title": {"text": "New client tier share", "anchor": "start", "fontSize": 20}}, {"mark": {"type": "rule", "x2Offset": 10, "xOffset": -10}, "encoding": {"opacity": {"condition": {"test": "(((datum.Tier === 'A+') || (datum.Tier === 'A')) || (datum.Tier === 'B'))", "value": 1}, "value": 0}, "strokeWidth": {"value": 2}, "x": {"field": "Tier", "sort": ["A+"], "type": "nominal"}, "x2": {"field": "Tier"}, "y": {"aggregate": "min", "field": "Value", "type": "quantitative"}, "y2": {"aggregate": "max", "field": "Value"}}}, {"mark": {"type": "rule", "x2Offset": 10, "xOffset": -10}, "encoding": {"opacity": {"condition": {"test": "(((datum.Tier === 'A+') || (datum.Tier === 'A')) || (datum.Tier === 'B'))", "value": 0}, "value": 1}, "strokeWidth": {"value": 2}, "x": {"field": "Tier", "sort": ["A+"], "type": "nominal"}, "x2": {"field": "Tier"}, "y": {"aggregate": "max", "field": "Value", "type": "quantitative"}, "y2": {"aggregate": "min", "field": "Value"}}}, {"mark": {"type": "point", "color": "black", "filled": true, "xOffset": 10}, "encoding": {"opacity": {"condition": {"test": "(((datum.Tier === 'A+') || (datum.Tier === 'A')) || (datum.Tier === 'B'))", "value": 1}, "value": 0}, "x": {"field": "Tier", "sort": ["A+"], "type": "nominal"}, "y": {"aggregate": "max", "field": "Value", "type": "quantitative"}}}, {"mark": {"type": "point", "color": "black", "filled": true, "xOffset": 10}, "encoding": {"opacity": {"condition": {"test": "(((datum.Tier === 'A+') || (datum.Tier === 'A')) || (datum.Tier === 'B'))", "value": 0}, "value": 1}, "x": {"field": "Tier", "sort": ["A+"], "type": "nominal"}, "y": {"aggregate": "min", "field": "Value", "type": "quantitative"}}}, {"mark": {"type": "point", "color": "black", "filled": true, "xOffset": -10}, "encoding": {"opacity": {"condition": {"test": "(((datum.Tier === 'A+') || (datum.Tier === 'A')) || (datum.Tier === 'B'))", "value": 0}, "value": 1}, "x": {"field": "Tier", "sort": ["A+"], "type": "nominal"}, "y": {"aggregate": "max", "field": "Value", "type": "quantitative"}}}, {"mark": {"type": "point", "color": "black", "filled": true, "xOffset": -10}, "encoding": {"opacity": {"condition": {"test": "(((datum.Tier === 'A+') || (datum.Tier === 'A')) || (datum.Tier === 'B'))", "value": 1}, "value": 0}, "x": {"field": "Tier", "sort": ["A+"], "type": "nominal"}, "y": {"aggregate": "min", "field": "Value", "type": "quantitative"}}}], "data": {"name": "data-bb1464c1645767b6ef3368e1fe4c14d1"}, "height": 250, "width": 375, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-bb1464c1645767b6ef3368e1fe4c14d1": [{"Tier": "A+", "Metric": "% Accounts", "Value": 1.7463235294117647}, {"Tier": "A", "Metric": "% Accounts", "Value": 7.077205882352941}, {"Tier": "B", "Metric": "% Accounts", "Value": 31.066176470588236}, {"Tier": "C", "Metric": "% Accounts", "Value": 39.0625}, {"Tier": "D", "Metric": "% Accounts", "Value": 2.2058823529411766}, {"Tier": "All other", "Metric": "% Accounts", "Value": 18.841911764705884}, {"Tier": "A+", "Metric": "% Revenue", "Value": 21.0}, {"Tier": "A", "Metric": "% Revenue", "Value": 25.0}, {"Tier": "B", "Metric": "% Revenue", "Value": 32.0}, {"Tier": "C", "Metric": "% Revenue", "Value": 15.0}, {"Tier": "D", "Metric": "% Revenue", "Value": 2.0}, {"Tier": "All other", "Metric": "% Revenue", "Value": 5.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/2_1j.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Slope-graph">Slope graph<a class="anchor-link" href="#Slope-graph"></a></h4><p>At last, we can reassemble the lines to create a slope graph.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[33]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Create base chart, setting the title</span>
<span class="n">base</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">selected_rows</span><span class="p">,</span> 
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="s2">"New client tier share"</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s1">'start'</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s1">'normal'</span><span class="p">,</span> <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Line chart configuration</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span>
    <span class="n">point</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># The lines have points at the end</span>
<span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s1">'Metric'</span><span class="p">,</span> 
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">domain</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Value'</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
        <span class="s1">'Tier'</span><span class="p">,</span> 
        <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'black'</span><span class="p">]),</span> <span class="c1"># All Tier lines are black</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
    <span class="n">height</span> <span class="o">=</span> <span class="mi">350</span>
<span class="p">)</span>

<span class="c1"># Labels to the right of the slope</span>
<span class="c1"># These labels are for the Accounts</span>
<span class="n">labels1</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span>
    <span class="n">align</span> <span class="o">=</span> <span class="s1">'left'</span><span class="p">,</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mi">10</span>
<span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'Metric'</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Value'</span><span class="p">),</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s1">'Value:Q'</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">'.0f'</span><span class="p">),</span>
    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Metric</span> <span class="o">==</span> <span class="s1">'% Accounts'</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.7</span><span class="p">))</span> 
<span class="p">)</span>

<span class="c1"># Labels to the left of the slope</span>
<span class="c1"># These labels are for the Revenue</span>
<span class="n">labels2</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span>
    <span class="n">align</span> <span class="o">=</span><span class="s1">'left'</span><span class="p">,</span> 
    <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span>
<span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'Metric'</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Value'</span><span class="p">),</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s1">'Value:Q'</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">'.0f'</span><span class="p">),</span>
    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Metric</span> <span class="o">==</span> <span class="s1">'% Accounts'</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.7</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> 
<span class="p">)</span>

<span class="c1"># Labels for the Tiers</span>
<span class="n">tier_labels</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span>
    <span class="n">align</span> <span class="o">=</span> <span class="s1">'left'</span><span class="p">,</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
    <span class="n">fontWeight</span> <span class="o">=</span> <span class="s1">'bold'</span>
<span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'Metric'</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Value'</span><span class="p">),</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s1">'Tier'</span><span class="p">,</span>
    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Metric</span> <span class="o">==</span> <span class="s1">'% Accounts'</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="c1"># Show in only one side</span>
<span class="p">)</span>

<span class="c1"># Tier title</span>
<span class="n">tier_title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span>  <span class="p">[</span><span class="s1">'TIER'</span><span class="p">]}]}</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span>
            <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> 
            <span class="n">dx</span> <span class="o">=</span> <span class="mi">105</span><span class="p">,</span> 
            <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">120</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s1">'bold'</span>
<span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>

<span class="n">slope</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">labels1</span> <span class="o">+</span> <span class="n">labels2</span> <span class="o">+</span> <span class="n">tier_labels</span> <span class="o">+</span> <span class="n">tier_title</span>
<span class="n">slope</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[33]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-5c6cb1d2d447432a88a96567a5833f0d.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-5c6cb1d2d447432a88a96567a5833f0d.vega-embed details,
  #altair-viz-5c6cb1d2d447432a88a96567a5833f0d.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-5c6cb1d2d447432a88a96567a5833f0d"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-5c6cb1d2d447432a88a96567a5833f0d") {
      outputDiv = document.getElementById("altair-viz-5c6cb1d2d447432a88a96567a5833f0d");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "point": true}, "encoding": {"color": {"field": "Tier", "legend": null, "scale": {"range": ["black"]}, "type": "nominal"}, "x": {"axis": {"domain": false, "labelAngle": 0, "ticks": false, "title": null}, "field": "Metric", "type": "nominal"}, "y": {"axis": null, "field": "Value", "type": "quantitative"}}, "title": {"text": "New client tier share", "anchor": "start", "fontSize": 20, "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "dx": 10}, "encoding": {"opacity": {"condition": {"test": "(datum.Metric === '% Accounts')", "value": 0}, "value": 0.7}, "text": {"field": "Value", "format": ".0f", "type": "quantitative"}, "x": {"field": "Metric", "type": "nominal"}, "y": {"field": "Value", "type": "quantitative"}}, "title": {"text": "New client tier share", "anchor": "start", "fontSize": 20, "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "dx": -20}, "encoding": {"opacity": {"condition": {"test": "(datum.Metric === '% Accounts')", "value": 0.7}, "value": 0}, "text": {"field": "Value", "format": ".0f", "type": "quantitative"}, "x": {"field": "Metric", "type": "nominal"}, "y": {"field": "Value", "type": "quantitative"}}, "title": {"text": "New client tier share", "anchor": "start", "fontSize": 20, "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "dx": 30, "fontWeight": "bold"}, "encoding": {"opacity": {"condition": {"test": "(datum.Metric === '% Accounts')", "value": 0}, "value": 1}, "text": {"field": "Tier", "type": "nominal"}, "x": {"field": "Metric", "type": "nominal"}, "y": {"field": "Value", "type": "quantitative"}}, "title": {"text": "New client tier share", "anchor": "start", "fontSize": 20, "fontWeight": "normal"}}, {"data": {"name": "data-8f4bbff9b538b2ed473c08d9b93ac2ac"}, "mark": {"type": "text", "align": "left", "dx": 105, "dy": -120, "fontWeight": "bold"}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "data": {"name": "data-bb1464c1645767b6ef3368e1fe4c14d1"}, "height": 350, "width": 300, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-bb1464c1645767b6ef3368e1fe4c14d1": [{"Tier": "A+", "Metric": "% Accounts", "Value": 1.7463235294117647}, {"Tier": "A", "Metric": "% Accounts", "Value": 7.077205882352941}, {"Tier": "B", "Metric": "% Accounts", "Value": 31.066176470588236}, {"Tier": "C", "Metric": "% Accounts", "Value": 39.0625}, {"Tier": "D", "Metric": "% Accounts", "Value": 2.2058823529411766}, {"Tier": "All other", "Metric": "% Accounts", "Value": 18.841911764705884}, {"Tier": "A+", "Metric": "% Revenue", "Value": 21.0}, {"Tier": "A", "Metric": "% Revenue", "Value": 25.0}, {"Tier": "B", "Metric": "% Revenue", "Value": 32.0}, {"Tier": "C", "Metric": "% Revenue", "Value": 15.0}, {"Tier": "D", "Metric": "% Revenue", "Value": 2.0}, {"Tier": "All other", "Metric": "% Revenue", "Value": 5.0}], "data-8f4bbff9b538b2ed473c08d9b93ac2ac": [{"text": ["TIER"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Notice how there are two numbers overlapping, the percentage of accounts of the A+ and D tiers. Since they are the same number when rounded, we can just eliminate one of the values display.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[34]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Eliminate Tier A+ from display</span>
<span class="n">label_condition</span> <span class="o">=</span> <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Metric</span> <span class="o">==</span> <span class="s1">'% Accounts'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Tier</span> <span class="o">!=</span> <span class="s1">'A+'</span><span class="p">)</span>


<span class="n">labels2</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span>
    <span class="n">align</span> <span class="o">=</span><span class="s1">'left'</span><span class="p">,</span> 
    <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span>
<span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'Metric'</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Value'</span><span class="p">),</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s1">'Value:Q'</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">'.0f'</span><span class="p">),</span>
    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">label_condition</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.7</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> 
<span class="p">)</span>

<span class="n">slope</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">labels1</span> <span class="o">+</span> <span class="n">labels2</span> <span class="o">+</span> <span class="n">tier_labels</span> <span class="o">+</span> <span class="n">tier_title</span>
<span class="n">slope</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[34]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-c4853df79f5e4da69c0a2388f4eef3d4.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-c4853df79f5e4da69c0a2388f4eef3d4.vega-embed details,
  #altair-viz-c4853df79f5e4da69c0a2388f4eef3d4.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-c4853df79f5e4da69c0a2388f4eef3d4"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-c4853df79f5e4da69c0a2388f4eef3d4") {
      outputDiv = document.getElementById("altair-viz-c4853df79f5e4da69c0a2388f4eef3d4");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "point": true}, "encoding": {"color": {"field": "Tier", "legend": null, "scale": {"range": ["black"]}, "type": "nominal"}, "x": {"axis": {"domain": false, "labelAngle": 0, "ticks": false, "title": null}, "field": "Metric", "type": "nominal"}, "y": {"axis": null, "field": "Value", "type": "quantitative"}}, "title": {"text": "New client tier share", "anchor": "start", "fontSize": 20, "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "dx": 10}, "encoding": {"opacity": {"condition": {"test": "(datum.Metric === '% Accounts')", "value": 0}, "value": 0.7}, "text": {"field": "Value", "format": ".0f", "type": "quantitative"}, "x": {"field": "Metric", "type": "nominal"}, "y": {"field": "Value", "type": "quantitative"}}, "title": {"text": "New client tier share", "anchor": "start", "fontSize": 20, "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "dx": -20}, "encoding": {"opacity": {"condition": {"test": "((datum.Metric === '% Accounts') && (datum.Tier !== 'A+'))", "value": 0.7}, "value": 0}, "text": {"field": "Value", "format": ".0f", "type": "quantitative"}, "x": {"field": "Metric", "type": "nominal"}, "y": {"field": "Value", "type": "quantitative"}}, "title": {"text": "New client tier share", "anchor": "start", "fontSize": 20, "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "dx": 30, "fontWeight": "bold"}, "encoding": {"opacity": {"condition": {"test": "(datum.Metric === '% Accounts')", "value": 0}, "value": 1}, "text": {"field": "Tier", "type": "nominal"}, "x": {"field": "Metric", "type": "nominal"}, "y": {"field": "Value", "type": "quantitative"}}, "title": {"text": "New client tier share", "anchor": "start", "fontSize": 20, "fontWeight": "normal"}}, {"data": {"name": "data-8f4bbff9b538b2ed473c08d9b93ac2ac"}, "mark": {"type": "text", "align": "left", "dx": 105, "dy": -120, "fontWeight": "bold"}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "data": {"name": "data-bb1464c1645767b6ef3368e1fe4c14d1"}, "height": 350, "width": 300, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-bb1464c1645767b6ef3368e1fe4c14d1": [{"Tier": "A+", "Metric": "% Accounts", "Value": 1.7463235294117647}, {"Tier": "A", "Metric": "% Accounts", "Value": 7.077205882352941}, {"Tier": "B", "Metric": "% Accounts", "Value": 31.066176470588236}, {"Tier": "C", "Metric": "% Accounts", "Value": 39.0625}, {"Tier": "D", "Metric": "% Accounts", "Value": 2.2058823529411766}, {"Tier": "All other", "Metric": "% Accounts", "Value": 18.841911764705884}, {"Tier": "A+", "Metric": "% Revenue", "Value": 21.0}, {"Tier": "A", "Metric": "% Revenue", "Value": 25.0}, {"Tier": "B", "Metric": "% Revenue", "Value": 32.0}, {"Tier": "C", "Metric": "% Revenue", "Value": 15.0}, {"Tier": "D", "Metric": "% Revenue", "Value": 2.0}, {"Tier": "All other", "Metric": "% Revenue", "Value": 5.0}], "data-8f4bbff9b538b2ed473c08d9b93ac2ac": [{"text": ["TIER"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/2_1k.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Interactivity">Interactivity<a class="anchor-link" href="#Interactivity"></a></h4><p>In this exercise, the selected graph for interactivity is the simple vertical bar chart, without the lines.</p>
<p>The chosen interactive features include a simple tooltip, revealing the precise values of each column upon hovering. Additionally, it shows the legend to provide further clarity about the corresponding data categories.</p>
<p>Finally, the columns are designed to highlight dynamically when the viewer hovers over them. Because of this feature, the color palette was changed, since the monochromatic version made the highlighted column and the not highlighted neighbor too similar.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[35]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Selection for interactive points on hover</span>
<span class="n">hover</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection_point</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">'mouseover'</span><span class="p">,</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">empty</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Bar chart configuration with interactivity</span>
<span class="n">bar_interactive</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">selected_rows</span><span class="p">,</span> 
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="s1">'New client tier share'</span><span class="p">,</span> <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s1">'start'</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s1">'Tier'</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">'TIER'</span><span class="p">,</span> <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span> <span class="n">domain</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">sort</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'A+'</span><span class="p">]</span>
    <span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Value'</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">"% OF TOTAL ACCOUNTS vs REVENUE"</span><span class="p">,</span>
        <span class="n">titleAlign</span> <span class="o">=</span> <span class="s1">'left'</span><span class="p">,</span>
        <span class="n">titleAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s1">'end'</span><span class="p">,</span>
        <span class="n">titleY</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
        <span class="n">titleColor</span> <span class="o">=</span> <span class="s1">'#888888'</span>
    <span class="p">)),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s1">'Metric'</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'#0a2f73'</span><span class="p">,</span> <span class="s1">'#096b2b'</span><span class="p">])),</span>
    <span class="n">xOffset</span> <span class="o">=</span> <span class="s1">'Metric'</span><span class="p">,</span>
    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">hover</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)),</span>  <span class="c1"># Set opacity based on hover</span>
    <span class="n">tooltip</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Value:Q'</span><span class="p">,</span> <span class="s1">'Metric'</span><span class="p">]</span>  <span class="c1"># Show tooltip with specified fields</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">height</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">375</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">hover</span><span class="p">)</span>  <span class="c1"># Add the hover selection to the chart</span>

<span class="c1"># Configure view settings for the interactive bar chart</span>
<span class="n">bar_interactive</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[35]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-2381616abe034c2dbd8e216fe659343e.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-2381616abe034c2dbd8e216fe659343e.vega-embed details,
  #altair-viz-2381616abe034c2dbd8e216fe659343e.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-2381616abe034c2dbd8e216fe659343e"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-2381616abe034c2dbd8e216fe659343e") {
      outputDiv = document.getElementById("altair-viz-2381616abe034c2dbd8e216fe659343e");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "data": {"name": "data-bb1464c1645767b6ef3368e1fe4c14d1"}, "mark": {"type": "bar"}, "encoding": {"color": {"field": "Metric", "scale": {"range": ["#0a2f73", "#096b2b"]}, "type": "nominal"}, "opacity": {"condition": {"param": "param_1", "value": 1, "empty": false}, "value": 0.5}, "tooltip": [{"field": "Value", "type": "quantitative"}, {"field": "Metric", "type": "nominal"}], "x": {"axis": {"domain": false, "labelAngle": 0, "ticks": false, "title": "TIER", "titleAnchor": "start"}, "field": "Tier", "sort": ["A+"], "type": "nominal"}, "xOffset": {"field": "Metric", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "title": "% OF TOTAL ACCOUNTS vs REVENUE", "titleAlign": "left", "titleAnchor": "end", "titleAngle": 0, "titleColor": "#888888", "titleY": -10}, "field": "Value", "type": "quantitative"}}, "height": 250, "params": [{"name": "param_1", "select": {"type": "point", "nearest": true, "on": "mouseover"}}], "title": {"text": "New client tier share", "anchor": "start", "fontSize": 20}, "width": 375, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-bb1464c1645767b6ef3368e1fe4c14d1": [{"Tier": "A+", "Metric": "% Accounts", "Value": 1.7463235294117647}, {"Tier": "A", "Metric": "% Accounts", "Value": 7.077205882352941}, {"Tier": "B", "Metric": "% Accounts", "Value": 31.066176470588236}, {"Tier": "C", "Metric": "% Accounts", "Value": 39.0625}, {"Tier": "D", "Metric": "% Accounts", "Value": 2.2058823529411766}, {"Tier": "All other", "Metric": "% Accounts", "Value": 18.841911764705884}, {"Tier": "A+", "Metric": "% Revenue", "Value": 21.0}, {"Tier": "A", "Metric": "% Revenue", "Value": 25.0}, {"Tier": "B", "Metric": "% Revenue", "Value": 32.0}, {"Tier": "C", "Metric": "% Revenue", "Value": 15.0}, {"Tier": "D", "Metric": "% Revenue", "Value": 2.0}, {"Tier": "All other", "Metric": "% Revenue", "Value": 5.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Exercise-2.4---Practice-in-your-tool">Exercise 2.4 - Practice in your tool<a name="2.4"></a><a class="anchor-link" href="#Exercise-2.4---Practice-in-your-tool"></a></h3><p>This exercise proposes to display the same data in six different formats, hand-drawn by the author in the theoretical exercise 2.3. The purpose of the activity is to practice in our own tool, and while C. Nussbaumer uses Excel, we will proceed with Altair.</p>
<p><img alt="Alt text" src="./Images/2_3b.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Loading-the-data">Loading the data<a class="anchor-link" href="#Loading-the-data"></a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[36]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Loading considering the NaN caused by Excel formatting</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Data\2.4 EXERCISE.xlsx"</span><span class="p">,</span> <span class="n">usecols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">table</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[36]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>DATE</th>
<th>CAPACITY</th>
<th>DEMAND</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2019-04</td>
<td>29263</td>
<td>46193</td>
</tr>
<tr>
<th>1</th>
<td>2019-05</td>
<td>28037</td>
<td>49131</td>
</tr>
<tr>
<th>2</th>
<td>2019-06</td>
<td>21596</td>
<td>50124</td>
</tr>
<tr>
<th>3</th>
<td>2019-07</td>
<td>25895</td>
<td>48850</td>
</tr>
<tr>
<th>4</th>
<td>2019-08</td>
<td>25813</td>
<td>47602</td>
</tr>
<tr>
<th>5</th>
<td>2019-09</td>
<td>22427</td>
<td>43697</td>
</tr>
<tr>
<th>6</th>
<td>2019-10</td>
<td>23605</td>
<td>41058</td>
</tr>
<tr>
<th>7</th>
<td>2019-11</td>
<td>24263</td>
<td>37364</td>
</tr>
<tr>
<th>8</th>
<td>2019-12</td>
<td>24243</td>
<td>34364</td>
</tr>
<tr>
<th>9</th>
<td>2020-01</td>
<td>25533</td>
<td>34149</td>
</tr>
<tr>
<th>10</th>
<td>2020-02</td>
<td>24467</td>
<td>25573</td>
</tr>
<tr>
<th>11</th>
<td>2020-03</td>
<td>25194</td>
<td>25284</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>In the graphs for this exercise, we require the inclusion of the "unmet demand" column, which is currently absent from the dataset. To obtain this value, we can calculate the difference between demand and capacity for each date.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[37]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Calculate Unmet Demand</span>
<span class="n">table</span><span class="p">[</span><span class="s1">'UNMET DEMAND'</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">'DEMAND'</span><span class="p">]</span> <span class="o">-</span> <span class="n">table</span><span class="p">[</span><span class="s1">'CAPACITY'</span><span class="p">]</span>

<span class="c1"># Show only the first five lines</span>
<span class="n">table</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[37]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>DATE</th>
<th>CAPACITY</th>
<th>DEMAND</th>
<th>UNMET DEMAND</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2019-04</td>
<td>29263</td>
<td>46193</td>
<td>16930</td>
</tr>
<tr>
<th>1</th>
<td>2019-05</td>
<td>28037</td>
<td>49131</td>
<td>21094</td>
</tr>
<tr>
<th>2</th>
<td>2019-06</td>
<td>21596</td>
<td>50124</td>
<td>28528</td>
</tr>
<tr>
<th>3</th>
<td>2019-07</td>
<td>25895</td>
<td>48850</td>
<td>22955</td>
</tr>
<tr>
<th>4</th>
<td>2019-08</td>
<td>25813</td>
<td>47602</td>
<td>21789</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Now we transform the data from the wide-format used in Excel to the long-format used in Altair.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[38]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Transforming data into long-format</span>

<span class="n">melted_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'DATE'</span><span class="p">],</span> <span class="n">var_name</span> <span class="o">=</span> <span class="s1">'Metric'</span><span class="p">,</span> <span class="n">value_name</span> <span class="o">=</span> <span class="s1">'Value'</span><span class="p">)</span>
<span class="n">melted_table</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[38]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>DATE</th>
<th>Metric</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2019-04</td>
<td>CAPACITY</td>
<td>29263</td>
</tr>
<tr>
<th>1</th>
<td>2019-05</td>
<td>CAPACITY</td>
<td>28037</td>
</tr>
<tr>
<th>2</th>
<td>2019-06</td>
<td>CAPACITY</td>
<td>21596</td>
</tr>
<tr>
<th>3</th>
<td>2019-07</td>
<td>CAPACITY</td>
<td>25895</td>
</tr>
<tr>
<th>4</th>
<td>2019-08</td>
<td>CAPACITY</td>
<td>25813</td>
</tr>
<tr>
<th>5</th>
<td>2019-09</td>
<td>CAPACITY</td>
<td>22427</td>
</tr>
<tr>
<th>6</th>
<td>2019-10</td>
<td>CAPACITY</td>
<td>23605</td>
</tr>
<tr>
<th>7</th>
<td>2019-11</td>
<td>CAPACITY</td>
<td>24263</td>
</tr>
<tr>
<th>8</th>
<td>2019-12</td>
<td>CAPACITY</td>
<td>24243</td>
</tr>
<tr>
<th>9</th>
<td>2020-01</td>
<td>CAPACITY</td>
<td>25533</td>
</tr>
<tr>
<th>10</th>
<td>2020-02</td>
<td>CAPACITY</td>
<td>24467</td>
</tr>
<tr>
<th>11</th>
<td>2020-03</td>
<td>CAPACITY</td>
<td>25194</td>
</tr>
<tr>
<th>12</th>
<td>2019-04</td>
<td>DEMAND</td>
<td>46193</td>
</tr>
<tr>
<th>13</th>
<td>2019-05</td>
<td>DEMAND</td>
<td>49131</td>
</tr>
<tr>
<th>14</th>
<td>2019-06</td>
<td>DEMAND</td>
<td>50124</td>
</tr>
<tr>
<th>15</th>
<td>2019-07</td>
<td>DEMAND</td>
<td>48850</td>
</tr>
<tr>
<th>16</th>
<td>2019-08</td>
<td>DEMAND</td>
<td>47602</td>
</tr>
<tr>
<th>17</th>
<td>2019-09</td>
<td>DEMAND</td>
<td>43697</td>
</tr>
<tr>
<th>18</th>
<td>2019-10</td>
<td>DEMAND</td>
<td>41058</td>
</tr>
<tr>
<th>19</th>
<td>2019-11</td>
<td>DEMAND</td>
<td>37364</td>
</tr>
<tr>
<th>20</th>
<td>2019-12</td>
<td>DEMAND</td>
<td>34364</td>
</tr>
<tr>
<th>21</th>
<td>2020-01</td>
<td>DEMAND</td>
<td>34149</td>
</tr>
<tr>
<th>22</th>
<td>2020-02</td>
<td>DEMAND</td>
<td>25573</td>
</tr>
<tr>
<th>23</th>
<td>2020-03</td>
<td>DEMAND</td>
<td>25284</td>
</tr>
<tr>
<th>24</th>
<td>2019-04</td>
<td>UNMET DEMAND</td>
<td>16930</td>
</tr>
<tr>
<th>25</th>
<td>2019-05</td>
<td>UNMET DEMAND</td>
<td>21094</td>
</tr>
<tr>
<th>26</th>
<td>2019-06</td>
<td>UNMET DEMAND</td>
<td>28528</td>
</tr>
<tr>
<th>27</th>
<td>2019-07</td>
<td>UNMET DEMAND</td>
<td>22955</td>
</tr>
<tr>
<th>28</th>
<td>2019-08</td>
<td>UNMET DEMAND</td>
<td>21789</td>
</tr>
<tr>
<th>29</th>
<td>2019-09</td>
<td>UNMET DEMAND</td>
<td>21270</td>
</tr>
<tr>
<th>30</th>
<td>2019-10</td>
<td>UNMET DEMAND</td>
<td>17453</td>
</tr>
<tr>
<th>31</th>
<td>2019-11</td>
<td>UNMET DEMAND</td>
<td>13101</td>
</tr>
<tr>
<th>32</th>
<td>2019-12</td>
<td>UNMET DEMAND</td>
<td>10121</td>
</tr>
<tr>
<th>33</th>
<td>2020-01</td>
<td>UNMET DEMAND</td>
<td>8616</td>
</tr>
<tr>
<th>34</th>
<td>2020-02</td>
<td>UNMET DEMAND</td>
<td>1106</td>
</tr>
<tr>
<th>35</th>
<td>2020-03</td>
<td>UNMET DEMAND</td>
<td>90</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>To simplify the data transformation process in the graphs, we will deviate from the "yyyy-mm" format for the date. Instead, we will create two separate columns, one for the year and another for the abbreviated name of the month. This adjustment will streamline our visualization efforts by reducing the need for extensive data transformations within the graphs themselves.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[39]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Transform the column into datetime format</span>
<span class="n">melted_table</span><span class="p">[</span><span class="s1">'DATE'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">melted_table</span><span class="p">[</span><span class="s1">'DATE'</span><span class="p">])</span>

<span class="c1"># Extracting year and month</span>
<span class="n">melted_table</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]</span> <span class="o">=</span> <span class="n">melted_table</span><span class="p">[</span><span class="s1">'DATE'</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
<span class="n">melted_table</span><span class="p">[</span><span class="s1">'month'</span><span class="p">]</span> <span class="o">=</span> <span class="n">melted_table</span><span class="p">[</span><span class="s1">'DATE'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">'%b'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[40]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># The DATE column is no longer useful</span>

<span class="n">melted_table</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'DATE'</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">melted_table</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[40]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Metric</th>
<th>Value</th>
<th>year</th>
<th>month</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CAPACITY</td>
<td>29263</td>
<td>2019</td>
<td>Apr</td>
</tr>
<tr>
<th>1</th>
<td>CAPACITY</td>
<td>28037</td>
<td>2019</td>
<td>May</td>
</tr>
<tr>
<th>2</th>
<td>CAPACITY</td>
<td>21596</td>
<td>2019</td>
<td>Jun</td>
</tr>
<tr>
<th>3</th>
<td>CAPACITY</td>
<td>25895</td>
<td>2019</td>
<td>Jul</td>
</tr>
<tr>
<th>4</th>
<td>CAPACITY</td>
<td>25813</td>
<td>2019</td>
<td>Aug</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>To further avoid data manipulation within the chart code, we will create auxiliary tables.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[41]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Making new sets of data</span>

<span class="c1"># Just 2019</span>
<span class="n">table_2019</span>  <span class="o">=</span> <span class="n">melted_table</span><span class="p">[</span><span class="n">melted_table</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">2019</span><span class="p">])]</span>
<span class="c1"># Just Demand from 2019</span>
<span class="n">demand_2019</span> <span class="o">=</span> <span class="n">table_2019</span><span class="p">[</span><span class="n">table_2019</span><span class="p">[</span><span class="s1">'Metric'</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">'DEMAND'</span><span class="p">])]</span>
<span class="c1"># Just Capacity from 2019</span>
<span class="n">capacity_2019</span> <span class="o">=</span> <span class="n">table_2019</span><span class="p">[</span><span class="n">table_2019</span><span class="p">[</span><span class="s1">'Metric'</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">'CAPACITY'</span><span class="p">])]</span>
<span class="c1"># Just Unmet Demand from 2019</span>
<span class="n">unmet_2019</span> <span class="o">=</span> <span class="n">table_2019</span><span class="p">[</span><span class="n">table_2019</span><span class="p">[</span><span class="s1">'Metric'</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">'UNMET DEMAND'</span><span class="p">])]</span>
<span class="c1"># Demand and Capacity from 2019</span>
<span class="n">bar_table</span> <span class="o">=</span> <span class="n">table_2019</span><span class="p">[</span><span class="n">table_2019</span><span class="p">[</span><span class="s1">'Metric'</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">'CAPACITY'</span><span class="p">,</span> <span class="s1">'DEMAND'</span><span class="p">])]</span>
<span class="c1"># Unmet Demand and Capacity from 2019</span>
<span class="n">stacked_table</span> <span class="o">=</span> <span class="n">table_2019</span><span class="p">[</span><span class="n">table_2019</span><span class="p">[</span><span class="s2">"Metric"</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">"CAPACITY"</span><span class="p">,</span> <span class="s2">"UNMET DEMAND"</span><span class="p">])]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Bar-chart">Bar chart<a class="anchor-link" href="#Bar-chart"></a></h4><p>While the author deliberately filled the Capacity columns while leaving Demand only outlined in the attempt to visually distinguish between what can be fulfilled (Capacity) and the unmet portion of the requirement (Unmet Demand), <code>Altair</code> is not easily compatible with that choice.</p>
<p>The variable which dictates if the mark will be filled does not accept a condition as its value. Since the author itself admits the shortcomings of this approach (<em>"I find the outline plus the white space between the bars visually jarring"</em>), we chose to differentiate the data by color, as it is traditional.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[42]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Unfilled version</span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">bar_table</span><span class="p">,</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
        <span class="s2">"Demand vs capacity over time"</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">16</span> <span class="c1"># Set customized title</span>
    <span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span> <span class="c1"># Filled = False makes the bars unfilled</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
        <span class="s2">"Value"</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="c1"># Removes grid</span>
            <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
            <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span> <span class="c1"># Changes the label color to gray</span>
            <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span> <span class="c1"># Changes the title color to gray</span>
            <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
        <span class="p">),</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60000</span><span class="p">]),</span> <span class="c1"># y-axis goes from 0 to 60000</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">"NUMBER OF PROJECT HOURS"</span>
    <span class="p">),</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s2">"month"</span><span class="p">,</span>
        <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
            <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="c1"># Makes label horizontal</span>
            <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span> <span class="c1"># Changes label and title color to gray</span>
            <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
            <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># Removes ticks from axis</span>
        <span class="p">),</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
    <span class="p">),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span> <span class="c1"># Sets colors based on Metric (Demand and Capacity)</span>
        <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#b4c6e4"</span><span class="p">,</span> <span class="s2">"#4871b7"</span><span class="p">]),</span> <span class="n">sort</span> <span class="o">=</span> <span class="s2">"descending"</span>
    <span class="p">),</span> 
    <span class="n">xOffset</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">XOffset</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="s2">"descending"</span><span class="p">)</span> <span class="c1"># Sets offset on the x-axis </span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span>
    <span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>  <span class="c1"># Remove the chart border</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[42]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-6088d41489c84a89840f33eaea794ab0.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-6088d41489c84a89840f33eaea794ab0.vega-embed details,
  #altair-viz-6088d41489c84a89840f33eaea794ab0.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-6088d41489c84a89840f33eaea794ab0"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-6088d41489c84a89840f33eaea794ab0") {
      outputDiv = document.getElementById("altair-viz-6088d41489c84a89840f33eaea794ab0");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "data": {"name": "data-f53bb01febd214e9ecb3cb7fbc625fc6"}, "mark": {"type": "bar", "filled": false}, "encoding": {"color": {"field": "Metric", "scale": {"range": ["#b4c6e4", "#4871b7"]}, "sort": "descending", "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "month", "sort": null, "title": "2019", "type": "nominal"}, "xOffset": {"field": "Metric", "sort": "descending", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 60000]}, "title": "NUMBER OF PROJECT HOURS", "type": "quantitative"}}, "title": {"text": "Demand vs capacity over time", "anchor": "start", "fontSize": 16, "offset": 20}, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-f53bb01febd214e9ecb3cb7fbc625fc6": [{"Metric": "CAPACITY", "Value": 29263, "year": 2019, "month": "Apr"}, {"Metric": "CAPACITY", "Value": 28037, "year": 2019, "month": "May"}, {"Metric": "CAPACITY", "Value": 21596, "year": 2019, "month": "Jun"}, {"Metric": "CAPACITY", "Value": 25895, "year": 2019, "month": "Jul"}, {"Metric": "CAPACITY", "Value": 25813, "year": 2019, "month": "Aug"}, {"Metric": "CAPACITY", "Value": 22427, "year": 2019, "month": "Sep"}, {"Metric": "CAPACITY", "Value": 23605, "year": 2019, "month": "Oct"}, {"Metric": "CAPACITY", "Value": 24263, "year": 2019, "month": "Nov"}, {"Metric": "CAPACITY", "Value": 24243, "year": 2019, "month": "Dec"}, {"Metric": "DEMAND", "Value": 46193, "year": 2019, "month": "Apr"}, {"Metric": "DEMAND", "Value": 49131, "year": 2019, "month": "May"}, {"Metric": "DEMAND", "Value": 50124, "year": 2019, "month": "Jun"}, {"Metric": "DEMAND", "Value": 48850, "year": 2019, "month": "Jul"}, {"Metric": "DEMAND", "Value": 47602, "year": 2019, "month": "Aug"}, {"Metric": "DEMAND", "Value": 43697, "year": 2019, "month": "Sep"}, {"Metric": "DEMAND", "Value": 41058, "year": 2019, "month": "Oct"}, {"Metric": "DEMAND", "Value": 37364, "year": 2019, "month": "Nov"}, {"Metric": "DEMAND", "Value": 34364, "year": 2019, "month": "Dec"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[43]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Filled version</span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">bar_table</span><span class="p">,</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
        <span class="s2">"Demand vs capacity over time"</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">16</span> <span class="c1"># Set customized title</span>
    <span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span> <span class="c1"># Filled = True is default</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
        <span class="s2">"Value"</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="c1"># Removes grid</span>
            <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
            <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span> <span class="c1"># Changes the label color to gray</span>
            <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span> <span class="c1"># Changes the title color to gray</span>
            <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
        <span class="p">),</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60000</span><span class="p">]),</span> <span class="c1"># y-axis goes from 0 to 60000</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">"NUMBER OF PROJECT HOURS"</span>
    <span class="p">),</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s2">"month"</span><span class="p">,</span>
        <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
            <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="c1"># Makes label horizontal</span>
            <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span> <span class="c1"># Changes label and title color to gray</span>
            <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
            <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># Removes ticks from axis</span>
        <span class="p">),</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
    <span class="p">),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span> <span class="c1"># Sets colors based on Metric (Demand and Capacity)</span>
        <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#b4c6e4"</span><span class="p">,</span> <span class="s2">"#4871b7"</span><span class="p">]),</span> <span class="n">sort</span> <span class="o">=</span> <span class="s2">"descending"</span>
    <span class="p">),</span> 
    <span class="n">xOffset</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">XOffset</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="s2">"descending"</span><span class="p">)</span> <span class="c1"># Sets offset on the x-axis </span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span>
    <span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>  <span class="c1"># Remove the chart border</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[43]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-73331f528841424f84e206345d07c80e.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-73331f528841424f84e206345d07c80e.vega-embed details,
  #altair-viz-73331f528841424f84e206345d07c80e.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-73331f528841424f84e206345d07c80e"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-73331f528841424f84e206345d07c80e") {
      outputDiv = document.getElementById("altair-viz-73331f528841424f84e206345d07c80e");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "data": {"name": "data-f53bb01febd214e9ecb3cb7fbc625fc6"}, "mark": {"type": "bar"}, "encoding": {"color": {"field": "Metric", "scale": {"range": ["#b4c6e4", "#4871b7"]}, "sort": "descending", "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "month", "sort": null, "title": "2019", "type": "nominal"}, "xOffset": {"field": "Metric", "sort": "descending", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 60000]}, "title": "NUMBER OF PROJECT HOURS", "type": "quantitative"}}, "title": {"text": "Demand vs capacity over time", "anchor": "start", "fontSize": 16, "offset": 20}, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-f53bb01febd214e9ecb3cb7fbc625fc6": [{"Metric": "CAPACITY", "Value": 29263, "year": 2019, "month": "Apr"}, {"Metric": "CAPACITY", "Value": 28037, "year": 2019, "month": "May"}, {"Metric": "CAPACITY", "Value": 21596, "year": 2019, "month": "Jun"}, {"Metric": "CAPACITY", "Value": 25895, "year": 2019, "month": "Jul"}, {"Metric": "CAPACITY", "Value": 25813, "year": 2019, "month": "Aug"}, {"Metric": "CAPACITY", "Value": 22427, "year": 2019, "month": "Sep"}, {"Metric": "CAPACITY", "Value": 23605, "year": 2019, "month": "Oct"}, {"Metric": "CAPACITY", "Value": 24263, "year": 2019, "month": "Nov"}, {"Metric": "CAPACITY", "Value": 24243, "year": 2019, "month": "Dec"}, {"Metric": "DEMAND", "Value": 46193, "year": 2019, "month": "Apr"}, {"Metric": "DEMAND", "Value": 49131, "year": 2019, "month": "May"}, {"Metric": "DEMAND", "Value": 50124, "year": 2019, "month": "Jun"}, {"Metric": "DEMAND", "Value": 48850, "year": 2019, "month": "Jul"}, {"Metric": "DEMAND", "Value": 47602, "year": 2019, "month": "Aug"}, {"Metric": "DEMAND", "Value": 43697, "year": 2019, "month": "Sep"}, {"Metric": "DEMAND", "Value": 41058, "year": 2019, "month": "Oct"}, {"Metric": "DEMAND", "Value": 37364, "year": 2019, "month": "Nov"}, {"Metric": "DEMAND", "Value": 34364, "year": 2019, "month": "Dec"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/2_4a.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Line-graph">Line graph<a class="anchor-link" href="#Line-graph"></a></h4><p>Cleaner than the bar chart, the next step was to convey the data using the line graph, with the labeling beside each line, along with the final value of the year. This helps the viewer to visualize the difference between the capacity and the demand.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[43]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">line</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">bar_table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Demand vs capacity over time"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># Offsets the title in the y-axis</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">()</span>  <span class="c1"># Using a line mark for the chart</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60000</span><span class="p">]),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"NUMBER OF PROJECT HOURS"</span>
        <span class="p">),</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Disabling sorting for better time representation</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span> <span class="c1"># Set colors to gray</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#1f77b4"</span><span class="p">,</span> <span class="s2">"#1f77b4"</span><span class="p">]),</span> 
            <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">strokeWidth</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="s2">"datum.Metric == 'CAPACITY'"</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>  <span class="c1"># Adjusting line thickness based on the metric</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">350</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">250</span><span class="p">)</span> <span class="c1"># Set size of the graph</span>
<span class="p">)</span>

<span class="c1"># Adding labels</span>
<span class="n">label</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">bar_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"month"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="s2">"max"</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"argmax"</span><span class="p">:</span> <span class="s2">"month"</span><span class="p">}),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">),</span> <span class="c1"># The text itself is the Metric</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#1f77b4"</span><span class="p">,</span> <span class="s2">"#1f77b4"</span><span class="p">]))</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Combining the line chart and labels</span>
<span class="n">line</span> <span class="o">+</span> <span class="n">label</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[43]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-138b386c77784fa48a87664723a5c747.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-138b386c77784fa48a87664723a5c747.vega-embed details,
  #altair-viz-138b386c77784fa48a87664723a5c747.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-138b386c77784fa48a87664723a5c747"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-138b386c77784fa48a87664723a5c747") {
      outputDiv = document.getElementById("altair-viz-138b386c77784fa48a87664723a5c747");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#1f77b4", "#1f77b4"]}, "type": "nominal"}, "strokeWidth": {"condition": {"test": "datum.Metric == 'CAPACITY'", "value": 3}, "value": 1}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 60000]}, "title": "NUMBER OF PROJECT HOURS", "type": "quantitative"}}, "title": {"text": "Demand vs capacity over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"mark": {"type": "text", "align": "left", "dx": 3}, "encoding": {"color": {"field": "Metric", "scale": {"range": ["#1f77b4", "#1f77b4"]}, "type": "nominal"}, "text": {"field": "Metric", "type": "nominal"}, "x": {"aggregate": "max", "field": "month", "sort": null, "type": "nominal"}, "y": {"aggregate": {"argmax": "month"}, "field": "Value", "type": "quantitative"}}}], "data": {"name": "data-f53bb01febd214e9ecb3cb7fbc625fc6"}, "height": 250, "width": 350, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-f53bb01febd214e9ecb3cb7fbc625fc6": [{"Metric": "CAPACITY", "Value": 29263, "year": 2019, "month": "Apr"}, {"Metric": "CAPACITY", "Value": 28037, "year": 2019, "month": "May"}, {"Metric": "CAPACITY", "Value": 21596, "year": 2019, "month": "Jun"}, {"Metric": "CAPACITY", "Value": 25895, "year": 2019, "month": "Jul"}, {"Metric": "CAPACITY", "Value": 25813, "year": 2019, "month": "Aug"}, {"Metric": "CAPACITY", "Value": 22427, "year": 2019, "month": "Sep"}, {"Metric": "CAPACITY", "Value": 23605, "year": 2019, "month": "Oct"}, {"Metric": "CAPACITY", "Value": 24263, "year": 2019, "month": "Nov"}, {"Metric": "CAPACITY", "Value": 24243, "year": 2019, "month": "Dec"}, {"Metric": "DEMAND", "Value": 46193, "year": 2019, "month": "Apr"}, {"Metric": "DEMAND", "Value": 49131, "year": 2019, "month": "May"}, {"Metric": "DEMAND", "Value": 50124, "year": 2019, "month": "Jun"}, {"Metric": "DEMAND", "Value": 48850, "year": 2019, "month": "Jul"}, {"Metric": "DEMAND", "Value": 47602, "year": 2019, "month": "Aug"}, {"Metric": "DEMAND", "Value": 43697, "year": 2019, "month": "Sep"}, {"Metric": "DEMAND", "Value": 41058, "year": 2019, "month": "Oct"}, {"Metric": "DEMAND", "Value": 37364, "year": 2019, "month": "Nov"}, {"Metric": "DEMAND", "Value": 34364, "year": 2019, "month": "Dec"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>As it is possible to notice, defining the label position as the maximum argument of the y-axis did not yield the intended result. This is because Altair is considering the values in an alphabetical order (making Sept the last month), even when setting <code>sort = None</code> in the x-axis.</p>
<p>Since documentation fixing this issue was not found, the next approach was adding the label manually. This also assist the process of adding the value next to the metric.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[44]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Demand label</span>
<span class="n">label1</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> 
                    <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span>  <span class="p">[</span><span class="s1">'34K DEMAND'</span><span class="p">]}]</span>
                    <span class="p">}</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                                <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> 
                                <span class="n">dx</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> 
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">'#1f77b4'</span> <span class="c1"># Color it blue</span>
                                <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>

<span class="c1"># Capacity label</span>
<span class="n">label2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> 
                    <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span>  <span class="p">[</span><span class="s1">'24K CAPACITY'</span><span class="p">]}]</span>
                    <span class="p">}</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                                <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> 
                                <span class="n">dx</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> 
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">'#1f77b4'</span><span class="p">,</span> <span class="c1"># Color it blue</span>
                                <span class="n">fontWeight</span> <span class="o">=</span> <span class="s1">'bold'</span>
                                <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>

<span class="n">line_final</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">label1</span> <span class="o">+</span>  <span class="n">label2</span>
<span class="n">line_final</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[44]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-a8488ff4016641b0bf10096206266358.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-a8488ff4016641b0bf10096206266358.vega-embed details,
  #altair-viz-a8488ff4016641b0bf10096206266358.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-a8488ff4016641b0bf10096206266358"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-a8488ff4016641b0bf10096206266358") {
      outputDiv = document.getElementById("altair-viz-a8488ff4016641b0bf10096206266358");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-f53bb01febd214e9ecb3cb7fbc625fc6"}, "mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#1f77b4", "#1f77b4"]}, "type": "nominal"}, "strokeWidth": {"condition": {"test": "datum.Metric == 'CAPACITY'", "value": 3}, "value": 1}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 60000]}, "title": "NUMBER OF PROJECT HOURS", "type": "quantitative"}}, "title": {"text": "Demand vs capacity over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "data-48f65438e058b5501ece770a27c9c234"}, "mark": {"type": "text", "align": "left", "color": "#1f77b4", "dx": 160, "dy": -15, "size": 10}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-ef424f4a39789c0a04e14775a2b8ab2e"}, "mark": {"type": "text", "align": "left", "color": "#1f77b4", "dx": 160, "dy": 25, "fontWeight": "bold", "size": 10}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "height": 250, "width": 350, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-f53bb01febd214e9ecb3cb7fbc625fc6": [{"Metric": "CAPACITY", "Value": 29263, "year": 2019, "month": "Apr"}, {"Metric": "CAPACITY", "Value": 28037, "year": 2019, "month": "May"}, {"Metric": "CAPACITY", "Value": 21596, "year": 2019, "month": "Jun"}, {"Metric": "CAPACITY", "Value": 25895, "year": 2019, "month": "Jul"}, {"Metric": "CAPACITY", "Value": 25813, "year": 2019, "month": "Aug"}, {"Metric": "CAPACITY", "Value": 22427, "year": 2019, "month": "Sep"}, {"Metric": "CAPACITY", "Value": 23605, "year": 2019, "month": "Oct"}, {"Metric": "CAPACITY", "Value": 24263, "year": 2019, "month": "Nov"}, {"Metric": "CAPACITY", "Value": 24243, "year": 2019, "month": "Dec"}, {"Metric": "DEMAND", "Value": 46193, "year": 2019, "month": "Apr"}, {"Metric": "DEMAND", "Value": 49131, "year": 2019, "month": "May"}, {"Metric": "DEMAND", "Value": 50124, "year": 2019, "month": "Jun"}, {"Metric": "DEMAND", "Value": 48850, "year": 2019, "month": "Jul"}, {"Metric": "DEMAND", "Value": 47602, "year": 2019, "month": "Aug"}, {"Metric": "DEMAND", "Value": 43697, "year": 2019, "month": "Sep"}, {"Metric": "DEMAND", "Value": 41058, "year": 2019, "month": "Oct"}, {"Metric": "DEMAND", "Value": 37364, "year": 2019, "month": "Nov"}, {"Metric": "DEMAND", "Value": 34364, "year": 2019, "month": "Dec"}], "data-48f65438e058b5501ece770a27c9c234": [{"text": ["34K DEMAND"]}], "data-ef424f4a39789c0a04e14775a2b8ab2e": [{"text": ["24K CAPACITY"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/2_4b.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Overlapping-bars">Overlapping bars<a class="anchor-link" href="#Overlapping-bars"></a></h4><p>The author now explores overlapping bars, wherein two bar graphs are positioned on top of each other, sharing the same axis. The Capacity data is displayed with transparency to prevent any potential confusion that might arise with a stacked bar chart.</p>
<p>In this particular graph, our choice was to emulate the column labeling using a title with different colors, despite Altair not providing a straightforward method for such customization. Unlike previous examples where the default legend effectively distinguished colors, the current data distinction  "opaque" or "transparent"  is better conveyed by utilizing normal or bold text in the title instead of relying on a legend with colors.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[45]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Demand bar, with bigger spacing between them, unfilled</span>
<span class="n">demand</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">demand_2019</span><span class="p">,</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Step</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span> <span class="c1"># Defines the width of the bars (including distance between them)</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Demand vs capacity over time"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="c1"># Unfilled</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span> <span class="c1"># Gray label and title</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span>
            <span class="p">),</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60000</span><span class="p">]),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"NUMBER OF PROJECT HOURS"</span>
        <span class="p">),</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="c1"># Horizontal label</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>


<span class="c1"># Capacity bar, bigger size and more transparency</span>
<span class="n">capacity</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">capacity_2019</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span> <span class="c1"># Makes the bar thicker but keeps the distance the same</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60000</span><span class="p">]),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"NUMBER OF PROJECT HOURS"</span>
        <span class="p">),</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
        <span class="p">),</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># Makes the bar transparent</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Labeling for subtitle</span>
<span class="n">label1</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"DEMAND  |"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">235</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#1f77b4"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">label2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"CAPACITY"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">177</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#1f77b4"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">800</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">overlap</span> <span class="o">=</span> <span class="n">capacity</span> <span class="o">+</span> <span class="n">demand</span> <span class="o">+</span> <span class="n">label1</span> <span class="o">+</span> <span class="n">label2</span>

<span class="c1"># Sets space (padding) between bands</span>
<span class="n">overlap</span><span class="o">.</span><span class="n">configure_scale</span><span class="p">(</span><span class="n">bandPaddingInner</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">height</span> <span class="o">=</span> <span class="mi">200</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[45]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-087bae1ff6d446f6bef6b1a32028716d.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-087bae1ff6d446f6bef6b1a32028716d.vega-embed details,
  #altair-viz-087bae1ff6d446f6bef6b1a32028716d.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-087bae1ff6d446f6bef6b1a32028716d"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-087bae1ff6d446f6bef6b1a32028716d") {
      outputDiv = document.getElementById("altair-viz-087bae1ff6d446f6bef6b1a32028716d");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}, "scale": {"bandPaddingInner": 0.5}}, "layer": [{"data": {"name": "data-6563dc1165a072f2ab68a801d7f1a3ed"}, "mark": {"type": "bar", "size": 30}, "encoding": {"opacity": {"value": 0.5}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 60000]}, "title": "NUMBER OF PROJECT HOURS", "type": "quantitative"}}}, {"data": {"name": "data-e534e8b67a67e2c71dfef5a17d5b54f3"}, "mark": {"type": "bar", "filled": false}, "encoding": {"x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888"}, "field": "month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888"}, "field": "Value", "scale": {"domain": [0, 60000]}, "title": "NUMBER OF PROJECT HOURS", "type": "quantitative"}}, "title": {"text": "Demand vs capacity over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal"}}, {"data": {"name": "data-fd40bf7b2ed89b2c582bd8d0b2fc7524"}, "mark": {"type": "text", "align": "left", "color": "#1f77b4", "dx": -235, "dy": -120, "size": 10}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-6b100461ad86d17fc030d068d1e8d22d"}, "mark": {"type": "text", "align": "left", "color": "#1f77b4", "dx": -177, "dy": -120, "fontWeight": 800, "size": 10}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "height": 200, "width": {"step": 40}, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-6563dc1165a072f2ab68a801d7f1a3ed": [{"Metric": "CAPACITY", "Value": 29263, "year": 2019, "month": "Apr"}, {"Metric": "CAPACITY", "Value": 28037, "year": 2019, "month": "May"}, {"Metric": "CAPACITY", "Value": 21596, "year": 2019, "month": "Jun"}, {"Metric": "CAPACITY", "Value": 25895, "year": 2019, "month": "Jul"}, {"Metric": "CAPACITY", "Value": 25813, "year": 2019, "month": "Aug"}, {"Metric": "CAPACITY", "Value": 22427, "year": 2019, "month": "Sep"}, {"Metric": "CAPACITY", "Value": 23605, "year": 2019, "month": "Oct"}, {"Metric": "CAPACITY", "Value": 24263, "year": 2019, "month": "Nov"}, {"Metric": "CAPACITY", "Value": 24243, "year": 2019, "month": "Dec"}], "data-e534e8b67a67e2c71dfef5a17d5b54f3": [{"Metric": "DEMAND", "Value": 46193, "year": 2019, "month": "Apr"}, {"Metric": "DEMAND", "Value": 49131, "year": 2019, "month": "May"}, {"Metric": "DEMAND", "Value": 50124, "year": 2019, "month": "Jun"}, {"Metric": "DEMAND", "Value": 48850, "year": 2019, "month": "Jul"}, {"Metric": "DEMAND", "Value": 47602, "year": 2019, "month": "Aug"}, {"Metric": "DEMAND", "Value": 43697, "year": 2019, "month": "Sep"}, {"Metric": "DEMAND", "Value": 41058, "year": 2019, "month": "Oct"}, {"Metric": "DEMAND", "Value": 37364, "year": 2019, "month": "Nov"}, {"Metric": "DEMAND", "Value": 34364, "year": 2019, "month": "Dec"}], "data-fd40bf7b2ed89b2c582bd8d0b2fc7524": [{"text": ["DEMAND  |"]}], "data-6b100461ad86d17fc030d068d1e8d22d": [{"text": ["CAPACITY"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/2_4c.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Stacked-bars">Stacked bars<a class="anchor-link" href="#Stacked-bars"></a></h4><p>In the stacked bars configuration, the Demand bar chart has been replaced with Unmet Demand (i.e., Demand - Capacity). This modification allows the stacking to represent the cumulative Demand value. Additionally, a color adjustment has been made, with Unmet Demand now rendered in a darker shade to emphasize its significance as a more meaningful metric.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[46]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Stacked bar</span>
<span class="n">bars</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">stacked_table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Demand vs capacity over time"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># Offsets title in the y-axis</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span> <span class="c1"># Sets title and label to gray</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60000</span><span class="p">]),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"NUMBER OF PROJECT HOURS"</span>
        <span class="p">),</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#d9dad9"</span><span class="p">,</span> <span class="s2">"#4871b7"</span><span class="p">])),</span>
        <span class="n">order</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Order</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="s2">"ascending"</span><span class="p">)</span> <span class="c1"># Unmet demand on top</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Border detail, makes the graph more visible</span>
<span class="n">border</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">stacked_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">filled</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="c1"># Makes an unfilled bar</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span>
            <span class="p">),</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60000</span><span class="p">]),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"NUMBER OF PROJECT HOURS"</span>
        <span class="p">),</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
        <span class="p">),</span>
        <span class="n">order</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Order</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="s2">"ascending"</span><span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">stacked</span> <span class="o">=</span> <span class="n">bars</span> <span class="o">+</span> <span class="n">border</span>
<span class="n">stacked</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[46]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-c03448feb9af49b38134ff16f68e88ee.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-c03448feb9af49b38134ff16f68e88ee.vega-embed details,
  #altair-viz-c03448feb9af49b38134ff16f68e88ee.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-c03448feb9af49b38134ff16f68e88ee"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-c03448feb9af49b38134ff16f68e88ee") {
      outputDiv = document.getElementById("altair-viz-c03448feb9af49b38134ff16f68e88ee");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "bar", "size": 25}, "encoding": {"color": {"field": "Metric", "scale": {"range": ["#d9dad9", "#4871b7"]}, "type": "nominal"}, "order": {"field": "Metric", "sort": "ascending", "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 60000]}, "title": "NUMBER OF PROJECT HOURS", "type": "quantitative"}}, "title": {"text": "Demand vs capacity over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"mark": {"type": "bar", "filled": false, "size": 25}, "encoding": {"order": {"field": "Metric", "sort": "ascending", "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "end", "titleColor": "#888888"}, "field": "month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888"}, "field": "Value", "scale": {"domain": [0, 60000]}, "title": "NUMBER OF PROJECT HOURS", "type": "quantitative"}}}], "data": {"name": "data-59ee266a658aca26e26fe99ca8d64a60"}, "height": 200, "width": 300, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-59ee266a658aca26e26fe99ca8d64a60": [{"Metric": "CAPACITY", "Value": 29263, "year": 2019, "month": "Apr"}, {"Metric": "CAPACITY", "Value": 28037, "year": 2019, "month": "May"}, {"Metric": "CAPACITY", "Value": 21596, "year": 2019, "month": "Jun"}, {"Metric": "CAPACITY", "Value": 25895, "year": 2019, "month": "Jul"}, {"Metric": "CAPACITY", "Value": 25813, "year": 2019, "month": "Aug"}, {"Metric": "CAPACITY", "Value": 22427, "year": 2019, "month": "Sep"}, {"Metric": "CAPACITY", "Value": 23605, "year": 2019, "month": "Oct"}, {"Metric": "CAPACITY", "Value": 24263, "year": 2019, "month": "Nov"}, {"Metric": "CAPACITY", "Value": 24243, "year": 2019, "month": "Dec"}, {"Metric": "UNMET DEMAND", "Value": 16930, "year": 2019, "month": "Apr"}, {"Metric": "UNMET DEMAND", "Value": 21094, "year": 2019, "month": "May"}, {"Metric": "UNMET DEMAND", "Value": 28528, "year": 2019, "month": "Jun"}, {"Metric": "UNMET DEMAND", "Value": 22955, "year": 2019, "month": "Jul"}, {"Metric": "UNMET DEMAND", "Value": 21789, "year": 2019, "month": "Aug"}, {"Metric": "UNMET DEMAND", "Value": 21270, "year": 2019, "month": "Sep"}, {"Metric": "UNMET DEMAND", "Value": 17453, "year": 2019, "month": "Oct"}, {"Metric": "UNMET DEMAND", "Value": 13101, "year": 2019, "month": "Nov"}, {"Metric": "UNMET DEMAND", "Value": 10121, "year": 2019, "month": "Dec"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Dot-plot">Dot plot<a class="anchor-link" href="#Dot-plot"></a></h4><p>For the next graph, a dot plot, the author reveals the challenges she had in Excel. To create the circles, she employed data markers from two line graphs, concealing the lines themselves. The region connecting the dots was achieved by employing a stacked bar of Unmet Demand, sitting on top of an transparent Capacity series.</p>
<p>This serves as a noteworthy example of the limitations of Excel when dealing with charts not inherently programmed into the tool. While certain graphs may be more straightforward in Excel, unconventional visualizations might demand intricate and obscure workarounds, while in Altair, where the approach to data visualization is more flexible, documentation for this graph was readily available.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[47]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Unfilled version</span>
<span class="n">dots1</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">bar_table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Demand vs capacity over time"</span><span class="p">,</span> <span class="c1"># Set title</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">600</span><span class="p">,</span> <span class="n">opacity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># Maximum opacity</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
                <span class="n">labels</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="c1"># Removes labels from axis</span>
                <span class="n">domain</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># Removes line from axis</span>
            <span class="p">),</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60000</span><span class="p">]),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"# OF PROJECT HOURS"</span>
        <span class="p">),</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">labelPadding</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="c1"># Makes label more distant to the axis</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#4871b7"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> 
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">250</span><span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Metric</span> <span class="o">==</span> <span class="s2">"CAPACITY"</span><span class="p">)</span> <span class="c1"># Alternative way to filter, similar to using auxiliary table</span>
<span class="p">)</span>

<span class="n">dots2</span> <span class="o">=</span> <span class="p">(</span> <span class="c1"># Same graph but to Demand</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">bar_table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Demand vs capacity over time"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">600</span><span class="p">,</span> <span class="n">opacity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">filled</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="c1"># Unfilled</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">domain</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60000</span><span class="p">]),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"# OF PROJECT HOURS"</span>
        <span class="p">),</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">labelPadding</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="c1"># Makes label more distant to axis</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#b4c6e4"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="c1"># Darker blue</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">250</span><span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Metric</span> <span class="o">==</span> <span class="s2">"DEMAND"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Lines between dots</span>
<span class="n">line</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">bar_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">strokeWidth</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">)</span> <span class="c1"># Sets width and transparency</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"month"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">"Value"</span><span class="p">,</span> <span class="n">detail</span> <span class="o">=</span> <span class="s2">"month"</span><span class="p">)</span> <span class="c1"># detail = month makes a line per month</span>
<span class="p">)</span>                                                                           <span class="c1"># instead of a single one</span>

<span class="c1"># Text inside the dots</span>
<span class="n">text</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">bar_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">()</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"month"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="s2">"Value"</span><span class="p">,</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Value:Q"</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s2">".2s"</span><span class="p">),</span> <span class="c1"># Formats 10000 as 10k</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Metric</span> <span class="o">==</span> <span class="s2">"DEMAND"</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"black"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"white"</span><span class="p">)</span> <span class="c1"># Set color depending on metric</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Set legend for Metric</span>
<span class="n">label1</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"DEMAND"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">17</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#4871b7"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">label2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"CAPACITY"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#4871b7"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"bold"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">dot_plot</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">dots1</span> <span class="o">+</span> <span class="n">dots2</span> <span class="o">+</span> <span class="n">text</span> <span class="o">+</span> <span class="n">label1</span> <span class="o">+</span> <span class="n">label2</span>
<span class="n">dot_plot</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[47]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-52fd46cc249f481b96569e93b9aad40e.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-52fd46cc249f481b96569e93b9aad40e.vega-embed details,
  #altair-viz-52fd46cc249f481b96569e93b9aad40e.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-52fd46cc249f481b96569e93b9aad40e"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-52fd46cc249f481b96569e93b9aad40e") {
      outputDiv = document.getElementById("altair-viz-52fd46cc249f481b96569e93b9aad40e");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "opacity": 0.25, "strokeWidth": 25}, "encoding": {"detail": {"field": "month", "type": "nominal"}, "x": {"field": "month", "sort": null, "type": "nominal"}, "y": {"field": "Value", "type": "quantitative"}}}, {"mark": {"type": "circle", "opacity": 1, "size": 600}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#4871b7"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "labelPadding": 10, "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 60000]}, "title": "# OF PROJECT HOURS", "type": "quantitative"}}, "title": {"text": "Demand vs capacity over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": "(datum.Metric === 'CAPACITY')"}]}, {"mark": {"type": "circle", "filled": false, "opacity": 1, "size": 600}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#b4c6e4"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "labelPadding": 10, "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 60000]}, "title": "# OF PROJECT HOURS", "type": "quantitative"}}, "title": {"text": "Demand vs capacity over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": "(datum.Metric === 'DEMAND')"}]}, {"mark": {"type": "text"}, "encoding": {"color": {"condition": {"test": "(datum.Metric === 'DEMAND')", "value": "black"}, "value": "white"}, "text": {"field": "Value", "format": ".2s", "type": "quantitative"}, "x": {"field": "month", "sort": null, "type": "nominal"}, "y": {"field": "Value", "type": "quantitative"}}}, {"data": {"name": "data-236c70691cbd81f5f11f1ce0d980efb8"}, "mark": {"type": "text", "align": "left", "color": "#4871b7", "dx": 200, "dy": -17, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-6b100461ad86d17fc030d068d1e8d22d"}, "mark": {"type": "text", "align": "left", "color": "#4871b7", "dx": 200, "dy": 25, "fontWeight": "bold", "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "data": {"name": "data-f53bb01febd214e9ecb3cb7fbc625fc6"}, "height": 250, "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-f53bb01febd214e9ecb3cb7fbc625fc6": [{"Metric": "CAPACITY", "Value": 29263, "year": 2019, "month": "Apr"}, {"Metric": "CAPACITY", "Value": 28037, "year": 2019, "month": "May"}, {"Metric": "CAPACITY", "Value": 21596, "year": 2019, "month": "Jun"}, {"Metric": "CAPACITY", "Value": 25895, "year": 2019, "month": "Jul"}, {"Metric": "CAPACITY", "Value": 25813, "year": 2019, "month": "Aug"}, {"Metric": "CAPACITY", "Value": 22427, "year": 2019, "month": "Sep"}, {"Metric": "CAPACITY", "Value": 23605, "year": 2019, "month": "Oct"}, {"Metric": "CAPACITY", "Value": 24263, "year": 2019, "month": "Nov"}, {"Metric": "CAPACITY", "Value": 24243, "year": 2019, "month": "Dec"}, {"Metric": "DEMAND", "Value": 46193, "year": 2019, "month": "Apr"}, {"Metric": "DEMAND", "Value": 49131, "year": 2019, "month": "May"}, {"Metric": "DEMAND", "Value": 50124, "year": 2019, "month": "Jun"}, {"Metric": "DEMAND", "Value": 48850, "year": 2019, "month": "Jul"}, {"Metric": "DEMAND", "Value": 47602, "year": 2019, "month": "Aug"}, {"Metric": "DEMAND", "Value": 43697, "year": 2019, "month": "Sep"}, {"Metric": "DEMAND", "Value": 41058, "year": 2019, "month": "Oct"}, {"Metric": "DEMAND", "Value": 37364, "year": 2019, "month": "Nov"}, {"Metric": "DEMAND", "Value": 34364, "year": 2019, "month": "Dec"}], "data-236c70691cbd81f5f11f1ce0d980efb8": [{"text": ["DEMAND"]}], "data-6b100461ad86d17fc030d068d1e8d22d": [{"text": ["CAPACITY"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[49]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Dot plot, filled-only version</span>
<span class="n">dots</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">bar_table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Demand vs capacity over time"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_circle</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">600</span><span class="p">,</span> <span class="n">opacity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># Max opacity, filled by default</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">domain</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60000</span><span class="p">]),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"# OF PROJECT HOURS"</span>
        <span class="p">),</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">labelPadding</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#4871b7"</span><span class="p">,</span> <span class="s2">"#b4c6e4"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">250</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">dot_plot</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">dots</span> <span class="o">+</span> <span class="n">text</span> <span class="o">+</span> <span class="n">label1</span> <span class="o">+</span> <span class="n">label2</span>
<span class="n">dot_plot</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[49]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-bda3d82b2ce849cf803edfaf610e64c1.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-bda3d82b2ce849cf803edfaf610e64c1.vega-embed details,
  #altair-viz-bda3d82b2ce849cf803edfaf610e64c1.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-bda3d82b2ce849cf803edfaf610e64c1"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-bda3d82b2ce849cf803edfaf610e64c1") {
      outputDiv = document.getElementById("altair-viz-bda3d82b2ce849cf803edfaf610e64c1");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "opacity": 0.25, "strokeWidth": 25}, "encoding": {"detail": {"field": "month", "type": "nominal"}, "x": {"field": "month", "sort": null, "type": "nominal"}, "y": {"field": "Value", "type": "quantitative"}}}, {"mark": {"type": "circle", "opacity": 1, "size": 600}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#4871b7", "#b4c6e4"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "labelPadding": 10, "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 60000]}, "title": "# OF PROJECT HOURS", "type": "quantitative"}}, "title": {"text": "Demand vs capacity over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"mark": {"type": "text"}, "encoding": {"color": {"condition": {"test": "(datum.Metric === 'DEMAND')", "value": "black"}, "value": "white"}, "text": {"field": "Value", "format": ".2s", "type": "quantitative"}, "x": {"field": "month", "sort": null, "type": "nominal"}, "y": {"field": "Value", "type": "quantitative"}}}, {"data": {"name": "data-236c70691cbd81f5f11f1ce0d980efb8"}, "mark": {"type": "text", "align": "left", "color": "#4871b7", "dx": 200, "dy": -17, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-6b100461ad86d17fc030d068d1e8d22d"}, "mark": {"type": "text", "align": "left", "color": "#4871b7", "dx": 200, "dy": 25, "fontWeight": "bold", "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "data": {"name": "data-f53bb01febd214e9ecb3cb7fbc625fc6"}, "height": 250, "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-f53bb01febd214e9ecb3cb7fbc625fc6": [{"Metric": "CAPACITY", "Value": 29263, "year": 2019, "month": "Apr"}, {"Metric": "CAPACITY", "Value": 28037, "year": 2019, "month": "May"}, {"Metric": "CAPACITY", "Value": 21596, "year": 2019, "month": "Jun"}, {"Metric": "CAPACITY", "Value": 25895, "year": 2019, "month": "Jul"}, {"Metric": "CAPACITY", "Value": 25813, "year": 2019, "month": "Aug"}, {"Metric": "CAPACITY", "Value": 22427, "year": 2019, "month": "Sep"}, {"Metric": "CAPACITY", "Value": 23605, "year": 2019, "month": "Oct"}, {"Metric": "CAPACITY", "Value": 24263, "year": 2019, "month": "Nov"}, {"Metric": "CAPACITY", "Value": 24243, "year": 2019, "month": "Dec"}, {"Metric": "DEMAND", "Value": 46193, "year": 2019, "month": "Apr"}, {"Metric": "DEMAND", "Value": 49131, "year": 2019, "month": "May"}, {"Metric": "DEMAND", "Value": 50124, "year": 2019, "month": "Jun"}, {"Metric": "DEMAND", "Value": 48850, "year": 2019, "month": "Jul"}, {"Metric": "DEMAND", "Value": 47602, "year": 2019, "month": "Aug"}, {"Metric": "DEMAND", "Value": 43697, "year": 2019, "month": "Sep"}, {"Metric": "DEMAND", "Value": 41058, "year": 2019, "month": "Oct"}, {"Metric": "DEMAND", "Value": 37364, "year": 2019, "month": "Nov"}, {"Metric": "DEMAND", "Value": 34364, "year": 2019, "month": "Dec"}], "data-236c70691cbd81f5f11f1ce0d980efb8": [{"text": ["DEMAND"]}], "data-6b100461ad86d17fc030d068d1e8d22d": [{"text": ["CAPACITY"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/2_4e.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Graph-the-difference">Graph the difference<a class="anchor-link" href="#Graph-the-difference"></a></h4><p>For the final visualization, it was chosen a simple line plot representing the unmet demand. Although minimalist and clean, this choice occults data from the actual value of demand and capacity.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[48]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">unmet_2019</span><span class="p">,</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
        <span class="s2">"Unmet demand over time"</span><span class="p">,</span>
        <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
        <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
        <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
        <span class="s2">"Value"</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>  
            <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
            <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
            <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
        <span class="p">),</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">"NUMBER OF PROJECT HOURS"</span>
    <span class="p">),</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s2">"month"</span><span class="p">,</span>
        <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
            <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
            <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
            <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="p">),</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">"2019"</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">strokeWidth</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># Set thickness of the line</span>
<span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mi">375</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">250</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span>
    <span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[48]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-2020cc2a98f04174bc62b53676889c36.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-2020cc2a98f04174bc62b53676889c36.vega-embed details,
  #altair-viz-2020cc2a98f04174bc62b53676889c36.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-2020cc2a98f04174bc62b53676889c36"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-2020cc2a98f04174bc62b53676889c36") {
      outputDiv = document.getElementById("altair-viz-2020cc2a98f04174bc62b53676889c36");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "data": {"name": "data-f28fc1ada5012de1dec1069913cd61cf"}, "mark": {"type": "line"}, "encoding": {"strokeWidth": {"value": 3}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "title": "NUMBER OF PROJECT HOURS", "type": "quantitative"}}, "height": 250, "title": {"text": "Unmet demand over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "width": 375, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-f28fc1ada5012de1dec1069913cd61cf": [{"Metric": "UNMET DEMAND", "Value": 16930, "year": 2019, "month": "Apr"}, {"Metric": "UNMET DEMAND", "Value": 21094, "year": 2019, "month": "May"}, {"Metric": "UNMET DEMAND", "Value": 28528, "year": 2019, "month": "Jun"}, {"Metric": "UNMET DEMAND", "Value": 22955, "year": 2019, "month": "Jul"}, {"Metric": "UNMET DEMAND", "Value": 21789, "year": 2019, "month": "Aug"}, {"Metric": "UNMET DEMAND", "Value": 21270, "year": 2019, "month": "Sep"}, {"Metric": "UNMET DEMAND", "Value": 17453, "year": 2019, "month": "Oct"}, {"Metric": "UNMET DEMAND", "Value": 13101, "year": 2019, "month": "Nov"}, {"Metric": "UNMET DEMAND", "Value": 10121, "year": 2019, "month": "Dec"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/2_4f.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Interactivity">Interactivity<a class="anchor-link" href="#Interactivity"></a></h4><p>The initial idea was to make an interactive version of the Overlapping graph where the opacity adjusts when the mouse in near the column, similarly to the one in Exercise 2.1. Despite the tooltip functioning correctly, the hover feature failed to identify all graphs in the layering. As a result, only the Demand bars were highlighted.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[49]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Define hover</span>
<span class="n">hover</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection_point</span><span class="p">(</span><span class="n">on</span> <span class="o">=</span> <span class="s2">"mouseover"</span><span class="p">,</span> <span class="n">nearest</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">empty</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="n">demand</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">demand_2019</span><span class="p">,</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Step</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Demand vs capacity over time"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span>
            <span class="p">),</span>
            <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60000</span><span class="p">]),</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">"NUMBER OF PROJECT HOURS"</span>
        <span class="p">),</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
        <span class="p">),</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">hover</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)),</span>  <span class="c1"># Set opacity according to hover</span>
        <span class="n">tooltip</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Value:Q"</span><span class="p">,</span> <span class="s2">"Metric"</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">hover</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Capacity bar, bigger size and more transparency</span>
<span class="n">capacity</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">capacity_2019</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60000</span><span class="p">]),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"NUMBER OF PROJECT HOURS"</span>
        <span class="p">),</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
        <span class="p">),</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">hover</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)),</span>
        <span class="n">tooltip</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Value:Q"</span><span class="p">,</span> <span class="s2">"Metric"</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">hover</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">overlap</span> <span class="o">=</span> <span class="n">demand</span> <span class="o">+</span> <span class="n">capacity</span> 

<span class="n">overlap</span><span class="o">.</span><span class="n">configure_scale</span><span class="p">(</span><span class="n">bandPaddingInner</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">200</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[49]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-9e944147ca364b0cbf30c0aa2691bb18.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-9e944147ca364b0cbf30c0aa2691bb18.vega-embed details,
  #altair-viz-9e944147ca364b0cbf30c0aa2691bb18.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-9e944147ca364b0cbf30c0aa2691bb18"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-9e944147ca364b0cbf30c0aa2691bb18") {
      outputDiv = document.getElementById("altair-viz-9e944147ca364b0cbf30c0aa2691bb18");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}, "scale": {"bandPaddingInner": 0.5}}, "layer": [{"data": {"name": "data-e534e8b67a67e2c71dfef5a17d5b54f3"}, "mark": {"type": "bar"}, "encoding": {"opacity": {"condition": {"param": "param_2", "value": 1, "empty": false}, "value": 0.5}, "tooltip": [{"field": "Value", "type": "quantitative"}, {"field": "Metric", "type": "nominal"}], "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888"}, "field": "month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888"}, "field": "Value", "scale": {"domain": [0, 60000]}, "title": "NUMBER OF PROJECT HOURS", "type": "quantitative"}}, "name": "view_1", "title": {"text": "Demand vs capacity over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal"}}, {"data": {"name": "data-6563dc1165a072f2ab68a801d7f1a3ed"}, "mark": {"type": "bar", "size": 30}, "encoding": {"opacity": {"condition": {"param": "param_2", "value": 1, "empty": false}, "value": 0.5}, "tooltip": [{"field": "Value", "type": "quantitative"}, {"field": "Metric", "type": "nominal"}], "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 60000]}, "title": "NUMBER OF PROJECT HOURS", "type": "quantitative"}}}], "height": 200, "params": [{"name": "param_2", "select": {"type": "point", "nearest": true, "on": "mouseover"}, "views": ["view_1"]}], "width": {"step": 40}, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-e534e8b67a67e2c71dfef5a17d5b54f3": [{"Metric": "DEMAND", "Value": 46193, "year": 2019, "month": "Apr"}, {"Metric": "DEMAND", "Value": 49131, "year": 2019, "month": "May"}, {"Metric": "DEMAND", "Value": 50124, "year": 2019, "month": "Jun"}, {"Metric": "DEMAND", "Value": 48850, "year": 2019, "month": "Jul"}, {"Metric": "DEMAND", "Value": 47602, "year": 2019, "month": "Aug"}, {"Metric": "DEMAND", "Value": 43697, "year": 2019, "month": "Sep"}, {"Metric": "DEMAND", "Value": 41058, "year": 2019, "month": "Oct"}, {"Metric": "DEMAND", "Value": 37364, "year": 2019, "month": "Nov"}, {"Metric": "DEMAND", "Value": 34364, "year": 2019, "month": "Dec"}], "data-6563dc1165a072f2ab68a801d7f1a3ed": [{"Metric": "CAPACITY", "Value": 29263, "year": 2019, "month": "Apr"}, {"Metric": "CAPACITY", "Value": 28037, "year": 2019, "month": "May"}, {"Metric": "CAPACITY", "Value": 21596, "year": 2019, "month": "Jun"}, {"Metric": "CAPACITY", "Value": 25895, "year": 2019, "month": "Jul"}, {"Metric": "CAPACITY", "Value": 25813, "year": 2019, "month": "Aug"}, {"Metric": "CAPACITY", "Value": 22427, "year": 2019, "month": "Sep"}, {"Metric": "CAPACITY", "Value": 23605, "year": 2019, "month": "Oct"}, {"Metric": "CAPACITY", "Value": 24263, "year": 2019, "month": "Nov"}, {"Metric": "CAPACITY", "Value": 24243, "year": 2019, "month": "Dec"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Due to a lack of documentation about interactivity in layered charts, no solution to this problem was found.</p>
<p>The final interactive graph for this exercise was the line graph.  Rather than keeping the "Capacity and Demand" graph distinct from the "Unmet Demand" one, we opted for a consolidated approach with three lines.</p>
<p>Users can now choose the data to emphasize through a dropdown box. Additionally, each year features a tooltip marked by a point for enhanced clarity.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[50]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Sorts so that the metrics in the tooltip aligns with the graphs order</span>
<span class="n">custom_order</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"DEMAND"</span><span class="p">,</span> <span class="s2">"CAPACITY"</span><span class="p">,</span> <span class="s2">"UNMET DEMAND"</span><span class="p">]</span> 
<span class="n">sorted_metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">metric</span> <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">custom_order</span> <span class="k">if</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">table_2019</span><span class="p">[</span><span class="s2">"Metric"</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()]</span>

<span class="c1"># Creates the dropdown</span>
<span class="n">dropdown</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding_select</span><span class="p">(</span><span class="n">options</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sorted_metrics</span><span class="p">),</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"SELECT LINE:  "</span><span class="p">)</span>
<span class="n">selection</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection_point</span><span class="p">(</span><span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Metric"</span><span class="p">],</span> <span class="n">bind</span> <span class="o">=</span> <span class="n">dropdown</span><span class="p">)</span>

<span class="n">line</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">table_2019</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Demand and capacity over time: unmet demand calculated"</span><span class="p">,</span> <span class="c1"># Changes title</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">point</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>  <span class="c1"># Create a point at each month</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60000</span><span class="p">]),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"NUMBER OF PROJECT HOURS"</span>
        <span class="p">),</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Disabling sorting for better time representation</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span> <span class="c1"># Set colors to gray</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#1f77b4"</span><span class="p">,</span> <span class="s2">"#1f77b4"</span><span class="p">,</span> <span class="s2">"red"</span><span class="p">]),</span> <span class="c1"># Unmet demand is red</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">selection</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="p">),</span>  <span class="c1"># Adjusting opacity based on the dropdown</span>
        <span class="n">tooltip</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="s2">"month"</span><span class="p">,</span> <span class="s2">"Value"</span><span class="p">]</span> <span class="c1"># Sets tooltip</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">350</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">250</span><span class="p">)</span> 
<span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>


<span class="c1"># Demand label</span>
<span class="n">label1</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> 
                    <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span>  <span class="p">[</span><span class="s1">'DEMAND'</span><span class="p">]}]</span>
                    <span class="p">}</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                                <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> 
                                <span class="n">dx</span> <span class="o">=</span> <span class="mi">165</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> 
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">'#1f77b4'</span><span class="p">,</span> <span class="c1"># Color it blue</span>
                                <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span> <span class="c1"># Bold font</span>
                                <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
                                    <span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">,</span>
                                    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
                                            <span class="n">selection</span><span class="p">,</span> 
                                            <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> 
                                            <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                                            <span class="p">)</span> <span class="c1"># Label disappears when any line is selected</span>
                                        <span class="p">)</span>

<span class="c1"># Capacity label</span>
<span class="n">label2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> 
                    <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span>  <span class="p">[</span><span class="s1">'CAPACITY'</span><span class="p">]}]</span>
                    <span class="p">}</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                                <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> 
                                <span class="n">dx</span> <span class="o">=</span> <span class="mi">165</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> 
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">'#1f77b4'</span><span class="p">,</span> <span class="c1"># Color it blue</span>
                                <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span>
                                <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
                                    <span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">,</span>
                                    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
                                            <span class="n">selection</span><span class="p">,</span> 
                                            <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> 
                                            <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                                            <span class="p">)</span> <span class="c1"># Label disappears when any line is selected</span>
                                        <span class="p">)</span>
<span class="c1"># Unmet demand label</span>
<span class="n">label3</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> 
                    <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span>  <span class="p">[</span><span class="s1">'UNMET DEMAND'</span><span class="p">]}]</span>
                    <span class="p">}</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                                <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> 
                                <span class="n">dx</span> <span class="o">=</span> <span class="mi">165</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">82</span><span class="p">,</span> 
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">'red'</span><span class="p">,</span> <span class="c1"># Color it blue</span>
                                <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span>
                                <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
                                    <span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">,</span>
                                    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
                                            <span class="n">selection</span><span class="p">,</span> 
                                            <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> 
                                            <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                                            <span class="p">)</span> <span class="c1"># Label disappears when any line is selected</span>
                                        <span class="p">)</span>

<span class="n">line_final</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">label1</span> <span class="o">+</span> <span class="n">label2</span> <span class="o">+</span> <span class="n">label3</span>
<span class="n">line_final</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[50]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-9eefc9df78c6432a9e61d8c9759f03d8.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-9eefc9df78c6432a9e61d8c9759f03d8.vega-embed details,
  #altair-viz-9eefc9df78c6432a9e61d8c9759f03d8.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-9eefc9df78c6432a9e61d8c9759f03d8"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-9eefc9df78c6432a9e61d8c9759f03d8") {
      outputDiv = document.getElementById("altair-viz-9eefc9df78c6432a9e61d8c9759f03d8");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-b6f8f6b5b4ff5878a9e1f472fe76c407"}, "mark": {"type": "line", "point": true}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#1f77b4", "#1f77b4", "red"]}, "type": "nominal"}, "opacity": {"condition": {"param": "param_3", "value": 1}, "value": 0.1}, "tooltip": [{"field": "Metric", "type": "nominal"}, {"field": "month", "type": "nominal"}, {"field": "Value", "type": "quantitative"}], "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 60000]}, "title": "NUMBER OF PROJECT HOURS", "type": "quantitative"}}, "name": "view_2", "title": {"text": "Demand and capacity over time: unmet demand calculated", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "data-236c70691cbd81f5f11f1ce0d980efb8"}, "mark": {"type": "text", "align": "left", "color": "#1f77b4", "dx": 165, "dy": -15, "fontWeight": 700, "size": 10}, "encoding": {"opacity": {"condition": {"param": "param_3", "value": 1}, "value": 0}, "text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-6b100461ad86d17fc030d068d1e8d22d"}, "mark": {"type": "text", "align": "left", "color": "#1f77b4", "dx": 165, "dy": 25, "fontWeight": 700, "size": 10}, "encoding": {"opacity": {"condition": {"param": "param_3", "value": 1}, "value": 0}, "text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-bf433cd9a623fafb6f561ad388d191f1"}, "mark": {"type": "text", "align": "left", "color": "red", "dx": 165, "dy": 82, "fontWeight": 700, "size": 10}, "encoding": {"opacity": {"condition": {"param": "param_3", "value": 1}, "value": 0}, "text": {"field": "text", "type": "nominal"}}}], "height": 250, "params": [{"name": "param_3", "select": {"type": "point", "fields": ["Metric"]}, "bind": {"input": "select", "options": ["DEMAND", "CAPACITY", "UNMET DEMAND"], "name": "SELECT LINE:  "}, "views": ["view_2"]}], "width": 350, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-b6f8f6b5b4ff5878a9e1f472fe76c407": [{"Metric": "CAPACITY", "Value": 29263, "year": 2019, "month": "Apr"}, {"Metric": "CAPACITY", "Value": 28037, "year": 2019, "month": "May"}, {"Metric": "CAPACITY", "Value": 21596, "year": 2019, "month": "Jun"}, {"Metric": "CAPACITY", "Value": 25895, "year": 2019, "month": "Jul"}, {"Metric": "CAPACITY", "Value": 25813, "year": 2019, "month": "Aug"}, {"Metric": "CAPACITY", "Value": 22427, "year": 2019, "month": "Sep"}, {"Metric": "CAPACITY", "Value": 23605, "year": 2019, "month": "Oct"}, {"Metric": "CAPACITY", "Value": 24263, "year": 2019, "month": "Nov"}, {"Metric": "CAPACITY", "Value": 24243, "year": 2019, "month": "Dec"}, {"Metric": "DEMAND", "Value": 46193, "year": 2019, "month": "Apr"}, {"Metric": "DEMAND", "Value": 49131, "year": 2019, "month": "May"}, {"Metric": "DEMAND", "Value": 50124, "year": 2019, "month": "Jun"}, {"Metric": "DEMAND", "Value": 48850, "year": 2019, "month": "Jul"}, {"Metric": "DEMAND", "Value": 47602, "year": 2019, "month": "Aug"}, {"Metric": "DEMAND", "Value": 43697, "year": 2019, "month": "Sep"}, {"Metric": "DEMAND", "Value": 41058, "year": 2019, "month": "Oct"}, {"Metric": "DEMAND", "Value": 37364, "year": 2019, "month": "Nov"}, {"Metric": "DEMAND", "Value": 34364, "year": 2019, "month": "Dec"}, {"Metric": "UNMET DEMAND", "Value": 16930, "year": 2019, "month": "Apr"}, {"Metric": "UNMET DEMAND", "Value": 21094, "year": 2019, "month": "May"}, {"Metric": "UNMET DEMAND", "Value": 28528, "year": 2019, "month": "Jun"}, {"Metric": "UNMET DEMAND", "Value": 22955, "year": 2019, "month": "Jul"}, {"Metric": "UNMET DEMAND", "Value": 21789, "year": 2019, "month": "Aug"}, {"Metric": "UNMET DEMAND", "Value": 21270, "year": 2019, "month": "Sep"}, {"Metric": "UNMET DEMAND", "Value": 17453, "year": 2019, "month": "Oct"}, {"Metric": "UNMET DEMAND", "Value": 13101, "year": 2019, "month": "Nov"}, {"Metric": "UNMET DEMAND", "Value": 10121, "year": 2019, "month": "Dec"}], "data-236c70691cbd81f5f11f1ce0d980efb8": [{"text": ["DEMAND"]}], "data-6b100461ad86d17fc030d068d1e8d22d": [{"text": ["CAPACITY"]}], "data-bf433cd9a623fafb6f561ad388d191f1": [{"text": ["UNMET DEMAND"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Alternatively, we can make a simple selection with a radio button, including an option for all lines.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[51]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'DEMAND'</span><span class="p">,</span> <span class="s1">'CAPACITY'</span><span class="p">,</span> <span class="s1">'UNMET DEMAND'</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">option</span> <span class="o">+</span> <span class="s1">' '</span> <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">options</span><span class="p">]</span>


<span class="n">input_dropdown</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding_radio</span><span class="p">(</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">options</span> <span class="o">+</span> <span class="p">[</span><span class="kc">None</span><span class="p">],</span> <span class="c1"># Create the option for all lines</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'ALL'</span><span class="p">],</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">'SELECT LINE: '</span>
<span class="p">)</span>

<span class="c1"># Create the selection</span>
<span class="n">selection</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection_point</span><span class="p">(</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Metric'</span><span class="p">],</span>
    <span class="n">bind</span> <span class="o">=</span> <span class="n">input_dropdown</span>
<span class="p">)</span>


<span class="n">line</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">table_2019</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Demand and capacity over time: unmet demand calculated"</span><span class="p">,</span> <span class="c1"># Changes title</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">point</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>  <span class="c1"># Create a point at each month</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60000</span><span class="p">]),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"NUMBER OF PROJECT HOURS"</span>
        <span class="p">),</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Disabling sorting for better time representation</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span> <span class="c1"># Set colors to gray</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="n">options</span><span class="p">)</span> <span class="c1"># Instead of changing the opacity </span>
        <span class="p">),</span>                                       <span class="c1"># in this example, we will limit the domain</span>
        <span class="n">tooltip</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="s2">"month"</span><span class="p">,</span> <span class="s2">"Value"</span><span class="p">]</span> <span class="c1"># Sets tooltip</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">350</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">250</span><span class="p">)</span> 
<span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>

<span class="n">line_final</span> <span class="o">=</span> <span class="n">line</span> 
<span class="n">line_final</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[51]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-72f1973d922b41e79ebdcea15e4dad8e.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-72f1973d922b41e79ebdcea15e4dad8e.vega-embed details,
  #altair-viz-72f1973d922b41e79ebdcea15e4dad8e.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-72f1973d922b41e79ebdcea15e4dad8e"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-72f1973d922b41e79ebdcea15e4dad8e") {
      outputDiv = document.getElementById("altair-viz-72f1973d922b41e79ebdcea15e4dad8e");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "data": {"name": "data-b6f8f6b5b4ff5878a9e1f472fe76c407"}, "mark": {"type": "line", "point": true}, "encoding": {"color": {"field": "Metric", "scale": {"domain": ["DEMAND", "CAPACITY", "UNMET DEMAND"]}, "type": "nominal"}, "tooltip": [{"field": "Metric", "type": "nominal"}, {"field": "month", "type": "nominal"}, {"field": "Value", "type": "quantitative"}], "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 60000]}, "title": "NUMBER OF PROJECT HOURS", "type": "quantitative"}}, "height": 250, "params": [{"name": "param_4", "select": {"type": "point", "fields": ["Metric"]}, "bind": {"input": "radio", "options": ["DEMAND", "CAPACITY", "UNMET DEMAND", null], "labels": ["DEMAND ", "CAPACITY ", "UNMET DEMAND ", "ALL"], "name": "SELECT LINE: "}}], "title": {"text": "Demand and capacity over time: unmet demand calculated", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": {"param": "param_4"}}], "width": 350, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-b6f8f6b5b4ff5878a9e1f472fe76c407": [{"Metric": "CAPACITY", "Value": 29263, "year": 2019, "month": "Apr"}, {"Metric": "CAPACITY", "Value": 28037, "year": 2019, "month": "May"}, {"Metric": "CAPACITY", "Value": 21596, "year": 2019, "month": "Jun"}, {"Metric": "CAPACITY", "Value": 25895, "year": 2019, "month": "Jul"}, {"Metric": "CAPACITY", "Value": 25813, "year": 2019, "month": "Aug"}, {"Metric": "CAPACITY", "Value": 22427, "year": 2019, "month": "Sep"}, {"Metric": "CAPACITY", "Value": 23605, "year": 2019, "month": "Oct"}, {"Metric": "CAPACITY", "Value": 24263, "year": 2019, "month": "Nov"}, {"Metric": "CAPACITY", "Value": 24243, "year": 2019, "month": "Dec"}, {"Metric": "DEMAND", "Value": 46193, "year": 2019, "month": "Apr"}, {"Metric": "DEMAND", "Value": 49131, "year": 2019, "month": "May"}, {"Metric": "DEMAND", "Value": 50124, "year": 2019, "month": "Jun"}, {"Metric": "DEMAND", "Value": 48850, "year": 2019, "month": "Jul"}, {"Metric": "DEMAND", "Value": 47602, "year": 2019, "month": "Aug"}, {"Metric": "DEMAND", "Value": 43697, "year": 2019, "month": "Sep"}, {"Metric": "DEMAND", "Value": 41058, "year": 2019, "month": "Oct"}, {"Metric": "DEMAND", "Value": 37364, "year": 2019, "month": "Nov"}, {"Metric": "DEMAND", "Value": 34364, "year": 2019, "month": "Dec"}, {"Metric": "UNMET DEMAND", "Value": 16930, "year": 2019, "month": "Apr"}, {"Metric": "UNMET DEMAND", "Value": 21094, "year": 2019, "month": "May"}, {"Metric": "UNMET DEMAND", "Value": 28528, "year": 2019, "month": "Jun"}, {"Metric": "UNMET DEMAND", "Value": 22955, "year": 2019, "month": "Jul"}, {"Metric": "UNMET DEMAND", "Value": 21789, "year": 2019, "month": "Aug"}, {"Metric": "UNMET DEMAND", "Value": 21270, "year": 2019, "month": "Sep"}, {"Metric": "UNMET DEMAND", "Value": 17453, "year": 2019, "month": "Oct"}, {"Metric": "UNMET DEMAND", "Value": 13101, "year": 2019, "month": "Nov"}, {"Metric": "UNMET DEMAND", "Value": 10121, "year": 2019, "month": "Dec"}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Exercise-2.5---How-would-you-show-this-data?">Exercise 2.5 - How would you show this data?<a name="2.5"></a><a class="anchor-link" href="#Exercise-2.5---How-would-you-show-this-data?"></a></h3><p>This exercise shows a table and asks the viewer how would they show the data. We will replicate the visual answers given by the author.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Loading-the-data">Loading the data<a class="anchor-link" href="#Loading-the-data"></a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[52]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Loading considering the NaN caused by Excel formatting</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Data\2.5 EXERCISE.xlsx"</span><span class="p">,</span> <span class="n">usecols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">table</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[52]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Year</th>
<th>Attrition Rate</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2019</td>
<td>0.0910</td>
</tr>
<tr>
<th>1</th>
<td>2018</td>
<td>0.0820</td>
</tr>
<tr>
<th>2</th>
<td>2017</td>
<td>0.0450</td>
</tr>
<tr>
<th>3</th>
<td>2016</td>
<td>0.1230</td>
</tr>
<tr>
<th>4</th>
<td>2015</td>
<td>0.0560</td>
</tr>
<tr>
<th>5</th>
<td>2014</td>
<td>0.1510</td>
</tr>
<tr>
<th>6</th>
<td>2013</td>
<td>0.0700</td>
</tr>
<tr>
<th>7</th>
<td>2012</td>
<td>0.0100</td>
</tr>
<tr>
<th>8</th>
<td>2011</td>
<td>0.0200</td>
</tr>
<tr>
<th>9</th>
<td>2010</td>
<td>0.0970</td>
</tr>
<tr>
<th>10</th>
<td>AVG</td>
<td>0.0745</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>First, we will drop the "AVG" (Average) column, as it will not be a data point in our graphs. It is better to calculate it separately when needed.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[53]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Dot-plot">Dot plot<a class="anchor-link" href="#Dot-plot"></a></h4><p>When attempting the first scatter plot, we realize that Altair incorrectly classifies the data type of the "Year" column. This can be fixed by specifying the correct date type (:O, as of, Ordinary).</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[54]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Without data type</span>

<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'Year'</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Attrition Rate'</span><span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[54]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-4ea9e303d04e464b95b64d5850d1e93e.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-4ea9e303d04e464b95b64d5850d1e93e.vega-embed details,
  #altair-viz-4ea9e303d04e464b95b64d5850d1e93e.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-4ea9e303d04e464b95b64d5850d1e93e"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-4ea9e303d04e464b95b64d5850d1e93e") {
      outputDiv = document.getElementById("altair-viz-4ea9e303d04e464b95b64d5850d1e93e");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-0a7ed12b3693b0f6b7061ff4e2683f48"}, "mark": {"type": "point", "filled": true}, "encoding": {"x": {"field": "Year", "type": "quantitative"}, "y": {"field": "Attrition Rate", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0a7ed12b3693b0f6b7061ff4e2683f48": [{"Year": 2019, "Attrition Rate": 0.091}, {"Year": 2018, "Attrition Rate": 0.082}, {"Year": 2017, "Attrition Rate": 0.045}, {"Year": 2016, "Attrition Rate": 0.123}, {"Year": 2015, "Attrition Rate": 0.056}, {"Year": 2014, "Attrition Rate": 0.151}, {"Year": 2013, "Attrition Rate": 0.07}, {"Year": 2012, "Attrition Rate": 0.01}, {"Year": 2011, "Attrition Rate": 0.02}, {"Year": 2010, "Attrition Rate": 0.097}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[55]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># With data type equals temporal</span>

<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'Year:T'</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Attrition Rate'</span><span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[55]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-7da3c8c172ff46aba82f73a90ce06551.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-7da3c8c172ff46aba82f73a90ce06551.vega-embed details,
  #altair-viz-7da3c8c172ff46aba82f73a90ce06551.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-7da3c8c172ff46aba82f73a90ce06551"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-7da3c8c172ff46aba82f73a90ce06551") {
      outputDiv = document.getElementById("altair-viz-7da3c8c172ff46aba82f73a90ce06551");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-0a7ed12b3693b0f6b7061ff4e2683f48"}, "mark": {"type": "point", "filled": true}, "encoding": {"x": {"field": "Year", "type": "temporal"}, "y": {"field": "Attrition Rate", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0a7ed12b3693b0f6b7061ff4e2683f48": [{"Year": 2019, "Attrition Rate": 0.091}, {"Year": 2018, "Attrition Rate": 0.082}, {"Year": 2017, "Attrition Rate": 0.045}, {"Year": 2016, "Attrition Rate": 0.123}, {"Year": 2015, "Attrition Rate": 0.056}, {"Year": 2014, "Attrition Rate": 0.151}, {"Year": 2013, "Attrition Rate": 0.07}, {"Year": 2012, "Attrition Rate": 0.01}, {"Year": 2011, "Attrition Rate": 0.02}, {"Year": 2010, "Attrition Rate": 0.097}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[56]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># With data type equals ordinal </span>

<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'Year:O'</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Attrition Rate'</span><span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[56]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-bb995f16394c403aa891d2d779e76436.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-bb995f16394c403aa891d2d779e76436.vega-embed details,
  #altair-viz-bb995f16394c403aa891d2d779e76436.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-bb995f16394c403aa891d2d779e76436"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-bb995f16394c403aa891d2d779e76436") {
      outputDiv = document.getElementById("altair-viz-bb995f16394c403aa891d2d779e76436");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-0a7ed12b3693b0f6b7061ff4e2683f48"}, "mark": {"type": "point", "filled": true}, "encoding": {"x": {"field": "Year", "type": "ordinal"}, "y": {"field": "Attrition Rate", "type": "quantitative"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0a7ed12b3693b0f6b7061ff4e2683f48": [{"Year": 2019, "Attrition Rate": 0.091}, {"Year": 2018, "Attrition Rate": 0.082}, {"Year": 2017, "Attrition Rate": 0.045}, {"Year": 2016, "Attrition Rate": 0.123}, {"Year": 2015, "Attrition Rate": 0.056}, {"Year": 2014, "Attrition Rate": 0.151}, {"Year": 2013, "Attrition Rate": 0.07}, {"Year": 2012, "Attrition Rate": 0.01}, {"Year": 2011, "Attrition Rate": 0.02}, {"Year": 2010, "Attrition Rate": 0.097}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Initially, we will create a dot plot to visually represent the data over time, incorporating an average line to facilitate comparison.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[57]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Create the base graph with title</span>
<span class="n">base</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">table</span><span class="p">,</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
        <span class="s2">"Attrition rate over time"</span><span class="p">,</span>
        <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
        <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
        <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Make the filled dots</span>
<span class="n">dots</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#2c549d"</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s2">"Year:O"</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span> <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># Align the first dot with the y-axis (0 at x-axis)</span>
    <span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
        <span class="s2">"Attrition Rate"</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
            <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
            <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
            <span class="n">tickCount</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="c1"># Set fixed number of ticks (intervals)</span>
            <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span><span class="p">,</span> <span class="c1"># y-axis data is a percentage</span>
            <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
        <span class="p">),</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">"ATTRITION RATE"</span>
    <span class="p">),</span>
    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Maximum opacity</span>
<span class="p">)</span>

<span class="c1"># Makes a line at the average value</span>
<span class="c1"># strokeDash defines how dotted is the line</span>
<span class="n">rule</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_rule</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">"#2c549d"</span><span class="p">,</span> <span class="n">strokeDash</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">315</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">"mean(Attrition Rate)"</span>
<span class="p">)</span>

<span class="c1"># Text above the average line</span>
<span class="n">label</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"AVERAGE: 7.5%"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">170</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#2c549d"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"bold"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">final_dots</span> <span class="o">=</span> <span class="n">dots</span> <span class="o">+</span> <span class="n">rule</span> <span class="o">+</span> <span class="n">label</span>
<span class="n">final_dots</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[57]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-3d5a410e3d4c45039b72c09c7cd5ae61.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-3d5a410e3d4c45039b72c09c7cd5ae61.vega-embed details,
  #altair-viz-3d5a410e3d4c45039b72c09c7cd5ae61.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-3d5a410e3d4c45039b72c09c7cd5ae61"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-3d5a410e3d4c45039b72c09c7cd5ae61") {
      outputDiv = document.getElementById("altair-viz-3d5a410e3d4c45039b72c09c7cd5ae61");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "point", "color": "#2c549d", "filled": true, "size": 50}, "encoding": {"opacity": {"value": 1}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false}, "field": "Year", "scale": {"align": 0}, "title": null, "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 9, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Attrition Rate", "title": "ATTRITION RATE", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"mark": {"type": "rule", "color": "#2c549d", "strokeDash": [3, 3]}, "encoding": {"x": {"value": 0}, "x2": {"value": 315}, "y": {"aggregate": "mean", "field": "Attrition Rate", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "data-1980b1808ae6a949eac3470c1ac67659"}, "mark": {"type": "text", "align": "left", "color": "#2c549d", "dx": -170, "dy": 0, "fontWeight": "bold", "size": 10}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "data": {"name": "data-0a7ed12b3693b0f6b7061ff4e2683f48"}, "height": 200, "width": 350, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0a7ed12b3693b0f6b7061ff4e2683f48": [{"Year": 2019, "Attrition Rate": 0.091}, {"Year": 2018, "Attrition Rate": 0.082}, {"Year": 2017, "Attrition Rate": 0.045}, {"Year": 2016, "Attrition Rate": 0.123}, {"Year": 2015, "Attrition Rate": 0.056}, {"Year": 2014, "Attrition Rate": 0.151}, {"Year": 2013, "Attrition Rate": 0.07}, {"Year": 2012, "Attrition Rate": 0.01}, {"Year": 2011, "Attrition Rate": 0.02}, {"Year": 2010, "Attrition Rate": 0.097}], "data-1980b1808ae6a949eac3470c1ac67659": [{"text": ["AVERAGE: 7.5%"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/2_5b.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Line-graph">Line graph<a class="anchor-link" href="#Line-graph"></a></h4><p>Next, we will link the dots with a line, aiding in the comparison of value differences.</p>
<p>Once more, omitting the data type in the label specification causes the labels to accumulate on the right side of the graph.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[58]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">line</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">"#2c549d"</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s2">"Year:O"</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span> <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
        <span class="s2">"Attrition Rate"</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
            <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
            <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
            <span class="n">tickCount</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
            <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span><span class="p">,</span>
            <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
        <span class="p">),</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">"ATTRITION RATE"</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Label without specifying data type</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="s2">"max"</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Attrition Rate"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"argmax"</span><span class="p">:</span> <span class="s2">"Year"</span><span class="p">}),</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Attrition Rate"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">final_line</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">rule</span> <span class="o">+</span> <span class="n">label</span>

<span class="n">final_line</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">350</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[58]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-ee79545ebeb540aca10dc930bb2ee65b.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-ee79545ebeb540aca10dc930bb2ee65b.vega-embed details,
  #altair-viz-ee79545ebeb540aca10dc930bb2ee65b.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-ee79545ebeb540aca10dc930bb2ee65b"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-ee79545ebeb540aca10dc930bb2ee65b") {
      outputDiv = document.getElementById("altair-viz-ee79545ebeb540aca10dc930bb2ee65b");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "color": "#2c549d"}, "encoding": {"x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false}, "field": "Year", "scale": {"align": 0}, "title": null, "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 9, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Attrition Rate", "title": "ATTRITION RATE", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"mark": {"type": "rule", "color": "#2c549d", "strokeDash": [3, 3]}, "encoding": {"x": {"value": 0}, "x2": {"value": 315}, "y": {"aggregate": "mean", "field": "Attrition Rate", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"mark": {"type": "text", "align": "left", "dx": 3}, "encoding": {"text": {"field": "Attrition Rate", "type": "quantitative"}, "x": {"aggregate": "max", "field": "Year", "type": "quantitative"}, "y": {"aggregate": {"argmax": "Year"}, "field": "Attrition Rate", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}], "data": {"name": "data-0a7ed12b3693b0f6b7061ff4e2683f48"}, "height": 200, "width": 350, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0a7ed12b3693b0f6b7061ff4e2683f48": [{"Year": 2019, "Attrition Rate": 0.091}, {"Year": 2018, "Attrition Rate": 0.082}, {"Year": 2017, "Attrition Rate": 0.045}, {"Year": 2016, "Attrition Rate": 0.123}, {"Year": 2015, "Attrition Rate": 0.056}, {"Year": 2014, "Attrition Rate": 0.151}, {"Year": 2013, "Attrition Rate": 0.07}, {"Year": 2012, "Attrition Rate": 0.01}, {"Year": 2011, "Attrition Rate": 0.02}, {"Year": 2010, "Attrition Rate": 0.097}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[59]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># With data type</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#2c549d"</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Year:O"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="s2">"max"</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Attrition Rate"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"argmax"</span><span class="p">:</span> <span class="s2">"Year"</span><span class="p">}),</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Attrition Rate"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">final</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">rule</span> <span class="o">+</span> <span class="n">label</span>

<span class="n">final</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[59]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-80e810281ac247278ff3fb0099b70ed8.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-80e810281ac247278ff3fb0099b70ed8.vega-embed details,
  #altair-viz-80e810281ac247278ff3fb0099b70ed8.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-80e810281ac247278ff3fb0099b70ed8"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-80e810281ac247278ff3fb0099b70ed8") {
      outputDiv = document.getElementById("altair-viz-80e810281ac247278ff3fb0099b70ed8");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "color": "#2c549d"}, "encoding": {"x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false}, "field": "Year", "scale": {"align": 0}, "title": null, "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 9, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Attrition Rate", "title": "ATTRITION RATE", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"mark": {"type": "rule", "color": "#2c549d", "strokeDash": [3, 3]}, "encoding": {"x": {"value": 0}, "x2": {"value": 315}, "y": {"aggregate": "mean", "field": "Attrition Rate", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"mark": {"type": "text", "align": "left", "color": "#2c549d", "dx": 3}, "encoding": {"text": {"field": "Attrition Rate", "type": "quantitative"}, "x": {"aggregate": "max", "field": "Year", "type": "ordinal"}, "y": {"aggregate": {"argmax": "Year"}, "field": "Attrition Rate", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}], "data": {"name": "data-0a7ed12b3693b0f6b7061ff4e2683f48"}, "height": 200, "width": 350, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0a7ed12b3693b0f6b7061ff4e2683f48": [{"Year": 2019, "Attrition Rate": 0.091}, {"Year": 2018, "Attrition Rate": 0.082}, {"Year": 2017, "Attrition Rate": 0.045}, {"Year": 2016, "Attrition Rate": 0.123}, {"Year": 2015, "Attrition Rate": 0.056}, {"Year": 2014, "Attrition Rate": 0.151}, {"Year": 2013, "Attrition Rate": 0.07}, {"Year": 2012, "Attrition Rate": 0.01}, {"Year": 2011, "Attrition Rate": 0.02}, {"Year": 2010, "Attrition Rate": 0.097}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>The default method for placing the end label appeared ineffective, as it failed to filter out 2019 as the maximum value in the Year column. This issue can be rectified by straightforwardly filtering the entire dataset to encompass only values where "Year == 2019".</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[60]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Filter 2019 manually</span>

<span class="n">label</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s1">'left'</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'#2c549d'</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s1">'bold'</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'Year:O'</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Attrition Rate'</span><span class="p">),</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s1">'Attrition Rate'</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s2">".1%"</span><span class="p">),</span>
    <span class="n">xOffset</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">),</span> <span class="c1"># Offsets slightly in the x and y-axis</span>
    <span class="n">yOffset</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span> <span class="c1"># Filters</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">FieldEqualPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s1">'Year'</span><span class="p">,</span> <span class="n">equal</span> <span class="o">=</span> <span class="mi">2019</span><span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Label for the Average</span>
<span class="n">label2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> 
                    <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span>  <span class="p">[</span><span class="s1">'AVG: 7.5%'</span><span class="p">]}]</span>
                    <span class="p">}</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                                <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> 
                                <span class="n">dx</span> <span class="o">=</span> <span class="mi">96</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> 
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">'#2c549d'</span><span class="p">,</span>
                                <span class="n">fontWeight</span> <span class="o">=</span> <span class="s1">'bold'</span>
                                <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>


<span class="c1"># Filled point at the end of the line</span>
<span class="n">point</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'Year:O'</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Attrition Rate'</span><span class="p">),</span>
    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">FieldEqualPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s1">'Year'</span><span class="p">,</span> <span class="n">equal</span> <span class="o">=</span> <span class="mi">2019</span><span class="p">)</span>
    <span class="p">)</span>

<span class="n">final_line</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">rule</span> <span class="o">+</span> <span class="n">label</span> <span class="o">+</span> <span class="n">label2</span> <span class="o">+</span> <span class="n">point</span>

<span class="n">final_line</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mi">350</span><span class="p">,</span>
    <span class="n">height</span> <span class="o">=</span> <span class="mi">200</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[60]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-d9a0846378cb4b788f23bfe836899e40.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-d9a0846378cb4b788f23bfe836899e40.vega-embed details,
  #altair-viz-d9a0846378cb4b788f23bfe836899e40.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-d9a0846378cb4b788f23bfe836899e40"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-d9a0846378cb4b788f23bfe836899e40") {
      outputDiv = document.getElementById("altair-viz-d9a0846378cb4b788f23bfe836899e40");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "color": "#2c549d"}, "encoding": {"x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false}, "field": "Year", "scale": {"align": 0}, "title": null, "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 9, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Attrition Rate", "title": "ATTRITION RATE", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"mark": {"type": "rule", "color": "#2c549d", "strokeDash": [3, 3]}, "encoding": {"x": {"value": 0}, "x2": {"value": 315}, "y": {"aggregate": "mean", "field": "Attrition Rate", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"mark": {"type": "text", "align": "left", "color": "#2c549d", "dx": 3, "fontWeight": "bold"}, "encoding": {"text": {"field": "Attrition Rate", "format": ".1%", "type": "quantitative"}, "x": {"field": "Year", "type": "ordinal"}, "xOffset": {"value": -10}, "y": {"field": "Attrition Rate", "type": "quantitative"}, "yOffset": {"value": -10}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": {"equal": 2019, "field": "Year"}}]}, {"data": {"name": "data-237b215111f262900345e668dc9522f9"}, "mark": {"type": "text", "align": "left", "color": "#2c549d", "dx": 96, "dy": 15, "fontWeight": "bold", "size": 10}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-0a7ed12b3693b0f6b7061ff4e2683f48"}, "mark": {"type": "point", "filled": true}, "encoding": {"opacity": {"value": 1}, "x": {"field": "Year", "type": "ordinal"}, "y": {"field": "Attrition Rate", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": {"equal": 2019, "field": "Year"}}]}], "data": {"name": "data-0a7ed12b3693b0f6b7061ff4e2683f48"}, "height": 200, "width": 350, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0a7ed12b3693b0f6b7061ff4e2683f48": [{"Year": 2019, "Attrition Rate": 0.091}, {"Year": 2018, "Attrition Rate": 0.082}, {"Year": 2017, "Attrition Rate": 0.045}, {"Year": 2016, "Attrition Rate": 0.123}, {"Year": 2015, "Attrition Rate": 0.056}, {"Year": 2014, "Attrition Rate": 0.151}, {"Year": 2013, "Attrition Rate": 0.07}, {"Year": 2012, "Attrition Rate": 0.01}, {"Year": 2011, "Attrition Rate": 0.02}, {"Year": 2010, "Attrition Rate": 0.097}], "data-237b215111f262900345e668dc9522f9": [{"text": ["AVG: 7.5%"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/2_5c.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Coloring below the average line may help highlight values below it.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[61]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Calculates average</span>
<span class="n">avg</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">'Attrition Rate'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Creates a rectangle below the average line</span>
<span class="n">rect</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'y'</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">'y2'</span><span class="p">:[</span><span class="n">avg</span><span class="p">]}))</span><span class="o">.</span><span class="n">mark_rect</span><span class="p">(</span>
    <span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="s1">'y'</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="s1">'y2'</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">315</span><span class="p">))</span>

<span class="c1"># Makes a different average label, in lighter color</span>
<span class="n">label2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> 
                    <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span>  <span class="p">[</span><span class="s1">'AVG:'</span><span class="p">,</span> <span class="s1">'7.5%'</span><span class="p">]}]</span>
                    <span class="p">}</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
                                <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> 
                                <span class="n">dx</span> <span class="o">=</span> <span class="mi">113</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> 
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">'#9fb5db'</span><span class="p">,</span>
                                <span class="n">fontWeight</span> <span class="o">=</span> <span class="s1">'bold'</span>
                                <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>

<span class="n">final_line2</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">rect</span> <span class="o">+</span> <span class="n">label</span> <span class="o">+</span> <span class="n">label2</span> <span class="o">+</span> <span class="n">point</span>

<span class="n">final_line2</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mi">350</span><span class="p">,</span>
    <span class="n">height</span> <span class="o">=</span> <span class="mi">200</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[61]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-a4589200e60340aba1c8ec5b9b865bfa.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-a4589200e60340aba1c8ec5b9b865bfa.vega-embed details,
  #altair-viz-a4589200e60340aba1c8ec5b9b865bfa.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-a4589200e60340aba1c8ec5b9b865bfa"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-a4589200e60340aba1c8ec5b9b865bfa") {
      outputDiv = document.getElementById("altair-viz-a4589200e60340aba1c8ec5b9b865bfa");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-0a7ed12b3693b0f6b7061ff4e2683f48"}, "mark": {"type": "line", "color": "#2c549d"}, "encoding": {"x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false}, "field": "Year", "scale": {"align": 0}, "title": null, "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 9, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Attrition Rate", "title": "ATTRITION RATE", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "data-977bb4bb94569206e0f2e1118197c219"}, "mark": {"type": "rect", "opacity": 0.2}, "encoding": {"x": {"value": 0}, "x2": {"value": 315}, "y": {"field": "y", "type": "quantitative"}, "y2": {"field": "y2"}}}, {"data": {"name": "data-0a7ed12b3693b0f6b7061ff4e2683f48"}, "mark": {"type": "text", "align": "left", "color": "#2c549d", "dx": 3, "fontWeight": "bold"}, "encoding": {"text": {"field": "Attrition Rate", "format": ".1%", "type": "quantitative"}, "x": {"field": "Year", "type": "ordinal"}, "xOffset": {"value": -10}, "y": {"field": "Attrition Rate", "type": "quantitative"}, "yOffset": {"value": -10}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": {"equal": 2019, "field": "Year"}}]}, {"data": {"name": "data-e480302a3d980dc7ce0e1d4a24adb118"}, "mark": {"type": "text", "align": "left", "color": "#9fb5db", "dx": 113, "dy": 15, "fontWeight": "bold", "size": 10}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-0a7ed12b3693b0f6b7061ff4e2683f48"}, "mark": {"type": "point", "filled": true}, "encoding": {"opacity": {"value": 1}, "x": {"field": "Year", "type": "ordinal"}, "y": {"field": "Attrition Rate", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": {"equal": 2019, "field": "Year"}}]}], "height": 200, "width": 350, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0a7ed12b3693b0f6b7061ff4e2683f48": [{"Year": 2019, "Attrition Rate": 0.091}, {"Year": 2018, "Attrition Rate": 0.082}, {"Year": 2017, "Attrition Rate": 0.045}, {"Year": 2016, "Attrition Rate": 0.123}, {"Year": 2015, "Attrition Rate": 0.056}, {"Year": 2014, "Attrition Rate": 0.151}, {"Year": 2013, "Attrition Rate": 0.07}, {"Year": 2012, "Attrition Rate": 0.01}, {"Year": 2011, "Attrition Rate": 0.02}, {"Year": 2010, "Attrition Rate": 0.097}], "data-977bb4bb94569206e0f2e1118197c219": [{"y": 0, "y2": 0.07449999999999998}], "data-e480302a3d980dc7ce0e1d4a24adb118": [{"text": ["AVG:", "7.5%"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/2_5d.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Area-graph">Area graph<a class="anchor-link" href="#Area-graph"></a></h4><p>An exploration using an area graph was undertaken; however, it conveys the impression that the area under the line holds significance, which is not the case for this dataset. This graph type may not be the most suitable choice for presenting this data.</p>
<p>Also, the decision was made to stray from the example given and connect the area to the y-axis. It is unclear if the decision to have it separated for this graph only was on purpose or an error.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[62]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Area graph</span>
<span class="n">area</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_area</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s2">"Year:O"</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span> <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
        <span class="s2">"Attrition Rate"</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
            <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
            <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
            <span class="n">tickCount</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
            <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span><span class="p">,</span>
            <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
        <span class="p">),</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">"ATTRITION RATE"</span>
        <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Creates a lighter rule to contrast with area graph</span>
<span class="n">rule_light</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_rule</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">"#9fb5db"</span><span class="p">,</span> <span class="n">strokeDash</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">315</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">"mean(Attrition Rate)"</span>
<span class="p">)</span>

<span class="n">final_area</span> <span class="o">=</span> <span class="n">area</span> <span class="o">+</span> <span class="n">rule_light</span> <span class="o">+</span> <span class="n">label2</span>
<span class="n">final_area</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">350</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[62]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-2af363629bed43079ad2d801f8f6aba2.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-2af363629bed43079ad2d801f8f6aba2.vega-embed details,
  #altair-viz-2af363629bed43079ad2d801f8f6aba2.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-2af363629bed43079ad2d801f8f6aba2"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-2af363629bed43079ad2d801f8f6aba2") {
      outputDiv = document.getElementById("altair-viz-2af363629bed43079ad2d801f8f6aba2");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "area"}, "encoding": {"x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false}, "field": "Year", "scale": {"align": 0}, "title": null, "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 9, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Attrition Rate", "title": "ATTRITION RATE", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"mark": {"type": "rule", "color": "#9fb5db", "strokeDash": [3, 3]}, "encoding": {"x": {"value": 0}, "x2": {"value": 315}, "y": {"aggregate": "mean", "field": "Attrition Rate", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "data-e480302a3d980dc7ce0e1d4a24adb118"}, "mark": {"type": "text", "align": "left", "color": "#9fb5db", "dx": 113, "dy": 15, "fontWeight": "bold", "size": 10}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "data": {"name": "data-0a7ed12b3693b0f6b7061ff4e2683f48"}, "height": 200, "width": 350, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0a7ed12b3693b0f6b7061ff4e2683f48": [{"Year": 2019, "Attrition Rate": 0.091}, {"Year": 2018, "Attrition Rate": 0.082}, {"Year": 2017, "Attrition Rate": 0.045}, {"Year": 2016, "Attrition Rate": 0.123}, {"Year": 2015, "Attrition Rate": 0.056}, {"Year": 2014, "Attrition Rate": 0.151}, {"Year": 2013, "Attrition Rate": 0.07}, {"Year": 2012, "Attrition Rate": 0.01}, {"Year": 2011, "Attrition Rate": 0.02}, {"Year": 2010, "Attrition Rate": 0.097}], "data-e480302a3d980dc7ce0e1d4a24adb118": [{"text": ["AVG:", "7.5%"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/2_5e.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Bar-plot">Bar plot<a class="anchor-link" href="#Bar-plot"></a></h4><p>Finally, we can do a classic bar plot.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[63]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Bar plot </span>
<span class="n">bar</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s2">"Year:O"</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span> <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">domain</span> <span class="o">=</span> <span class="kc">False</span><span class="p">),</span>
        <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
        <span class="s2">"Attrition Rate"</span><span class="p">,</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
            <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
            <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
            <span class="n">tickCount</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
            <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span><span class="p">,</span>
            <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
        <span class="p">),</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">"ATTRITION RATE"</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Moves placement of average label </span>
<span class="n">label</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"AVG: 7.5%"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">130</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#2c549d"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"bold"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">final_bar</span> <span class="o">=</span> <span class="n">bar</span> <span class="o">+</span> <span class="n">rule</span> <span class="o">+</span> <span class="n">label</span>
<span class="n">final_bar</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">320</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[63]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-974f7de936214ebb9074637bd3d17aea.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-974f7de936214ebb9074637bd3d17aea.vega-embed details,
  #altair-viz-974f7de936214ebb9074637bd3d17aea.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-974f7de936214ebb9074637bd3d17aea"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-974f7de936214ebb9074637bd3d17aea") {
      outputDiv = document.getElementById("altair-viz-974f7de936214ebb9074637bd3d17aea");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "bar", "size": 25}, "encoding": {"x": {"axis": {"domain": false, "labelAngle": 0, "labelColor": "#888888", "ticks": false}, "field": "Year", "scale": {"align": 0}, "title": null, "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 9, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Attrition Rate", "title": "ATTRITION RATE", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"mark": {"type": "rule", "color": "#2c549d", "strokeDash": [3, 3]}, "encoding": {"x": {"value": 0}, "x2": {"value": 315}, "y": {"aggregate": "mean", "field": "Attrition Rate", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "data-237b215111f262900345e668dc9522f9"}, "mark": {"type": "text", "align": "left", "color": "#2c549d", "dx": -130, "dy": 0, "fontWeight": "bold", "size": 10}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "data": {"name": "data-0a7ed12b3693b0f6b7061ff4e2683f48"}, "height": 200, "width": 320, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0a7ed12b3693b0f6b7061ff4e2683f48": [{"Year": 2019, "Attrition Rate": 0.091}, {"Year": 2018, "Attrition Rate": 0.082}, {"Year": 2017, "Attrition Rate": 0.045}, {"Year": 2016, "Attrition Rate": 0.123}, {"Year": 2015, "Attrition Rate": 0.056}, {"Year": 2014, "Attrition Rate": 0.151}, {"Year": 2013, "Attrition Rate": 0.07}, {"Year": 2012, "Attrition Rate": 0.01}, {"Year": 2011, "Attrition Rate": 0.02}, {"Year": 2010, "Attrition Rate": 0.097}], "data-237b215111f262900345e668dc9522f9": [{"text": ["AVG: 7.5%"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/2_5f.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Interactive">Interactive<a class="anchor-link" href="#Interactive"></a></h4><p>For this interactive graph, the dot graph was selected. Inspired by the concept of the average line, we opted to create a "cut" line, allowing users to specify a value to partition the data. Dots falling below this threshold will be colored in red for enhanced visibility and focus.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[64]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Create the slider</span>
<span class="n">slider</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding_range</span><span class="p">(</span><span class="nb">min</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">max</span> <span class="o">=</span> <span class="mf">0.16</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="mf">0.005</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"CUT: "</span><span class="p">)</span>
<span class="n">selector</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">"SelectorName"</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="mf">0.03</span><span class="p">,</span> <span class="n">bind</span> <span class="o">=</span> <span class="n">slider</span><span class="p">)</span>

<span class="c1"># Remove space from column name</span>
<span class="n">table</span><span class="p">[</span><span class="s2">"AttRate"</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s2">"Attrition Rate"</span><span class="p">]</span>

<span class="n">base</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">table</span><span class="p">,</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
        <span class="s2">"Attrition rate over time"</span><span class="p">,</span>
        <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
        <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
        <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">dots</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">base</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Year:O"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span> <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span><span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Attrition Rate"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">tickCount</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"ATTRITION RATE"</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span> <span class="c1"># Change Attrition Rate is less than the slider</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">AttRate</span> <span class="o">&lt;</span> <span class="n">selector</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#ef476f"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#118ab2"</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Normal Average Rule</span>
<span class="n">rule</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_rule</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">"#118ab2"</span><span class="p">,</span> <span class="n">strokeDash</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">315</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">"mean(AttRate)"</span>
<span class="p">)</span>

<span class="c1"># "Cut" rule - moves based on the slider</span>
<span class="n">rule2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">base</span><span class="o">.</span><span class="n">mark_rule</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">"#ef476f"</span><span class="p">,</span> <span class="n">strokeDash</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">315</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">200</span> <span class="o">-</span> <span class="n">selector</span> <span class="o">*</span> <span class="mi">1250</span><span class="p">),</span> <span class="c1"># alt.datum did not work,</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>              <span class="c1"># this converts pixel value into actual data</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">label</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"AVERAGE: 7.5%"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">170</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#118ab2"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"bold"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># "Cut" label, moves along with rule2</span>
<span class="n">label2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"CUT"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">110</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#ef476f"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"bold"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">195</span> <span class="o">-</span> <span class="n">selector</span> <span class="o">*</span> <span class="mi">1250</span><span class="p">))</span>
    <span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">final_interactive</span> <span class="o">=</span> <span class="n">dots</span> <span class="o">+</span> <span class="n">rule</span> <span class="o">+</span> <span class="n">label</span> <span class="o">+</span> <span class="n">rule2</span> <span class="o">+</span> <span class="n">label2</span>
<span class="n">final_interactive</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">350</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[64]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-adb7ee80c4ea4f6ebf9e74989addefe0.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-adb7ee80c4ea4f6ebf9e74989addefe0.vega-embed details,
  #altair-viz-adb7ee80c4ea4f6ebf9e74989addefe0.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-adb7ee80c4ea4f6ebf9e74989addefe0"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-adb7ee80c4ea4f6ebf9e74989addefe0") {
      outputDiv = document.getElementById("altair-viz-adb7ee80c4ea4f6ebf9e74989addefe0");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "point", "filled": true, "size": 50}, "encoding": {"color": {"condition": {"test": "(datum.AttRate < SelectorName)", "value": "#ef476f"}, "value": "#118ab2"}, "opacity": {"value": 1}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false}, "field": "Year", "scale": {"align": 0}, "title": null, "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 9, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Attrition Rate", "title": "ATTRITION RATE", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"mark": {"type": "rule", "color": "#118ab2", "strokeDash": [3, 3]}, "encoding": {"x": {"value": 0}, "x2": {"value": 315}, "y": {"aggregate": "mean", "field": "AttRate", "type": "quantitative"}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "data-1980b1808ae6a949eac3470c1ac67659"}, "mark": {"type": "text", "align": "left", "color": "#118ab2", "dx": -170, "dy": 0, "fontWeight": "bold", "size": 10}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-8c501f72f1886ec5e97b8fec5aee901b"}, "mark": {"type": "rule", "color": "#ef476f", "strokeDash": [3, 3]}, "encoding": {"opacity": {"value": 0.1}, "x": {"value": 0}, "x2": {"value": 315}, "y": {"value": {"expr": "(200 - (SelectorName * 1250))"}}}, "title": {"text": "Attrition rate over time", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "data-560ff3a3dfb220ffa62ed2c505861cd4"}, "mark": {"type": "text", "align": "left", "color": "#ef476f", "dx": 110, "fontWeight": "bold", "size": 10}, "encoding": {"text": {"field": "text", "type": "nominal"}, "y": {"value": {"expr": "(195 - (SelectorName * 1250))"}}}}], "data": {"name": "data-8c501f72f1886ec5e97b8fec5aee901b"}, "height": 200, "params": [{"name": "SelectorName", "bind": {"input": "range", "max": 0.16, "min": 0, "name": "CUT: ", "step": 0.005}, "value": 0.03}], "width": 350, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-8c501f72f1886ec5e97b8fec5aee901b": [{"Year": 2019, "Attrition Rate": 0.091, "AttRate": 0.091}, {"Year": 2018, "Attrition Rate": 0.082, "AttRate": 0.082}, {"Year": 2017, "Attrition Rate": 0.045, "AttRate": 0.045}, {"Year": 2016, "Attrition Rate": 0.123, "AttRate": 0.123}, {"Year": 2015, "Attrition Rate": 0.056, "AttRate": 0.056}, {"Year": 2014, "Attrition Rate": 0.151, "AttRate": 0.151}, {"Year": 2013, "Attrition Rate": 0.07, "AttRate": 0.07}, {"Year": 2012, "Attrition Rate": 0.01, "AttRate": 0.01}, {"Year": 2011, "Attrition Rate": 0.02, "AttRate": 0.02}, {"Year": 2010, "Attrition Rate": 0.097, "AttRate": 0.097}], "data-1980b1808ae6a949eac3470c1ac67659": [{"text": ["AVERAGE: 7.5%"]}], "data-560ff3a3dfb220ffa62ed2c505861cd4": [{"text": ["CUT"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Chapter-3---Identify-and-eliminate-Cluster">Chapter 3 - Identify and eliminate Cluster<a name="3"></a><a class="anchor-link" href="#Chapter-3---Identify-and-eliminate-Cluster"></a></h2><p><em>"This lesson is simple but the impact is huge: get rid of the stuff that doesnt need
to be there"</em> - Cole Nussbaumer Knaflic</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Exercise-3.2---how-can-we-tie-words-to-the-graph?">Exercise 3.2 - how can we tie words to the graph?<a name="3.2"></a><a class="anchor-link" href="#Exercise-3.2---how-can-we-tie-words-to-the-graph?"></a></h3><p>The main focus of this exercise is to apply the Gestalt Principles of Visual Perception to declutter graphs. For principles will be demonstrated, and each of them will be clarified through the visualization employing it.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Loading-the-data">Loading the data<a class="anchor-link" href="#Loading-the-data"></a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[65]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Loading considering the NaN caused by Excel formatting</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Data\3.2 EXERCISE.xlsx"</span><span class="p">,</span> <span class="n">usecols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">skipfooter</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">table</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[65]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>2019</th>
<th>Rate</th>
<th># exits</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>JAN</td>
<td>0.0040</td>
<td>120</td>
</tr>
<tr>
<th>1</th>
<td>FEB</td>
<td>0.0010</td>
<td>30</td>
</tr>
<tr>
<th>2</th>
<td>MAR</td>
<td>0.0015</td>
<td>45</td>
</tr>
<tr>
<th>3</th>
<td>APR</td>
<td>0.0080</td>
<td>240</td>
</tr>
<tr>
<th>4</th>
<td>MAY</td>
<td>0.0030</td>
<td>90</td>
</tr>
<tr>
<th>5</th>
<td>JUN</td>
<td>0.0014</td>
<td>42</td>
</tr>
<tr>
<th>6</th>
<td>JUL</td>
<td>0.0044</td>
<td>132</td>
</tr>
<tr>
<th>7</th>
<td>AUG</td>
<td>0.0050</td>
<td>150</td>
</tr>
<tr>
<th>8</th>
<td>SEP</td>
<td>0.0022</td>
<td>66</td>
</tr>
<tr>
<th>9</th>
<td>OCT</td>
<td>0.0015</td>
<td>45</td>
</tr>
<tr>
<th>10</th>
<td>NOV</td>
<td>0.0005</td>
<td>15</td>
</tr>
<tr>
<th>11</th>
<td>DEC</td>
<td>0.0010</td>
<td>30</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>The column name for 2019 is currently an integer, which might pose issues in the future. To avoid potential complications, we will modify the column name to a string.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>For example, trying to run the following code returns an error:</p>
<div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'2019'</span><span class="p">),</span> 
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Rate'</span><span class="p">)</span>
        <span class="p">)</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="ne">ValueError</span><span class="p">:</span> <span class="n">Dataframe</span> <span class="n">contains</span> <span class="n">invalid</span> <span class="n">column</span> <span class="n">name</span><span class="p">:</span> <span class="mf">2019.</span> <span class="n">Column</span> <span class="n">names</span> <span class="n">must</span> <span class="n">be</span> <span class="n">strings</span>
</pre></div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[66]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2019</span><span class="p">:</span><span class="s1">'Date'</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Cluttered-graph">Cluttered graph<a class="anchor-link" href="#Cluttered-graph"></a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[67]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Graph with cluttered text</span>

<span class="n">bar</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"2019 monthly voluntary attrition rate"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#b0b0b0"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Date"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="c1"># Avoids alphabetical order</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">"2019"</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Rate"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span><span class="p">,</span> <span class="c1"># y-axis is a percentage</span>
                <span class="n">tickCount</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># Number of ticks (intervals) in axis</span>
            <span class="p">),</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"ATTRITION RATE"</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Text next to the graph</span>
<span class="n">text</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>   <span class="c1"># Each item is a line</span>
                    <span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">"Highlights:"</span><span class="p">,</span>
                        <span class="s2">" "</span><span class="p">,</span>
                        <span class="s2">"In April there was a"</span><span class="p">,</span>
                        <span class="s2">"reorganization. No jobs"</span><span class="p">,</span>
                        <span class="s2">"were eliminated, but many"</span><span class="p">,</span>
                        <span class="s2">"people chose to leave."</span><span class="p">,</span>
                        <span class="s2">" "</span><span class="p">,</span>
                        <span class="s2">"Attrition rates tend to be"</span><span class="p">,</span>
                        <span class="s2">"higher in the Summer"</span><span class="p">,</span>
                        <span class="s2">"months when it is"</span><span class="p">,</span>
                        <span class="s2">"common for associates"</span><span class="p">,</span>
                        <span class="s2">"to leave to go back to"</span><span class="p">,</span>
                        <span class="s2">"school."</span><span class="p">,</span>
                        <span class="s2">" "</span><span class="p">,</span>
                        <span class="s2">"Attrition is typically low in"</span><span class="p">,</span>
                        <span class="s2">"November and December"</span><span class="p">,</span>
                        <span class="s2">"due to the holidays."</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># Size and placement</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>


<span class="c1"># Using the | symbols makes it so Altair unites the bar and the text next to each other horizontally</span>
<span class="n">final_cluttered</span> <span class="o">=</span> <span class="n">bar</span> <span class="o">|</span> <span class="n">text</span>

<span class="n">final_cluttered</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[67]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-56da582c4e474cfd99a3eaa9798cb9f9.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-56da582c4e474cfd99a3eaa9798cb9f9.vega-embed details,
  #altair-viz-56da582c4e474cfd99a3eaa9798cb9f9.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-56da582c4e474cfd99a3eaa9798cb9f9"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-56da582c4e474cfd99a3eaa9798cb9f9") {
      outputDiv = document.getElementById("altair-viz-56da582c4e474cfd99a3eaa9798cb9f9");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "hconcat": [{"data": {"name": "data-0f748d12b71fa1969f524ef0b4d050d0"}, "mark": {"type": "bar", "color": "#b0b0b0", "size": 20}, "encoding": {"x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Date", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 10, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Rate", "scale": {"domain": [0, 0.01]}, "title": "ATTRITION RATE", "type": "quantitative"}}, "height": 200, "title": {"text": "2019 monthly voluntary attrition rate", "anchor": "start", "fontSize": 15, "fontWeight": "normal", "offset": 10}, "width": 300}, {"data": {"name": "data-c2d1f9b053875a01285743790ea52a99"}, "mark": {"type": "text", "align": "left", "dx": -10, "dy": -20, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0f748d12b71fa1969f524ef0b4d050d0": [{"Date": "JAN", "Rate": 0.004, "# exits": 120}, {"Date": "FEB", "Rate": 0.001, "# exits": 30}, {"Date": "MAR", "Rate": 0.0015, "# exits": 45}, {"Date": "APR", "Rate": 0.008, "# exits": 240}, {"Date": "MAY", "Rate": 0.003, "# exits": 90}, {"Date": "JUN", "Rate": 0.0014, "# exits": 42}, {"Date": "JUL", "Rate": 0.0044, "# exits": 132}, {"Date": "AUG", "Rate": 0.005, "# exits": 150}, {"Date": "SEP", "Rate": 0.0022, "# exits": 66}, {"Date": "OCT", "Rate": 0.0015, "# exits": 45}, {"Date": "NOV", "Rate": 0.0005, "# exits": 15}, {"Date": "DEC", "Rate": 0.001, "# exits": 30}], "data-c2d1f9b053875a01285743790ea52a99": [{"text": ["Highlights:", " ", "In April there was a", "reorganization. No jobs", "were eliminated, but many", "people chose to leave.", " ", "Attrition rates tend to be", "higher in the Summer", "months when it is", "common for associates", "to leave to go back to", "school.", " ", "Attrition is typically low in", "November and December", "due to the holidays."]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/3_2a.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Proximity">Proximity<a class="anchor-link" href="#Proximity"></a></h4><p>The "Proximity Principle" says that we tend to associate objects close to each other as being part of a single group. To apply this is our graph, we bring the texts near the data they represent.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[68]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># The text now needs to be broken into parts</span>

<span class="c1"># First paragraph</span>
<span class="n">text_april</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">"In April there was a"</span><span class="p">,</span>
                        <span class="s2">"reorganization. No jobs"</span><span class="p">,</span>
                        <span class="s2">"were eliminated, but many"</span><span class="p">,</span>
                        <span class="s2">"people chose to leave."</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">145</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">105</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Second paragraph</span>
<span class="n">text_summer</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">"Attrition rates tend to be"</span><span class="p">,</span>
                        <span class="s2">"higher in the Summer"</span><span class="p">,</span>
                        <span class="s2">"months when it is"</span><span class="p">,</span>
                        <span class="s2">"common for associates to"</span><span class="p">,</span>
                        <span class="s2">"leave to go back to"</span><span class="p">,</span>
                        <span class="s2">"school."</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">65</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Third paragraph</span>
<span class="n">text_nov_dec</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">"Attrition is"</span><span class="p">,</span>
                        <span class="s2">"typically low in"</span><span class="p">,</span>
                        <span class="s2">"November &amp;"</span><span class="p">,</span>
                        <span class="s2">"December due"</span><span class="p">,</span>
                        <span class="s2">"to the holidays."</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"right"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">150</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Now we sum the graphs, so that the texts lie on top of the bar, instead of next to it</span>
<span class="n">final_prox</span> <span class="o">=</span> <span class="n">bar</span> <span class="o">+</span> <span class="n">text_april</span> <span class="o">+</span> <span class="n">text_summer</span> <span class="o">+</span> <span class="n">text_nov_dec</span>

<span class="n">final_prox</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[68]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-8ad62aea614c4af4b89ff4f76845362f.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-8ad62aea614c4af4b89ff4f76845362f.vega-embed details,
  #altair-viz-8ad62aea614c4af4b89ff4f76845362f.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-8ad62aea614c4af4b89ff4f76845362f"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-8ad62aea614c4af4b89ff4f76845362f") {
      outputDiv = document.getElementById("altair-viz-8ad62aea614c4af4b89ff4f76845362f");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-0f748d12b71fa1969f524ef0b4d050d0"}, "mark": {"type": "bar", "color": "#b0b0b0", "size": 20}, "encoding": {"x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Date", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 10, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Rate", "scale": {"domain": [0, 0.01]}, "title": "ATTRITION RATE", "type": "quantitative"}}, "title": {"text": "2019 monthly voluntary attrition rate", "anchor": "start", "fontSize": 15, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "data-239b44d597c5aa597b4b2ba0ef21b2fe"}, "mark": {"type": "text", "align": "left", "dx": -145, "dy": -105, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-4f633faab5fc0748d2be4f6339623fb0"}, "mark": {"type": "text", "align": "left", "dx": -10, "dy": -65, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-9722e718ce72dfe0a91be2651cccc364"}, "mark": {"type": "text", "align": "right", "dx": 150, "dy": 5, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "height": 200, "width": 300, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0f748d12b71fa1969f524ef0b4d050d0": [{"Date": "JAN", "Rate": 0.004, "# exits": 120}, {"Date": "FEB", "Rate": 0.001, "# exits": 30}, {"Date": "MAR", "Rate": 0.0015, "# exits": 45}, {"Date": "APR", "Rate": 0.008, "# exits": 240}, {"Date": "MAY", "Rate": 0.003, "# exits": 90}, {"Date": "JUN", "Rate": 0.0014, "# exits": 42}, {"Date": "JUL", "Rate": 0.0044, "# exits": 132}, {"Date": "AUG", "Rate": 0.005, "# exits": 150}, {"Date": "SEP", "Rate": 0.0022, "# exits": 66}, {"Date": "OCT", "Rate": 0.0015, "# exits": 45}, {"Date": "NOV", "Rate": 0.0005, "# exits": 15}, {"Date": "DEC", "Rate": 0.001, "# exits": 30}], "data-239b44d597c5aa597b4b2ba0ef21b2fe": [{"text": ["In April there was a", "reorganization. No jobs", "were eliminated, but many", "people chose to leave."]}], "data-4f633faab5fc0748d2be4f6339623fb0": [{"text": ["Attrition rates tend to be", "higher in the Summer", "months when it is", "common for associates to", "leave to go back to", "school."]}], "data-9722e718ce72dfe0a91be2651cccc364": [{"text": ["Attrition is", "typically low in", "November &", "December due", "to the holidays."]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/3_2b.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Proximity-with-emphasis">Proximity with emphasis<a class="anchor-link" href="#Proximity-with-emphasis"></a></h4><p>We can enhance the visual impact by emphasizing the bars and keywords.</p>
<p>Given that Altair does not support bold text within regular content, a strategy is to introduce blank spaces in the text and create a distinct object for the bold keywords.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[69]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">bar_highlight</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"2019 monthly voluntary attrition rate"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Date"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleX</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Rate"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span><span class="p">,</span>
                <span class="n">tickCount</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"ATTRITION RATE"</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Date"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span>
                <span class="nb">range</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">"#b0b0b0"</span><span class="p">,</span>
                    <span class="s2">"#b0b0b0"</span><span class="p">,</span>
                    <span class="s2">"#b0b0b0"</span><span class="p">,</span>
                    <span class="s2">"#666666"</span><span class="p">,</span> <span class="c1"># It was also possible to color by condition</span>
                    <span class="s2">"#b0b0b0"</span><span class="p">,</span> <span class="c1"># where Date == [list of highlighted months]</span>
                    <span class="s2">"#b0b0b0"</span><span class="p">,</span>
                    <span class="s2">"#666666"</span><span class="p">,</span>
                    <span class="s2">"#666666"</span><span class="p">,</span>
                    <span class="s2">"#b0b0b0"</span><span class="p">,</span>
                    <span class="s2">"#b0b0b0"</span><span class="p">,</span>
                    <span class="s2">"#666666"</span><span class="p">,</span>
                    <span class="s2">"#666666"</span>
                <span class="p">]</span>
            <span class="p">),</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># First paragraph with blank space</span>
<span class="n">text_april_blank</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">"In            there was a"</span><span class="p">,</span>
                        <span class="s2">"reorganization. No jobs"</span><span class="p">,</span>
                        <span class="s2">"were eliminated, but many"</span><span class="p">,</span>
                        <span class="s2">"people chose to leave."</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">145</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">105</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Second paragraph with blank space</span>
<span class="n">text_summer_blank</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">"Attrition rates tend to be"</span><span class="p">,</span>
                        <span class="s2">"higher in the"</span><span class="p">,</span>
                        <span class="s2">"months when it is"</span><span class="p">,</span>
                        <span class="s2">"common for associates to"</span><span class="p">,</span>
                        <span class="s2">"leave to go back to"</span><span class="p">,</span>
                        <span class="s2">"school."</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">65</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Third paragraph with blank space</span>
<span class="n">text_nov_dec_blank</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">"Attrition is"</span><span class="p">,</span>
                        <span class="s2">"typically low in"</span><span class="p">,</span>
                        <span class="s2">"&amp;"</span><span class="p">,</span>
                        <span class="s2">"due"</span><span class="p">,</span>
                        <span class="s2">"to the holidays."</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"right"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">150</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Bold "April" word</span>
<span class="n">text_april_bold</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"April"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">133</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">105</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">800</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Bold "Summer" word</span>
<span class="n">text_summer_bold</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Summer"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">54</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">52</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">800</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Bold "November" word</span>
<span class="n">text_nov_bold</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"November"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">31</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">800</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Bold "December" word</span>
<span class="n">text_dec_bold</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"December"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">68</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">44</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">800</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Adds everything</span>
<span class="n">final_prox_emph</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">bar_highlight</span>
    <span class="o">+</span> <span class="n">text_april_blank</span>
    <span class="o">+</span> <span class="n">text_april_bold</span>
    <span class="o">+</span> <span class="n">text_summer_blank</span>
    <span class="o">+</span> <span class="n">text_summer_bold</span>
    <span class="o">+</span> <span class="n">text_nov_dec_blank</span>
    <span class="o">+</span> <span class="n">text_nov_bold</span>
    <span class="o">+</span> <span class="n">text_dec_bold</span>
<span class="p">)</span>

<span class="n">final_prox_emph</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[69]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-57d743a725bb48f499ed2b1b0d44e235.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-57d743a725bb48f499ed2b1b0d44e235.vega-embed details,
  #altair-viz-57d743a725bb48f499ed2b1b0d44e235.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-57d743a725bb48f499ed2b1b0d44e235"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-57d743a725bb48f499ed2b1b0d44e235") {
      outputDiv = document.getElementById("altair-viz-57d743a725bb48f499ed2b1b0d44e235");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-0f748d12b71fa1969f524ef0b4d050d0"}, "mark": {"type": "bar", "size": 20}, "encoding": {"color": {"field": "Date", "legend": null, "scale": {"range": ["#b0b0b0", "#b0b0b0", "#b0b0b0", "#666666", "#b0b0b0", "#b0b0b0", "#666666", "#666666", "#b0b0b0", "#b0b0b0", "#666666", "#666666"]}, "sort": null, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal", "titleX": 12}, "field": "Date", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 10, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Rate", "scale": {"domain": [0, 0.01]}, "title": "ATTRITION RATE", "type": "quantitative"}}, "title": {"text": "2019 monthly voluntary attrition rate", "anchor": "start", "fontSize": 15, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "data-4b2db09edd7b755be26354eb12fb19ef"}, "mark": {"type": "text", "align": "left", "dx": -145, "dy": -105, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-f9846e3e8d56027489b8c959b216eeeb"}, "mark": {"type": "text", "align": "left", "dx": -133, "dy": -105, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-e74a840aaa77e5e6cb5d77efd782561f"}, "mark": {"type": "text", "align": "left", "dx": -10, "dy": -65, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-bf0c0886e85857075dcfec6916d457fe"}, "mark": {"type": "text", "align": "left", "dx": 54, "dy": -52, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-ea580427a5198bdc08c1b30897679b7b"}, "mark": {"type": "text", "align": "right", "dx": 150, "dy": 5, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-faa7370696b24381d4498fd5bfebb2f4"}, "mark": {"type": "text", "align": "left", "dx": 80, "dy": 31, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-4882944318c84009e536f6c565db3347"}, "mark": {"type": "text", "align": "left", "dx": 68, "dy": 44, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "height": 200, "width": 300, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0f748d12b71fa1969f524ef0b4d050d0": [{"Date": "JAN", "Rate": 0.004, "# exits": 120}, {"Date": "FEB", "Rate": 0.001, "# exits": 30}, {"Date": "MAR", "Rate": 0.0015, "# exits": 45}, {"Date": "APR", "Rate": 0.008, "# exits": 240}, {"Date": "MAY", "Rate": 0.003, "# exits": 90}, {"Date": "JUN", "Rate": 0.0014, "# exits": 42}, {"Date": "JUL", "Rate": 0.0044, "# exits": 132}, {"Date": "AUG", "Rate": 0.005, "# exits": 150}, {"Date": "SEP", "Rate": 0.0022, "# exits": 66}, {"Date": "OCT", "Rate": 0.0015, "# exits": 45}, {"Date": "NOV", "Rate": 0.0005, "# exits": 15}, {"Date": "DEC", "Rate": 0.001, "# exits": 30}], "data-4b2db09edd7b755be26354eb12fb19ef": [{"text": ["In            there was a", "reorganization. No jobs", "were eliminated, but many", "people chose to leave."]}], "data-f9846e3e8d56027489b8c959b216eeeb": [{"text": ["April"]}], "data-e74a840aaa77e5e6cb5d77efd782561f": [{"text": ["Attrition rates tend to be", "higher in the", "months when it is", "common for associates to", "leave to go back to", "school."]}], "data-bf0c0886e85857075dcfec6916d457fe": [{"text": ["Summer"]}], "data-ea580427a5198bdc08c1b30897679b7b": [{"text": ["Attrition is", "typically low in", "&", "due", "to the holidays."]}], "data-faa7370696b24381d4498fd5bfebb2f4": [{"text": ["November"]}], "data-4882944318c84009e536f6c565db3347": [{"text": ["December"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/3_2c.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Similarity">Similarity<a class="anchor-link" href="#Similarity"></a></h4><p>The "Similarity Principle" pertains to our tendency to perceive objects as part of the same group when they share similar color, shape, or size. For this example, this means coloring the columns in the same shade as the chosen keywords.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[70]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">bar_highlight_color</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"2019 monthly voluntary attrition rate"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Date"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Rate"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span><span class="p">,</span>
                <span class="n">tickCount</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="p">),</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"ATTRITION RATE"</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Date"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span>
                <span class="nb">range</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">"#b0b0b0"</span><span class="p">,</span>
                    <span class="s2">"#b0b0b0"</span><span class="p">,</span> <span class="c1"># Since there are multiple colors</span>
                    <span class="s2">"#b0b0b0"</span><span class="p">,</span> <span class="c1"># set by condition would be harder</span>
                    <span class="s2">"#ed1e24"</span><span class="p">,</span>
                    <span class="s2">"#b0b0b0"</span><span class="p">,</span>
                    <span class="s2">"#b0b0b0"</span><span class="p">,</span>
                    <span class="s2">"#ec7c30"</span><span class="p">,</span>
                    <span class="s2">"#ec7c30"</span><span class="p">,</span>
                    <span class="s2">"#b0b0b0"</span><span class="p">,</span>
                    <span class="s2">"#b0b0b0"</span><span class="p">,</span>
                    <span class="s2">"#5d9bd1"</span><span class="p">,</span>
                    <span class="s2">"#5d9bd1"</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">),</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Blank texts with different position</span>
<span class="n">text_april_blank2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">"Highlights:"</span><span class="p">,</span>
                        <span class="s2">" "</span><span class="p">,</span>
                        <span class="s2">"In            there was a"</span><span class="p">,</span>
                        <span class="s2">"reorganization. No jobs"</span><span class="p">,</span>
                        <span class="s2">"were eliminated, but many"</span><span class="p">,</span>
                        <span class="s2">"people chose to leave."</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">text_summer_blank2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">"Attrition rates tend to be"</span><span class="p">,</span>
                        <span class="s2">"higher in the"</span><span class="p">,</span>
                        <span class="s2">"months when it is"</span><span class="p">,</span>
                        <span class="s2">"common for associates to"</span><span class="p">,</span>
                        <span class="s2">"leave to go back to"</span><span class="p">,</span>
                        <span class="s2">"school."</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">65</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">text_nov_dec_blank2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Attrition is typically low in"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">,</span> <span class="s2">"due to the holidays."</span><span class="p">]}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">155</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Colored texts</span>
<span class="n">text_april_color</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"April"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">800</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#ed1e24"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">text_summer_color</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Summer"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">55</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">78</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">800</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#ec7c30"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">text_nov_dec_color</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"November &amp; December"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">168</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">800</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#5d9bd1"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># While we could have used '&amp;' to arrange the texts vertically,</span>
<span class="c1"># employing '+' provides greater flexibility in determining the layout of the text.</span>

<span class="n">final_sim</span> <span class="o">=</span> <span class="n">bar_highlight_color</span> <span class="o">|</span> <span class="p">(</span>
    <span class="n">text_april_blank2</span>
    <span class="o">+</span> <span class="n">text_april_color</span>
    <span class="o">+</span> <span class="n">text_summer_blank2</span>
    <span class="o">+</span> <span class="n">text_summer_color</span>
    <span class="o">+</span> <span class="n">text_nov_dec_blank2</span>
    <span class="o">+</span> <span class="n">text_nov_dec_color</span>
<span class="p">)</span>

<span class="n">final_sim</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[70]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-9357fddc196944888914b702589b3987.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-9357fddc196944888914b702589b3987.vega-embed details,
  #altair-viz-9357fddc196944888914b702589b3987.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-9357fddc196944888914b702589b3987"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-9357fddc196944888914b702589b3987") {
      outputDiv = document.getElementById("altair-viz-9357fddc196944888914b702589b3987");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "hconcat": [{"data": {"name": "data-0f748d12b71fa1969f524ef0b4d050d0"}, "mark": {"type": "bar", "size": 20}, "encoding": {"color": {"field": "Date", "legend": null, "scale": {"range": ["#b0b0b0", "#b0b0b0", "#b0b0b0", "#ed1e24", "#b0b0b0", "#b0b0b0", "#ec7c30", "#ec7c30", "#b0b0b0", "#b0b0b0", "#5d9bd1", "#5d9bd1"]}, "sort": null, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Date", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 10, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Rate", "scale": {"domain": [0, 0.01]}, "title": "ATTRITION RATE", "type": "quantitative"}}, "height": 200, "title": {"text": "2019 monthly voluntary attrition rate", "anchor": "start", "fontSize": 15, "fontWeight": "normal", "offset": 10}, "width": 300}, {"layer": [{"data": {"name": "data-547bb088e9c8c00000f42a90929c9173"}, "mark": {"type": "text", "align": "left", "dx": -10, "dy": -25, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-f9846e3e8d56027489b8c959b216eeeb"}, "mark": {"type": "text", "align": "left", "color": "#ed1e24", "dx": 3, "dy": 1, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-e74a840aaa77e5e6cb5d77efd782561f"}, "mark": {"type": "text", "align": "left", "dx": -10, "dy": 65, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-bf0c0886e85857075dcfec6916d457fe"}, "mark": {"type": "text", "align": "left", "color": "#ec7c30", "dx": 55, "dy": 78, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-50a41c20af379a6e5c8ff82d5b95345b"}, "mark": {"type": "text", "align": "left", "dx": -10, "dy": 155, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-56051377289bab148d95af94c7fc24d1"}, "mark": {"type": "text", "align": "left", "color": "#5d9bd1", "dx": -10, "dy": 168, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}]}], "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0f748d12b71fa1969f524ef0b4d050d0": [{"Date": "JAN", "Rate": 0.004, "# exits": 120}, {"Date": "FEB", "Rate": 0.001, "# exits": 30}, {"Date": "MAR", "Rate": 0.0015, "# exits": 45}, {"Date": "APR", "Rate": 0.008, "# exits": 240}, {"Date": "MAY", "Rate": 0.003, "# exits": 90}, {"Date": "JUN", "Rate": 0.0014, "# exits": 42}, {"Date": "JUL", "Rate": 0.0044, "# exits": 132}, {"Date": "AUG", "Rate": 0.005, "# exits": 150}, {"Date": "SEP", "Rate": 0.0022, "# exits": 66}, {"Date": "OCT", "Rate": 0.0015, "# exits": 45}, {"Date": "NOV", "Rate": 0.0005, "# exits": 15}, {"Date": "DEC", "Rate": 0.001, "# exits": 30}], "data-547bb088e9c8c00000f42a90929c9173": [{"text": ["Highlights:", " ", "In            there was a", "reorganization. No jobs", "were eliminated, but many", "people chose to leave."]}], "data-f9846e3e8d56027489b8c959b216eeeb": [{"text": ["April"]}], "data-e74a840aaa77e5e6cb5d77efd782561f": [{"text": ["Attrition rates tend to be", "higher in the", "months when it is", "common for associates to", "leave to go back to", "school."]}], "data-bf0c0886e85857075dcfec6916d457fe": [{"text": ["Summer"]}], "data-50a41c20af379a6e5c8ff82d5b95345b": [{"text": ["Attrition is typically low in", " ", "due to the holidays."]}], "data-56051377289bab148d95af94c7fc24d1": [{"text": ["November & December"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/3_2d.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Enclosure">Enclosure<a class="anchor-link" href="#Enclosure"></a></h4><p>The "Enclosure Principle" says simply that, when objects are enclosed together, we perceive them as belonging to the same group.</p>
<p>Attempting to combine charts using the expression <code>(bar | text) + rect_nov_dec + rect_summer + rect_april</code> results in an error:</p>
<div class="highlight"><pre><span></span><span class="n">Concatenated</span> <span class="n">charts</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">layered</span><span class="o">.</span> <span class="n">Instead</span><span class="p">,</span> <span class="n">layer</span> <span class="n">the</span> <span class="n">charts</span> <span class="n">before</span> <span class="n">concatenating</span><span class="o">.</span>
</pre></div>
<p>The most straightforward way to solve this is to add the text to the bar using <code>bar + text</code>, but doing so means assigning another position (dx, dy) to the text.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[71]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Assign another position to text</span>
<span class="n">text_enclosure</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">"Highlights:"</span><span class="p">,</span>
                        <span class="s2">" "</span><span class="p">,</span>
                        <span class="s2">"In April there was a"</span><span class="p">,</span>
                        <span class="s2">"reorganization. No jobs"</span><span class="p">,</span>
                        <span class="s2">"were eliminated, but many"</span><span class="p">,</span>
                        <span class="s2">"people chose to leave."</span><span class="p">,</span>
                        <span class="s2">" "</span><span class="p">,</span>
                        <span class="s2">"Attrition rates tend to be"</span><span class="p">,</span>
                        <span class="s2">"higher in the Summer"</span><span class="p">,</span>
                        <span class="s2">"months when it is"</span><span class="p">,</span>
                        <span class="s2">"common for associates"</span><span class="p">,</span>
                        <span class="s2">"to leave to go back to"</span><span class="p">,</span>
                        <span class="s2">"school."</span><span class="p">,</span>
                        <span class="s2">" "</span><span class="p">,</span>
                        <span class="s2">"Attrition is typically low in"</span><span class="p">,</span>
                        <span class="s2">"November and December"</span><span class="p">,</span>
                        <span class="s2">"due to the holidays."</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">113</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Defines the rectangles that are going to enclose the text</span>
<span class="n">rect_nov_dec</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"y"</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"y2"</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0019</span><span class="p">],</span> <span class="s2">"x"</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="s2">"x2"</span><span class="p">:</span> <span class="p">[</span><span class="mf">8.4</span><span class="p">]}))</span>
    <span class="o">.</span><span class="n">mark_rect</span><span class="p">(</span><span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span> <span class="c1"># Low opacity</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="s2">"y"</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="s2">"y2"</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"x"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span> <span class="n">x2</span> <span class="o">=</span> <span class="s2">"x2"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">rect_summer</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"y"</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0023</span><span class="p">],</span> <span class="s2">"y2"</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0063</span><span class="p">],</span> <span class="s2">"x"</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="s2">"x2"</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.1</span><span class="p">]}))</span>
    <span class="o">.</span><span class="n">mark_rect</span><span class="p">(</span><span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="s2">"y"</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="s2">"y2"</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"x"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span> <span class="n">x2</span> <span class="o">=</span> <span class="s2">"x2"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">rect_april</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"y"</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0068</span><span class="p">],</span> <span class="s2">"y2"</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0095</span><span class="p">],</span> <span class="s2">"x"</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="s2">"x2"</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.6</span><span class="p">]}))</span>
    <span class="o">.</span><span class="n">mark_rect</span><span class="p">(</span><span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="s2">"y"</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="s2">"y2"</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"x"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span> <span class="n">x2</span> <span class="o">=</span> <span class="s2">"x2"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">bar</span> <span class="o">+</span> <span class="n">text_enclosure</span> <span class="o">+</span> <span class="n">rect_nov_dec</span> <span class="o">+</span> <span class="n">rect_summer</span> <span class="o">+</span> <span class="n">rect_april</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[71]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-6a071116a0454670a4f46c1f941f1a6c.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-6a071116a0454670a4f46c1f941f1a6c.vega-embed details,
  #altair-viz-6a071116a0454670a4f46c1f941f1a6c.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-6a071116a0454670a4f46c1f941f1a6c"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-6a071116a0454670a4f46c1f941f1a6c") {
      outputDiv = document.getElementById("altair-viz-6a071116a0454670a4f46c1f941f1a6c");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"data": {"name": "data-0f748d12b71fa1969f524ef0b4d050d0"}, "mark": {"type": "bar", "color": "#b0b0b0", "size": 20}, "encoding": {"x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Date", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 10, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Rate", "scale": {"domain": [0, 0.01]}, "title": "ATTRITION RATE", "type": "quantitative"}}, "title": {"text": "2019 monthly voluntary attrition rate", "anchor": "start", "fontSize": 15, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "data-c2d1f9b053875a01285743790ea52a99"}, "mark": {"type": "text", "align": "left", "dx": 160, "dy": -113, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-230ce528c836f5854dc0853798cd05e3"}, "mark": {"type": "rect", "opacity": 0.2}, "encoding": {"x": {"axis": null, "field": "x", "type": "quantitative"}, "x2": {"field": "x2"}, "y": {"field": "y", "type": "quantitative"}, "y2": {"field": "y2"}}}, {"data": {"name": "data-a38ac05592537fcdcb85945b263fa707"}, "mark": {"type": "rect", "opacity": 0.2}, "encoding": {"x": {"axis": null, "field": "x", "type": "quantitative"}, "x2": {"field": "x2"}, "y": {"field": "y", "type": "quantitative"}, "y2": {"field": "y2"}}}, {"data": {"name": "data-e9eddaccc3eb941d707590eb1ccec00a"}, "mark": {"type": "rect", "opacity": 0.2}, "encoding": {"x": {"axis": null, "field": "x", "type": "quantitative"}, "x2": {"field": "x2"}, "y": {"field": "y", "type": "quantitative"}, "y2": {"field": "y2"}}}], "height": 200, "width": 300, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0f748d12b71fa1969f524ef0b4d050d0": [{"Date": "JAN", "Rate": 0.004, "# exits": 120}, {"Date": "FEB", "Rate": 0.001, "# exits": 30}, {"Date": "MAR", "Rate": 0.0015, "# exits": 45}, {"Date": "APR", "Rate": 0.008, "# exits": 240}, {"Date": "MAY", "Rate": 0.003, "# exits": 90}, {"Date": "JUN", "Rate": 0.0014, "# exits": 42}, {"Date": "JUL", "Rate": 0.0044, "# exits": 132}, {"Date": "AUG", "Rate": 0.005, "# exits": 150}, {"Date": "SEP", "Rate": 0.0022, "# exits": 66}, {"Date": "OCT", "Rate": 0.0015, "# exits": 45}, {"Date": "NOV", "Rate": 0.0005, "# exits": 15}, {"Date": "DEC", "Rate": 0.001, "# exits": 30}], "data-c2d1f9b053875a01285743790ea52a99": [{"text": ["Highlights:", " ", "In April there was a", "reorganization. No jobs", "were eliminated, but many", "people chose to leave.", " ", "Attrition rates tend to be", "higher in the Summer", "months when it is", "common for associates", "to leave to go back to", "school.", " ", "Attrition is typically low in", "November and December", "due to the holidays."]}], "data-230ce528c836f5854dc0853798cd05e3": [{"y": 0, "y2": 0.0019, "x": 10, "x2": 8.4}], "data-a38ac05592537fcdcb85945b263fa707": [{"y": 0.0023, "y2": 0.0063, "x": 10, "x2": 5.1}], "data-e9eddaccc3eb941d707590eb1ccec00a": [{"y": 0.0068, "y2": 0.0095, "x": 10, "x2": 2.6}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Utilizing a DataFrame to define the rectangles seems to prevent them from reaching the text section. As a next step, we will explicitly define the coordinates of the rectangles in pixels.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[72]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Rectangles with position defined by pixels</span>
<span class="n">rect_nov_dec</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'values'</span><span class="p">:[{}]}))</span><span class="o">.</span><span class="n">mark_rect</span><span class="p">(</span><span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#b0b0b0"</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
   <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">75</span><span class="p">),</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">440</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">rect_summer</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'values'</span><span class="p">:[{}]}))</span><span class="o">.</span><span class="n">mark_rect</span><span class="p">(</span><span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#b0b0b0"</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
   <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">70</span><span class="p">),</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">440</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">rect_april</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'values'</span><span class="p">:[{}]}))</span><span class="o">.</span><span class="n">mark_rect</span><span class="p">(</span><span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#b0b0b0"</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
   <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">160</span><span class="p">),</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">202</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">250</span><span class="p">),</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">440</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># The text_enclosure and bar comes after the rectangles so that they sit on top</span>
<span class="n">final_enc</span> <span class="o">=</span> <span class="n">rect_nov_dec</span> <span class="o">+</span> <span class="n">rect_summer</span> <span class="o">+</span> <span class="n">rect_april</span> <span class="o">+</span> <span class="n">bar</span> <span class="o">+</span> <span class="n">text_enclosure</span>

<span class="n">final_enc</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[72]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-5835c669bcd3458588305e06fbb3271a.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-5835c669bcd3458588305e06fbb3271a.vega-embed details,
  #altair-viz-5835c669bcd3458588305e06fbb3271a.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-5835c669bcd3458588305e06fbb3271a"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-5835c669bcd3458588305e06fbb3271a") {
      outputDiv = document.getElementById("altair-viz-5835c669bcd3458588305e06fbb3271a");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-04e931d655a49d81bb0fafa8be8a3ea8"}, "mark": {"type": "rect", "color": "#b0b0b0", "opacity": 0.2}, "encoding": {"x": {"value": 75}, "x2": {"value": 440}, "y": {"value": 5}, "y2": {"value": 60}}}, {"data": {"name": "data-04e931d655a49d81bb0fafa8be8a3ea8"}, "mark": {"type": "rect", "color": "#b0b0b0", "opacity": 0.2}, "encoding": {"x": {"value": 150}, "x2": {"value": 440}, "y": {"value": 70}, "y2": {"value": 150}}}, {"data": {"name": "data-04e931d655a49d81bb0fafa8be8a3ea8"}, "mark": {"type": "rect", "color": "#b0b0b0", "opacity": 0.2}, "encoding": {"x": {"value": 250}, "x2": {"value": 440}, "y": {"value": 160}, "y2": {"value": 202}}}, {"data": {"name": "data-0f748d12b71fa1969f524ef0b4d050d0"}, "mark": {"type": "bar", "color": "#b0b0b0", "size": 20}, "encoding": {"x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Date", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 10, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Rate", "scale": {"domain": [0, 0.01]}, "title": "ATTRITION RATE", "type": "quantitative"}}, "title": {"text": "2019 monthly voluntary attrition rate", "anchor": "start", "fontSize": 15, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "data-c2d1f9b053875a01285743790ea52a99"}, "mark": {"type": "text", "align": "left", "dx": 160, "dy": -113, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "height": 200, "width": 300, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-04e931d655a49d81bb0fafa8be8a3ea8": [{"values": {}}], "data-0f748d12b71fa1969f524ef0b4d050d0": [{"Date": "JAN", "Rate": 0.004, "# exits": 120}, {"Date": "FEB", "Rate": 0.001, "# exits": 30}, {"Date": "MAR", "Rate": 0.0015, "# exits": 45}, {"Date": "APR", "Rate": 0.008, "# exits": 240}, {"Date": "MAY", "Rate": 0.003, "# exits": 90}, {"Date": "JUN", "Rate": 0.0014, "# exits": 42}, {"Date": "JUL", "Rate": 0.0044, "# exits": 132}, {"Date": "AUG", "Rate": 0.005, "# exits": 150}, {"Date": "SEP", "Rate": 0.0022, "# exits": 66}, {"Date": "OCT", "Rate": 0.0015, "# exits": 45}, {"Date": "NOV", "Rate": 0.0005, "# exits": 15}, {"Date": "DEC", "Rate": 0.001, "# exits": 30}], "data-c2d1f9b053875a01285743790ea52a99": [{"text": ["Highlights:", " ", "In April there was a", "reorganization. No jobs", "were eliminated, but many", "people chose to leave.", " ", "Attrition rates tend to be", "higher in the Summer", "months when it is", "common for associates", "to leave to go back to", "school.", " ", "Attrition is typically low in", "November and December", "due to the holidays."]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/3_2e.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Enclosure-with-color-differentiation">Enclosure with color differentiation<a class="anchor-link" href="#Enclosure-with-color-differentiation"></a></h4><p>We can use color to emphasize the different enclosures.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[73]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Colored rectangles</span>
<span class="n">rect_nov_dec_color</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{}]}))</span>
    <span class="o">.</span><span class="n">mark_rect</span><span class="p">(</span><span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#ed1e24"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">75</span><span class="p">),</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">450</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">rect_summer_color</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{}]}))</span>
    <span class="o">.</span><span class="n">mark_rect</span><span class="p">(</span><span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#ec7c30"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">70</span><span class="p">),</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">450</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">rect_april_color</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{}]}))</span>
    <span class="o">.</span><span class="n">mark_rect</span><span class="p">(</span><span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#5d9bd1"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">160</span><span class="p">),</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">202</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">250</span><span class="p">),</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">450</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">final_enc_color</span> <span class="o">=</span> <span class="n">rect_nov_dec_color</span> <span class="o">+</span> <span class="n">rect_summer_color</span> <span class="o">+</span> <span class="n">rect_april_color</span> <span class="o">+</span> <span class="n">bar</span> <span class="o">+</span> <span class="n">text_enclosure</span>

<span class="n">final_enc_color</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[73]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-aa2b1701da93440499469a8fe0755136.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-aa2b1701da93440499469a8fe0755136.vega-embed details,
  #altair-viz-aa2b1701da93440499469a8fe0755136.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-aa2b1701da93440499469a8fe0755136"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-aa2b1701da93440499469a8fe0755136") {
      outputDiv = document.getElementById("altair-viz-aa2b1701da93440499469a8fe0755136");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-04e931d655a49d81bb0fafa8be8a3ea8"}, "mark": {"type": "rect", "color": "#ed1e24", "opacity": 0.2}, "encoding": {"x": {"value": 75}, "x2": {"value": 450}, "y": {"value": 5}, "y2": {"value": 60}}}, {"data": {"name": "data-04e931d655a49d81bb0fafa8be8a3ea8"}, "mark": {"type": "rect", "color": "#ec7c30", "opacity": 0.2}, "encoding": {"x": {"value": 150}, "x2": {"value": 450}, "y": {"value": 70}, "y2": {"value": 150}}}, {"data": {"name": "data-04e931d655a49d81bb0fafa8be8a3ea8"}, "mark": {"type": "rect", "color": "#5d9bd1", "opacity": 0.2}, "encoding": {"x": {"value": 250}, "x2": {"value": 450}, "y": {"value": 160}, "y2": {"value": 202}}}, {"data": {"name": "data-0f748d12b71fa1969f524ef0b4d050d0"}, "mark": {"type": "bar", "color": "#b0b0b0", "size": 20}, "encoding": {"x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Date", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 10, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Rate", "scale": {"domain": [0, 0.01]}, "title": "ATTRITION RATE", "type": "quantitative"}}, "title": {"text": "2019 monthly voluntary attrition rate", "anchor": "start", "fontSize": 15, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "data-c2d1f9b053875a01285743790ea52a99"}, "mark": {"type": "text", "align": "left", "dx": 160, "dy": -113, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "height": 200, "width": 300, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-04e931d655a49d81bb0fafa8be8a3ea8": [{"values": {}}], "data-0f748d12b71fa1969f524ef0b4d050d0": [{"Date": "JAN", "Rate": 0.004, "# exits": 120}, {"Date": "FEB", "Rate": 0.001, "# exits": 30}, {"Date": "MAR", "Rate": 0.0015, "# exits": 45}, {"Date": "APR", "Rate": 0.008, "# exits": 240}, {"Date": "MAY", "Rate": 0.003, "# exits": 90}, {"Date": "JUN", "Rate": 0.0014, "# exits": 42}, {"Date": "JUL", "Rate": 0.0044, "# exits": 132}, {"Date": "AUG", "Rate": 0.005, "# exits": 150}, {"Date": "SEP", "Rate": 0.0022, "# exits": 66}, {"Date": "OCT", "Rate": 0.0015, "# exits": 45}, {"Date": "NOV", "Rate": 0.0005, "# exits": 15}, {"Date": "DEC", "Rate": 0.001, "# exits": 30}], "data-c2d1f9b053875a01285743790ea52a99": [{"text": ["Highlights:", " ", "In April there was a", "reorganization. No jobs", "were eliminated, but many", "people chose to leave.", " ", "Attrition rates tend to be", "higher in the Summer", "months when it is", "common for associates", "to leave to go back to", "school.", " ", "Attrition is typically low in", "November and December", "due to the holidays."]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/3_2f.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Enclosure-+-Similarity">Enclosure + Similarity<a class="anchor-link" href="#Enclosure-+-Similarity"></a></h4><p>We can make use of both Enclosure and Similarity principles. First, we will try to add already existing components.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[74]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">bar_highlight_color</span> <span class="o">+</span> <span class="n">rect_april_color</span> <span class="o">|</span> <span class="p">(</span><span class="n">text_april_blank2</span> <span class="o">+</span> <span class="n">text_april_color</span> 
                                 <span class="o">+</span> <span class="n">text_summer_blank2</span> <span class="o">+</span> <span class="n">text_summer_color</span> 
                                 <span class="o">+</span> <span class="n">text_nov_dec_blank2</span> <span class="o">+</span> <span class="n">text_nov_dec_color</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[74]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-db0c805ea81e43a9b7710409c28bb95b.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-db0c805ea81e43a9b7710409c28bb95b.vega-embed details,
  #altair-viz-db0c805ea81e43a9b7710409c28bb95b.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-db0c805ea81e43a9b7710409c28bb95b"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-db0c805ea81e43a9b7710409c28bb95b") {
      outputDiv = document.getElementById("altair-viz-db0c805ea81e43a9b7710409c28bb95b");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "hconcat": [{"layer": [{"data": {"name": "data-0f748d12b71fa1969f524ef0b4d050d0"}, "mark": {"type": "bar", "size": 20}, "encoding": {"color": {"field": "Date", "legend": null, "scale": {"range": ["#b0b0b0", "#b0b0b0", "#b0b0b0", "#ed1e24", "#b0b0b0", "#b0b0b0", "#ec7c30", "#ec7c30", "#b0b0b0", "#b0b0b0", "#5d9bd1", "#5d9bd1"]}, "sort": null, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Date", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 10, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Rate", "scale": {"domain": [0, 0.01]}, "title": "ATTRITION RATE", "type": "quantitative"}}, "title": {"text": "2019 monthly voluntary attrition rate", "anchor": "start", "fontSize": 15, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "data-04e931d655a49d81bb0fafa8be8a3ea8"}, "mark": {"type": "rect", "color": "#5d9bd1", "opacity": 0.2}, "encoding": {"x": {"value": 250}, "x2": {"value": 450}, "y": {"value": 160}, "y2": {"value": 202}}}], "height": 200, "width": 300}, {"layer": [{"data": {"name": "data-547bb088e9c8c00000f42a90929c9173"}, "mark": {"type": "text", "align": "left", "dx": -10, "dy": -25, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-f9846e3e8d56027489b8c959b216eeeb"}, "mark": {"type": "text", "align": "left", "color": "#ed1e24", "dx": 3, "dy": 1, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-e74a840aaa77e5e6cb5d77efd782561f"}, "mark": {"type": "text", "align": "left", "dx": -10, "dy": 65, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-bf0c0886e85857075dcfec6916d457fe"}, "mark": {"type": "text", "align": "left", "color": "#ec7c30", "dx": 55, "dy": 78, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-50a41c20af379a6e5c8ff82d5b95345b"}, "mark": {"type": "text", "align": "left", "dx": -10, "dy": 155, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-56051377289bab148d95af94c7fc24d1"}, "mark": {"type": "text", "align": "left", "color": "#5d9bd1", "dx": -10, "dy": 168, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}]}], "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0f748d12b71fa1969f524ef0b4d050d0": [{"Date": "JAN", "Rate": 0.004, "# exits": 120}, {"Date": "FEB", "Rate": 0.001, "# exits": 30}, {"Date": "MAR", "Rate": 0.0015, "# exits": 45}, {"Date": "APR", "Rate": 0.008, "# exits": 240}, {"Date": "MAY", "Rate": 0.003, "# exits": 90}, {"Date": "JUN", "Rate": 0.0014, "# exits": 42}, {"Date": "JUL", "Rate": 0.0044, "# exits": 132}, {"Date": "AUG", "Rate": 0.005, "# exits": 150}, {"Date": "SEP", "Rate": 0.0022, "# exits": 66}, {"Date": "OCT", "Rate": 0.0015, "# exits": 45}, {"Date": "NOV", "Rate": 0.0005, "# exits": 15}, {"Date": "DEC", "Rate": 0.001, "# exits": 30}], "data-04e931d655a49d81bb0fafa8be8a3ea8": [{"values": {}}], "data-547bb088e9c8c00000f42a90929c9173": [{"text": ["Highlights:", " ", "In            there was a", "reorganization. No jobs", "were eliminated, but many", "people chose to leave."]}], "data-f9846e3e8d56027489b8c959b216eeeb": [{"text": ["April"]}], "data-e74a840aaa77e5e6cb5d77efd782561f": [{"text": ["Attrition rates tend to be", "higher in the", "months when it is", "common for associates to", "leave to go back to", "school."]}], "data-bf0c0886e85857075dcfec6916d457fe": [{"text": ["Summer"]}], "data-50a41c20af379a6e5c8ff82d5b95345b": [{"text": ["Attrition is typically low in", " ", "due to the holidays."]}], "data-56051377289bab148d95af94c7fc24d1": [{"text": ["November & December"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[75]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">bar_highlight_color</span> <span class="o">|</span> <span class="p">(</span><span class="n">text_april_blank2</span> <span class="o">+</span> <span class="n">text_april_color</span> 
                       <span class="o">+</span> <span class="n">text_summer_blank2</span> <span class="o">+</span> <span class="n">text_summer_color</span> 
                       <span class="o">+</span> <span class="n">text_nov_dec_blank2</span> <span class="o">+</span> <span class="n">text_nov_dec_color</span><span class="p">)</span> <span class="o">+</span> <span class="n">rect_april_color</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[75]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-99c6eed1eba346c28220bb421eec4a85.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-99c6eed1eba346c28220bb421eec4a85.vega-embed details,
  #altair-viz-99c6eed1eba346c28220bb421eec4a85.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-99c6eed1eba346c28220bb421eec4a85"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-99c6eed1eba346c28220bb421eec4a85") {
      outputDiv = document.getElementById("altair-viz-99c6eed1eba346c28220bb421eec4a85");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "hconcat": [{"data": {"name": "data-0f748d12b71fa1969f524ef0b4d050d0"}, "mark": {"type": "bar", "size": 20}, "encoding": {"color": {"field": "Date", "legend": null, "scale": {"range": ["#b0b0b0", "#b0b0b0", "#b0b0b0", "#ed1e24", "#b0b0b0", "#b0b0b0", "#ec7c30", "#ec7c30", "#b0b0b0", "#b0b0b0", "#5d9bd1", "#5d9bd1"]}, "sort": null, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Date", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 10, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Rate", "scale": {"domain": [0, 0.01]}, "title": "ATTRITION RATE", "type": "quantitative"}}, "height": 200, "title": {"text": "2019 monthly voluntary attrition rate", "anchor": "start", "fontSize": 15, "fontWeight": "normal", "offset": 10}, "width": 300}, {"layer": [{"data": {"name": "data-547bb088e9c8c00000f42a90929c9173"}, "mark": {"type": "text", "align": "left", "dx": -10, "dy": -25, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-f9846e3e8d56027489b8c959b216eeeb"}, "mark": {"type": "text", "align": "left", "color": "#ed1e24", "dx": 3, "dy": 1, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-e74a840aaa77e5e6cb5d77efd782561f"}, "mark": {"type": "text", "align": "left", "dx": -10, "dy": 65, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-bf0c0886e85857075dcfec6916d457fe"}, "mark": {"type": "text", "align": "left", "color": "#ec7c30", "dx": 55, "dy": 78, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-50a41c20af379a6e5c8ff82d5b95345b"}, "mark": {"type": "text", "align": "left", "dx": -10, "dy": 155, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-56051377289bab148d95af94c7fc24d1"}, "mark": {"type": "text", "align": "left", "color": "#5d9bd1", "dx": -10, "dy": 168, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-04e931d655a49d81bb0fafa8be8a3ea8"}, "mark": {"type": "rect", "color": "#5d9bd1", "opacity": 0.2}, "encoding": {"x": {"value": 250}, "x2": {"value": 450}, "y": {"value": 160}, "y2": {"value": 202}}}]}], "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0f748d12b71fa1969f524ef0b4d050d0": [{"Date": "JAN", "Rate": 0.004, "# exits": 120}, {"Date": "FEB", "Rate": 0.001, "# exits": 30}, {"Date": "MAR", "Rate": 0.0015, "# exits": 45}, {"Date": "APR", "Rate": 0.008, "# exits": 240}, {"Date": "MAY", "Rate": 0.003, "# exits": 90}, {"Date": "JUN", "Rate": 0.0014, "# exits": 42}, {"Date": "JUL", "Rate": 0.0044, "# exits": 132}, {"Date": "AUG", "Rate": 0.005, "# exits": 150}, {"Date": "SEP", "Rate": 0.0022, "# exits": 66}, {"Date": "OCT", "Rate": 0.0015, "# exits": 45}, {"Date": "NOV", "Rate": 0.0005, "# exits": 15}, {"Date": "DEC", "Rate": 0.001, "# exits": 30}], "data-547bb088e9c8c00000f42a90929c9173": [{"text": ["Highlights:", " ", "In            there was a", "reorganization. No jobs", "were eliminated, but many", "people chose to leave."]}], "data-f9846e3e8d56027489b8c959b216eeeb": [{"text": ["April"]}], "data-e74a840aaa77e5e6cb5d77efd782561f": [{"text": ["Attrition rates tend to be", "higher in the", "months when it is", "common for associates to", "leave to go back to", "school."]}], "data-bf0c0886e85857075dcfec6916d457fe": [{"text": ["Summer"]}], "data-50a41c20af379a6e5c8ff82d5b95345b": [{"text": ["Attrition is typically low in", " ", "due to the holidays."]}], "data-56051377289bab148d95af94c7fc24d1": [{"text": ["November & December"]}], "data-04e931d655a49d81bb0fafa8be8a3ea8": [{"values": {}}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Since attempting to layer only already assigned variables seems to be ineffective, we will recreate the texts using alternative positions to enable their addition using the + symbol.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[76]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Same texts, different dx and dy values</span>

<span class="n">text_april_blank2_enclosure</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">"Highlights:"</span><span class="p">,</span>
                        <span class="s2">" "</span><span class="p">,</span>
                        <span class="s2">"In            there was a"</span><span class="p">,</span>
                        <span class="s2">"reorganization. No jobs"</span><span class="p">,</span>
                        <span class="s2">"were eliminated, but many"</span><span class="p">,</span>
                        <span class="s2">"people chose to leave."</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">113</span><span class="p">)</span> 
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">text_summer_blank2_enclosure</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">"Attrition rates tend to be"</span><span class="p">,</span>
                        <span class="s2">"higher in the"</span><span class="p">,</span>
                        <span class="s2">"months when it is"</span><span class="p">,</span>
                        <span class="s2">"common for associates to"</span><span class="p">,</span>
                        <span class="s2">"leave to go back to"</span><span class="p">,</span>
                        <span class="s2">"school."</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">21</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">text_nov_dec_blank2_enclosure</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Attrition is typically low in"</span><span class="p">,</span> <span class="s2">" "</span><span class="p">,</span> <span class="s2">"due to the holidays."</span><span class="p">]}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">68</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">text_april_color_enclosure</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"April"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">172</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">87</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">800</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#ed1e24"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">text_summer_color_enclosure</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Summer"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">225</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">800</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#ec7c30"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">text_nov_dec_color_enclosure</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"November &amp; December"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">160</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">82</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">800</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#5d9bd1"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">final_enc_sim</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">rect_nov_dec_color</span>
    <span class="o">+</span> <span class="n">rect_summer_color</span>
    <span class="o">+</span> <span class="n">rect_april_color</span>
    <span class="o">+</span> <span class="n">bar_highlight_color</span>
    <span class="o">+</span> <span class="n">text_april_blank2_enclosure</span>
    <span class="o">+</span> <span class="n">text_summer_blank2_enclosure</span>
    <span class="o">+</span> <span class="n">text_nov_dec_blank2_enclosure</span>
    <span class="o">+</span> <span class="n">text_april_color_enclosure</span>
    <span class="o">+</span> <span class="n">text_summer_color_enclosure</span>
    <span class="o">+</span> <span class="n">text_nov_dec_color_enclosure</span>
<span class="p">)</span>

<span class="n">final_enc_sim</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[76]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-a40c46dd44e34244b802d51a0baa6141.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-a40c46dd44e34244b802d51a0baa6141.vega-embed details,
  #altair-viz-a40c46dd44e34244b802d51a0baa6141.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-a40c46dd44e34244b802d51a0baa6141"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-a40c46dd44e34244b802d51a0baa6141") {
      outputDiv = document.getElementById("altair-viz-a40c46dd44e34244b802d51a0baa6141");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-04e931d655a49d81bb0fafa8be8a3ea8"}, "mark": {"type": "rect", "color": "#ed1e24", "opacity": 0.2}, "encoding": {"x": {"value": 75}, "x2": {"value": 450}, "y": {"value": 5}, "y2": {"value": 60}}}, {"data": {"name": "data-04e931d655a49d81bb0fafa8be8a3ea8"}, "mark": {"type": "rect", "color": "#ec7c30", "opacity": 0.2}, "encoding": {"x": {"value": 150}, "x2": {"value": 450}, "y": {"value": 70}, "y2": {"value": 150}}}, {"data": {"name": "data-04e931d655a49d81bb0fafa8be8a3ea8"}, "mark": {"type": "rect", "color": "#5d9bd1", "opacity": 0.2}, "encoding": {"x": {"value": 250}, "x2": {"value": 450}, "y": {"value": 160}, "y2": {"value": 202}}}, {"data": {"name": "data-0f748d12b71fa1969f524ef0b4d050d0"}, "mark": {"type": "bar", "size": 20}, "encoding": {"color": {"field": "Date", "legend": null, "scale": {"range": ["#b0b0b0", "#b0b0b0", "#b0b0b0", "#ed1e24", "#b0b0b0", "#b0b0b0", "#ec7c30", "#ec7c30", "#b0b0b0", "#b0b0b0", "#5d9bd1", "#5d9bd1"]}, "sort": null, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Date", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 10, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Rate", "scale": {"domain": [0, 0.01]}, "title": "ATTRITION RATE", "type": "quantitative"}}, "title": {"text": "2019 monthly voluntary attrition rate", "anchor": "start", "fontSize": 15, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "data-547bb088e9c8c00000f42a90929c9173"}, "mark": {"type": "text", "align": "left", "dx": 160, "dy": -113, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-e74a840aaa77e5e6cb5d77efd782561f"}, "mark": {"type": "text", "align": "left", "dx": 160, "dy": -21, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-50a41c20af379a6e5c8ff82d5b95345b"}, "mark": {"type": "text", "align": "left", "dx": 160, "dy": 68, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-f9846e3e8d56027489b8c959b216eeeb"}, "mark": {"type": "text", "align": "left", "color": "#ed1e24", "dx": 172, "dy": -87, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-bf0c0886e85857075dcfec6916d457fe"}, "mark": {"type": "text", "align": "left", "color": "#ec7c30", "dx": 225, "dy": -8, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-56051377289bab148d95af94c7fc24d1"}, "mark": {"type": "text", "align": "left", "color": "#5d9bd1", "dx": 160, "dy": 82, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "height": 200, "width": 300, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-04e931d655a49d81bb0fafa8be8a3ea8": [{"values": {}}], "data-0f748d12b71fa1969f524ef0b4d050d0": [{"Date": "JAN", "Rate": 0.004, "# exits": 120}, {"Date": "FEB", "Rate": 0.001, "# exits": 30}, {"Date": "MAR", "Rate": 0.0015, "# exits": 45}, {"Date": "APR", "Rate": 0.008, "# exits": 240}, {"Date": "MAY", "Rate": 0.003, "# exits": 90}, {"Date": "JUN", "Rate": 0.0014, "# exits": 42}, {"Date": "JUL", "Rate": 0.0044, "# exits": 132}, {"Date": "AUG", "Rate": 0.005, "# exits": 150}, {"Date": "SEP", "Rate": 0.0022, "# exits": 66}, {"Date": "OCT", "Rate": 0.0015, "# exits": 45}, {"Date": "NOV", "Rate": 0.0005, "# exits": 15}, {"Date": "DEC", "Rate": 0.001, "# exits": 30}], "data-547bb088e9c8c00000f42a90929c9173": [{"text": ["Highlights:", " ", "In            there was a", "reorganization. No jobs", "were eliminated, but many", "people chose to leave."]}], "data-e74a840aaa77e5e6cb5d77efd782561f": [{"text": ["Attrition rates tend to be", "higher in the", "months when it is", "common for associates to", "leave to go back to", "school."]}], "data-50a41c20af379a6e5c8ff82d5b95345b": [{"text": ["Attrition is typically low in", " ", "due to the holidays."]}], "data-f9846e3e8d56027489b8c959b216eeeb": [{"text": ["April"]}], "data-bf0c0886e85857075dcfec6916d457fe": [{"text": ["Summer"]}], "data-56051377289bab148d95af94c7fc24d1": [{"text": ["November & December"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/3_2g.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Connection">Connection<a class="anchor-link" href="#Connection"></a></h4><p>The "Connection" relies on the fact that objects that are physically connected are often perceived as part of a single group. In this example, we will connect the texts and the data using a line.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[77]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Rules connecting text with bar</span>
<span class="n">rule_april</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">()</span>
    <span class="o">.</span><span class="n">mark_rule</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="p">{</span><span class="s2">"fill"</span><span class="p">:</span> <span class="s2">"gray"</span><span class="p">})</span> <span class="c1"># With a dot at the end</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">102</span><span class="p">),</span> 
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">45</span><span class="p">),</span> 
        <span class="n">x2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">300</span><span class="p">),</span> 
        <span class="n">strokeWidth</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">rule_summer</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">()</span>
    <span class="o">.</span><span class="n">mark_rule</span><span class="p">(</span><span class="n">point</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"fill"</span><span class="p">:</span> <span class="s2">"gray"</span><span class="p">})</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">202</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">105</span><span class="p">),</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">300</span><span class="p">),</span>
        <span class="n">strokeWidth</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Part one of the November/December rule</span>
<span class="n">rule_nov_dec_1</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">()</span>
    <span class="o">.</span><span class="n">mark_rule</span><span class="p">()</span> <span class="c1"># Without the dot</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">260</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">175</span><span class="p">),</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">300</span><span class="p">),</span>
        <span class="n">strokeWidth</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Part two of the November/December rule</span>
<span class="n">rule_nov_dec_2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">()</span>
    <span class="o">.</span><span class="n">mark_rule</span><span class="p">(</span><span class="n">point</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"fill"</span><span class="p">:</span> <span class="s2">"gray"</span><span class="p">})</span> <span class="c1"># With the dot</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">260</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">185</span><span class="p">),</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">175</span><span class="p">),</span>
        <span class="n">strokeWidth</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">final_conn</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">bar</span> <span class="o">+</span> <span class="n">text_enclosure</span> <span class="o">+</span> <span class="n">rule_april</span> <span class="o">+</span> <span class="n">rule_summer</span> <span class="o">+</span> <span class="n">rule_nov_dec_1</span> <span class="o">+</span> <span class="n">rule_nov_dec_2</span>
<span class="p">)</span>

<span class="n">final_conn</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[77]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-3ab2457c8a9948f4b7aa00b62670a953.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-3ab2457c8a9948f4b7aa00b62670a953.vega-embed details,
  #altair-viz-3ab2457c8a9948f4b7aa00b62670a953.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-3ab2457c8a9948f4b7aa00b62670a953"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-3ab2457c8a9948f4b7aa00b62670a953") {
      outputDiv = document.getElementById("altair-viz-3ab2457c8a9948f4b7aa00b62670a953");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-0f748d12b71fa1969f524ef0b4d050d0"}, "mark": {"type": "bar", "color": "#b0b0b0", "size": 20}, "encoding": {"x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Date", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 10, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Rate", "scale": {"domain": [0, 0.01]}, "title": "ATTRITION RATE", "type": "quantitative"}}, "title": {"text": "2019 monthly voluntary attrition rate", "anchor": "start", "fontSize": 15, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "data-c2d1f9b053875a01285743790ea52a99"}, "mark": {"type": "text", "align": "left", "dx": 160, "dy": -113, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "empty"}, "mark": {"type": "rule", "point": {"fill": "gray"}}, "encoding": {"strokeWidth": {"value": 0.5}, "x": {"value": 102}, "x2": {"value": 300}, "y": {"value": 45}}}, {"data": {"name": "empty"}, "mark": {"type": "rule", "point": {"fill": "gray"}}, "encoding": {"strokeWidth": {"value": 0.5}, "x": {"value": 202}, "x2": {"value": 300}, "y": {"value": 105}}}, {"data": {"name": "empty"}, "mark": {"type": "rule"}, "encoding": {"strokeWidth": {"value": 0.5}, "x": {"value": 260}, "x2": {"value": 300}, "y": {"value": 175}}}, {"data": {"name": "empty"}, "mark": {"type": "rule", "point": {"fill": "gray"}}, "encoding": {"strokeWidth": {"value": 0.5}, "x": {"value": 260}, "y": {"value": 185}, "y2": {"value": 175}}}], "height": 200, "width": 300, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0f748d12b71fa1969f524ef0b4d050d0": [{"Date": "JAN", "Rate": 0.004, "# exits": 120}, {"Date": "FEB", "Rate": 0.001, "# exits": 30}, {"Date": "MAR", "Rate": 0.0015, "# exits": 45}, {"Date": "APR", "Rate": 0.008, "# exits": 240}, {"Date": "MAY", "Rate": 0.003, "# exits": 90}, {"Date": "JUN", "Rate": 0.0014, "# exits": 42}, {"Date": "JUL", "Rate": 0.0044, "# exits": 132}, {"Date": "AUG", "Rate": 0.005, "# exits": 150}, {"Date": "SEP", "Rate": 0.0022, "# exits": 66}, {"Date": "OCT", "Rate": 0.0015, "# exits": 45}, {"Date": "NOV", "Rate": 0.0005, "# exits": 15}, {"Date": "DEC", "Rate": 0.001, "# exits": 30}], "data-c2d1f9b053875a01285743790ea52a99": [{"text": ["Highlights:", " ", "In April there was a", "reorganization. No jobs", "were eliminated, but many", "people chose to leave.", " ", "Attrition rates tend to be", "higher in the Summer", "months when it is", "common for associates", "to leave to go back to", "school.", " ", "Attrition is typically low in", "November and December", "due to the holidays."]}], "empty": [{}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/3_2h.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Connection-+-Similarity">Connection + Similarity<a class="anchor-link" href="#Connection-+-Similarity"></a></h4><p>Now we can use the connection and the similarity principles to connect highlighted texts with colored data.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[78]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">final_conn_sim</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">bar_highlight_color</span>
    <span class="o">+</span> <span class="n">text_april_blank2_enclosure</span>
    <span class="o">+</span> <span class="n">text_summer_blank2_enclosure</span>
    <span class="o">+</span> <span class="n">text_nov_dec_blank2_enclosure</span>
    <span class="o">+</span> <span class="n">text_april_color_enclosure</span>
    <span class="o">+</span> <span class="n">text_summer_color_enclosure</span>
    <span class="o">+</span> <span class="n">text_nov_dec_color_enclosure</span>
    <span class="o">+</span> <span class="n">rule_april</span>
    <span class="o">+</span> <span class="n">rule_summer</span>
    <span class="o">+</span> <span class="n">rule_nov_dec_1</span>
    <span class="o">+</span> <span class="n">rule_nov_dec_2</span>
<span class="p">)</span>

<span class="n">final_conn_sim</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[78]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-46da59307c614672aef553a74a603c1e.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-46da59307c614672aef553a74a603c1e.vega-embed details,
  #altair-viz-46da59307c614672aef553a74a603c1e.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-46da59307c614672aef553a74a603c1e"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-46da59307c614672aef553a74a603c1e") {
      outputDiv = document.getElementById("altair-viz-46da59307c614672aef553a74a603c1e");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-0f748d12b71fa1969f524ef0b4d050d0"}, "mark": {"type": "bar", "size": 20}, "encoding": {"color": {"field": "Date", "legend": null, "scale": {"range": ["#b0b0b0", "#b0b0b0", "#b0b0b0", "#ed1e24", "#b0b0b0", "#b0b0b0", "#ec7c30", "#ec7c30", "#b0b0b0", "#b0b0b0", "#5d9bd1", "#5d9bd1"]}, "sort": null, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Date", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 10, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Rate", "scale": {"domain": [0, 0.01]}, "title": "ATTRITION RATE", "type": "quantitative"}}, "title": {"text": "2019 monthly voluntary attrition rate", "anchor": "start", "fontSize": 15, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "data-547bb088e9c8c00000f42a90929c9173"}, "mark": {"type": "text", "align": "left", "dx": 160, "dy": -113, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-e74a840aaa77e5e6cb5d77efd782561f"}, "mark": {"type": "text", "align": "left", "dx": 160, "dy": -21, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-50a41c20af379a6e5c8ff82d5b95345b"}, "mark": {"type": "text", "align": "left", "dx": 160, "dy": 68, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-f9846e3e8d56027489b8c959b216eeeb"}, "mark": {"type": "text", "align": "left", "color": "#ed1e24", "dx": 172, "dy": -87, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-bf0c0886e85857075dcfec6916d457fe"}, "mark": {"type": "text", "align": "left", "color": "#ec7c30", "dx": 225, "dy": -8, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-56051377289bab148d95af94c7fc24d1"}, "mark": {"type": "text", "align": "left", "color": "#5d9bd1", "dx": 160, "dy": 82, "fontWeight": 800, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "empty"}, "mark": {"type": "rule", "point": {"fill": "gray"}}, "encoding": {"strokeWidth": {"value": 0.5}, "x": {"value": 102}, "x2": {"value": 300}, "y": {"value": 45}}}, {"data": {"name": "empty"}, "mark": {"type": "rule", "point": {"fill": "gray"}}, "encoding": {"strokeWidth": {"value": 0.5}, "x": {"value": 202}, "x2": {"value": 300}, "y": {"value": 105}}}, {"data": {"name": "empty"}, "mark": {"type": "rule"}, "encoding": {"strokeWidth": {"value": 0.5}, "x": {"value": 260}, "x2": {"value": 300}, "y": {"value": 175}}}, {"data": {"name": "empty"}, "mark": {"type": "rule", "point": {"fill": "gray"}}, "encoding": {"strokeWidth": {"value": 0.5}, "x": {"value": 260}, "y": {"value": 185}, "y2": {"value": 175}}}], "height": 200, "width": 300, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0f748d12b71fa1969f524ef0b4d050d0": [{"Date": "JAN", "Rate": 0.004, "# exits": 120}, {"Date": "FEB", "Rate": 0.001, "# exits": 30}, {"Date": "MAR", "Rate": 0.0015, "# exits": 45}, {"Date": "APR", "Rate": 0.008, "# exits": 240}, {"Date": "MAY", "Rate": 0.003, "# exits": 90}, {"Date": "JUN", "Rate": 0.0014, "# exits": 42}, {"Date": "JUL", "Rate": 0.0044, "# exits": 132}, {"Date": "AUG", "Rate": 0.005, "# exits": 150}, {"Date": "SEP", "Rate": 0.0022, "# exits": 66}, {"Date": "OCT", "Rate": 0.0015, "# exits": 45}, {"Date": "NOV", "Rate": 0.0005, "# exits": 15}, {"Date": "DEC", "Rate": 0.001, "# exits": 30}], "data-547bb088e9c8c00000f42a90929c9173": [{"text": ["Highlights:", " ", "In            there was a", "reorganization. No jobs", "were eliminated, but many", "people chose to leave."]}], "data-e74a840aaa77e5e6cb5d77efd782561f": [{"text": ["Attrition rates tend to be", "higher in the", "months when it is", "common for associates to", "leave to go back to", "school."]}], "data-50a41c20af379a6e5c8ff82d5b95345b": [{"text": ["Attrition is typically low in", " ", "due to the holidays."]}], "data-f9846e3e8d56027489b8c959b216eeeb": [{"text": ["April"]}], "data-bf0c0886e85857075dcfec6916d457fe": [{"text": ["Summer"]}], "data-56051377289bab148d95af94c7fc24d1": [{"text": ["November & December"]}], "empty": [{}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/3_2i.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Interactivity">Interactivity<a class="anchor-link" href="#Interactivity"></a></h4><p>In designing this interactive graph, we opted to apply the Gestalt Principle of Proximity for tooltips. Rather than displaying the text next to the bars it represents, the information will appear when the user hovers over the respective bars.</p>
<p>Having experimented with more sophisticated code solutions without achieving success, we opted for an alternative approach. We created a "base" bar in light gray without any tooltips. Subsequently, for each of the three groups of bars, we crafted distinct charts containing only the data relevant to the tooltips, in darker gray. Consequently, the final graph is composed of four charts added on top of each other.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[79]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Base graph</span>
<span class="n">bar_base</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"2019 monthly voluntary attrition rate"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Date"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleX</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Rate"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span><span class="p">,</span>
                <span class="n">tickCount</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="p">),</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"ATTRITION RATE"</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span> <span class="c1"># Light gray</span>
            <span class="s2">"Date"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#b0b0b0"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">200</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Graph for April</span>
<span class="n">bar_apr</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Date"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Rate"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">])),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#666666"</span><span class="p">),</span> <span class="c1"># Darker gray</span>
        <span class="n">tooltip</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span>
            <span class="s2">"In April there was a reorganization. No jobs were eliminated, but many people chose to leave."</span>
        <span class="p">)</span> <span class="c1"># Text for April</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">FieldEqualPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"Date"</span><span class="p">,</span> <span class="n">equal</span> <span class="o">=</span> <span class="s2">"APR"</span><span class="p">))</span> <span class="c1"># Only data for April</span>
<span class="p">)</span>

<span class="c1"># Graph for summer</span>
<span class="n">bar_jul_aug</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Date"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Rate"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">])),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#666666"</span><span class="p">),</span> <span class="c1"># Darker gray</span>
        <span class="n">tooltip</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span>
            <span class="s2">"Attrition rates tend to be higher in the Summer months when it is common for associates to leave to go back to school."</span>
        <span class="p">)</span> <span class="c1"># Text for summer</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"Date"</span><span class="p">,</span> <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"JUL"</span><span class="p">,</span> <span class="s2">"AUG"</span><span class="p">]))</span>
<span class="p">)</span> <span class="c1"># Filter summer data</span>

<span class="c1"># Graph for end of year</span>
<span class="n">bar_dec_nov</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Date"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Rate"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">])),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#666666"</span><span class="p">),</span> <span class="c1"># Darker gray</span>
        <span class="n">tooltip</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span>
            <span class="s2">"Attrition is typically low in November and December due to the holidays."</span>
        <span class="p">)</span> <span class="c1"># Text for the end of year</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"Date"</span><span class="p">,</span> <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"NOV"</span><span class="p">,</span> <span class="s2">"DEC"</span><span class="p">]))</span>
<span class="p">)</span>

<span class="n">final_tooltip</span> <span class="o">=</span> <span class="n">bar_base</span> <span class="o">+</span> <span class="n">bar_apr</span> <span class="o">+</span> <span class="n">bar_jul_aug</span> <span class="o">+</span> <span class="n">bar_dec_nov</span>
<span class="n">final_tooltip</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[79]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-c24bd2a74e64493fb532550f76c6b297.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-c24bd2a74e64493fb532550f76c6b297.vega-embed details,
  #altair-viz-c24bd2a74e64493fb532550f76c6b297.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-c24bd2a74e64493fb532550f76c6b297"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-c24bd2a74e64493fb532550f76c6b297") {
      outputDiv = document.getElementById("altair-viz-c24bd2a74e64493fb532550f76c6b297");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "bar", "size": 20}, "encoding": {"color": {"field": "Date", "legend": null, "scale": {"range": ["#b0b0b0"]}, "sort": null, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal", "titleX": 12}, "field": "Date", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "tickCount": 10, "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Rate", "scale": {"domain": [0, 0.01]}, "title": "ATTRITION RATE", "type": "quantitative"}}, "title": {"text": "2019 monthly voluntary attrition rate", "anchor": "start", "fontSize": 15, "fontWeight": "normal", "offset": 10}}, {"mark": {"type": "bar"}, "encoding": {"color": {"value": "#666666"}, "tooltip": {"value": "In April there was a reorganization. No jobs were eliminated, but many people chose to leave."}, "x": {"field": "Date", "sort": null, "type": "nominal"}, "y": {"field": "Rate", "scale": {"domain": [0, 0.01]}, "type": "quantitative"}}, "transform": [{"filter": {"equal": "APR", "field": "Date"}}]}, {"mark": {"type": "bar", "size": 20}, "encoding": {"color": {"value": "#666666"}, "tooltip": {"value": "Attrition rates tend to be higher in the Summer months when it is common for associates to leave to go back to school."}, "x": {"field": "Date", "sort": null, "type": "nominal"}, "y": {"field": "Rate", "scale": {"domain": [0, 0.01]}, "type": "quantitative"}}, "transform": [{"filter": {"field": "Date", "oneOf": ["JUL", "AUG"]}}]}, {"mark": {"type": "bar", "size": 20}, "encoding": {"color": {"value": "#666666"}, "tooltip": {"value": "Attrition is typically low in November and December due to the holidays."}, "x": {"field": "Date", "sort": null, "type": "nominal"}, "y": {"field": "Rate", "scale": {"domain": [0, 0.01]}, "type": "quantitative"}}, "transform": [{"filter": {"field": "Date", "oneOf": ["NOV", "DEC"]}}]}], "data": {"name": "data-0f748d12b71fa1969f524ef0b4d050d0"}, "height": 200, "width": 300, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0f748d12b71fa1969f524ef0b4d050d0": [{"Date": "JAN", "Rate": 0.004, "# exits": 120}, {"Date": "FEB", "Rate": 0.001, "# exits": 30}, {"Date": "MAR", "Rate": 0.0015, "# exits": 45}, {"Date": "APR", "Rate": 0.008, "# exits": 240}, {"Date": "MAY", "Rate": 0.003, "# exits": 90}, {"Date": "JUN", "Rate": 0.0014, "# exits": 42}, {"Date": "JUL", "Rate": 0.0044, "# exits": 132}, {"Date": "AUG", "Rate": 0.005, "# exits": 150}, {"Date": "SEP", "Rate": 0.0022, "# exits": 66}, {"Date": "OCT", "Rate": 0.0015, "# exits": 45}, {"Date": "NOV", "Rate": 0.0005, "# exits": 15}, {"Date": "DEC", "Rate": 0.001, "# exits": 30}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Chapter-4---Focus-Attention">Chapter 4 - Focus Attention<a name="4"></a><a class="anchor-link" href="#Chapter-4---Focus-Attention"></a></h2><p><em>"Where do you want your audience to look?"</em> - Cole Nussbaumer Knaflic</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Exercise-2---Focus-on...">Exercise 2 - Focus on...<a name="4.2"></a><a class="anchor-link" href="#Exercise-2---Focus-on..."></a></h3><p>This exercise focuses on identifying what you want to highlight in a graph, the specific insights you wish the viewer to take from the visual presentation.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Loading-the-data">Loading the data<a class="anchor-link" href="#Loading-the-data"></a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[80]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Loading table</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Data\4.2 EXERCISE.xlsx"</span><span class="p">,</span> <span class="n">usecols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">skipfooter</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>

<span class="c1"># Fixing names</span>
<span class="n">table</span><span class="p">[</span><span class="s1">'Brands'</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">'Unnamed: 1'</span><span class="p">]</span>
<span class="n">table</span><span class="p">[</span><span class="s1">'Change'</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">'$ Vol </span><span class="si">% c</span><span class="s1">hange'</span><span class="p">]</span>

<span class="n">table</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Unnamed: 1'</span><span class="p">,</span> <span class="s1">'$ Vol </span><span class="si">% c</span><span class="s1">hange'</span><span class="p">],</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">table</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[80]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>spacing for dot plot</th>
<th>Brands</th>
<th>Change</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>Fran's Recipe</td>
<td>-0.14</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>Wholesome Goodness</td>
<td>-0.13</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>Lifestyle</td>
<td>-0.10</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>Coat protection</td>
<td>-0.09</td>
</tr>
<tr>
<th>4</th>
<td>4</td>
<td>Diet Lifestyle</td>
<td>-0.08</td>
</tr>
<tr>
<th>5</th>
<td>5</td>
<td>Feline Basics</td>
<td>-0.05</td>
</tr>
<tr>
<th>6</th>
<td>6</td>
<td>Lifestyle Plus</td>
<td>-0.04</td>
</tr>
<tr>
<th>7</th>
<td>7</td>
<td>Feline Freedom</td>
<td>-0.02</td>
</tr>
<tr>
<th>8</th>
<td>8</td>
<td>Feline Gold</td>
<td>0.01</td>
</tr>
<tr>
<th>9</th>
<td>9</td>
<td>Feline Platinum</td>
<td>0.01</td>
</tr>
<tr>
<th>10</th>
<td>10</td>
<td>Feline Instinct</td>
<td>0.02</td>
</tr>
<tr>
<th>11</th>
<td>11</td>
<td>Feline Pro</td>
<td>0.03</td>
</tr>
<tr>
<th>12</th>
<td>12</td>
<td>Farm Fresh Tasties</td>
<td>0.04</td>
</tr>
<tr>
<th>13</th>
<td>13</td>
<td>Feline Royal</td>
<td>0.05</td>
</tr>
<tr>
<th>14</th>
<td>14</td>
<td>Feline Focus</td>
<td>0.09</td>
</tr>
<tr>
<th>15</th>
<td>15</td>
<td>Feline Grain Free</td>
<td>0.09</td>
</tr>
<tr>
<th>16</th>
<td>16</td>
<td>Feline Silver</td>
<td>0.12</td>
</tr>
<tr>
<th>17</th>
<td>17</td>
<td>Nutri Balance</td>
<td>0.16</td>
</tr>
<tr>
<th>18</th>
<td>18</td>
<td>Farm Fresh Basics</td>
<td>0.17</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Graph-without-highlights">Graph without highlights<a class="anchor-link" href="#Graph-without-highlights"></a></h4><p>Initially, we will show the graph in a light gray color. Notice that not using <code>sort = None</code> results in the brands being arranged in alphabetical order.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[81]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Brans in alphabetical order</span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s2">"Change"</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[81]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-639b53d38cbe473f9e1ef8d525e92721.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-639b53d38cbe473f9e1ef8d525e92721.vega-embed details,
  #altair-viz-639b53d38cbe473f9e1ef8d525e92721.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-639b53d38cbe473f9e1ef8d525e92721"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-639b53d38cbe473f9e1ef8d525e92721") {
      outputDiv = document.getElementById("altair-viz-639b53d38cbe473f9e1ef8d525e92721");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "mark": {"type": "bar"}, "encoding": {"x": {"field": "Change", "type": "quantitative"}, "y": {"field": "Brands", "type": "nominal"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[82]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># "Not sorted" graph</span>

<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s2">"Change"</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[82]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-939999a3497b4c9f88127eb5b20f17a6.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-939999a3497b4c9f88127eb5b20f17a6.vega-embed details,
  #altair-viz-939999a3497b4c9f88127eb5b20f17a6.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-939999a3497b4c9f88127eb5b20f17a6"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-939999a3497b4c9f88127eb5b20f17a6") {
      outputDiv = document.getElementById("altair-viz-939999a3497b4c9f88127eb5b20f17a6");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "mark": {"type": "bar"}, "encoding": {"x": {"field": "Change", "type": "quantitative"}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[83]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Customized graph</span>

<span class="n">chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Cat food brands: YoY sales change"</span><span class="p">,</span>
            <span class="n">subtitle</span> <span class="o">=</span> <span class="s2">"% CHANGE IN VOLUME ($)"</span><span class="p">,</span> <span class="c1"># Add subtitle</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">,</span>
            <span class="n">subtitleColor</span> <span class="o">=</span> <span class="s2">"gray"</span><span class="p">,</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">19</span><span class="p">,</span>
            <span class="n">subtitleFontSize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">"#8b8b8b"</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> <span class="c1"># x-axis from -20% to 20%</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">orient</span> <span class="o">=</span> <span class="s2">"top"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"DECREASED | INCREASED"</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>


<span class="c1"># Brand names that go on the right</span>
<span class="n">label1</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#8b8b8b"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">207</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span> <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Brand names that go on the left</span>
<span class="n">label2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"right"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#8b8b8b"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">192</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span> <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">gray</span> <span class="o">=</span> <span class="n">chart</span> <span class="o">+</span> <span class="n">label1</span> <span class="o">+</span> <span class="n">label2</span>

<span class="n">gray</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[83]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-66b735de1efd4de29050110c1958fd71.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-66b735de1efd4de29050110c1958fd71.vega-embed details,
  #altair-viz-66b735de1efd4de29050110c1958fd71.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-66b735de1efd4de29050110c1958fd71"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-66b735de1efd4de29050110c1958fd71") {
      outputDiv = document.getElementById("altair-viz-66b735de1efd4de29050110c1958fd71");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "mark": {"type": "bar", "color": "#8b8b8b", "size": 15}, "encoding": {"x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": "DECREASED | INCREASED", "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "title": {"text": "Cat food brands: YoY sales change", "anchor": "start", "color": "black", "fontSize": 19, "fontWeight": "normal", "offset": 10, "subtitle": "% CHANGE IN VOLUME ($)", "subtitleColor": "gray", "subtitleFontSize": 11}}, {"data": {"name": "data-0cc3663d469e54c83c8449d2705bfe37"}, "mark": {"type": "text", "align": "left", "color": "#8b8b8b", "fontWeight": 700}, "encoding": {"text": {"field": "Brands", "type": "nominal"}, "x": {"value": 207}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-ec5f7c8dc3e548f95008aa754a246610"}, "mark": {"type": "text", "align": "right", "color": "#8b8b8b", "fontWeight": 700}, "encoding": {"text": {"field": "Brands", "type": "nominal"}, "x": {"value": 192}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}], "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-0cc3663d469e54c83c8449d2705bfe37": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}], "data-ec5f7c8dc3e548f95008aa754a246610": [{"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_2a.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Highlighting-the-Lifestyle-brands">Highlighting the Lifestyle brands<a class="anchor-link" href="#Highlighting-the-Lifestyle-brands"></a></h4><p>Following this, the author suggests highlighting a specific brand of cat food, the Lifestyle line. All labels and bars associated with this brand will be colored black to captivate the viewer's attention.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[84]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Creates a list of brand in the Lifestyle line</span>
<span class="n">conditions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sa">f</span><span class="s1">'datum.Brands == "</span><span class="si">{</span><span class="n">brand</span><span class="si">}</span><span class="s1">"'</span> <span class="k">for</span> <span class="n">brand</span> <span class="ow">in</span> <span class="n">table</span><span class="p">[</span><span class="s2">"Brands"</span><span class="p">]</span> <span class="k">if</span> <span class="s2">"Lifestyle"</span> <span class="ow">in</span> <span class="n">brand</span>
<span class="p">]</span>
<span class="n">condition</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"(</span><span class="si">{</span><span class="s1">'|'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span><span class="si">}</span><span class="s2">)"</span>


<span class="c1"># Create the chart</span>
<span class="n">chart</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Cat food brands:"</span><span class="p">,</span> <span class="c1"># Title</span>
            <span class="n">subtitle</span> <span class="o">=</span> <span class="s2">"YEAR-OVER-YEAR % CHANGE IN VOLUME ($)"</span><span class="p">,</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">,</span>
            <span class="n">subtitleColor</span> <span class="o">=</span> <span class="s2">"gray"</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">19</span><span class="p">,</span>
            <span class="n">subtitleFontSize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">orient</span> <span class="o">=</span> <span class="s2">"top"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"DECREASED | INCREASED"</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span> <span class="c1"># If brand in Lifestyle, then color equals black</span>
            <span class="n">condition</span><span class="p">,</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"black"</span><span class="p">),</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#c6c6c6"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Labels to the right</span>
<span class="n">label1_bw</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">207</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">),</span>
        <span class="c1"># If brand in Lifestyle, then label equals black</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"black"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#c6c6c6"</span><span class="p">))</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Labels to the left</span>
<span class="c1"># There are no lifestyle brand line in this category</span>
<span class="n">label2_bw</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"right"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#c6c6c6"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">192</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span> <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Add bold part of the title separately</span>
<span class="n">title_bw</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Lifestyle line brands decline"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">19</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">172</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="p">(</span><span class="n">chart</span> <span class="o">+</span> <span class="n">label1_bw</span> <span class="o">+</span> <span class="n">label2_bw</span> <span class="o">+</span> <span class="n">title_bw</span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span>
    <span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[84]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-225d725e1d3e48eea165bbd85d4362b5.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-225d725e1d3e48eea165bbd85d4362b5.vega-embed details,
  #altair-viz-225d725e1d3e48eea165bbd85d4362b5.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-225d725e1d3e48eea165bbd85d4362b5"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-225d725e1d3e48eea165bbd85d4362b5") {
      outputDiv = document.getElementById("altair-viz-225d725e1d3e48eea165bbd85d4362b5");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Lifestyle\"|datum.Brands == \"Diet Lifestyle\"|datum.Brands == \"Lifestyle Plus\")", "value": "black"}, "value": "#c6c6c6"}, "x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": "DECREASED | INCREASED", "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "title": {"text": "Cat food brands:", "anchor": "start", "color": "black", "fontSize": 19, "fontWeight": "normal", "subtitle": "YEAR-OVER-YEAR % CHANGE IN VOLUME ($)", "subtitleColor": "gray", "subtitleFontSize": 11}}, {"data": {"name": "data-0cc3663d469e54c83c8449d2705bfe37"}, "mark": {"type": "text", "align": "left", "fontWeight": 700}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Lifestyle\"|datum.Brands == \"Diet Lifestyle\"|datum.Brands == \"Lifestyle Plus\")", "value": "black"}, "value": "#c6c6c6"}, "text": {"field": "Brands", "type": "nominal"}, "x": {"value": 207}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-ec5f7c8dc3e548f95008aa754a246610"}, "mark": {"type": "text", "align": "right", "color": "#c6c6c6", "fontWeight": 700}, "encoding": {"text": {"field": "Brands", "type": "nominal"}, "x": {"value": 192}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-2750fc8342e1c69ffe882ae24c231e24"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": 172, "dy": -250, "fontWeight": 700, "size": 19}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-0cc3663d469e54c83c8449d2705bfe37": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}], "data-ec5f7c8dc3e548f95008aa754a246610": [{"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-2750fc8342e1c69ffe882ae24c231e24": [{"text": ["Lifestyle line brands decline"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Given that incorporating the bold section of the title next to the chart's predefined title proved unsuccessful, we will proceed by generating the chart without a title. Subsequently, we will add both texts separately.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[85]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Graph without title</span>
<span class="n">chart_bw</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span> 
        <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span>
        <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s2">"Change"</span><span class="p">,</span> 
        <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
        <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span><span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">orient</span> <span class="o">=</span> <span class="s2">"top"</span><span class="p">,</span> 
                        <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span> <span class="n">titleColor</span> <span class="o">=</span> <span class="s1">'#888888'</span><span class="p">,</span> 
                        <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s1">'normal'</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span><span class="p">),</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">"DECREASED | INCREASED"</span>
        <span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
        <span class="n">condition</span><span class="p">,</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">'black'</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">'#c6c6c6'</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Part one of title</span>
<span class="n">title_bw</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Cat food brands:"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">270</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Part two of title</span>
<span class="n">title_bw_bold</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Lifestyle line brands decline"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">78</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">270</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Subtitle</span>
<span class="n">subtitle_bw</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"YEAR-OVER-YEAR % CHANGE IN VOLUME ($)"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"gray"</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>


<span class="n">lifestyle</span> <span class="o">=</span> <span class="n">chart_bw</span> <span class="o">+</span> <span class="n">label1_bw</span> <span class="o">+</span> <span class="n">label2_bw</span> <span class="o">+</span> <span class="n">title_bw</span> <span class="o">+</span> <span class="n">title_bw_bold</span> <span class="o">+</span> <span class="n">subtitle_bw</span>

<span class="n">lifestyle</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[85]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-a5d449b3959d4eed8d87601490c4f3e8.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-a5d449b3959d4eed8d87601490c4f3e8.vega-embed details,
  #altair-viz-a5d449b3959d4eed8d87601490c4f3e8.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-a5d449b3959d4eed8d87601490c4f3e8"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-a5d449b3959d4eed8d87601490c4f3e8") {
      outputDiv = document.getElementById("altair-viz-a5d449b3959d4eed8d87601490c4f3e8");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Lifestyle\"|datum.Brands == \"Diet Lifestyle\"|datum.Brands == \"Lifestyle Plus\")", "value": "black"}, "value": "#c6c6c6"}, "x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": "DECREASED | INCREASED", "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-0cc3663d469e54c83c8449d2705bfe37"}, "mark": {"type": "text", "align": "left", "fontWeight": 700}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Lifestyle\"|datum.Brands == \"Diet Lifestyle\"|datum.Brands == \"Lifestyle Plus\")", "value": "black"}, "value": "#c6c6c6"}, "text": {"field": "Brands", "type": "nominal"}, "x": {"value": 207}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-ec5f7c8dc3e548f95008aa754a246610"}, "mark": {"type": "text", "align": "right", "color": "#c6c6c6", "fontWeight": 700}, "encoding": {"text": {"field": "Brands", "type": "nominal"}, "x": {"value": 192}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-61ed60cd51bbea95a6d688536e3e2c35"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": -200, "dy": -270, "fontWeight": "normal", "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-2750fc8342e1c69ffe882ae24c231e24"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": -78, "dy": -270, "fontWeight": 700, "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-ba11cdcb5208607813ec99b1dd569bab"}, "mark": {"type": "text", "align": "left", "color": "gray", "dx": -200, "dy": -250, "fontWeight": "normal", "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-0cc3663d469e54c83c8449d2705bfe37": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}], "data-ec5f7c8dc3e548f95008aa754a246610": [{"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-61ed60cd51bbea95a6d688536e3e2c35": [{"text": ["Cat food brands:"]}], "data-2750fc8342e1c69ffe882ae24c231e24": [{"text": ["Lifestyle line brands decline"]}], "data-ba11cdcb5208607813ec99b1dd569bab": [{"text": ["YEAR-OVER-YEAR % CHANGE IN VOLUME ($)"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_2b.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Highlighting-the-Feline-brand">Highlighting the Feline brand<a class="anchor-link" href="#Highlighting-the-Feline-brand"></a></h4><p>In the next step, our focus is on highlighting the Feline brand line. The difference is that we have the information that the brand uses a purple logo, and therefore, we can incorporate this color into our design.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[86]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Set condition to list of Feline products</span>
<span class="n">conditions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sa">f</span><span class="s1">'datum.Brands == "</span><span class="si">{</span><span class="n">brand</span><span class="si">}</span><span class="s1">"'</span> <span class="k">for</span> <span class="n">brand</span> <span class="ow">in</span> <span class="n">table</span><span class="p">[</span><span class="s2">"Brands"</span><span class="p">]</span> <span class="k">if</span> <span class="s2">"Feline"</span> <span class="ow">in</span> <span class="n">brand</span>
<span class="p">]</span>
<span class="n">condition_purple</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"(</span><span class="si">{</span><span class="s1">'|'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span><span class="si">}</span><span class="s2">)"</span>


<span class="c1"># Highlights Feline products with purple color</span>
<span class="n">chart_purple</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">orient</span> <span class="o">=</span> <span class="s2">"top"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"DECREASED | INCREASED"</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_purple</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#713a97"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#c6c6c6"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Labels to the right</span>
<span class="n">label1_purple</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">207</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_purple</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#713a97"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#c6c6c6"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Labels to the left</span>
<span class="c1"># Now we need to add condition as there are Feline products in this</span>
<span class="n">label2_purple</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"right"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">192</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_purple</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#713a97"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#c6c6c6"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Second title in purple</span>
<span class="n">title_purple</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"most in Feline line increased"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">78</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">270</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#713a97"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>


<span class="n">feline</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">chart_purple</span> <span class="o">+</span> <span class="n">label1_purple</span> <span class="o">+</span> <span class="n">label2_purple</span> <span class="o">+</span> <span class="n">title_bw</span> <span class="o">+</span> <span class="n">title_purple</span> <span class="o">+</span> <span class="n">subtitle_bw</span>
<span class="p">)</span>

<span class="n">feline</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[86]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-68ce2c290ab2431e8978599590cf15b7.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-68ce2c290ab2431e8978599590cf15b7.vega-embed details,
  #altair-viz-68ce2c290ab2431e8978599590cf15b7.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-68ce2c290ab2431e8978599590cf15b7"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-68ce2c290ab2431e8978599590cf15b7") {
      outputDiv = document.getElementById("altair-viz-68ce2c290ab2431e8978599590cf15b7");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Feline Basics\"|datum.Brands == \"Feline Freedom\"|datum.Brands == \"Feline Gold\"|datum.Brands == \"Feline Platinum\"|datum.Brands == \"Feline Instinct\"|datum.Brands == \"Feline Pro\"|datum.Brands == \"Feline Royal\"|datum.Brands == \"Feline Focus\"|datum.Brands == \"Feline Grain Free\"|datum.Brands == \"Feline Silver\")", "value": "#713a97"}, "value": "#c6c6c6"}, "x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": "DECREASED | INCREASED", "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-0cc3663d469e54c83c8449d2705bfe37"}, "mark": {"type": "text", "align": "left", "fontWeight": 700}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Feline Basics\"|datum.Brands == \"Feline Freedom\"|datum.Brands == \"Feline Gold\"|datum.Brands == \"Feline Platinum\"|datum.Brands == \"Feline Instinct\"|datum.Brands == \"Feline Pro\"|datum.Brands == \"Feline Royal\"|datum.Brands == \"Feline Focus\"|datum.Brands == \"Feline Grain Free\"|datum.Brands == \"Feline Silver\")", "value": "#713a97"}, "value": "#c6c6c6"}, "text": {"field": "Brands", "type": "nominal"}, "x": {"value": 207}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-ec5f7c8dc3e548f95008aa754a246610"}, "mark": {"type": "text", "align": "right", "fontWeight": 700}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Feline Basics\"|datum.Brands == \"Feline Freedom\"|datum.Brands == \"Feline Gold\"|datum.Brands == \"Feline Platinum\"|datum.Brands == \"Feline Instinct\"|datum.Brands == \"Feline Pro\"|datum.Brands == \"Feline Royal\"|datum.Brands == \"Feline Focus\"|datum.Brands == \"Feline Grain Free\"|datum.Brands == \"Feline Silver\")", "value": "#713a97"}, "value": "#c6c6c6"}, "text": {"field": "Brands", "type": "nominal"}, "x": {"value": 192}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-61ed60cd51bbea95a6d688536e3e2c35"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": -200, "dy": -270, "fontWeight": "normal", "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-19ea155562c358d38165a59a968b6f99"}, "mark": {"type": "text", "align": "left", "color": "#713a97", "dx": -78, "dy": -270, "fontWeight": 700, "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-ba11cdcb5208607813ec99b1dd569bab"}, "mark": {"type": "text", "align": "left", "color": "gray", "dx": -200, "dy": -250, "fontWeight": "normal", "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-0cc3663d469e54c83c8449d2705bfe37": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}], "data-ec5f7c8dc3e548f95008aa754a246610": [{"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-61ed60cd51bbea95a6d688536e3e2c35": [{"text": ["Cat food brands:"]}], "data-19ea155562c358d38165a59a968b6f99": [{"text": ["most in Feline line increased"]}], "data-ba11cdcb5208607813ec99b1dd569bab": [{"text": ["YEAR-OVER-YEAR % CHANGE IN VOLUME ($)"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_2c.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>In the displayed chart from the book, there is an error where the bar corresponding to "Feline Gold" cat food appears light gray instead of the correct purple, consistent with the labeling. A request for information on the process of formally submitting an erratum has been made.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Highlighting-brands-that-declined">Highlighting brands that declined<a class="anchor-link" href="#Highlighting-brands-that-declined"></a></h4><p>Moving forward, we will selectively color the brands that experienced a decline in sales. Recognizing the accessibility challenges associated with the conventional red and green combination, the author suggests using orange and blue to cater to individuals with colorblindness.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[87]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Condition based on negative values of Change</span>
<span class="n">condition</span> <span class="o">=</span> <span class="s2">"datum.Change &lt; 0"</span>

<span class="c1"># Chart with orange color</span>
<span class="n">chart_orange</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">orient</span> <span class="o">=</span> <span class="s2">"top"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#ec7c30"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#c6c6c6"</span><span class="p">))</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># The right label is for decreased brands</span>
<span class="c1"># so we will color all of it with orange</span>
<span class="n">label1_orange</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">207</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#ec7c30"</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># There is no need to create labeling for the left</span>
<span class="c1"># it will all be gray and we already have that variable</span>

<span class="c1"># Second title in orange</span>
<span class="n">title_orange</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"8 brands decreased in sale"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">78</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">270</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#ec7c30"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># "DECREASED" text in orange, serves as a label</span>
<span class="n">decreased_orange</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"DECREASED"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">220</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#ec7c30"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># "INCREASED" text in gray</span>
<span class="n">increased_gray</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"|    INCREASED"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">0</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">220</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#8b8b8b"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">decreased</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">chart_orange</span>
    <span class="o">+</span> <span class="n">label1_orange</span>
    <span class="o">+</span> <span class="n">label2_bw</span>
    <span class="o">+</span> <span class="n">title_bw</span>
    <span class="o">+</span> <span class="n">title_orange</span>
    <span class="o">+</span> <span class="n">subtitle_bw</span>
    <span class="o">+</span> <span class="n">decreased_orange</span>
    <span class="o">+</span> <span class="n">increased_gray</span>
<span class="p">)</span>

<span class="n">decreased</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[87]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-c25a0070a3324b67b57b644d4ecc83b1.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-c25a0070a3324b67b57b644d4ecc83b1.vega-embed details,
  #altair-viz-c25a0070a3324b67b57b644d4ecc83b1.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-c25a0070a3324b67b57b644d4ecc83b1"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-c25a0070a3324b67b57b644d4ecc83b1") {
      outputDiv = document.getElementById("altair-viz-c25a0070a3324b67b57b644d4ecc83b1");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "datum.Change < 0", "value": "#ec7c30"}, "value": "#c6c6c6"}, "x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-0cc3663d469e54c83c8449d2705bfe37"}, "mark": {"type": "text", "align": "left", "fontWeight": 700}, "encoding": {"color": {"value": "#ec7c30"}, "text": {"field": "Brands", "type": "nominal"}, "x": {"value": 207}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-ec5f7c8dc3e548f95008aa754a246610"}, "mark": {"type": "text", "align": "right", "color": "#c6c6c6", "fontWeight": 700}, "encoding": {"text": {"field": "Brands", "type": "nominal"}, "x": {"value": 192}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-61ed60cd51bbea95a6d688536e3e2c35"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": -200, "dy": -270, "fontWeight": "normal", "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-8fb65900842ee286421a4b8ea376e54b"}, "mark": {"type": "text", "align": "left", "color": "#ec7c30", "dx": -78, "dy": -270, "fontWeight": 700, "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-ba11cdcb5208607813ec99b1dd569bab"}, "mark": {"type": "text", "align": "left", "color": "gray", "dx": -200, "dy": -250, "fontWeight": "normal", "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-3ecb015f60fd260c79b4fc4b31f64dd1"}, "mark": {"type": "text", "align": "left", "color": "#ec7c30", "dx": -80, "dy": -220, "fontWeight": 700, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-bb37a89b4f0b28651c604558da7ca904"}, "mark": {"type": "text", "align": "left", "color": "#8b8b8b", "dx": 0, "dy": -220, "fontWeight": 700, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-0cc3663d469e54c83c8449d2705bfe37": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}], "data-ec5f7c8dc3e548f95008aa754a246610": [{"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-61ed60cd51bbea95a6d688536e3e2c35": [{"text": ["Cat food brands:"]}], "data-8fb65900842ee286421a4b8ea376e54b": [{"text": ["8 brands decreased in sale"]}], "data-ba11cdcb5208607813ec99b1dd569bab": [{"text": ["YEAR-OVER-YEAR % CHANGE IN VOLUME ($)"]}], "data-3ecb015f60fd260c79b4fc4b31f64dd1": [{"text": ["DECREASED"]}], "data-bb37a89b4f0b28651c604558da7ca904": [{"text": ["|    INCREASED"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_2d.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Highlighting-the-two-brands-that-decreased-the-most">Highlighting the two brands that decreased the most<a class="anchor-link" href="#Highlighting-the-two-brands-that-decreased-the-most"></a></h4><p>To achieve this, the author has opted to maintain the coloration of all brands that experienced a decrease while placing additional emphasis on the two with the most significant declines by using a brighter shade of orange compared to the others.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[88]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Create a list of brands that decreased the most</span>
<span class="n">decreased_most</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">"Change"</span><span class="p">)</span>
<span class="n">brands_decreased</span> <span class="o">=</span> <span class="n">decreased_most</span><span class="p">[</span><span class="s2">"Brands"</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Create a condition based on that list</span>
<span class="n">conditions</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">'datum.Brands == "</span><span class="si">{</span><span class="n">brand</span><span class="si">}</span><span class="s1">"'</span> <span class="k">for</span> <span class="n">brand</span> <span class="ow">in</span> <span class="n">brands_decreased</span><span class="p">]</span>
<span class="n">condition</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"(</span><span class="si">{</span><span class="s1">'|'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span><span class="si">}</span><span class="s2">)"</span>

<span class="c1"># Create a list of brands with positive changes for auxiliary graph</span>
<span class="n">positive_brands</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"Brands"</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">positive_brands_list</span> <span class="o">=</span> <span class="n">positive_brands</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Chart of brands that decreased</span>
<span class="n">chart_oranges</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">orient</span> <span class="o">=</span> <span class="s2">"top"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="c1"># If the Brand is in the list of decreased most,</span>
        <span class="c1"># color it orange - else, color it light orange</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#ec7c30"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#efb284"</span><span class="p">))</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Auxiliary graph with gray bottom</span>
<span class="n">chart_oranges2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="c1"># Color equals gray</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#c6c6c6"</span><span class="p">,</span> <span class="n">opacity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">orient</span> <span class="o">=</span> <span class="s2">"top"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span> <span class="c1"># Only positive brands</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span> <span class="n">oneOf</span> <span class="o">=</span> <span class="n">positive_brands_list</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Label to the right</span>
<span class="n">label1_oranges</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">207</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">),</span>
        <span class="c1"># Color it orange or light orange</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#ec7c30"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#efb284"</span><span class="p">))</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Again, no need for new labels for the left</span>

<span class="c1"># Second title in orange</span>
<span class="n">title_oranges</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"2 brands decreased the most"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">78</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">270</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#ec7c30"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>


<span class="n">decreased2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">chart_oranges</span>
    <span class="o">+</span> <span class="n">chart_oranges2</span>
    <span class="o">+</span> <span class="n">label1_oranges</span>
    <span class="o">+</span> <span class="n">label2_bw</span>
    <span class="o">+</span> <span class="n">title_bw</span>
    <span class="o">+</span> <span class="n">title_oranges</span>
    <span class="o">+</span> <span class="n">subtitle_bw</span>
    <span class="o">+</span> <span class="n">decreased_orange</span>
    <span class="o">+</span> <span class="n">increased_gray</span>
<span class="p">)</span>

<span class="n">decreased2</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[88]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-52e8b012d09844b3a9a1b1f9d99a3c1c.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-52e8b012d09844b3a9a1b1f9d99a3c1c.vega-embed details,
  #altair-viz-52e8b012d09844b3a9a1b1f9d99a3c1c.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-52e8b012d09844b3a9a1b1f9d99a3c1c"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-52e8b012d09844b3a9a1b1f9d99a3c1c") {
      outputDiv = document.getElementById("altair-viz-52e8b012d09844b3a9a1b1f9d99a3c1c");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Fran's Recipe\"|datum.Brands == \"Wholesome Goodness\")", "value": "#ec7c30"}, "value": "#efb284"}, "x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}}, {"mark": {"type": "bar", "color": "#c6c6c6", "opacity": 1, "size": 15}, "encoding": {"x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Feline Gold", "Feline Platinum", "Feline Instinct", "Feline Pro", "Farm Fresh Tasties", "Feline Royal", "Feline Focus", "Feline Grain Free", "Feline Silver", "Nutri Balance", "Farm Fresh Basics"]}}]}, {"data": {"name": "data-0cc3663d469e54c83c8449d2705bfe37"}, "mark": {"type": "text", "align": "left", "fontWeight": 700}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Fran's Recipe\"|datum.Brands == \"Wholesome Goodness\")", "value": "#ec7c30"}, "value": "#efb284"}, "text": {"field": "Brands", "type": "nominal"}, "x": {"value": 207}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-ec5f7c8dc3e548f95008aa754a246610"}, "mark": {"type": "text", "align": "right", "color": "#c6c6c6", "fontWeight": 700}, "encoding": {"text": {"field": "Brands", "type": "nominal"}, "x": {"value": 192}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-61ed60cd51bbea95a6d688536e3e2c35"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": -200, "dy": -270, "fontWeight": "normal", "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-f2ace38498b90b0158d20d3c1b3546ef"}, "mark": {"type": "text", "align": "left", "color": "#ec7c30", "dx": -78, "dy": -270, "fontWeight": 700, "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-ba11cdcb5208607813ec99b1dd569bab"}, "mark": {"type": "text", "align": "left", "color": "gray", "dx": -200, "dy": -250, "fontWeight": "normal", "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-3ecb015f60fd260c79b4fc4b31f64dd1"}, "mark": {"type": "text", "align": "left", "color": "#ec7c30", "dx": -80, "dy": -220, "fontWeight": 700, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-bb37a89b4f0b28651c604558da7ca904"}, "mark": {"type": "text", "align": "left", "color": "#8b8b8b", "dx": 0, "dy": -220, "fontWeight": 700, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-0cc3663d469e54c83c8449d2705bfe37": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}], "data-ec5f7c8dc3e548f95008aa754a246610": [{"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-61ed60cd51bbea95a6d688536e3e2c35": [{"text": ["Cat food brands:"]}], "data-f2ace38498b90b0158d20d3c1b3546ef": [{"text": ["2 brands decreased the most"]}], "data-ba11cdcb5208607813ec99b1dd569bab": [{"text": ["YEAR-OVER-YEAR % CHANGE IN VOLUME ($)"]}], "data-3ecb015f60fd260c79b4fc4b31f64dd1": [{"text": ["DECREASED"]}], "data-bb37a89b4f0b28651c604558da7ca904": [{"text": ["|    INCREASED"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_2e.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Highlighting-brands-that-increased">Highlighting brands that increased<a class="anchor-link" href="#Highlighting-brands-that-increased"></a></h4><p>This code closely resembles the one used to highlight all brands that experienced a decrease, with modifications made to the condition and color, now blue.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[89]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Change signal of condition from &lt; to &gt;</span>
<span class="n">condition</span> <span class="o">=</span> <span class="s2">"datum.Change &gt; 0"</span>

<span class="c1"># Graph highlighting increased brands</span>
<span class="n">chart_blue</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">orient</span> <span class="o">=</span> <span class="s2">"top"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="c1"># If brand increased, color it blue, else, color it gray</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#4772b8"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#c6c6c6"</span><span class="p">))</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Create labels to the left</span>
<span class="n">label2_blue</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"right"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">192</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#4772b8"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#c6c6c6"</span><span class="p">))</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># This time there is no need to create labels on the right</span>

<span class="c1"># Second title in blue</span>
<span class="n">title_blue</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"11 brands flat to increasing"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">78</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">270</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#4772b8"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># "DECREASED" text in gray</span>
<span class="n">decreased_gray</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"DECREASED    |"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">220</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#8b8b8b"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># "INCREASED" text in blue</span>
<span class="n">increased_blue</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"INCREASED"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">220</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#4772b8"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">increased</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">chart_blue</span>
    <span class="o">+</span> <span class="n">label1</span>
    <span class="o">+</span> <span class="n">label2_blue</span>
    <span class="o">+</span> <span class="n">title_bw</span>
    <span class="o">+</span> <span class="n">title_blue</span>
    <span class="o">+</span> <span class="n">subtitle_bw</span>
    <span class="o">+</span> <span class="n">decreased_gray</span>
    <span class="o">+</span> <span class="n">increased_blue</span>
<span class="p">)</span>

<span class="n">increased</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[89]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-ef158eedaf494f25967621ed43a02084.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-ef158eedaf494f25967621ed43a02084.vega-embed details,
  #altair-viz-ef158eedaf494f25967621ed43a02084.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-ef158eedaf494f25967621ed43a02084"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-ef158eedaf494f25967621ed43a02084") {
      outputDiv = document.getElementById("altair-viz-ef158eedaf494f25967621ed43a02084");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "datum.Change > 0", "value": "#4772b8"}, "value": "#c6c6c6"}, "x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-0cc3663d469e54c83c8449d2705bfe37"}, "mark": {"type": "text", "align": "left", "color": "#8b8b8b", "fontWeight": 700}, "encoding": {"text": {"field": "Brands", "type": "nominal"}, "x": {"value": 207}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-ec5f7c8dc3e548f95008aa754a246610"}, "mark": {"type": "text", "align": "right", "fontWeight": 700}, "encoding": {"color": {"condition": {"test": "datum.Change > 0", "value": "#4772b8"}, "value": "#c6c6c6"}, "text": {"field": "Brands", "type": "nominal"}, "x": {"value": 192}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-61ed60cd51bbea95a6d688536e3e2c35"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": -200, "dy": -270, "fontWeight": "normal", "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-4bcbfc1426600ec69949f38626ff0e4e"}, "mark": {"type": "text", "align": "left", "color": "#4772b8", "dx": -78, "dy": -270, "fontWeight": 700, "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-ba11cdcb5208607813ec99b1dd569bab"}, "mark": {"type": "text", "align": "left", "color": "gray", "dx": -200, "dy": -250, "fontWeight": "normal", "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-8a19d90ddeb8fab8e579c0dae9aa37d8"}, "mark": {"type": "text", "align": "left", "color": "#8b8b8b", "dx": -80, "dy": -220, "fontWeight": 700, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-57e7b42d682c5889d2d5910745e9ec89"}, "mark": {"type": "text", "align": "left", "color": "#4772b8", "dx": 20, "dy": -220, "fontWeight": 700, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-0cc3663d469e54c83c8449d2705bfe37": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}], "data-ec5f7c8dc3e548f95008aa754a246610": [{"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-61ed60cd51bbea95a6d688536e3e2c35": [{"text": ["Cat food brands:"]}], "data-4bcbfc1426600ec69949f38626ff0e4e": [{"text": ["11 brands flat to increasing"]}], "data-ba11cdcb5208607813ec99b1dd569bab": [{"text": ["YEAR-OVER-YEAR % CHANGE IN VOLUME ($)"]}], "data-8a19d90ddeb8fab8e579c0dae9aa37d8": [{"text": ["DECREASED    |"]}], "data-57e7b42d682c5889d2d5910745e9ec89": [{"text": ["INCREASED"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_2f.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Final-view-with-all-highlights">Final view with all highlights<a class="anchor-link" href="#Final-view-with-all-highlights"></a></h4><p>For the last question, the author explores the creation of a conclusive slide that highlights all the points discussed above. For this, we will create two graphs, one with both Feline and Lifestyle Brands and one showcasing increased and decreased sales. The author initially paired the visualizations with text, but as the manual labor-intensive method has already been explored, we will abstain from incorporating additional textual elements.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[90]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Graph with both brands</span>

<span class="c1"># Lifestyle brand</span>
<span class="n">chart_bw2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">orient</span> <span class="o">=</span> <span class="s2">"top"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"DECREASED | INCREASED"</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"black"</span><span class="p">)</span> <span class="c1"># Color black with no condition</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span> <span class="c1"># Filter to be only lifestyle products</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span> <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Lifestyle"</span><span class="p">,</span> <span class="s2">"Lifestyle Plus"</span><span class="p">,</span> <span class="s2">"Diet Lifestyle"</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># We can reuse the left labeling for the lifestyle brand</span>

<span class="c1"># Second title in black</span>
<span class="n">title_bw_bold_2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"mixed results in sales year-over-year"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">78</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">270</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Creates list of all brands that are not Lifestyle</span>
<span class="n">not_lifestyle</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span>
    <span class="o">~</span><span class="n">table</span><span class="p">[</span><span class="s2">"Brands"</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">"Lifestyle"</span><span class="p">,</span> <span class="s2">"Lifestyle Plus"</span><span class="p">,</span> <span class="s2">"Diet Lifestyle"</span><span class="p">])</span>
<span class="p">]</span>
<span class="n">not_lifestyle</span> <span class="o">=</span> <span class="n">not_lifestyle</span><span class="p">[</span><span class="s2">"Brands"</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Create the labeling in the right for the Feline brand in purple</span>
<span class="c1"># If we reuse the one we already have, it will overwrite the labels in black</span>
<span class="n">label1_purple_2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">207</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_purple</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#713a97"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#c6c6c6"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># Filter out the Lifestyle brand so that it is not overwritten</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span> <span class="n">oneOf</span> <span class="o">=</span> <span class="n">not_lifestyle</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Since there are no Lifestyle brand labeling on the left,</span>
<span class="c1"># there is no need to create a new left labeling for Feline</span>

<span class="n">mixed</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">chart_purple</span>
    <span class="o">+</span> <span class="n">chart_bw2</span>
    <span class="o">+</span> <span class="n">label1_bw</span>
    <span class="o">+</span> <span class="n">label1_purple_2</span>
    <span class="o">+</span> <span class="n">label2_purple</span>
    <span class="o">+</span> <span class="n">title_bw</span>
    <span class="o">+</span> <span class="n">title_bw_bold_2</span>
    <span class="o">+</span> <span class="n">subtitle_bw</span>
<span class="p">)</span>

<span class="n">mixed</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[90]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-dfe2c4463929460eb5522ecccf6dec50.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-dfe2c4463929460eb5522ecccf6dec50.vega-embed details,
  #altair-viz-dfe2c4463929460eb5522ecccf6dec50.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-dfe2c4463929460eb5522ecccf6dec50"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-dfe2c4463929460eb5522ecccf6dec50") {
      outputDiv = document.getElementById("altair-viz-dfe2c4463929460eb5522ecccf6dec50");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Feline Basics\"|datum.Brands == \"Feline Freedom\"|datum.Brands == \"Feline Gold\"|datum.Brands == \"Feline Platinum\"|datum.Brands == \"Feline Instinct\"|datum.Brands == \"Feline Pro\"|datum.Brands == \"Feline Royal\"|datum.Brands == \"Feline Focus\"|datum.Brands == \"Feline Grain Free\"|datum.Brands == \"Feline Silver\")", "value": "#713a97"}, "value": "#c6c6c6"}, "x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": "DECREASED | INCREASED", "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"value": "black"}, "x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": "DECREASED | INCREASED", "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Lifestyle", "Lifestyle Plus", "Diet Lifestyle"]}}]}, {"data": {"name": "data-0cc3663d469e54c83c8449d2705bfe37"}, "mark": {"type": "text", "align": "left", "fontWeight": 700}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Lifestyle\"|datum.Brands == \"Diet Lifestyle\"|datum.Brands == \"Lifestyle Plus\")", "value": "black"}, "value": "#c6c6c6"}, "text": {"field": "Brands", "type": "nominal"}, "x": {"value": 207}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-0cc3663d469e54c83c8449d2705bfe37"}, "mark": {"type": "text", "align": "left", "fontWeight": 700}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Feline Basics\"|datum.Brands == \"Feline Freedom\"|datum.Brands == \"Feline Gold\"|datum.Brands == \"Feline Platinum\"|datum.Brands == \"Feline Instinct\"|datum.Brands == \"Feline Pro\"|datum.Brands == \"Feline Royal\"|datum.Brands == \"Feline Focus\"|datum.Brands == \"Feline Grain Free\"|datum.Brands == \"Feline Silver\")", "value": "#713a97"}, "value": "#c6c6c6"}, "text": {"field": "Brands", "type": "nominal"}, "x": {"value": 207}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Fran's Recipe", "Wholesome Goodness", "Coat protection", "Feline Basics", "Feline Freedom", "Feline Gold", "Feline Platinum", "Feline Instinct", "Feline Pro", "Farm Fresh Tasties", "Feline Royal", "Feline Focus", "Feline Grain Free", "Feline Silver", "Nutri Balance", "Farm Fresh Basics"]}}]}, {"data": {"name": "data-ec5f7c8dc3e548f95008aa754a246610"}, "mark": {"type": "text", "align": "right", "fontWeight": 700}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Feline Basics\"|datum.Brands == \"Feline Freedom\"|datum.Brands == \"Feline Gold\"|datum.Brands == \"Feline Platinum\"|datum.Brands == \"Feline Instinct\"|datum.Brands == \"Feline Pro\"|datum.Brands == \"Feline Royal\"|datum.Brands == \"Feline Focus\"|datum.Brands == \"Feline Grain Free\"|datum.Brands == \"Feline Silver\")", "value": "#713a97"}, "value": "#c6c6c6"}, "text": {"field": "Brands", "type": "nominal"}, "x": {"value": 192}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-61ed60cd51bbea95a6d688536e3e2c35"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": -200, "dy": -270, "fontWeight": "normal", "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-3250e3b759259a267385e6508eb69b35"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": -78, "dy": -270, "fontWeight": 700, "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-ba11cdcb5208607813ec99b1dd569bab"}, "mark": {"type": "text", "align": "left", "color": "gray", "dx": -200, "dy": -250, "fontWeight": "normal", "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-0cc3663d469e54c83c8449d2705bfe37": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}], "data-ec5f7c8dc3e548f95008aa754a246610": [{"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-61ed60cd51bbea95a6d688536e3e2c35": [{"text": ["Cat food brands:"]}], "data-3250e3b759259a267385e6508eb69b35": [{"text": ["mixed results in sales year-over-year"]}], "data-ba11cdcb5208607813ec99b1dd569bab": [{"text": ["YEAR-OVER-YEAR % CHANGE IN VOLUME ($)"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_2g.png"/></p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[91]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Create a list to the most increased and most decreased brands</span>
<span class="n">decreased_most</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">"Change"</span><span class="p">)</span>
<span class="n">increased_most</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">"Change"</span><span class="p">)</span>

<span class="n">brands_decreased</span> <span class="o">=</span> <span class="n">decreased_most</span><span class="p">[</span><span class="s2">"Brands"</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">brands_increased</span> <span class="o">=</span> <span class="n">increased_most</span><span class="p">[</span><span class="s2">"Brands"</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Create a condition for brands that increased and decreased</span>
<span class="n">conditions_decreased</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">'datum.Brands == "</span><span class="si">{</span><span class="n">brand</span><span class="si">}</span><span class="s1">"'</span> <span class="k">for</span> <span class="n">brand</span> <span class="ow">in</span> <span class="n">brands_decreased</span><span class="p">]</span>
<span class="n">condition_decreased</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"(</span><span class="si">{</span><span class="s1">'|'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conditions_decreased</span><span class="p">)</span><span class="si">}</span><span class="s2">)"</span>

<span class="n">conditions_increased</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">'datum.Brands == "</span><span class="si">{</span><span class="n">brand</span><span class="si">}</span><span class="s1">"'</span> <span class="k">for</span> <span class="n">brand</span> <span class="ow">in</span> <span class="n">brands_increased</span><span class="p">]</span>
<span class="n">condition_increased</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"(</span><span class="si">{</span><span class="s1">'|'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conditions_increased</span><span class="p">)</span><span class="si">}</span><span class="s2">)"</span>

<span class="c1"># Create a gray graph representing middle brands</span>
<span class="n">chart_gray</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">"#c6c6c6"</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">orient</span> <span class="o">=</span> <span class="s2">"top"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Labels on the right for those middle brands</span>
<span class="n">label1_gray</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#c6c6c6"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">207</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span> <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Labels on the left for those middle brands</span>
<span class="n">label2_gray</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"right"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#c6c6c6"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">192</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span> <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Graph for decreased values</span>
<span class="n">chart_oranges_mix</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">orient</span> <span class="o">=</span> <span class="s2">"top"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="c1"># If on top 2 decreased, bright orange</span>
            <span class="c1"># Else, light orange</span>
            <span class="n">condition_decreased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#ec7c30"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#efb284"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># Filter to only the five most decreased brands</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s2">"Brands"</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Labeling on the right for decreased brands</span>
<span class="n">label_oranges</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">207</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="c1"># If on top 2 decreased, bright orange</span>
            <span class="c1"># Else, light orange</span>
            <span class="n">condition_decreased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#ec7c30"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#efb284"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s2">"Brands"</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Graph for increased values</span>
<span class="n">chart_blue_mix</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">orient</span> <span class="o">=</span> <span class="s2">"top"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="c1"># If on top 2 increased, color blue</span>
            <span class="c1"># Else, color it light blue</span>
            <span class="n">condition_increased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#4772b8"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#91a9d5"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># Filter to only increased brands</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s2">"Brands"</span><span class="p">][</span><span class="mi">14</span><span class="p">:</span><span class="mi">19</span><span class="p">])</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Labeling on the left for increased brands</span>
<span class="n">label_blue</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"right"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">192</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_increased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#4772b8"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#91a9d5"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s2">"Brands"</span><span class="p">][</span><span class="mi">14</span><span class="p">:</span><span class="mi">19</span><span class="p">])</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># We will unite the "DECREASED" orange with the "INCREASED" blue</span>
<span class="c1"># So we will create the "|" separation in gray </span>
<span class="n">separation</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"|"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">220</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#c6c6c6"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">mixed2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">chart_gray</span>
    <span class="o">+</span> <span class="n">chart_oranges_mix</span>
    <span class="o">+</span> <span class="n">chart_blue_mix</span>
    <span class="o">+</span> <span class="n">label1_gray</span>
    <span class="o">+</span> <span class="n">label2_gray</span>
    <span class="o">+</span> <span class="n">label_oranges</span>
    <span class="o">+</span> <span class="n">label_blue</span>
    <span class="o">+</span> <span class="n">title_bw</span>
    <span class="o">+</span> <span class="n">title_bw_bold_2</span>
    <span class="o">+</span> <span class="n">subtitle_bw</span>
    <span class="o">+</span> <span class="n">decreased_orange</span>
    <span class="o">+</span> <span class="n">increased_blue</span>
    <span class="o">+</span> <span class="n">separation</span>
<span class="p">)</span>

<span class="n">mixed2</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[91]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-669cdb3de4494db68cd9201f40aa7ef6.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-669cdb3de4494db68cd9201f40aa7ef6.vega-embed details,
  #altair-viz-669cdb3de4494db68cd9201f40aa7ef6.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-669cdb3de4494db68cd9201f40aa7ef6"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-669cdb3de4494db68cd9201f40aa7ef6") {
      outputDiv = document.getElementById("altair-viz-669cdb3de4494db68cd9201f40aa7ef6");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "bar", "color": "#c6c6c6", "size": 15}, "encoding": {"x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Fran's Recipe\"|datum.Brands == \"Wholesome Goodness\")", "value": "#ec7c30"}, "value": "#efb284"}, "x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Fran's Recipe", "Wholesome Goodness", "Lifestyle", "Coat protection", "Diet Lifestyle"]}}]}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Farm Fresh Basics\"|datum.Brands == \"Nutri Balance\")", "value": "#4772b8"}, "value": "#91a9d5"}, "x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Feline Focus", "Feline Grain Free", "Feline Silver", "Nutri Balance", "Farm Fresh Basics"]}}]}, {"data": {"name": "data-0cc3663d469e54c83c8449d2705bfe37"}, "mark": {"type": "text", "align": "left", "color": "#c6c6c6", "fontWeight": 700}, "encoding": {"text": {"field": "Brands", "type": "nominal"}, "x": {"value": 207}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-ec5f7c8dc3e548f95008aa754a246610"}, "mark": {"type": "text", "align": "right", "color": "#c6c6c6", "fontWeight": 700}, "encoding": {"text": {"field": "Brands", "type": "nominal"}, "x": {"value": 192}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-0cc3663d469e54c83c8449d2705bfe37"}, "mark": {"type": "text", "align": "left", "fontWeight": 700}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Fran's Recipe\"|datum.Brands == \"Wholesome Goodness\")", "value": "#ec7c30"}, "value": "#efb284"}, "text": {"field": "Brands", "type": "nominal"}, "x": {"value": 207}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Fran's Recipe", "Wholesome Goodness", "Lifestyle", "Coat protection", "Diet Lifestyle"]}}]}, {"data": {"name": "data-ec5f7c8dc3e548f95008aa754a246610"}, "mark": {"type": "text", "align": "right", "fontWeight": 700}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Farm Fresh Basics\"|datum.Brands == \"Nutri Balance\")", "value": "#4772b8"}, "value": "#91a9d5"}, "text": {"field": "Brands", "type": "nominal"}, "x": {"value": 192}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Feline Focus", "Feline Grain Free", "Feline Silver", "Nutri Balance", "Farm Fresh Basics"]}}]}, {"data": {"name": "data-61ed60cd51bbea95a6d688536e3e2c35"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": -200, "dy": -270, "fontWeight": "normal", "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-3250e3b759259a267385e6508eb69b35"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": -78, "dy": -270, "fontWeight": 700, "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-ba11cdcb5208607813ec99b1dd569bab"}, "mark": {"type": "text", "align": "left", "color": "gray", "dx": -200, "dy": -250, "fontWeight": "normal", "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-3ecb015f60fd260c79b4fc4b31f64dd1"}, "mark": {"type": "text", "align": "left", "color": "#ec7c30", "dx": -80, "dy": -220, "fontWeight": 700, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-57e7b42d682c5889d2d5910745e9ec89"}, "mark": {"type": "text", "align": "left", "color": "#4772b8", "dx": 20, "dy": -220, "fontWeight": 700, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-f20e0fb6a7aa96b3235c63a327f85e9f"}, "mark": {"type": "text", "align": "left", "color": "#c6c6c6", "dx": 3, "dy": -220, "fontWeight": 700, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-0cc3663d469e54c83c8449d2705bfe37": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}], "data-ec5f7c8dc3e548f95008aa754a246610": [{"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-61ed60cd51bbea95a6d688536e3e2c35": [{"text": ["Cat food brands:"]}], "data-3250e3b759259a267385e6508eb69b35": [{"text": ["mixed results in sales year-over-year"]}], "data-ba11cdcb5208607813ec99b1dd569bab": [{"text": ["YEAR-OVER-YEAR % CHANGE IN VOLUME ($)"]}], "data-3ecb015f60fd260c79b4fc4b31f64dd1": [{"text": ["DECREASED"]}], "data-57e7b42d682c5889d2d5910745e9ec89": [{"text": ["INCREASED"]}], "data-f20e0fb6a7aa96b3235c63a327f85e9f": [{"text": ["|"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_2h.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Although this exercise does not have an interactive version of the graph, we will discuss the color palette of it in a <a href="#5.4">subsequent exercise</a>. There, an interactive version relating to the colors will be demonstrated.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Exercise-3---Direct-attention-many-ways">Exercise 3 - Direct attention many ways<a name="4.3"></a><a class="anchor-link" href="#Exercise-3---Direct-attention-many-ways"></a></h3><p>While the last visualizations was about highlighting key elements with color, in this exercise we will explore other ways to bring the viewer's attention, such as contrast and size.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Loading-the-data">Loading the data<a class="anchor-link" href="#Loading-the-data"></a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[97]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Load Excel file</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Data\4.3 EXERCISE.xlsx"</span><span class="p">,</span> <span class="n">usecols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">skipfooter</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">table</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[97]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>YEAR</th>
<th>Total</th>
<th>Organic</th>
<th>Referral</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2005</td>
<td>0.087</td>
<td>0.033</td>
<td>0.054</td>
</tr>
<tr>
<th>1</th>
<td>2006</td>
<td>0.083</td>
<td>0.035</td>
<td>0.048</td>
</tr>
<tr>
<th>2</th>
<td>2007</td>
<td>0.086</td>
<td>0.037</td>
<td>0.049</td>
</tr>
<tr>
<th>3</th>
<td>2008</td>
<td>0.089</td>
<td>0.036</td>
<td>0.053</td>
</tr>
<tr>
<th>4</th>
<td>2009</td>
<td>0.084</td>
<td>0.034</td>
<td>0.050</td>
</tr>
<tr>
<th>5</th>
<td>2010</td>
<td>0.086</td>
<td>0.031</td>
<td>0.055</td>
</tr>
<tr>
<th>6</th>
<td>2011</td>
<td>0.075</td>
<td>0.032</td>
<td>0.043</td>
</tr>
<tr>
<th>7</th>
<td>2012</td>
<td>0.072</td>
<td>0.035</td>
<td>0.037</td>
</tr>
<tr>
<th>8</th>
<td>2013</td>
<td>0.069</td>
<td>0.032</td>
<td>0.037</td>
</tr>
<tr>
<th>9</th>
<td>2014</td>
<td>0.074</td>
<td>0.038</td>
<td>0.036</td>
</tr>
<tr>
<th>10</th>
<td>2015</td>
<td>0.066</td>
<td>0.035</td>
<td>0.031</td>
</tr>
<tr>
<th>11</th>
<td>2016</td>
<td>0.080</td>
<td>0.045</td>
<td>0.035</td>
</tr>
<tr>
<th>12</th>
<td>2017</td>
<td>0.073</td>
<td>0.041</td>
<td>0.032</td>
</tr>
<tr>
<th>13</th>
<td>2018</td>
<td>0.070</td>
<td>0.042</td>
<td>0.028</td>
</tr>
<tr>
<th>14</th>
<td>2019</td>
<td>0.063</td>
<td>0.038</td>
<td>0.025</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[98]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Transform into the long format</span>
<span class="n">melted_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'YEAR'</span><span class="p">],</span> <span class="n">var_name</span> <span class="o">=</span> <span class="s1">'Metric'</span><span class="p">,</span> <span class="n">value_name</span> <span class="o">=</span> <span class="s1">'Value'</span><span class="p">)</span>
<span class="n">melted_table</span><span class="p">[</span><span class="s2">"Metric"</span><span class="p">]</span> <span class="o">=</span> <span class="n">melted_table</span><span class="p">[</span><span class="s2">"Metric"</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

<span class="n">melted_table</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[98]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>YEAR</th>
<th>Metric</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2005</td>
<td>TOTAL</td>
<td>0.087</td>
</tr>
<tr>
<th>1</th>
<td>2006</td>
<td>TOTAL</td>
<td>0.083</td>
</tr>
<tr>
<th>2</th>
<td>2007</td>
<td>TOTAL</td>
<td>0.086</td>
</tr>
<tr>
<th>3</th>
<td>2008</td>
<td>TOTAL</td>
<td>0.089</td>
</tr>
<tr>
<th>4</th>
<td>2009</td>
<td>TOTAL</td>
<td>0.084</td>
</tr>
<tr>
<th>5</th>
<td>2010</td>
<td>TOTAL</td>
<td>0.086</td>
</tr>
<tr>
<th>6</th>
<td>2011</td>
<td>TOTAL</td>
<td>0.075</td>
</tr>
<tr>
<th>7</th>
<td>2012</td>
<td>TOTAL</td>
<td>0.072</td>
</tr>
<tr>
<th>8</th>
<td>2013</td>
<td>TOTAL</td>
<td>0.069</td>
</tr>
<tr>
<th>9</th>
<td>2014</td>
<td>TOTAL</td>
<td>0.074</td>
</tr>
<tr>
<th>10</th>
<td>2015</td>
<td>TOTAL</td>
<td>0.066</td>
</tr>
<tr>
<th>11</th>
<td>2016</td>
<td>TOTAL</td>
<td>0.080</td>
</tr>
<tr>
<th>12</th>
<td>2017</td>
<td>TOTAL</td>
<td>0.073</td>
</tr>
<tr>
<th>13</th>
<td>2018</td>
<td>TOTAL</td>
<td>0.070</td>
</tr>
<tr>
<th>14</th>
<td>2019</td>
<td>TOTAL</td>
<td>0.063</td>
</tr>
<tr>
<th>15</th>
<td>2005</td>
<td>ORGANIC</td>
<td>0.033</td>
</tr>
<tr>
<th>16</th>
<td>2006</td>
<td>ORGANIC</td>
<td>0.035</td>
</tr>
<tr>
<th>17</th>
<td>2007</td>
<td>ORGANIC</td>
<td>0.037</td>
</tr>
<tr>
<th>18</th>
<td>2008</td>
<td>ORGANIC</td>
<td>0.036</td>
</tr>
<tr>
<th>19</th>
<td>2009</td>
<td>ORGANIC</td>
<td>0.034</td>
</tr>
<tr>
<th>20</th>
<td>2010</td>
<td>ORGANIC</td>
<td>0.031</td>
</tr>
<tr>
<th>21</th>
<td>2011</td>
<td>ORGANIC</td>
<td>0.032</td>
</tr>
<tr>
<th>22</th>
<td>2012</td>
<td>ORGANIC</td>
<td>0.035</td>
</tr>
<tr>
<th>23</th>
<td>2013</td>
<td>ORGANIC</td>
<td>0.032</td>
</tr>
<tr>
<th>24</th>
<td>2014</td>
<td>ORGANIC</td>
<td>0.038</td>
</tr>
<tr>
<th>25</th>
<td>2015</td>
<td>ORGANIC</td>
<td>0.035</td>
</tr>
<tr>
<th>26</th>
<td>2016</td>
<td>ORGANIC</td>
<td>0.045</td>
</tr>
<tr>
<th>27</th>
<td>2017</td>
<td>ORGANIC</td>
<td>0.041</td>
</tr>
<tr>
<th>28</th>
<td>2018</td>
<td>ORGANIC</td>
<td>0.042</td>
</tr>
<tr>
<th>29</th>
<td>2019</td>
<td>ORGANIC</td>
<td>0.038</td>
</tr>
<tr>
<th>30</th>
<td>2005</td>
<td>REFERRAL</td>
<td>0.054</td>
</tr>
<tr>
<th>31</th>
<td>2006</td>
<td>REFERRAL</td>
<td>0.048</td>
</tr>
<tr>
<th>32</th>
<td>2007</td>
<td>REFERRAL</td>
<td>0.049</td>
</tr>
<tr>
<th>33</th>
<td>2008</td>
<td>REFERRAL</td>
<td>0.053</td>
</tr>
<tr>
<th>34</th>
<td>2009</td>
<td>REFERRAL</td>
<td>0.050</td>
</tr>
<tr>
<th>35</th>
<td>2010</td>
<td>REFERRAL</td>
<td>0.055</td>
</tr>
<tr>
<th>36</th>
<td>2011</td>
<td>REFERRAL</td>
<td>0.043</td>
</tr>
<tr>
<th>37</th>
<td>2012</td>
<td>REFERRAL</td>
<td>0.037</td>
</tr>
<tr>
<th>38</th>
<td>2013</td>
<td>REFERRAL</td>
<td>0.037</td>
</tr>
<tr>
<th>39</th>
<td>2014</td>
<td>REFERRAL</td>
<td>0.036</td>
</tr>
<tr>
<th>40</th>
<td>2015</td>
<td>REFERRAL</td>
<td>0.031</td>
</tr>
<tr>
<th>41</th>
<td>2016</td>
<td>REFERRAL</td>
<td>0.035</td>
</tr>
<tr>
<th>42</th>
<td>2017</td>
<td>REFERRAL</td>
<td>0.032</td>
</tr>
<tr>
<th>43</th>
<td>2018</td>
<td>REFERRAL</td>
<td>0.028</td>
</tr>
<tr>
<th>44</th>
<td>2019</td>
<td>REFERRAL</td>
<td>0.025</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Graph-without-highlights">Graph without highlights<a class="anchor-link" href="#Graph-without-highlights"></a></h4><p>First, we will create the graph without bringing attention to any specific data.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[99]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Line graph</span>
<span class="n">line_simple</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">melted_table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Conversion rate over time"</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">17</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">strokeWidth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># Set thickness of the line</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"YEAR:O"</span><span class="p">,</span> <span class="c1"># Inform that Year is an Ordinal data</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"FISCAL YEAR"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># Align horizontally</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"CONVERSION RATE"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span> <span class="c1"># y-axis goes from 0 to 0.1</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#aaaaaa"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="c1"># All lines gray</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Labeling for the lines</span>
<span class="n">text_simple</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#aaaaaa"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="c1"># Place text at the end of the line</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"YEAR"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="s2">"max"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"argmax"</span><span class="p">:</span> <span class="s2">"YEAR"</span><span class="p">}),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s2">"Metric"</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">gray_line</span> <span class="o">=</span> <span class="n">line_simple</span> <span class="o">+</span> <span class="n">text_simple</span>
<span class="n">gray_line</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[99]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-26ad05158e9544b1a5efb2a8726669ce.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-26ad05158e9544b1a5efb2a8726669ce.vega-embed details,
  #altair-viz-26ad05158e9544b1a5efb2a8726669ce.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-26ad05158e9544b1a5efb2a8726669ce"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-26ad05158e9544b1a5efb2a8726669ce") {
      outputDiv = document.getElementById("altair-viz-26ad05158e9544b1a5efb2a8726669ce");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "strokeWidth": 3}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "title": {"text": "Conversion rate over time", "anchor": "start", "fontSize": 17, "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "color": "#aaaaaa", "dx": 20, "size": 13}, "encoding": {"text": {"field": "Metric", "type": "nominal"}, "x": {"aggregate": "max", "axis": null, "field": "YEAR", "type": "quantitative"}, "y": {"aggregate": {"argmax": "YEAR"}, "field": "Value", "type": "quantitative"}}}], "data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-79200e94ab13e17b934630c35a39db52": [{"YEAR": 2005, "Metric": "TOTAL", "Value": 0.087}, {"YEAR": 2006, "Metric": "TOTAL", "Value": 0.083}, {"YEAR": 2007, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2008, "Metric": "TOTAL", "Value": 0.089}, {"YEAR": 2009, "Metric": "TOTAL", "Value": 0.084}, {"YEAR": 2010, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2011, "Metric": "TOTAL", "Value": 0.075}, {"YEAR": 2012, "Metric": "TOTAL", "Value": 0.07200000000000001}, {"YEAR": 2013, "Metric": "TOTAL", "Value": 0.069}, {"YEAR": 2014, "Metric": "TOTAL", "Value": 0.074}, {"YEAR": 2015, "Metric": "TOTAL", "Value": 0.066}, {"YEAR": 2016, "Metric": "TOTAL", "Value": 0.08}, {"YEAR": 2017, "Metric": "TOTAL", "Value": 0.07300000000000001}, {"YEAR": 2018, "Metric": "TOTAL", "Value": 0.07}, {"YEAR": 2019, "Metric": "TOTAL", "Value": 0.063}, {"YEAR": 2005, "Metric": "ORGANIC", "Value": 0.033}, {"YEAR": 2006, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2007, "Metric": "ORGANIC", "Value": 0.037}, {"YEAR": 2008, "Metric": "ORGANIC", "Value": 0.036}, {"YEAR": 2009, "Metric": "ORGANIC", "Value": 0.034}, {"YEAR": 2010, "Metric": "ORGANIC", "Value": 0.031}, {"YEAR": 2011, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2012, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2013, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2014, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2015, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2016, "Metric": "ORGANIC", "Value": 0.045}, {"YEAR": 2017, "Metric": "ORGANIC", "Value": 0.041}, {"YEAR": 2018, "Metric": "ORGANIC", "Value": 0.042}, {"YEAR": 2019, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2005, "Metric": "REFERRAL", "Value": 0.054}, {"YEAR": 2006, "Metric": "REFERRAL", "Value": 0.048}, {"YEAR": 2007, "Metric": "REFERRAL", "Value": 0.049}, {"YEAR": 2008, "Metric": "REFERRAL", "Value": 0.053}, {"YEAR": 2009, "Metric": "REFERRAL", "Value": 0.05}, {"YEAR": 2010, "Metric": "REFERRAL", "Value": 0.055}, {"YEAR": 2011, "Metric": "REFERRAL", "Value": 0.043}, {"YEAR": 2012, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2013, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2014, "Metric": "REFERRAL", "Value": 0.036}, {"YEAR": 2015, "Metric": "REFERRAL", "Value": 0.031}, {"YEAR": 2016, "Metric": "REFERRAL", "Value": 0.035}, {"YEAR": 2017, "Metric": "REFERRAL", "Value": 0.032}, {"YEAR": 2018, "Metric": "REFERRAL", "Value": 0.028}, {"YEAR": 2019, "Metric": "REFERRAL", "Value": 0.025}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt Text" src="./Images/4_3a.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Not-implemented-versions">Not implemented versions<a class="anchor-link" href="#Not-implemented-versions"></a></h4><p>Before initiating the generated graphs, it is important to acknowledge that two highlight optionsArrows and Circleswere ultimately not implemented for this project. These versions are: Arrows and Circles. The decision not to include them stemmed from the challenges associated with their execution in Altair and their perceived lack of effectiveness in conveying the intended information, as the author herself admits by calling them "brute force options".</p>
<p><em>Arrow highlight in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_3b.png"/></p>
<p><em>Circle highlight in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_3c.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Transparent-white-boxes">Transparent white boxes<a class="anchor-link" href="#Transparent-white-boxes"></a></h4><p>In constructing this graph, the author employed transparent white boxes to obscure lines other than Referral, aiming to reduce their visibility and emphasize the desired data. However, a more elegant approach in Altair involves achieving the same effect by simply adjusting the opacity of each line.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[100]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Create line graph</span>
<span class="n">line</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">melted_table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Conversion rate over time"</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">17</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">strokeWidth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"YEAR:O"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"FISCAL YEAR"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"CONVERSION RATE"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#aaaaaa"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="c1"># If Metric equals Referral, it has maximum opacity</span>
            <span class="c1"># Otherwise, it is slightly transparent</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">[</span><span class="s2">"Metric"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"REFERRAL"</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Text for the end of each line</span>
<span class="n">text</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">baseline</span> <span class="o">=</span> <span class="s2">"middle"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#aaaaaa"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"YEAR:O"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="s2">"max"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"argmax"</span><span class="p">:</span> <span class="s2">"YEAR"</span><span class="p">}),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s2">"Metric"</span><span class="p">,</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="c1"># If Metric equals Referral, it has maximum opacity</span>
            <span class="c1"># Otherwise, it is slightly transparent        </span>
            <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">[</span><span class="s2">"Metric"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"REFERRAL"</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">final_boxes</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">text</span>
<span class="n">final_boxes</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[100]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-5473dbd555054aa3b9bc4a91998acdab.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-5473dbd555054aa3b9bc4a91998acdab.vega-embed details,
  #altair-viz-5473dbd555054aa3b9bc4a91998acdab.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-5473dbd555054aa3b9bc4a91998acdab"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-5473dbd555054aa3b9bc4a91998acdab") {
      outputDiv = document.getElementById("altair-viz-5473dbd555054aa3b9bc4a91998acdab");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "strokeWidth": 3}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa"]}, "type": "nominal"}, "opacity": {"condition": {"test": "(datum['Metric'] === 'REFERRAL')", "value": 1}, "value": 0.5}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "title": {"text": "Conversion rate over time", "anchor": "start", "fontSize": 17, "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "baseline": "middle", "color": "#aaaaaa", "dx": 20, "size": 13}, "encoding": {"opacity": {"condition": {"test": "(datum['Metric'] === 'REFERRAL')", "value": 1}, "value": 0.5}, "text": {"field": "Metric", "type": "nominal"}, "x": {"aggregate": "max", "axis": null, "field": "YEAR", "type": "ordinal"}, "y": {"aggregate": {"argmax": "YEAR"}, "field": "Value", "type": "quantitative"}}}], "data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-79200e94ab13e17b934630c35a39db52": [{"YEAR": 2005, "Metric": "TOTAL", "Value": 0.087}, {"YEAR": 2006, "Metric": "TOTAL", "Value": 0.083}, {"YEAR": 2007, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2008, "Metric": "TOTAL", "Value": 0.089}, {"YEAR": 2009, "Metric": "TOTAL", "Value": 0.084}, {"YEAR": 2010, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2011, "Metric": "TOTAL", "Value": 0.075}, {"YEAR": 2012, "Metric": "TOTAL", "Value": 0.07200000000000001}, {"YEAR": 2013, "Metric": "TOTAL", "Value": 0.069}, {"YEAR": 2014, "Metric": "TOTAL", "Value": 0.074}, {"YEAR": 2015, "Metric": "TOTAL", "Value": 0.066}, {"YEAR": 2016, "Metric": "TOTAL", "Value": 0.08}, {"YEAR": 2017, "Metric": "TOTAL", "Value": 0.07300000000000001}, {"YEAR": 2018, "Metric": "TOTAL", "Value": 0.07}, {"YEAR": 2019, "Metric": "TOTAL", "Value": 0.063}, {"YEAR": 2005, "Metric": "ORGANIC", "Value": 0.033}, {"YEAR": 2006, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2007, "Metric": "ORGANIC", "Value": 0.037}, {"YEAR": 2008, "Metric": "ORGANIC", "Value": 0.036}, {"YEAR": 2009, "Metric": "ORGANIC", "Value": 0.034}, {"YEAR": 2010, "Metric": "ORGANIC", "Value": 0.031}, {"YEAR": 2011, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2012, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2013, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2014, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2015, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2016, "Metric": "ORGANIC", "Value": 0.045}, {"YEAR": 2017, "Metric": "ORGANIC", "Value": 0.041}, {"YEAR": 2018, "Metric": "ORGANIC", "Value": 0.042}, {"YEAR": 2019, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2005, "Metric": "REFERRAL", "Value": 0.054}, {"YEAR": 2006, "Metric": "REFERRAL", "Value": 0.048}, {"YEAR": 2007, "Metric": "REFERRAL", "Value": 0.049}, {"YEAR": 2008, "Metric": "REFERRAL", "Value": 0.053}, {"YEAR": 2009, "Metric": "REFERRAL", "Value": 0.05}, {"YEAR": 2010, "Metric": "REFERRAL", "Value": 0.055}, {"YEAR": 2011, "Metric": "REFERRAL", "Value": 0.043}, {"YEAR": 2012, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2013, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2014, "Metric": "REFERRAL", "Value": 0.036}, {"YEAR": 2015, "Metric": "REFERRAL", "Value": 0.031}, {"YEAR": 2016, "Metric": "REFERRAL", "Value": 0.035}, {"YEAR": 2017, "Metric": "REFERRAL", "Value": 0.032}, {"YEAR": 2018, "Metric": "REFERRAL", "Value": 0.028}, {"YEAR": 2019, "Metric": "REFERRAL", "Value": 0.025}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_3d.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>White boxes created by the author:</em></p>
<p><img alt="Alt text" src="./Images/4_3e.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Thicken-the-line">Thicken the line<a class="anchor-link" href="#Thicken-the-line"></a></h4><p>Next, we will increase the thickness of the Referral line to draw greater attention to it.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[101]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Line graph with thicker line</span>
<span class="n">line</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">melted_table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Conversion rate over time"</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">17</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">()</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"YEAR:O"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"FISCAL YEAR"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"CONVERSION RATE"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#aaaaaa"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">strokeWidth</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="c1"># Make Referral line thicker</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">[</span><span class="s2">"Metric"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"REFERRAL"</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Text at the end of the line</span>
<span class="n">text</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">baseline</span> <span class="o">=</span> <span class="s2">"middle"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#aaaaaa"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"YEAR"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="s2">"max"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"argmax"</span><span class="p">:</span> <span class="s2">"YEAR"</span><span class="p">}),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s2">"Metric"</span><span class="p">,</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="c1"># Make Referral line more opaque</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">[</span><span class="s2">"Metric"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"REFERRAL"</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">final_thick</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">text</span>
<span class="n">final_thick</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[101]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-b545a27503094aba918a0c4f0acd12b4.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-b545a27503094aba918a0c4f0acd12b4.vega-embed details,
  #altair-viz-b545a27503094aba918a0c4f0acd12b4.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-b545a27503094aba918a0c4f0acd12b4"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-b545a27503094aba918a0c4f0acd12b4") {
      outputDiv = document.getElementById("altair-viz-b545a27503094aba918a0c4f0acd12b4");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa"]}, "type": "nominal"}, "strokeWidth": {"condition": {"test": "(datum['Metric'] === 'REFERRAL')", "value": 4}, "value": 2}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "title": {"text": "Conversion rate over time", "anchor": "start", "fontSize": 17, "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "baseline": "middle", "color": "#aaaaaa", "dx": 20, "size": 13}, "encoding": {"opacity": {"condition": {"test": "(datum['Metric'] === 'REFERRAL')", "value": 1}, "value": 0.7}, "text": {"field": "Metric", "type": "nominal"}, "x": {"aggregate": "max", "axis": null, "field": "YEAR", "type": "quantitative"}, "y": {"aggregate": {"argmax": "YEAR"}, "field": "Value", "type": "quantitative"}}}], "data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-79200e94ab13e17b934630c35a39db52": [{"YEAR": 2005, "Metric": "TOTAL", "Value": 0.087}, {"YEAR": 2006, "Metric": "TOTAL", "Value": 0.083}, {"YEAR": 2007, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2008, "Metric": "TOTAL", "Value": 0.089}, {"YEAR": 2009, "Metric": "TOTAL", "Value": 0.084}, {"YEAR": 2010, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2011, "Metric": "TOTAL", "Value": 0.075}, {"YEAR": 2012, "Metric": "TOTAL", "Value": 0.07200000000000001}, {"YEAR": 2013, "Metric": "TOTAL", "Value": 0.069}, {"YEAR": 2014, "Metric": "TOTAL", "Value": 0.074}, {"YEAR": 2015, "Metric": "TOTAL", "Value": 0.066}, {"YEAR": 2016, "Metric": "TOTAL", "Value": 0.08}, {"YEAR": 2017, "Metric": "TOTAL", "Value": 0.07300000000000001}, {"YEAR": 2018, "Metric": "TOTAL", "Value": 0.07}, {"YEAR": 2019, "Metric": "TOTAL", "Value": 0.063}, {"YEAR": 2005, "Metric": "ORGANIC", "Value": 0.033}, {"YEAR": 2006, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2007, "Metric": "ORGANIC", "Value": 0.037}, {"YEAR": 2008, "Metric": "ORGANIC", "Value": 0.036}, {"YEAR": 2009, "Metric": "ORGANIC", "Value": 0.034}, {"YEAR": 2010, "Metric": "ORGANIC", "Value": 0.031}, {"YEAR": 2011, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2012, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2013, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2014, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2015, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2016, "Metric": "ORGANIC", "Value": 0.045}, {"YEAR": 2017, "Metric": "ORGANIC", "Value": 0.041}, {"YEAR": 2018, "Metric": "ORGANIC", "Value": 0.042}, {"YEAR": 2019, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2005, "Metric": "REFERRAL", "Value": 0.054}, {"YEAR": 2006, "Metric": "REFERRAL", "Value": 0.048}, {"YEAR": 2007, "Metric": "REFERRAL", "Value": 0.049}, {"YEAR": 2008, "Metric": "REFERRAL", "Value": 0.053}, {"YEAR": 2009, "Metric": "REFERRAL", "Value": 0.05}, {"YEAR": 2010, "Metric": "REFERRAL", "Value": 0.055}, {"YEAR": 2011, "Metric": "REFERRAL", "Value": 0.043}, {"YEAR": 2012, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2013, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2014, "Metric": "REFERRAL", "Value": 0.036}, {"YEAR": 2015, "Metric": "REFERRAL", "Value": 0.031}, {"YEAR": 2016, "Metric": "REFERRAL", "Value": 0.035}, {"YEAR": 2017, "Metric": "REFERRAL", "Value": 0.032}, {"YEAR": 2018, "Metric": "REFERRAL", "Value": 0.028}, {"YEAR": 2019, "Metric": "REFERRAL", "Value": 0.025}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_3f.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Change-line-style">Change line style<a class="anchor-link" href="#Change-line-style"></a></h4><p>We can change the Referral line to a dashed line, while maintaining other continuous. This type of highlight is recommended when you are representing some type of uncertain data, such as a prediction or goal.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[102]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Line chart</span>
<span class="n">line</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">melted_table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Conversion rate over time"</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">17</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">strokeWidth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"YEAR:O"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"FISCAL YEAR"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"CONVERSION RATE"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#aaaaaa"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">strokeDash</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="c1"># Define dash based on condition if equal referral</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">[</span><span class="s2">"Metric"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"REFERRAL"</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># We will use the same text as the original version of the graph</span>

<span class="n">final_dashed</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">text_simple</span>
<span class="n">final_dashed</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[102]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-b62d0c7131a842b7b6bd448affd22f6f.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-b62d0c7131a842b7b6bd448affd22f6f.vega-embed details,
  #altair-viz-b62d0c7131a842b7b6bd448affd22f6f.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-b62d0c7131a842b7b6bd448affd22f6f"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-b62d0c7131a842b7b6bd448affd22f6f") {
      outputDiv = document.getElementById("altair-viz-b62d0c7131a842b7b6bd448affd22f6f");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "strokeWidth": 3}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa"]}, "type": "nominal"}, "strokeDash": {"condition": {"test": "(datum['Metric'] === 'REFERRAL')", "value": [5, 3]}, "value": [1, 0]}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "title": {"text": "Conversion rate over time", "anchor": "start", "fontSize": 17, "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "color": "#aaaaaa", "dx": 20, "size": 13}, "encoding": {"text": {"field": "Metric", "type": "nominal"}, "x": {"aggregate": "max", "axis": null, "field": "YEAR", "type": "quantitative"}, "y": {"aggregate": {"argmax": "YEAR"}, "field": "Value", "type": "quantitative"}}}], "data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-79200e94ab13e17b934630c35a39db52": [{"YEAR": 2005, "Metric": "TOTAL", "Value": 0.087}, {"YEAR": 2006, "Metric": "TOTAL", "Value": 0.083}, {"YEAR": 2007, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2008, "Metric": "TOTAL", "Value": 0.089}, {"YEAR": 2009, "Metric": "TOTAL", "Value": 0.084}, {"YEAR": 2010, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2011, "Metric": "TOTAL", "Value": 0.075}, {"YEAR": 2012, "Metric": "TOTAL", "Value": 0.07200000000000001}, {"YEAR": 2013, "Metric": "TOTAL", "Value": 0.069}, {"YEAR": 2014, "Metric": "TOTAL", "Value": 0.074}, {"YEAR": 2015, "Metric": "TOTAL", "Value": 0.066}, {"YEAR": 2016, "Metric": "TOTAL", "Value": 0.08}, {"YEAR": 2017, "Metric": "TOTAL", "Value": 0.07300000000000001}, {"YEAR": 2018, "Metric": "TOTAL", "Value": 0.07}, {"YEAR": 2019, "Metric": "TOTAL", "Value": 0.063}, {"YEAR": 2005, "Metric": "ORGANIC", "Value": 0.033}, {"YEAR": 2006, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2007, "Metric": "ORGANIC", "Value": 0.037}, {"YEAR": 2008, "Metric": "ORGANIC", "Value": 0.036}, {"YEAR": 2009, "Metric": "ORGANIC", "Value": 0.034}, {"YEAR": 2010, "Metric": "ORGANIC", "Value": 0.031}, {"YEAR": 2011, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2012, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2013, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2014, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2015, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2016, "Metric": "ORGANIC", "Value": 0.045}, {"YEAR": 2017, "Metric": "ORGANIC", "Value": 0.041}, {"YEAR": 2018, "Metric": "ORGANIC", "Value": 0.042}, {"YEAR": 2019, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2005, "Metric": "REFERRAL", "Value": 0.054}, {"YEAR": 2006, "Metric": "REFERRAL", "Value": 0.048}, {"YEAR": 2007, "Metric": "REFERRAL", "Value": 0.049}, {"YEAR": 2008, "Metric": "REFERRAL", "Value": 0.053}, {"YEAR": 2009, "Metric": "REFERRAL", "Value": 0.05}, {"YEAR": 2010, "Metric": "REFERRAL", "Value": 0.055}, {"YEAR": 2011, "Metric": "REFERRAL", "Value": 0.043}, {"YEAR": 2012, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2013, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2014, "Metric": "REFERRAL", "Value": 0.036}, {"YEAR": 2015, "Metric": "REFERRAL", "Value": 0.031}, {"YEAR": 2016, "Metric": "REFERRAL", "Value": 0.035}, {"YEAR": 2017, "Metric": "REFERRAL", "Value": 0.032}, {"YEAR": 2018, "Metric": "REFERRAL", "Value": 0.028}, {"YEAR": 2019, "Metric": "REFERRAL", "Value": 0.025}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_3g.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Leverage-intensity">Leverage intensity<a class="anchor-link" href="#Leverage-intensity"></a></h4><p>In the opposite idea of making the other lines slightly transparent, we can make the referral line darker in color.</p>
<p>Since the next part of the exercise is to covert the Referral line on visually top of the others and the default behavior Altair already does that, we will undertake the task of intentionally positioning the Referral line below for now. This will be achieved by creating the Referral line separately and adding it as the initial layer in the graph.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[103]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Line only for referral</span>
<span class="n">line_referral</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">strokeWidth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"YEAR:O"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"FISCAL YEAR"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"CONVERSION RATE"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"black"</span><span class="p">),</span> <span class="c1"># Color it black</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Maximum opacity</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
    <span class="c1"># Filter out other lines</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">FieldEqualPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">equal</span> <span class="o">=</span> <span class="s2">"REFERRAL"</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Other lines</span>
<span class="n">line_rest</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">melted_table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Conversion rate over time"</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">17</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">strokeWidth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"YEAR:O"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"FISCAL YEAR"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"CONVERSION RATE"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
        <span class="p">),</span>
        <span class="c1"># Gray color</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#aaaaaa"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Maximum opacity</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
    <span class="c1"># Filter referral out</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"ORGANIC"</span><span class="p">,</span> <span class="s2">"TOTAL"</span><span class="p">]))</span>
<span class="p">)</span>

<span class="c1"># Create text that highlights Referral in black</span>
<span class="n">text_highlight</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"YEAR"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="s2">"max"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"argmax"</span><span class="p">:</span> <span class="s2">"YEAR"</span><span class="p">}),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s2">"Metric"</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">[</span><span class="s2">"Metric"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"REFERRAL"</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"black"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#aaaaaa"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">final_darker</span> <span class="o">=</span> <span class="n">line_referral</span> <span class="o">+</span> <span class="n">line_rest</span> <span class="o">+</span> <span class="n">text_highlight</span>
<span class="n">final_darker</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[103]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-3eb69471b0f84050b28b940c3c005dab.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-3eb69471b0f84050b28b940c3c005dab.vega-embed details,
  #altair-viz-3eb69471b0f84050b28b940c3c005dab.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-3eb69471b0f84050b28b940c3c005dab"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-3eb69471b0f84050b28b940c3c005dab") {
      outputDiv = document.getElementById("altair-viz-3eb69471b0f84050b28b940c3c005dab");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "strokeWidth": 3}, "encoding": {"color": {"value": "black"}, "opacity": {"value": 1}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "transform": [{"filter": {"equal": "REFERRAL", "field": "Metric"}}]}, {"mark": {"type": "line", "strokeWidth": 3}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa"]}, "type": "nominal"}, "opacity": {"value": 1}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "title": {"text": "Conversion rate over time", "anchor": "start", "fontSize": 17, "fontWeight": "normal"}, "transform": [{"filter": {"field": "Metric", "oneOf": ["ORGANIC", "TOTAL"]}}]}, {"mark": {"type": "text", "align": "left", "dx": 20, "size": 13}, "encoding": {"color": {"condition": {"test": "(datum['Metric'] === 'REFERRAL')", "value": "black"}, "value": "#aaaaaa"}, "text": {"field": "Metric", "type": "nominal"}, "x": {"aggregate": "max", "axis": null, "field": "YEAR", "type": "quantitative"}, "y": {"aggregate": {"argmax": "YEAR"}, "field": "Value", "type": "quantitative"}}}], "data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-79200e94ab13e17b934630c35a39db52": [{"YEAR": 2005, "Metric": "TOTAL", "Value": 0.087}, {"YEAR": 2006, "Metric": "TOTAL", "Value": 0.083}, {"YEAR": 2007, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2008, "Metric": "TOTAL", "Value": 0.089}, {"YEAR": 2009, "Metric": "TOTAL", "Value": 0.084}, {"YEAR": 2010, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2011, "Metric": "TOTAL", "Value": 0.075}, {"YEAR": 2012, "Metric": "TOTAL", "Value": 0.07200000000000001}, {"YEAR": 2013, "Metric": "TOTAL", "Value": 0.069}, {"YEAR": 2014, "Metric": "TOTAL", "Value": 0.074}, {"YEAR": 2015, "Metric": "TOTAL", "Value": 0.066}, {"YEAR": 2016, "Metric": "TOTAL", "Value": 0.08}, {"YEAR": 2017, "Metric": "TOTAL", "Value": 0.07300000000000001}, {"YEAR": 2018, "Metric": "TOTAL", "Value": 0.07}, {"YEAR": 2019, "Metric": "TOTAL", "Value": 0.063}, {"YEAR": 2005, "Metric": "ORGANIC", "Value": 0.033}, {"YEAR": 2006, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2007, "Metric": "ORGANIC", "Value": 0.037}, {"YEAR": 2008, "Metric": "ORGANIC", "Value": 0.036}, {"YEAR": 2009, "Metric": "ORGANIC", "Value": 0.034}, {"YEAR": 2010, "Metric": "ORGANIC", "Value": 0.031}, {"YEAR": 2011, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2012, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2013, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2014, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2015, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2016, "Metric": "ORGANIC", "Value": 0.045}, {"YEAR": 2017, "Metric": "ORGANIC", "Value": 0.041}, {"YEAR": 2018, "Metric": "ORGANIC", "Value": 0.042}, {"YEAR": 2019, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2005, "Metric": "REFERRAL", "Value": 0.054}, {"YEAR": 2006, "Metric": "REFERRAL", "Value": 0.048}, {"YEAR": 2007, "Metric": "REFERRAL", "Value": 0.049}, {"YEAR": 2008, "Metric": "REFERRAL", "Value": 0.053}, {"YEAR": 2009, "Metric": "REFERRAL", "Value": 0.05}, {"YEAR": 2010, "Metric": "REFERRAL", "Value": 0.055}, {"YEAR": 2011, "Metric": "REFERRAL", "Value": 0.043}, {"YEAR": 2012, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2013, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2014, "Metric": "REFERRAL", "Value": 0.036}, {"YEAR": 2015, "Metric": "REFERRAL", "Value": 0.031}, {"YEAR": 2016, "Metric": "REFERRAL", "Value": 0.035}, {"YEAR": 2017, "Metric": "REFERRAL", "Value": 0.032}, {"YEAR": 2018, "Metric": "REFERRAL", "Value": 0.028}, {"YEAR": 2019, "Metric": "REFERRAL", "Value": 0.025}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Adding the text created an undesired axis on top, that we could not remove by setting <code>Axis = None</code>. To solve this issue, we will define each word by pixel value.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[104]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Text for Total</span>
<span class="n">text_total</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> 
                    <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span>  <span class="p">[</span><span class="s1">'TOTAL'</span><span class="p">]}]</span>
                    <span class="p">}</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span> 
                                <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> 
                                <span class="n">dx</span> <span class="o">=</span> <span class="mi">230</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">37</span><span class="p">,</span> 
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">'#aaaaaa'</span>
                                <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>

<span class="c1"># Text for Organic</span>
<span class="n">text_organic</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> 
                    <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span>  <span class="p">[</span><span class="s1">'ORGANIC'</span><span class="p">]}]</span>
                    <span class="p">}</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span> 
                                <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> 
                                <span class="n">dx</span> <span class="o">=</span> <span class="mi">230</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">37</span><span class="p">,</span> 
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">'#aaaaaa'</span>
                                <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>

<span class="c1"># Text for Referral</span>
<span class="n">text_referral</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> 
                    <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span>  <span class="p">[</span><span class="s1">'REFERRAL'</span><span class="p">]}]</span>
                    <span class="p">}</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span> 
                                <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> 
                                <span class="n">dx</span> <span class="o">=</span> <span class="mi">230</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">78</span><span class="p">,</span> 
                                <span class="n">color</span> <span class="o">=</span> <span class="s1">'black'</span>
                                <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>

<span class="n">final_darker</span> <span class="o">=</span> <span class="n">line_referral</span> <span class="o">+</span> <span class="n">line_rest</span> <span class="o">+</span> <span class="n">text_total</span> <span class="o">+</span> <span class="n">text_organic</span> <span class="o">+</span> <span class="n">text_referral</span>
<span class="n">final_darker</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[104]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-9e2acd08fb144fa4864f2388c16fd730.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-9e2acd08fb144fa4864f2388c16fd730.vega-embed details,
  #altair-viz-9e2acd08fb144fa4864f2388c16fd730.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-9e2acd08fb144fa4864f2388c16fd730"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-9e2acd08fb144fa4864f2388c16fd730") {
      outputDiv = document.getElementById("altair-viz-9e2acd08fb144fa4864f2388c16fd730");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "strokeWidth": 3}, "encoding": {"color": {"value": "black"}, "opacity": {"value": 1}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "transform": [{"filter": {"equal": "REFERRAL", "field": "Metric"}}]}, {"mark": {"type": "line", "strokeWidth": 3}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa"]}, "type": "nominal"}, "opacity": {"value": 1}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "title": {"text": "Conversion rate over time", "anchor": "start", "fontSize": 17, "fontWeight": "normal"}, "transform": [{"filter": {"field": "Metric", "oneOf": ["ORGANIC", "TOTAL"]}}]}, {"data": {"name": "data-9cf0f3738d14cac59bc2e0c7ef16c2b3"}, "mark": {"type": "text", "align": "left", "color": "#aaaaaa", "dx": 230, "dy": -37, "size": 13}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-885531ff90f84f45e85d779e69d78fe2"}, "mark": {"type": "text", "align": "left", "color": "#aaaaaa", "dx": 230, "dy": 37, "size": 13}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-af960006992e8536783d4e2884e42787"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": 230, "dy": 78, "size": 13}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-79200e94ab13e17b934630c35a39db52": [{"YEAR": 2005, "Metric": "TOTAL", "Value": 0.087}, {"YEAR": 2006, "Metric": "TOTAL", "Value": 0.083}, {"YEAR": 2007, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2008, "Metric": "TOTAL", "Value": 0.089}, {"YEAR": 2009, "Metric": "TOTAL", "Value": 0.084}, {"YEAR": 2010, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2011, "Metric": "TOTAL", "Value": 0.075}, {"YEAR": 2012, "Metric": "TOTAL", "Value": 0.07200000000000001}, {"YEAR": 2013, "Metric": "TOTAL", "Value": 0.069}, {"YEAR": 2014, "Metric": "TOTAL", "Value": 0.074}, {"YEAR": 2015, "Metric": "TOTAL", "Value": 0.066}, {"YEAR": 2016, "Metric": "TOTAL", "Value": 0.08}, {"YEAR": 2017, "Metric": "TOTAL", "Value": 0.07300000000000001}, {"YEAR": 2018, "Metric": "TOTAL", "Value": 0.07}, {"YEAR": 2019, "Metric": "TOTAL", "Value": 0.063}, {"YEAR": 2005, "Metric": "ORGANIC", "Value": 0.033}, {"YEAR": 2006, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2007, "Metric": "ORGANIC", "Value": 0.037}, {"YEAR": 2008, "Metric": "ORGANIC", "Value": 0.036}, {"YEAR": 2009, "Metric": "ORGANIC", "Value": 0.034}, {"YEAR": 2010, "Metric": "ORGANIC", "Value": 0.031}, {"YEAR": 2011, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2012, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2013, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2014, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2015, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2016, "Metric": "ORGANIC", "Value": 0.045}, {"YEAR": 2017, "Metric": "ORGANIC", "Value": 0.041}, {"YEAR": 2018, "Metric": "ORGANIC", "Value": 0.042}, {"YEAR": 2019, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2005, "Metric": "REFERRAL", "Value": 0.054}, {"YEAR": 2006, "Metric": "REFERRAL", "Value": 0.048}, {"YEAR": 2007, "Metric": "REFERRAL", "Value": 0.049}, {"YEAR": 2008, "Metric": "REFERRAL", "Value": 0.053}, {"YEAR": 2009, "Metric": "REFERRAL", "Value": 0.05}, {"YEAR": 2010, "Metric": "REFERRAL", "Value": 0.055}, {"YEAR": 2011, "Metric": "REFERRAL", "Value": 0.043}, {"YEAR": 2012, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2013, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2014, "Metric": "REFERRAL", "Value": 0.036}, {"YEAR": 2015, "Metric": "REFERRAL", "Value": 0.031}, {"YEAR": 2016, "Metric": "REFERRAL", "Value": 0.035}, {"YEAR": 2017, "Metric": "REFERRAL", "Value": 0.032}, {"YEAR": 2018, "Metric": "REFERRAL", "Value": 0.028}, {"YEAR": 2019, "Metric": "REFERRAL", "Value": 0.025}], "data-9cf0f3738d14cac59bc2e0c7ef16c2b3": [{"text": ["TOTAL"]}], "data-885531ff90f84f45e85d779e69d78fe2": [{"text": ["ORGANIC"]}], "data-af960006992e8536783d4e2884e42787": [{"text": ["REFERRAL"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_3h.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Position-Referral-on-top-of-other-lines">Position Referral on top of other lines<a class="anchor-link" href="#Position-Referral-on-top-of-other-lines"></a></h4><p>We can create this effect by simply making a line graph where the color has a condition for <code>Metric == Referral</code>, or a scale with range <code>[gray, black, gray]</code>. However, since we already have the visualizations from above, we can just change the order we add them so that the line referral is on top of the others.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[105]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">final_top</span> <span class="o">=</span> <span class="n">line_rest</span> <span class="o">+</span> <span class="n">line_referral</span> <span class="o">+</span> <span class="n">text_total</span> <span class="o">+</span> <span class="n">text_organic</span> <span class="o">+</span> <span class="n">text_referral</span>
<span class="n">final_top</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[105]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-08d4f7d7df5646218b00d1292265cc95.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-08d4f7d7df5646218b00d1292265cc95.vega-embed details,
  #altair-viz-08d4f7d7df5646218b00d1292265cc95.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-08d4f7d7df5646218b00d1292265cc95"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-08d4f7d7df5646218b00d1292265cc95") {
      outputDiv = document.getElementById("altair-viz-08d4f7d7df5646218b00d1292265cc95");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "strokeWidth": 3}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa"]}, "type": "nominal"}, "opacity": {"value": 1}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "title": {"text": "Conversion rate over time", "anchor": "start", "fontSize": 17, "fontWeight": "normal"}, "transform": [{"filter": {"field": "Metric", "oneOf": ["ORGANIC", "TOTAL"]}}]}, {"mark": {"type": "line", "strokeWidth": 3}, "encoding": {"color": {"value": "black"}, "opacity": {"value": 1}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "transform": [{"filter": {"equal": "REFERRAL", "field": "Metric"}}]}, {"data": {"name": "data-9cf0f3738d14cac59bc2e0c7ef16c2b3"}, "mark": {"type": "text", "align": "left", "color": "#aaaaaa", "dx": 230, "dy": -37, "size": 13}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-885531ff90f84f45e85d779e69d78fe2"}, "mark": {"type": "text", "align": "left", "color": "#aaaaaa", "dx": 230, "dy": 37, "size": 13}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-af960006992e8536783d4e2884e42787"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": 230, "dy": 78, "size": 13}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-79200e94ab13e17b934630c35a39db52": [{"YEAR": 2005, "Metric": "TOTAL", "Value": 0.087}, {"YEAR": 2006, "Metric": "TOTAL", "Value": 0.083}, {"YEAR": 2007, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2008, "Metric": "TOTAL", "Value": 0.089}, {"YEAR": 2009, "Metric": "TOTAL", "Value": 0.084}, {"YEAR": 2010, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2011, "Metric": "TOTAL", "Value": 0.075}, {"YEAR": 2012, "Metric": "TOTAL", "Value": 0.07200000000000001}, {"YEAR": 2013, "Metric": "TOTAL", "Value": 0.069}, {"YEAR": 2014, "Metric": "TOTAL", "Value": 0.074}, {"YEAR": 2015, "Metric": "TOTAL", "Value": 0.066}, {"YEAR": 2016, "Metric": "TOTAL", "Value": 0.08}, {"YEAR": 2017, "Metric": "TOTAL", "Value": 0.07300000000000001}, {"YEAR": 2018, "Metric": "TOTAL", "Value": 0.07}, {"YEAR": 2019, "Metric": "TOTAL", "Value": 0.063}, {"YEAR": 2005, "Metric": "ORGANIC", "Value": 0.033}, {"YEAR": 2006, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2007, "Metric": "ORGANIC", "Value": 0.037}, {"YEAR": 2008, "Metric": "ORGANIC", "Value": 0.036}, {"YEAR": 2009, "Metric": "ORGANIC", "Value": 0.034}, {"YEAR": 2010, "Metric": "ORGANIC", "Value": 0.031}, {"YEAR": 2011, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2012, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2013, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2014, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2015, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2016, "Metric": "ORGANIC", "Value": 0.045}, {"YEAR": 2017, "Metric": "ORGANIC", "Value": 0.041}, {"YEAR": 2018, "Metric": "ORGANIC", "Value": 0.042}, {"YEAR": 2019, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2005, "Metric": "REFERRAL", "Value": 0.054}, {"YEAR": 2006, "Metric": "REFERRAL", "Value": 0.048}, {"YEAR": 2007, "Metric": "REFERRAL", "Value": 0.049}, {"YEAR": 2008, "Metric": "REFERRAL", "Value": 0.053}, {"YEAR": 2009, "Metric": "REFERRAL", "Value": 0.05}, {"YEAR": 2010, "Metric": "REFERRAL", "Value": 0.055}, {"YEAR": 2011, "Metric": "REFERRAL", "Value": 0.043}, {"YEAR": 2012, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2013, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2014, "Metric": "REFERRAL", "Value": 0.036}, {"YEAR": 2015, "Metric": "REFERRAL", "Value": 0.031}, {"YEAR": 2016, "Metric": "REFERRAL", "Value": 0.035}, {"YEAR": 2017, "Metric": "REFERRAL", "Value": 0.032}, {"YEAR": 2018, "Metric": "REFERRAL", "Value": 0.028}, {"YEAR": 2019, "Metric": "REFERRAL", "Value": 0.025}], "data-9cf0f3738d14cac59bc2e0c7ef16c2b3": [{"text": ["TOTAL"]}], "data-885531ff90f84f45e85d779e69d78fe2": [{"text": ["ORGANIC"]}], "data-af960006992e8536783d4e2884e42787": [{"text": ["REFERRAL"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_3i.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Change-the-hue">Change the hue<a class="anchor-link" href="#Change-the-hue"></a></h4><p>Similarly to setting the highlighted line to black, we can change it to other colors such as red.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[106]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Create a red referral line</span>
<span class="n">line_red</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">melted_table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Conversion rate over time"</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">17</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">strokeWidth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"YEAR:O"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"FISCAL YEAR"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"CONVERSION RATE"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span>
            <span class="c1"># The hex code in the middle corresponds to the referral line</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#aaaaaa"</span><span class="p">,</span> <span class="s2">"#d24b53"</span><span class="p">,</span> <span class="s2">"#aaaaaa"</span><span class="p">]),</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Create a referral red text</span>
<span class="n">text_red</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">baseline</span> <span class="o">=</span> <span class="s2">"middle"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"YEAR"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="s2">"max"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"argmax"</span><span class="p">:</span> <span class="s2">"YEAR"</span><span class="p">}),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s2">"Metric"</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span>
            <span class="c1"># Set referral color to red</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#aaaaaa"</span><span class="p">,</span> <span class="s2">"#d24b53"</span><span class="p">,</span> <span class="s2">"#aaaaaa"</span><span class="p">]),</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">final_red</span> <span class="o">=</span> <span class="n">line_red</span> <span class="o">+</span> <span class="n">text_red</span>
<span class="n">final_red</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[106]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-acefb441997845db90879360e0daff31.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-acefb441997845db90879360e0daff31.vega-embed details,
  #altair-viz-acefb441997845db90879360e0daff31.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-acefb441997845db90879360e0daff31"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-acefb441997845db90879360e0daff31") {
      outputDiv = document.getElementById("altair-viz-acefb441997845db90879360e0daff31");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "strokeWidth": 3}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa", "#d24b53", "#aaaaaa"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "title": {"text": "Conversion rate over time", "anchor": "start", "fontSize": 17, "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "baseline": "middle", "dx": 20, "size": 13}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa", "#d24b53", "#aaaaaa"]}, "type": "nominal"}, "text": {"field": "Metric", "type": "nominal"}, "x": {"aggregate": "max", "axis": null, "field": "YEAR", "type": "quantitative"}, "y": {"aggregate": {"argmax": "YEAR"}, "field": "Value", "type": "quantitative"}}}], "data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-79200e94ab13e17b934630c35a39db52": [{"YEAR": 2005, "Metric": "TOTAL", "Value": 0.087}, {"YEAR": 2006, "Metric": "TOTAL", "Value": 0.083}, {"YEAR": 2007, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2008, "Metric": "TOTAL", "Value": 0.089}, {"YEAR": 2009, "Metric": "TOTAL", "Value": 0.084}, {"YEAR": 2010, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2011, "Metric": "TOTAL", "Value": 0.075}, {"YEAR": 2012, "Metric": "TOTAL", "Value": 0.07200000000000001}, {"YEAR": 2013, "Metric": "TOTAL", "Value": 0.069}, {"YEAR": 2014, "Metric": "TOTAL", "Value": 0.074}, {"YEAR": 2015, "Metric": "TOTAL", "Value": 0.066}, {"YEAR": 2016, "Metric": "TOTAL", "Value": 0.08}, {"YEAR": 2017, "Metric": "TOTAL", "Value": 0.07300000000000001}, {"YEAR": 2018, "Metric": "TOTAL", "Value": 0.07}, {"YEAR": 2019, "Metric": "TOTAL", "Value": 0.063}, {"YEAR": 2005, "Metric": "ORGANIC", "Value": 0.033}, {"YEAR": 2006, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2007, "Metric": "ORGANIC", "Value": 0.037}, {"YEAR": 2008, "Metric": "ORGANIC", "Value": 0.036}, {"YEAR": 2009, "Metric": "ORGANIC", "Value": 0.034}, {"YEAR": 2010, "Metric": "ORGANIC", "Value": 0.031}, {"YEAR": 2011, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2012, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2013, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2014, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2015, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2016, "Metric": "ORGANIC", "Value": 0.045}, {"YEAR": 2017, "Metric": "ORGANIC", "Value": 0.041}, {"YEAR": 2018, "Metric": "ORGANIC", "Value": 0.042}, {"YEAR": 2019, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2005, "Metric": "REFERRAL", "Value": 0.054}, {"YEAR": 2006, "Metric": "REFERRAL", "Value": 0.048}, {"YEAR": 2007, "Metric": "REFERRAL", "Value": 0.049}, {"YEAR": 2008, "Metric": "REFERRAL", "Value": 0.053}, {"YEAR": 2009, "Metric": "REFERRAL", "Value": 0.05}, {"YEAR": 2010, "Metric": "REFERRAL", "Value": 0.055}, {"YEAR": 2011, "Metric": "REFERRAL", "Value": 0.043}, {"YEAR": 2012, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2013, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2014, "Metric": "REFERRAL", "Value": 0.036}, {"YEAR": 2015, "Metric": "REFERRAL", "Value": 0.031}, {"YEAR": 2016, "Metric": "REFERRAL", "Value": 0.035}, {"YEAR": 2017, "Metric": "REFERRAL", "Value": 0.032}, {"YEAR": 2018, "Metric": "REFERRAL", "Value": 0.028}, {"YEAR": 2019, "Metric": "REFERRAL", "Value": 0.025}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_3j.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Use-words">Use words<a class="anchor-link" href="#Use-words"></a></h4><p>For this example, we will add a second part for the title.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[107]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Same graph as the one without highlights</span>
<span class="c1"># but with a bigger title</span>
<span class="n">line</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">melted_table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="c1"># Add more explicit title</span>
            <span class="s2">"Conversion rate over time: Referral decreasing markedly since 2010"</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">17</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">strokeWidth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"YEAR:O"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"FISCAL YEAR"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"CONVERSION RATE"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#aaaaaa"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">final_text</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">text_simple</span>
<span class="n">final_text</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[107]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-5436644be0c94e1b8aed909c8be0772b.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-5436644be0c94e1b8aed909c8be0772b.vega-embed details,
  #altair-viz-5436644be0c94e1b8aed909c8be0772b.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-5436644be0c94e1b8aed909c8be0772b"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-5436644be0c94e1b8aed909c8be0772b") {
      outputDiv = document.getElementById("altair-viz-5436644be0c94e1b8aed909c8be0772b");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "strokeWidth": 3}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "title": {"text": "Conversion rate over time: Referral decreasing markedly since 2010", "anchor": "start", "fontSize": 17, "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "color": "#aaaaaa", "dx": 20, "size": 13}, "encoding": {"text": {"field": "Metric", "type": "nominal"}, "x": {"aggregate": "max", "axis": null, "field": "YEAR", "type": "quantitative"}, "y": {"aggregate": {"argmax": "YEAR"}, "field": "Value", "type": "quantitative"}}}], "data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-79200e94ab13e17b934630c35a39db52": [{"YEAR": 2005, "Metric": "TOTAL", "Value": 0.087}, {"YEAR": 2006, "Metric": "TOTAL", "Value": 0.083}, {"YEAR": 2007, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2008, "Metric": "TOTAL", "Value": 0.089}, {"YEAR": 2009, "Metric": "TOTAL", "Value": 0.084}, {"YEAR": 2010, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2011, "Metric": "TOTAL", "Value": 0.075}, {"YEAR": 2012, "Metric": "TOTAL", "Value": 0.07200000000000001}, {"YEAR": 2013, "Metric": "TOTAL", "Value": 0.069}, {"YEAR": 2014, "Metric": "TOTAL", "Value": 0.074}, {"YEAR": 2015, "Metric": "TOTAL", "Value": 0.066}, {"YEAR": 2016, "Metric": "TOTAL", "Value": 0.08}, {"YEAR": 2017, "Metric": "TOTAL", "Value": 0.07300000000000001}, {"YEAR": 2018, "Metric": "TOTAL", "Value": 0.07}, {"YEAR": 2019, "Metric": "TOTAL", "Value": 0.063}, {"YEAR": 2005, "Metric": "ORGANIC", "Value": 0.033}, {"YEAR": 2006, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2007, "Metric": "ORGANIC", "Value": 0.037}, {"YEAR": 2008, "Metric": "ORGANIC", "Value": 0.036}, {"YEAR": 2009, "Metric": "ORGANIC", "Value": 0.034}, {"YEAR": 2010, "Metric": "ORGANIC", "Value": 0.031}, {"YEAR": 2011, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2012, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2013, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2014, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2015, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2016, "Metric": "ORGANIC", "Value": 0.045}, {"YEAR": 2017, "Metric": "ORGANIC", "Value": 0.041}, {"YEAR": 2018, "Metric": "ORGANIC", "Value": 0.042}, {"YEAR": 2019, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2005, "Metric": "REFERRAL", "Value": 0.054}, {"YEAR": 2006, "Metric": "REFERRAL", "Value": 0.048}, {"YEAR": 2007, "Metric": "REFERRAL", "Value": 0.049}, {"YEAR": 2008, "Metric": "REFERRAL", "Value": 0.053}, {"YEAR": 2009, "Metric": "REFERRAL", "Value": 0.05}, {"YEAR": 2010, "Metric": "REFERRAL", "Value": 0.055}, {"YEAR": 2011, "Metric": "REFERRAL", "Value": 0.043}, {"YEAR": 2012, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2013, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2014, "Metric": "REFERRAL", "Value": 0.036}, {"YEAR": 2015, "Metric": "REFERRAL", "Value": 0.031}, {"YEAR": 2016, "Metric": "REFERRAL", "Value": 0.035}, {"YEAR": 2017, "Metric": "REFERRAL", "Value": 0.032}, {"YEAR": 2018, "Metric": "REFERRAL", "Value": 0.028}, {"YEAR": 2019, "Metric": "REFERRAL", "Value": 0.025}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_3k.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Eliminate-other-data">Eliminate other data<a class="anchor-link" href="#Eliminate-other-data"></a></h4><p>For this, we will only display the pertinent data.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[108]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Filter other data out of the original graph</span>
<span class="n">final_referral</span> <span class="o">=</span> <span class="n">gray_line</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">FieldEqualPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">equal</span> <span class="o">=</span> <span class="s2">"REFERRAL"</span><span class="p">))</span>
<span class="n">final_referral</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[108]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-ca1e30c09721497bbc4645497e89176e.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-ca1e30c09721497bbc4645497e89176e.vega-embed details,
  #altair-viz-ca1e30c09721497bbc4645497e89176e.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-ca1e30c09721497bbc4645497e89176e"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-ca1e30c09721497bbc4645497e89176e") {
      outputDiv = document.getElementById("altair-viz-ca1e30c09721497bbc4645497e89176e");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "strokeWidth": 3}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "title": {"text": "Conversion rate over time", "anchor": "start", "fontSize": 17, "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "color": "#aaaaaa", "dx": 20, "size": 13}, "encoding": {"text": {"field": "Metric", "type": "nominal"}, "x": {"aggregate": "max", "axis": null, "field": "YEAR", "type": "quantitative"}, "y": {"aggregate": {"argmax": "YEAR"}, "field": "Value", "type": "quantitative"}}}], "data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "transform": [{"filter": {"equal": "REFERRAL", "field": "Metric"}}], "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-79200e94ab13e17b934630c35a39db52": [{"YEAR": 2005, "Metric": "TOTAL", "Value": 0.087}, {"YEAR": 2006, "Metric": "TOTAL", "Value": 0.083}, {"YEAR": 2007, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2008, "Metric": "TOTAL", "Value": 0.089}, {"YEAR": 2009, "Metric": "TOTAL", "Value": 0.084}, {"YEAR": 2010, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2011, "Metric": "TOTAL", "Value": 0.075}, {"YEAR": 2012, "Metric": "TOTAL", "Value": 0.07200000000000001}, {"YEAR": 2013, "Metric": "TOTAL", "Value": 0.069}, {"YEAR": 2014, "Metric": "TOTAL", "Value": 0.074}, {"YEAR": 2015, "Metric": "TOTAL", "Value": 0.066}, {"YEAR": 2016, "Metric": "TOTAL", "Value": 0.08}, {"YEAR": 2017, "Metric": "TOTAL", "Value": 0.07300000000000001}, {"YEAR": 2018, "Metric": "TOTAL", "Value": 0.07}, {"YEAR": 2019, "Metric": "TOTAL", "Value": 0.063}, {"YEAR": 2005, "Metric": "ORGANIC", "Value": 0.033}, {"YEAR": 2006, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2007, "Metric": "ORGANIC", "Value": 0.037}, {"YEAR": 2008, "Metric": "ORGANIC", "Value": 0.036}, {"YEAR": 2009, "Metric": "ORGANIC", "Value": 0.034}, {"YEAR": 2010, "Metric": "ORGANIC", "Value": 0.031}, {"YEAR": 2011, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2012, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2013, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2014, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2015, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2016, "Metric": "ORGANIC", "Value": 0.045}, {"YEAR": 2017, "Metric": "ORGANIC", "Value": 0.041}, {"YEAR": 2018, "Metric": "ORGANIC", "Value": 0.042}, {"YEAR": 2019, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2005, "Metric": "REFERRAL", "Value": 0.054}, {"YEAR": 2006, "Metric": "REFERRAL", "Value": 0.048}, {"YEAR": 2007, "Metric": "REFERRAL", "Value": 0.049}, {"YEAR": 2008, "Metric": "REFERRAL", "Value": 0.053}, {"YEAR": 2009, "Metric": "REFERRAL", "Value": 0.05}, {"YEAR": 2010, "Metric": "REFERRAL", "Value": 0.055}, {"YEAR": 2011, "Metric": "REFERRAL", "Value": 0.043}, {"YEAR": 2012, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2013, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2014, "Metric": "REFERRAL", "Value": 0.036}, {"YEAR": 2015, "Metric": "REFERRAL", "Value": 0.031}, {"YEAR": 2016, "Metric": "REFERRAL", "Value": 0.035}, {"YEAR": 2017, "Metric": "REFERRAL", "Value": 0.032}, {"YEAR": 2018, "Metric": "REFERRAL", "Value": 0.028}, {"YEAR": 2019, "Metric": "REFERRAL", "Value": 0.025}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_3l.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Animate-to-appear">Animate to appear<a class="anchor-link" href="#Animate-to-appear"></a></h4><p>This option is only described in the book and not visually demonstrated due to its static nature. The idea of the author is to animate in such a way that one line appears at a time. We will double this section as our interactive graph and display a visualization where users can click on the legend to reveal the desired line. Holding down the Shift key while clicking will enable the selection of multiple lines.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[109]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Define an interactive selection</span>
<span class="n">metric_selection</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection_point</span><span class="p">(</span><span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Metric"</span><span class="p">])</span>

<span class="c1"># Base line chart</span>
<span class="n">line</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">melted_table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Conversion rate over time: Referral decreasing markedly since 2010"</span><span class="p">,</span>
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">17</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">strokeWidth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"YEAR:O"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"FISCAL YEAR"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"CONVERSION RATE"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#aaaaaa"</span><span class="p">])),</span>
        <span class="c1"># Maximum transparency if not selected</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">metric_selection</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">metric_selection</span><span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">metric_selection</span><span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Text chart</span>
<span class="n">text</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">baseline</span> <span class="o">=</span> <span class="s2">"middle"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"YEAR"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="s2">"max"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"argmax"</span><span class="p">:</span> <span class="s2">"YEAR"</span><span class="p">}),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s2">"Metric"</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#aaaaaa"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="c1"># Maximum transparency if not selected</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">metric_selection</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">metric_selection</span><span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">metric_selection</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># CLickable legend</span>
<span class="n">legend</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_point</span><span class="p">()</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">)</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">orient</span> <span class="o">=</span> <span class="s2">"right"</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">metric_selection</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#aaaaaa"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"lightgrey"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">add_params</span><span class="p">(</span><span class="n">metric_selection</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">final_interactive</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">text</span> <span class="o">|</span> <span class="n">legend</span>
<span class="n">final_interactive</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[109]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-ebb43d96bce3477eb75f7c4da8a494ac.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-ebb43d96bce3477eb75f7c4da8a494ac.vega-embed details,
  #altair-viz-ebb43d96bce3477eb75f7c4da8a494ac.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-ebb43d96bce3477eb75f7c4da8a494ac"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-ebb43d96bce3477eb75f7c4da8a494ac") {
      outputDiv = document.getElementById("altair-viz-ebb43d96bce3477eb75f7c4da8a494ac");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "hconcat": [{"layer": [{"mark": {"type": "line", "strokeWidth": 3}, "encoding": {"color": {"field": "Metric", "scale": {"range": ["#aaaaaa"]}, "type": "nominal"}, "opacity": {"condition": {"param": "param_5", "value": 1}, "value": 0}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "name": "view_3", "title": {"text": "Conversion rate over time: Referral decreasing markedly since 2010", "anchor": "start", "fontSize": 17, "fontWeight": "normal"}, "transform": [{"filter": {"param": "param_5"}}]}, {"mark": {"type": "text", "align": "left", "baseline": "middle", "dx": 20, "size": 13}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa"]}, "type": "nominal"}, "opacity": {"condition": {"param": "param_5", "value": 1}, "value": 0}, "text": {"field": "Metric", "type": "nominal"}, "x": {"aggregate": "max", "axis": null, "field": "YEAR", "type": "quantitative"}, "y": {"aggregate": {"argmax": "YEAR"}, "field": "Value", "type": "quantitative"}}, "transform": [{"filter": {"param": "param_5"}}]}], "width": 500}, {"mark": {"type": "point"}, "encoding": {"color": {"condition": {"param": "param_5", "value": "#aaaaaa"}, "value": "lightgrey"}, "y": {"axis": {"orient": "right"}, "field": "Metric", "type": "nominal"}}, "name": "view_4"}], "data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "params": [{"name": "param_5", "select": {"type": "point", "fields": ["Metric"]}, "views": ["view_3", "view_4"]}], "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-79200e94ab13e17b934630c35a39db52": [{"YEAR": 2005, "Metric": "TOTAL", "Value": 0.087}, {"YEAR": 2006, "Metric": "TOTAL", "Value": 0.083}, {"YEAR": 2007, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2008, "Metric": "TOTAL", "Value": 0.089}, {"YEAR": 2009, "Metric": "TOTAL", "Value": 0.084}, {"YEAR": 2010, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2011, "Metric": "TOTAL", "Value": 0.075}, {"YEAR": 2012, "Metric": "TOTAL", "Value": 0.07200000000000001}, {"YEAR": 2013, "Metric": "TOTAL", "Value": 0.069}, {"YEAR": 2014, "Metric": "TOTAL", "Value": 0.074}, {"YEAR": 2015, "Metric": "TOTAL", "Value": 0.066}, {"YEAR": 2016, "Metric": "TOTAL", "Value": 0.08}, {"YEAR": 2017, "Metric": "TOTAL", "Value": 0.07300000000000001}, {"YEAR": 2018, "Metric": "TOTAL", "Value": 0.07}, {"YEAR": 2019, "Metric": "TOTAL", "Value": 0.063}, {"YEAR": 2005, "Metric": "ORGANIC", "Value": 0.033}, {"YEAR": 2006, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2007, "Metric": "ORGANIC", "Value": 0.037}, {"YEAR": 2008, "Metric": "ORGANIC", "Value": 0.036}, {"YEAR": 2009, "Metric": "ORGANIC", "Value": 0.034}, {"YEAR": 2010, "Metric": "ORGANIC", "Value": 0.031}, {"YEAR": 2011, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2012, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2013, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2014, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2015, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2016, "Metric": "ORGANIC", "Value": 0.045}, {"YEAR": 2017, "Metric": "ORGANIC", "Value": 0.041}, {"YEAR": 2018, "Metric": "ORGANIC", "Value": 0.042}, {"YEAR": 2019, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2005, "Metric": "REFERRAL", "Value": 0.054}, {"YEAR": 2006, "Metric": "REFERRAL", "Value": 0.048}, {"YEAR": 2007, "Metric": "REFERRAL", "Value": 0.049}, {"YEAR": 2008, "Metric": "REFERRAL", "Value": 0.053}, {"YEAR": 2009, "Metric": "REFERRAL", "Value": 0.05}, {"YEAR": 2010, "Metric": "REFERRAL", "Value": 0.055}, {"YEAR": 2011, "Metric": "REFERRAL", "Value": 0.043}, {"YEAR": 2012, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2013, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2014, "Metric": "REFERRAL", "Value": 0.036}, {"YEAR": 2015, "Metric": "REFERRAL", "Value": 0.031}, {"YEAR": 2016, "Metric": "REFERRAL", "Value": 0.035}, {"YEAR": 2017, "Metric": "REFERRAL", "Value": 0.032}, {"YEAR": 2018, "Metric": "REFERRAL", "Value": 0.028}, {"YEAR": 2019, "Metric": "REFERRAL", "Value": 0.025}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Add-data-markers">Add data markers<a class="anchor-link" href="#Add-data-markers"></a></h4><p>We can add data markers simply by defining <code>point = True</code> in the line mark.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[110]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Referral line with markers</span>
<span class="n">line_referral_markers</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">strokeWidth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">point</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"YEAR:O"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"FISCAL YEAR"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"CONVERSION RATE"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#aaaaaa"</span><span class="p">),</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">FieldEqualPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">equal</span> <span class="o">=</span> <span class="s2">"REFERRAL"</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Text only for referral in gray color</span>
<span class="c1"># since adding the "text_simple" results in top axis</span>
<span class="n">text_referral_gray</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"REFERRAL"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">230</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">78</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#aaaaaa"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">final_markers</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">line_rest</span> <span class="o">+</span> <span class="n">line_referral_markers</span> <span class="o">+</span> <span class="n">text_total</span> <span class="o">+</span> <span class="n">text_organic</span> <span class="o">+</span> <span class="n">text_referral_gray</span>
<span class="p">)</span>
<span class="n">final_markers</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[110]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-357cd28e0b6145bbac4da95323761b59.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-357cd28e0b6145bbac4da95323761b59.vega-embed details,
  #altair-viz-357cd28e0b6145bbac4da95323761b59.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-357cd28e0b6145bbac4da95323761b59"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-357cd28e0b6145bbac4da95323761b59") {
      outputDiv = document.getElementById("altair-viz-357cd28e0b6145bbac4da95323761b59");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "strokeWidth": 3}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa"]}, "type": "nominal"}, "opacity": {"value": 1}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "title": {"text": "Conversion rate over time", "anchor": "start", "fontSize": 17, "fontWeight": "normal"}, "transform": [{"filter": {"field": "Metric", "oneOf": ["ORGANIC", "TOTAL"]}}]}, {"mark": {"type": "line", "point": true, "strokeWidth": 3}, "encoding": {"color": {"value": "#aaaaaa"}, "opacity": {"value": 1}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "transform": [{"filter": {"equal": "REFERRAL", "field": "Metric"}}]}, {"data": {"name": "data-9cf0f3738d14cac59bc2e0c7ef16c2b3"}, "mark": {"type": "text", "align": "left", "color": "#aaaaaa", "dx": 230, "dy": -37, "size": 13}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-885531ff90f84f45e85d779e69d78fe2"}, "mark": {"type": "text", "align": "left", "color": "#aaaaaa", "dx": 230, "dy": 37, "size": 13}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-af960006992e8536783d4e2884e42787"}, "mark": {"type": "text", "align": "left", "color": "#aaaaaa", "dx": 230, "dy": 78, "size": 13}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-79200e94ab13e17b934630c35a39db52": [{"YEAR": 2005, "Metric": "TOTAL", "Value": 0.087}, {"YEAR": 2006, "Metric": "TOTAL", "Value": 0.083}, {"YEAR": 2007, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2008, "Metric": "TOTAL", "Value": 0.089}, {"YEAR": 2009, "Metric": "TOTAL", "Value": 0.084}, {"YEAR": 2010, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2011, "Metric": "TOTAL", "Value": 0.075}, {"YEAR": 2012, "Metric": "TOTAL", "Value": 0.07200000000000001}, {"YEAR": 2013, "Metric": "TOTAL", "Value": 0.069}, {"YEAR": 2014, "Metric": "TOTAL", "Value": 0.074}, {"YEAR": 2015, "Metric": "TOTAL", "Value": 0.066}, {"YEAR": 2016, "Metric": "TOTAL", "Value": 0.08}, {"YEAR": 2017, "Metric": "TOTAL", "Value": 0.07300000000000001}, {"YEAR": 2018, "Metric": "TOTAL", "Value": 0.07}, {"YEAR": 2019, "Metric": "TOTAL", "Value": 0.063}, {"YEAR": 2005, "Metric": "ORGANIC", "Value": 0.033}, {"YEAR": 2006, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2007, "Metric": "ORGANIC", "Value": 0.037}, {"YEAR": 2008, "Metric": "ORGANIC", "Value": 0.036}, {"YEAR": 2009, "Metric": "ORGANIC", "Value": 0.034}, {"YEAR": 2010, "Metric": "ORGANIC", "Value": 0.031}, {"YEAR": 2011, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2012, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2013, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2014, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2015, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2016, "Metric": "ORGANIC", "Value": 0.045}, {"YEAR": 2017, "Metric": "ORGANIC", "Value": 0.041}, {"YEAR": 2018, "Metric": "ORGANIC", "Value": 0.042}, {"YEAR": 2019, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2005, "Metric": "REFERRAL", "Value": 0.054}, {"YEAR": 2006, "Metric": "REFERRAL", "Value": 0.048}, {"YEAR": 2007, "Metric": "REFERRAL", "Value": 0.049}, {"YEAR": 2008, "Metric": "REFERRAL", "Value": 0.053}, {"YEAR": 2009, "Metric": "REFERRAL", "Value": 0.05}, {"YEAR": 2010, "Metric": "REFERRAL", "Value": 0.055}, {"YEAR": 2011, "Metric": "REFERRAL", "Value": 0.043}, {"YEAR": 2012, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2013, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2014, "Metric": "REFERRAL", "Value": 0.036}, {"YEAR": 2015, "Metric": "REFERRAL", "Value": 0.031}, {"YEAR": 2016, "Metric": "REFERRAL", "Value": 0.035}, {"YEAR": 2017, "Metric": "REFERRAL", "Value": 0.032}, {"YEAR": 2018, "Metric": "REFERRAL", "Value": 0.028}, {"YEAR": 2019, "Metric": "REFERRAL", "Value": 0.025}], "data-9cf0f3738d14cac59bc2e0c7ef16c2b3": [{"text": ["TOTAL"]}], "data-885531ff90f84f45e85d779e69d78fe2": [{"text": ["ORGANIC"]}], "data-af960006992e8536783d4e2884e42787": [{"text": ["REFERRAL"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_3m.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Add-data-labels">Add data labels<a class="anchor-link" href="#Add-data-labels"></a></h4><p>In addition to the markers, we can also add labels.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[111]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Coding for the labels</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s1">'left'</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'#aaaaaa'</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'YEAR:O'</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Value'</span><span class="p">),</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s1">'Value'</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s2">".1%"</span><span class="p">),</span>
    <span class="n">xOffset</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">yOffset</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">FieldEqualPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s1">'Metric'</span><span class="p">,</span> <span class="n">equal</span> <span class="o">=</span> <span class="s2">"REFERRAL"</span><span class="p">)</span>
    <span class="p">)</span>

<span class="n">final</span> <span class="o">=</span> <span class="n">line_rest</span> <span class="o">+</span> <span class="n">line_referral_markers</span> <span class="o">+</span> <span class="n">text_total</span> <span class="o">+</span> <span class="n">text_organic</span> <span class="o">+</span> <span class="n">text_referral_gray</span> <span class="o">+</span> <span class="n">label</span>
<span class="n">final</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[111]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-fc3047ac77f2471c95a792439f5e2f63.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-fc3047ac77f2471c95a792439f5e2f63.vega-embed details,
  #altair-viz-fc3047ac77f2471c95a792439f5e2f63.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-fc3047ac77f2471c95a792439f5e2f63"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-fc3047ac77f2471c95a792439f5e2f63") {
      outputDiv = document.getElementById("altair-viz-fc3047ac77f2471c95a792439f5e2f63");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "strokeWidth": 3}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa"]}, "type": "nominal"}, "opacity": {"value": 1}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "title": {"text": "Conversion rate over time", "anchor": "start", "fontSize": 17, "fontWeight": "normal"}, "transform": [{"filter": {"field": "Metric", "oneOf": ["ORGANIC", "TOTAL"]}}]}, {"mark": {"type": "line", "point": true, "strokeWidth": 3}, "encoding": {"color": {"value": "#aaaaaa"}, "opacity": {"value": 1}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "transform": [{"filter": {"equal": "REFERRAL", "field": "Metric"}}]}, {"data": {"name": "data-9cf0f3738d14cac59bc2e0c7ef16c2b3"}, "mark": {"type": "text", "align": "left", "color": "#aaaaaa", "dx": 230, "dy": -37, "size": 13}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-885531ff90f84f45e85d779e69d78fe2"}, "mark": {"type": "text", "align": "left", "color": "#aaaaaa", "dx": 230, "dy": 37, "size": 13}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-af960006992e8536783d4e2884e42787"}, "mark": {"type": "text", "align": "left", "color": "#aaaaaa", "dx": 230, "dy": 78, "size": 13}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "mark": {"type": "text", "align": "left", "color": "#aaaaaa", "dx": 3}, "encoding": {"text": {"field": "Value", "format": ".1%", "type": "quantitative"}, "x": {"field": "YEAR", "type": "ordinal"}, "xOffset": {"value": -10}, "y": {"field": "Value", "type": "quantitative"}, "yOffset": {"value": -10}}, "transform": [{"filter": {"equal": "REFERRAL", "field": "Metric"}}]}], "data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-79200e94ab13e17b934630c35a39db52": [{"YEAR": 2005, "Metric": "TOTAL", "Value": 0.087}, {"YEAR": 2006, "Metric": "TOTAL", "Value": 0.083}, {"YEAR": 2007, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2008, "Metric": "TOTAL", "Value": 0.089}, {"YEAR": 2009, "Metric": "TOTAL", "Value": 0.084}, {"YEAR": 2010, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2011, "Metric": "TOTAL", "Value": 0.075}, {"YEAR": 2012, "Metric": "TOTAL", "Value": 0.07200000000000001}, {"YEAR": 2013, "Metric": "TOTAL", "Value": 0.069}, {"YEAR": 2014, "Metric": "TOTAL", "Value": 0.074}, {"YEAR": 2015, "Metric": "TOTAL", "Value": 0.066}, {"YEAR": 2016, "Metric": "TOTAL", "Value": 0.08}, {"YEAR": 2017, "Metric": "TOTAL", "Value": 0.07300000000000001}, {"YEAR": 2018, "Metric": "TOTAL", "Value": 0.07}, {"YEAR": 2019, "Metric": "TOTAL", "Value": 0.063}, {"YEAR": 2005, "Metric": "ORGANIC", "Value": 0.033}, {"YEAR": 2006, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2007, "Metric": "ORGANIC", "Value": 0.037}, {"YEAR": 2008, "Metric": "ORGANIC", "Value": 0.036}, {"YEAR": 2009, "Metric": "ORGANIC", "Value": 0.034}, {"YEAR": 2010, "Metric": "ORGANIC", "Value": 0.031}, {"YEAR": 2011, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2012, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2013, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2014, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2015, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2016, "Metric": "ORGANIC", "Value": 0.045}, {"YEAR": 2017, "Metric": "ORGANIC", "Value": 0.041}, {"YEAR": 2018, "Metric": "ORGANIC", "Value": 0.042}, {"YEAR": 2019, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2005, "Metric": "REFERRAL", "Value": 0.054}, {"YEAR": 2006, "Metric": "REFERRAL", "Value": 0.048}, {"YEAR": 2007, "Metric": "REFERRAL", "Value": 0.049}, {"YEAR": 2008, "Metric": "REFERRAL", "Value": 0.053}, {"YEAR": 2009, "Metric": "REFERRAL", "Value": 0.05}, {"YEAR": 2010, "Metric": "REFERRAL", "Value": 0.055}, {"YEAR": 2011, "Metric": "REFERRAL", "Value": 0.043}, {"YEAR": 2012, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2013, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2014, "Metric": "REFERRAL", "Value": 0.036}, {"YEAR": 2015, "Metric": "REFERRAL", "Value": 0.031}, {"YEAR": 2016, "Metric": "REFERRAL", "Value": 0.035}, {"YEAR": 2017, "Metric": "REFERRAL", "Value": 0.032}, {"YEAR": 2018, "Metric": "REFERRAL", "Value": 0.028}, {"YEAR": 2019, "Metric": "REFERRAL", "Value": 0.025}], "data-9cf0f3738d14cac59bc2e0c7ef16c2b3": [{"text": ["TOTAL"]}], "data-885531ff90f84f45e85d779e69d78fe2": [{"text": ["ORGANIC"]}], "data-af960006992e8536783d4e2884e42787": [{"text": ["REFERRAL"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_3n.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Add-end-markers-and-labels">Add end markers and labels<a class="anchor-link" href="#Add-end-markers-and-labels"></a></h4><p>Instead of adding a marker and label to every data in Referral, we can add it only to the end of each line.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[112]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Text with the Metric</span>
<span class="n">text</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">baseline</span> <span class="o">=</span> <span class="s2">"middle"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">55</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"YEAR"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="s2">"max"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"argmax"</span><span class="p">:</span> <span class="s2">"YEAR"</span><span class="p">}),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s2">"Metric"</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#aaaaaa"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Text with the Value</span>
<span class="n">text2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#aaaaaa"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"YEAR:O"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s2">".1%"</span><span class="p">),</span>
        <span class="n">xOffset</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">225</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">FieldEqualPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"YEAR"</span><span class="p">,</span> <span class="n">equal</span> <span class="o">=</span> <span class="mi">2019</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Add end point</span>
<span class="n">point</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#aaaaaa"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"YEAR:O"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">),</span> <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">FieldEqualPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"YEAR"</span><span class="p">,</span> <span class="n">equal</span> <span class="o">=</span> <span class="s2">"2019"</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">line_simple</span> <span class="o">+</span> <span class="n">text</span> <span class="o">+</span> <span class="n">text2</span> <span class="o">+</span> <span class="n">point</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[112]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-b60879f30b314a268e19f0a26cb035ca.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-b60879f30b314a268e19f0a26cb035ca.vega-embed details,
  #altair-viz-b60879f30b314a268e19f0a26cb035ca.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-b60879f30b314a268e19f0a26cb035ca"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-b60879f30b314a268e19f0a26cb035ca") {
      outputDiv = document.getElementById("altair-viz-b60879f30b314a268e19f0a26cb035ca");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "strokeWidth": 3}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "title": {"text": "Conversion rate over time", "anchor": "start", "fontSize": 17, "fontWeight": "normal"}}, {"mark": {"type": "text", "align": "left", "baseline": "middle", "dx": 55, "size": 13}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa"]}, "type": "nominal"}, "text": {"field": "Metric", "type": "nominal"}, "x": {"aggregate": "max", "axis": null, "field": "YEAR", "type": "quantitative"}, "y": {"aggregate": {"argmax": "YEAR"}, "field": "Value", "type": "quantitative"}}}, {"mark": {"type": "text", "align": "left", "color": "#aaaaaa"}, "encoding": {"text": {"field": "Value", "format": ".1%", "type": "quantitative"}, "x": {"axis": null, "field": "YEAR", "type": "ordinal"}, "xOffset": {"value": 225}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": {"equal": 2019, "field": "YEAR"}}]}, {"mark": {"type": "point", "color": "#aaaaaa", "filled": true}, "encoding": {"opacity": {"value": 1}, "x": {"axis": null, "field": "YEAR", "type": "ordinal"}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": {"equal": "2019", "field": "YEAR"}}]}], "data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-79200e94ab13e17b934630c35a39db52": [{"YEAR": 2005, "Metric": "TOTAL", "Value": 0.087}, {"YEAR": 2006, "Metric": "TOTAL", "Value": 0.083}, {"YEAR": 2007, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2008, "Metric": "TOTAL", "Value": 0.089}, {"YEAR": 2009, "Metric": "TOTAL", "Value": 0.084}, {"YEAR": 2010, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2011, "Metric": "TOTAL", "Value": 0.075}, {"YEAR": 2012, "Metric": "TOTAL", "Value": 0.07200000000000001}, {"YEAR": 2013, "Metric": "TOTAL", "Value": 0.069}, {"YEAR": 2014, "Metric": "TOTAL", "Value": 0.074}, {"YEAR": 2015, "Metric": "TOTAL", "Value": 0.066}, {"YEAR": 2016, "Metric": "TOTAL", "Value": 0.08}, {"YEAR": 2017, "Metric": "TOTAL", "Value": 0.07300000000000001}, {"YEAR": 2018, "Metric": "TOTAL", "Value": 0.07}, {"YEAR": 2019, "Metric": "TOTAL", "Value": 0.063}, {"YEAR": 2005, "Metric": "ORGANIC", "Value": 0.033}, {"YEAR": 2006, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2007, "Metric": "ORGANIC", "Value": 0.037}, {"YEAR": 2008, "Metric": "ORGANIC", "Value": 0.036}, {"YEAR": 2009, "Metric": "ORGANIC", "Value": 0.034}, {"YEAR": 2010, "Metric": "ORGANIC", "Value": 0.031}, {"YEAR": 2011, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2012, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2013, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2014, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2015, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2016, "Metric": "ORGANIC", "Value": 0.045}, {"YEAR": 2017, "Metric": "ORGANIC", "Value": 0.041}, {"YEAR": 2018, "Metric": "ORGANIC", "Value": 0.042}, {"YEAR": 2019, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2005, "Metric": "REFERRAL", "Value": 0.054}, {"YEAR": 2006, "Metric": "REFERRAL", "Value": 0.048}, {"YEAR": 2007, "Metric": "REFERRAL", "Value": 0.049}, {"YEAR": 2008, "Metric": "REFERRAL", "Value": 0.053}, {"YEAR": 2009, "Metric": "REFERRAL", "Value": 0.05}, {"YEAR": 2010, "Metric": "REFERRAL", "Value": 0.055}, {"YEAR": 2011, "Metric": "REFERRAL", "Value": 0.043}, {"YEAR": 2012, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2013, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2014, "Metric": "REFERRAL", "Value": 0.036}, {"YEAR": 2015, "Metric": "REFERRAL", "Value": 0.031}, {"YEAR": 2016, "Metric": "REFERRAL", "Value": 0.035}, {"YEAR": 2017, "Metric": "REFERRAL", "Value": 0.032}, {"YEAR": 2018, "Metric": "REFERRAL", "Value": 0.028}, {"YEAR": 2019, "Metric": "REFERRAL", "Value": 0.025}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>The points appear to be in the incorrect location on the x-axis. Interestingly, running the visualization without the text elements seems to alter their positions.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[113]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">line</span> <span class="o">+</span> <span class="n">point</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[113]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-4fec773ae8464505ba1f0b3c770a1238.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-4fec773ae8464505ba1f0b3c770a1238.vega-embed details,
  #altair-viz-4fec773ae8464505ba1f0b3c770a1238.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-4fec773ae8464505ba1f0b3c770a1238"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-4fec773ae8464505ba1f0b3c770a1238") {
      outputDiv = document.getElementById("altair-viz-4fec773ae8464505ba1f0b3c770a1238");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "strokeWidth": 3}, "encoding": {"color": {"field": "Metric", "scale": {"range": ["#aaaaaa"]}, "type": "nominal"}, "opacity": {"condition": {"param": "param_5", "value": 1}, "value": 0}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "name": "view_5", "title": {"text": "Conversion rate over time: Referral decreasing markedly since 2010", "anchor": "start", "fontSize": 17, "fontWeight": "normal"}, "transform": [{"filter": {"param": "param_5"}}]}, {"mark": {"type": "point", "color": "#aaaaaa", "filled": true}, "encoding": {"opacity": {"value": 1}, "x": {"axis": null, "field": "YEAR", "type": "ordinal"}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": {"equal": "2019", "field": "YEAR"}}]}], "data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "params": [{"name": "param_5", "select": {"type": "point", "fields": ["Metric"]}, "views": ["view_5"]}], "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-79200e94ab13e17b934630c35a39db52": [{"YEAR": 2005, "Metric": "TOTAL", "Value": 0.087}, {"YEAR": 2006, "Metric": "TOTAL", "Value": 0.083}, {"YEAR": 2007, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2008, "Metric": "TOTAL", "Value": 0.089}, {"YEAR": 2009, "Metric": "TOTAL", "Value": 0.084}, {"YEAR": 2010, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2011, "Metric": "TOTAL", "Value": 0.075}, {"YEAR": 2012, "Metric": "TOTAL", "Value": 0.07200000000000001}, {"YEAR": 2013, "Metric": "TOTAL", "Value": 0.069}, {"YEAR": 2014, "Metric": "TOTAL", "Value": 0.074}, {"YEAR": 2015, "Metric": "TOTAL", "Value": 0.066}, {"YEAR": 2016, "Metric": "TOTAL", "Value": 0.08}, {"YEAR": 2017, "Metric": "TOTAL", "Value": 0.07300000000000001}, {"YEAR": 2018, "Metric": "TOTAL", "Value": 0.07}, {"YEAR": 2019, "Metric": "TOTAL", "Value": 0.063}, {"YEAR": 2005, "Metric": "ORGANIC", "Value": 0.033}, {"YEAR": 2006, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2007, "Metric": "ORGANIC", "Value": 0.037}, {"YEAR": 2008, "Metric": "ORGANIC", "Value": 0.036}, {"YEAR": 2009, "Metric": "ORGANIC", "Value": 0.034}, {"YEAR": 2010, "Metric": "ORGANIC", "Value": 0.031}, {"YEAR": 2011, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2012, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2013, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2014, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2015, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2016, "Metric": "ORGANIC", "Value": 0.045}, {"YEAR": 2017, "Metric": "ORGANIC", "Value": 0.041}, {"YEAR": 2018, "Metric": "ORGANIC", "Value": 0.042}, {"YEAR": 2019, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2005, "Metric": "REFERRAL", "Value": 0.054}, {"YEAR": 2006, "Metric": "REFERRAL", "Value": 0.048}, {"YEAR": 2007, "Metric": "REFERRAL", "Value": 0.049}, {"YEAR": 2008, "Metric": "REFERRAL", "Value": 0.053}, {"YEAR": 2009, "Metric": "REFERRAL", "Value": 0.05}, {"YEAR": 2010, "Metric": "REFERRAL", "Value": 0.055}, {"YEAR": 2011, "Metric": "REFERRAL", "Value": 0.043}, {"YEAR": 2012, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2013, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2014, "Metric": "REFERRAL", "Value": 0.036}, {"YEAR": 2015, "Metric": "REFERRAL", "Value": 0.031}, {"YEAR": 2016, "Metric": "REFERRAL", "Value": 0.035}, {"YEAR": 2017, "Metric": "REFERRAL", "Value": 0.032}, {"YEAR": 2018, "Metric": "REFERRAL", "Value": 0.028}, {"YEAR": 2019, "Metric": "REFERRAL", "Value": 0.025}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>To solve this issue, we will simply offset the point in the axis until they are in the right place.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[114]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">point</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'#aaaaaa'</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">'YEAR:O'</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Value'</span><span class="p">),</span>
    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <span class="c1"># Offset points in the x-axis</span>
    <span class="n">xOffset</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">217</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">FieldEqualPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s1">'YEAR'</span><span class="p">,</span> <span class="n">equal</span> <span class="o">=</span> <span class="s1">'2019'</span><span class="p">)</span>
    <span class="p">)</span>

<span class="n">final</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">text</span> <span class="o">+</span> <span class="n">text2</span> <span class="o">+</span> <span class="n">point</span>
<span class="n">final</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[114]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-fd71a3d0282646bb8cdd29e3468f4905.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-fd71a3d0282646bb8cdd29e3468f4905.vega-embed details,
  #altair-viz-fd71a3d0282646bb8cdd29e3468f4905.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-fd71a3d0282646bb8cdd29e3468f4905"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-fd71a3d0282646bb8cdd29e3468f4905") {
      outputDiv = document.getElementById("altair-viz-fd71a3d0282646bb8cdd29e3468f4905");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line", "strokeWidth": 3}, "encoding": {"color": {"field": "Metric", "scale": {"range": ["#aaaaaa"]}, "type": "nominal"}, "opacity": {"condition": {"param": "param_5", "value": 1}, "value": 0}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}, "name": "view_6", "title": {"text": "Conversion rate over time: Referral decreasing markedly since 2010", "anchor": "start", "fontSize": 17, "fontWeight": "normal"}, "transform": [{"filter": {"param": "param_5"}}]}, {"mark": {"type": "text", "align": "left", "baseline": "middle", "dx": 55, "size": 13}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa"]}, "type": "nominal"}, "text": {"field": "Metric", "type": "nominal"}, "x": {"aggregate": "max", "axis": null, "field": "YEAR", "type": "quantitative"}, "y": {"aggregate": {"argmax": "YEAR"}, "field": "Value", "type": "quantitative"}}}, {"mark": {"type": "text", "align": "left", "color": "#aaaaaa"}, "encoding": {"text": {"field": "Value", "format": ".1%", "type": "quantitative"}, "x": {"axis": null, "field": "YEAR", "type": "ordinal"}, "xOffset": {"value": 225}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": {"equal": 2019, "field": "YEAR"}}]}, {"mark": {"type": "point", "color": "#aaaaaa", "filled": true}, "encoding": {"opacity": {"value": 1}, "x": {"axis": null, "field": "YEAR", "type": "ordinal"}, "xOffset": {"value": 217}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": {"equal": "2019", "field": "YEAR"}}]}], "data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "params": [{"name": "param_5", "select": {"type": "point", "fields": ["Metric"]}, "views": ["view_6"]}], "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-79200e94ab13e17b934630c35a39db52": [{"YEAR": 2005, "Metric": "TOTAL", "Value": 0.087}, {"YEAR": 2006, "Metric": "TOTAL", "Value": 0.083}, {"YEAR": 2007, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2008, "Metric": "TOTAL", "Value": 0.089}, {"YEAR": 2009, "Metric": "TOTAL", "Value": 0.084}, {"YEAR": 2010, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2011, "Metric": "TOTAL", "Value": 0.075}, {"YEAR": 2012, "Metric": "TOTAL", "Value": 0.07200000000000001}, {"YEAR": 2013, "Metric": "TOTAL", "Value": 0.069}, {"YEAR": 2014, "Metric": "TOTAL", "Value": 0.074}, {"YEAR": 2015, "Metric": "TOTAL", "Value": 0.066}, {"YEAR": 2016, "Metric": "TOTAL", "Value": 0.08}, {"YEAR": 2017, "Metric": "TOTAL", "Value": 0.07300000000000001}, {"YEAR": 2018, "Metric": "TOTAL", "Value": 0.07}, {"YEAR": 2019, "Metric": "TOTAL", "Value": 0.063}, {"YEAR": 2005, "Metric": "ORGANIC", "Value": 0.033}, {"YEAR": 2006, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2007, "Metric": "ORGANIC", "Value": 0.037}, {"YEAR": 2008, "Metric": "ORGANIC", "Value": 0.036}, {"YEAR": 2009, "Metric": "ORGANIC", "Value": 0.034}, {"YEAR": 2010, "Metric": "ORGANIC", "Value": 0.031}, {"YEAR": 2011, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2012, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2013, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2014, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2015, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2016, "Metric": "ORGANIC", "Value": 0.045}, {"YEAR": 2017, "Metric": "ORGANIC", "Value": 0.041}, {"YEAR": 2018, "Metric": "ORGANIC", "Value": 0.042}, {"YEAR": 2019, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2005, "Metric": "REFERRAL", "Value": 0.054}, {"YEAR": 2006, "Metric": "REFERRAL", "Value": 0.048}, {"YEAR": 2007, "Metric": "REFERRAL", "Value": 0.049}, {"YEAR": 2008, "Metric": "REFERRAL", "Value": 0.053}, {"YEAR": 2009, "Metric": "REFERRAL", "Value": 0.05}, {"YEAR": 2010, "Metric": "REFERRAL", "Value": 0.055}, {"YEAR": 2011, "Metric": "REFERRAL", "Value": 0.043}, {"YEAR": 2012, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2013, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2014, "Metric": "REFERRAL", "Value": 0.036}, {"YEAR": 2015, "Metric": "REFERRAL", "Value": 0.031}, {"YEAR": 2016, "Metric": "REFERRAL", "Value": 0.035}, {"YEAR": 2017, "Metric": "REFERRAL", "Value": 0.032}, {"YEAR": 2018, "Metric": "REFERRAL", "Value": 0.028}, {"YEAR": 2019, "Metric": "REFERRAL", "Value": 0.025}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_3o.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Combine">Combine<a class="anchor-link" href="#Combine"></a></h4><p>To conclude the exercise, we will combine some attributes into one single graph. We will make a thicker colored line, with data markers and data labels, along with tied texts.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[115]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Red and thicker referral line</span>
<span class="n">line_red_thicker</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">melted_table</span> <span class="c1"># We need to add the title separately</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">()</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"YEAR:O"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"FISCAL YEAR"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"CONVERSION RATE"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span>
            <span class="c1"># The hex code in the middle corresponds to the referral line</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#aaaaaa"</span><span class="p">,</span> <span class="s2">"#d24b53"</span><span class="p">,</span> <span class="s2">"#aaaaaa"</span><span class="p">]),</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">strokeWidth</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="c1"># Make Referral line thicker</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">[</span><span class="s2">"Metric"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"REFERRAL"</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>        
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Red text with Metric</span>
<span class="n">text_red</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">baseline</span> <span class="o">=</span> <span class="s2">"middle"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">55</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"YEAR"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="s2">"max"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"argmax"</span><span class="p">:</span> <span class="s2">"YEAR"</span><span class="p">}),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s2">"Metric"</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#aaaaaa"</span><span class="p">,</span> <span class="s2">"#d24b53"</span><span class="p">,</span> <span class="s2">"#aaaaaa"</span><span class="p">]),</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Red text with Value</span>
<span class="n">text2_red</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"YEAR:O"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s2">".1%"</span><span class="p">),</span>
        <span class="n">xOffset</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">225</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#aaaaaa"</span><span class="p">,</span> <span class="s2">"#d24b53"</span><span class="p">,</span> <span class="s2">"#aaaaaa"</span><span class="p">]),</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">FieldEqualPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"YEAR"</span><span class="p">,</span> <span class="n">equal</span> <span class="o">=</span> <span class="mi">2019</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Red points</span>
<span class="n">point_red</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"YEAR:O"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">),</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">xOffset</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">217</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#aaaaaa"</span><span class="p">,</span> <span class="s2">"#d24b53"</span><span class="p">,</span> <span class="s2">"#aaaaaa"</span><span class="p">]),</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">FieldEqualPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"YEAR"</span><span class="p">,</span> <span class="n">equal</span> <span class="o">=</span> <span class="s2">"2019"</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># End points</span>
<span class="n">other_points</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#d24b53"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"YEAR:O"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">),</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"YEAR"</span><span class="p">,</span> <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"2010"</span><span class="p">,</span> <span class="s2">"2016"</span><span class="p">]))</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">FieldEqualPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">equal</span> <span class="o">=</span> <span class="s2">"REFERRAL"</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">line_red_thicker</span> <span class="o">+</span> <span class="n">text_red</span> <span class="o">+</span> <span class="n">text2_red</span> <span class="o">+</span> <span class="n">point_red</span> <span class="o">+</span> <span class="n">other_points</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[115]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-7c249115c42f435baae54d08d9f40985.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-7c249115c42f435baae54d08d9f40985.vega-embed details,
  #altair-viz-7c249115c42f435baae54d08d9f40985.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-7c249115c42f435baae54d08d9f40985"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-7c249115c42f435baae54d08d9f40985") {
      outputDiv = document.getElementById("altair-viz-7c249115c42f435baae54d08d9f40985");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa", "#d24b53", "#aaaaaa"]}, "type": "nominal"}, "strokeWidth": {"condition": {"test": "(datum['Metric'] === 'REFERRAL')", "value": 4}, "value": 2}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}}, {"mark": {"type": "text", "align": "left", "baseline": "middle", "dx": 55, "size": 13}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa", "#d24b53", "#aaaaaa"]}, "type": "nominal"}, "text": {"field": "Metric", "type": "nominal"}, "x": {"aggregate": "max", "axis": null, "field": "YEAR", "type": "quantitative"}, "y": {"aggregate": {"argmax": "YEAR"}, "field": "Value", "type": "quantitative"}}}, {"mark": {"type": "text", "align": "left"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa", "#d24b53", "#aaaaaa"]}, "type": "nominal"}, "text": {"field": "Value", "format": ".1%", "type": "quantitative"}, "x": {"axis": null, "field": "YEAR", "type": "ordinal"}, "xOffset": {"value": 225}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": {"equal": 2019, "field": "YEAR"}}]}, {"mark": {"type": "point", "filled": true}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa", "#d24b53", "#aaaaaa"]}, "type": "nominal"}, "opacity": {"value": 1}, "x": {"axis": null, "field": "YEAR", "type": "ordinal"}, "xOffset": {"value": 217}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": {"equal": "2019", "field": "YEAR"}}]}, {"mark": {"type": "point", "color": "#d24b53", "filled": true}, "encoding": {"opacity": {"value": 1}, "x": {"axis": null, "field": "YEAR", "type": "ordinal"}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": {"field": "YEAR", "oneOf": ["2010", "2016"]}}, {"filter": {"equal": "REFERRAL", "field": "Metric"}}]}], "data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-79200e94ab13e17b934630c35a39db52": [{"YEAR": 2005, "Metric": "TOTAL", "Value": 0.087}, {"YEAR": 2006, "Metric": "TOTAL", "Value": 0.083}, {"YEAR": 2007, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2008, "Metric": "TOTAL", "Value": 0.089}, {"YEAR": 2009, "Metric": "TOTAL", "Value": 0.084}, {"YEAR": 2010, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2011, "Metric": "TOTAL", "Value": 0.075}, {"YEAR": 2012, "Metric": "TOTAL", "Value": 0.07200000000000001}, {"YEAR": 2013, "Metric": "TOTAL", "Value": 0.069}, {"YEAR": 2014, "Metric": "TOTAL", "Value": 0.074}, {"YEAR": 2015, "Metric": "TOTAL", "Value": 0.066}, {"YEAR": 2016, "Metric": "TOTAL", "Value": 0.08}, {"YEAR": 2017, "Metric": "TOTAL", "Value": 0.07300000000000001}, {"YEAR": 2018, "Metric": "TOTAL", "Value": 0.07}, {"YEAR": 2019, "Metric": "TOTAL", "Value": 0.063}, {"YEAR": 2005, "Metric": "ORGANIC", "Value": 0.033}, {"YEAR": 2006, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2007, "Metric": "ORGANIC", "Value": 0.037}, {"YEAR": 2008, "Metric": "ORGANIC", "Value": 0.036}, {"YEAR": 2009, "Metric": "ORGANIC", "Value": 0.034}, {"YEAR": 2010, "Metric": "ORGANIC", "Value": 0.031}, {"YEAR": 2011, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2012, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2013, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2014, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2015, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2016, "Metric": "ORGANIC", "Value": 0.045}, {"YEAR": 2017, "Metric": "ORGANIC", "Value": 0.041}, {"YEAR": 2018, "Metric": "ORGANIC", "Value": 0.042}, {"YEAR": 2019, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2005, "Metric": "REFERRAL", "Value": 0.054}, {"YEAR": 2006, "Metric": "REFERRAL", "Value": 0.048}, {"YEAR": 2007, "Metric": "REFERRAL", "Value": 0.049}, {"YEAR": 2008, "Metric": "REFERRAL", "Value": 0.053}, {"YEAR": 2009, "Metric": "REFERRAL", "Value": 0.05}, {"YEAR": 2010, "Metric": "REFERRAL", "Value": 0.055}, {"YEAR": 2011, "Metric": "REFERRAL", "Value": 0.043}, {"YEAR": 2012, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2013, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2014, "Metric": "REFERRAL", "Value": 0.036}, {"YEAR": 2015, "Metric": "REFERRAL", "Value": 0.031}, {"YEAR": 2016, "Metric": "REFERRAL", "Value": 0.035}, {"YEAR": 2017, "Metric": "REFERRAL", "Value": 0.032}, {"YEAR": 2018, "Metric": "REFERRAL", "Value": 0.028}, {"YEAR": 2019, "Metric": "REFERRAL", "Value": 0.025}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Since rationally positioning the red points failed, we will manually insert the x and y values for each of them.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[116]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Red point from 2010</span>
<span class="n">point2010</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#d24b53"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"YEAR:O"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">),</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">xOffset</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="o">-</span><span class="mi">84</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># Filter only Referral 2010</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">FieldEqualPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"YEAR"</span><span class="p">,</span> <span class="n">equal</span> <span class="o">=</span> <span class="s2">"2010"</span><span class="p">))</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">FieldEqualPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">equal</span> <span class="o">=</span> <span class="s2">"REFERRAL"</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Red point for referral 2016</span>
<span class="n">point2016</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#d24b53"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"YEAR:O"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">),</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">xOffset</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">117</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">FieldEqualPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"YEAR"</span><span class="p">,</span> <span class="n">equal</span> <span class="o">=</span> <span class="s2">"2016"</span><span class="p">))</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">FieldEqualPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">equal</span> <span class="o">=</span> <span class="s2">"REFERRAL"</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Line connecting 2016 point with text</span>
<span class="n">rule2016</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">()</span>
    <span class="o">.</span><span class="n">mark_rule</span><span class="p">()</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">367</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="mf">0.034</span><span class="p">),</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="mf">0.013</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#aaaaaa"</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Line connecting 2010 point with text</span>
<span class="n">rule2010</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">()</span>
    <span class="o">.</span><span class="n">mark_rule</span><span class="p">()</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">166</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="mf">0.054</span><span class="p">),</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="mf">0.022</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#aaaaaa"</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Red part of text for 2010</span>
<span class="n">text2010red</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"2010: all time referral conversion high"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">87</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">93</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"bold"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#d24b53"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Red part of text for 2016</span>
<span class="n">text2016red</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"2016: new campaigns"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">115</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">118</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"bold"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#d24b53"</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Rest of text for 2010</span>
<span class="n">text2010gray</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">"values"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">"(5.5%). Strong partnerships historically"</span><span class="p">,</span>
                        <span class="s2">"meant steady conversions. Entry of"</span><span class="p">,</span>
                        <span class="s2">"competitor ABC has markedly impacted"</span><span class="p">,</span>
                        <span class="s2">"referral quality: fewer are buying."</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">87</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">105</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"bold"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#aaaaaa"</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Rest of text for 2016</span>
<span class="n">text2016gray</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="p">{</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"lead to brief uptick; steady"</span><span class="p">,</span> <span class="s2">"decrease since then."</span><span class="p">]}]}</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">115</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">130</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"bold"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#aaaaaa"</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># First half of title</span>
<span class="n">title_black</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Conversion rate over time: "</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">275</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">168</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Second half of title</span>
<span class="n">title_red</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"referral decreasing markedly since 2010"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">83</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">168</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#d24b53"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">final_combined</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">line_red_thicker</span>
    <span class="o">+</span> <span class="n">text_red</span>
    <span class="o">+</span> <span class="n">text2_red</span>
    <span class="o">+</span> <span class="n">rule2010</span>
    <span class="o">+</span> <span class="n">rule2016</span>
    <span class="o">+</span> <span class="n">point_red</span>
    <span class="o">+</span> <span class="n">point2010</span>
    <span class="o">+</span> <span class="n">point2016</span>
    <span class="o">+</span> <span class="n">text2010red</span>
    <span class="o">+</span> <span class="n">text2016red</span>
    <span class="o">+</span> <span class="n">text2010gray</span>
    <span class="o">+</span> <span class="n">text2016gray</span>
    <span class="o">+</span> <span class="n">title_black</span>
    <span class="o">+</span> <span class="n">title_red</span>
<span class="p">)</span>

<span class="n">final_combined</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[116]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-c01e695e843a4e97a08b5c0bdbdffa6c.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-c01e695e843a4e97a08b5c0bdbdffa6c.vega-embed details,
  #altair-viz-c01e695e843a4e97a08b5c0bdbdffa6c.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-c01e695e843a4e97a08b5c0bdbdffa6c"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-c01e695e843a4e97a08b5c0bdbdffa6c") {
      outputDiv = document.getElementById("altair-viz-c01e695e843a4e97a08b5c0bdbdffa6c");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa", "#d24b53", "#aaaaaa"]}, "type": "nominal"}, "strokeWidth": {"condition": {"test": "(datum['Metric'] === 'REFERRAL')", "value": 4}, "value": 2}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "YEAR", "scale": {"align": 0}, "title": "FISCAL YEAR", "type": "ordinal"}, "y": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 0.1]}, "title": "CONVERSION RATE", "type": "quantitative"}}}, {"mark": {"type": "text", "align": "left", "baseline": "middle", "dx": 55, "size": 13}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa", "#d24b53", "#aaaaaa"]}, "type": "nominal"}, "text": {"field": "Metric", "type": "nominal"}, "x": {"aggregate": "max", "axis": null, "field": "YEAR", "type": "quantitative"}, "y": {"aggregate": {"argmax": "YEAR"}, "field": "Value", "type": "quantitative"}}}, {"mark": {"type": "text", "align": "left"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa", "#d24b53", "#aaaaaa"]}, "type": "nominal"}, "text": {"field": "Value", "format": ".1%", "type": "quantitative"}, "x": {"axis": null, "field": "YEAR", "type": "ordinal"}, "xOffset": {"value": 225}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": {"equal": 2019, "field": "YEAR"}}]}, {"mark": {"type": "rule"}, "encoding": {"color": {"value": "#aaaaaa"}, "x": {"value": 166}, "y": {"datum": 0.054}, "y2": {"datum": 0.022}}}, {"mark": {"type": "rule"}, "encoding": {"color": {"value": "#aaaaaa"}, "x": {"value": 367}, "y": {"datum": 0.034}, "y2": {"datum": 0.013}}}, {"mark": {"type": "point", "filled": true}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#aaaaaa", "#d24b53", "#aaaaaa"]}, "type": "nominal"}, "opacity": {"value": 1}, "x": {"axis": null, "field": "YEAR", "type": "ordinal"}, "xOffset": {"value": 217}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": {"equal": "2019", "field": "YEAR"}}]}, {"mark": {"type": "point", "color": "#d24b53", "filled": true}, "encoding": {"opacity": {"value": 1}, "x": {"axis": null, "field": "YEAR", "type": "ordinal"}, "xOffset": {"value": -84}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": {"equal": "2010", "field": "YEAR"}}, {"filter": {"equal": "REFERRAL", "field": "Metric"}}]}, {"mark": {"type": "point", "color": "#d24b53", "filled": true}, "encoding": {"opacity": {"value": 1}, "x": {"axis": null, "field": "YEAR", "type": "ordinal"}, "xOffset": {"value": 117}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": {"equal": "2016", "field": "YEAR"}}, {"filter": {"equal": "REFERRAL", "field": "Metric"}}]}, {"data": {"name": "data-a3218370111950991f35d959bfe15980"}, "mark": {"type": "text", "align": "left", "color": "#d24b53", "dx": -87, "dy": 93, "fontWeight": "bold", "size": 10}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-eb17923731b36b48f04298a6c087995c"}, "mark": {"type": "text", "align": "left", "color": "#d24b53", "dx": 115, "dy": 118, "fontWeight": "bold", "size": 10}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-a3390e12bb5b24b51cc8d3f42f63891c"}, "mark": {"type": "text", "align": "left", "color": "#aaaaaa", "dx": -87, "dy": 105, "fontWeight": "bold", "size": 10}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-afa76c4efa3fa7e935e6a907184bb893"}, "mark": {"type": "text", "align": "left", "color": "#aaaaaa", "dx": 115, "dy": 130, "fontWeight": "bold", "size": 10}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-0dadc4b0852f853d9d2ed234d446fe07"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": -275, "dy": -168, "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-957aec6d2574b50e8211a956f6065ffe"}, "mark": {"type": "text", "align": "left", "color": "#d24b53", "dx": -83, "dy": -168, "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "data": {"name": "data-79200e94ab13e17b934630c35a39db52"}, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-79200e94ab13e17b934630c35a39db52": [{"YEAR": 2005, "Metric": "TOTAL", "Value": 0.087}, {"YEAR": 2006, "Metric": "TOTAL", "Value": 0.083}, {"YEAR": 2007, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2008, "Metric": "TOTAL", "Value": 0.089}, {"YEAR": 2009, "Metric": "TOTAL", "Value": 0.084}, {"YEAR": 2010, "Metric": "TOTAL", "Value": 0.086}, {"YEAR": 2011, "Metric": "TOTAL", "Value": 0.075}, {"YEAR": 2012, "Metric": "TOTAL", "Value": 0.07200000000000001}, {"YEAR": 2013, "Metric": "TOTAL", "Value": 0.069}, {"YEAR": 2014, "Metric": "TOTAL", "Value": 0.074}, {"YEAR": 2015, "Metric": "TOTAL", "Value": 0.066}, {"YEAR": 2016, "Metric": "TOTAL", "Value": 0.08}, {"YEAR": 2017, "Metric": "TOTAL", "Value": 0.07300000000000001}, {"YEAR": 2018, "Metric": "TOTAL", "Value": 0.07}, {"YEAR": 2019, "Metric": "TOTAL", "Value": 0.063}, {"YEAR": 2005, "Metric": "ORGANIC", "Value": 0.033}, {"YEAR": 2006, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2007, "Metric": "ORGANIC", "Value": 0.037}, {"YEAR": 2008, "Metric": "ORGANIC", "Value": 0.036}, {"YEAR": 2009, "Metric": "ORGANIC", "Value": 0.034}, {"YEAR": 2010, "Metric": "ORGANIC", "Value": 0.031}, {"YEAR": 2011, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2012, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2013, "Metric": "ORGANIC", "Value": 0.032}, {"YEAR": 2014, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2015, "Metric": "ORGANIC", "Value": 0.035}, {"YEAR": 2016, "Metric": "ORGANIC", "Value": 0.045}, {"YEAR": 2017, "Metric": "ORGANIC", "Value": 0.041}, {"YEAR": 2018, "Metric": "ORGANIC", "Value": 0.042}, {"YEAR": 2019, "Metric": "ORGANIC", "Value": 0.038}, {"YEAR": 2005, "Metric": "REFERRAL", "Value": 0.054}, {"YEAR": 2006, "Metric": "REFERRAL", "Value": 0.048}, {"YEAR": 2007, "Metric": "REFERRAL", "Value": 0.049}, {"YEAR": 2008, "Metric": "REFERRAL", "Value": 0.053}, {"YEAR": 2009, "Metric": "REFERRAL", "Value": 0.05}, {"YEAR": 2010, "Metric": "REFERRAL", "Value": 0.055}, {"YEAR": 2011, "Metric": "REFERRAL", "Value": 0.043}, {"YEAR": 2012, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2013, "Metric": "REFERRAL", "Value": 0.037}, {"YEAR": 2014, "Metric": "REFERRAL", "Value": 0.036}, {"YEAR": 2015, "Metric": "REFERRAL", "Value": 0.031}, {"YEAR": 2016, "Metric": "REFERRAL", "Value": 0.035}, {"YEAR": 2017, "Metric": "REFERRAL", "Value": 0.032}, {"YEAR": 2018, "Metric": "REFERRAL", "Value": 0.028}, {"YEAR": 2019, "Metric": "REFERRAL", "Value": 0.025}], "data-a3218370111950991f35d959bfe15980": [{"text": ["2010: all time referral conversion high"]}], "data-eb17923731b36b48f04298a6c087995c": [{"text": ["2016: new campaigns"]}], "data-a3390e12bb5b24b51cc8d3f42f63891c": [{"text": ["(5.5%). Strong partnerships historically", "meant steady conversions. Entry of", "competitor ABC has markedly impacted", "referral quality: fewer are buying."]}], "data-afa76c4efa3fa7e935e6a907184bb893": [{"text": ["lead to brief uptick; steady", "decrease since then."]}], "data-0dadc4b0852f853d9d2ed234d446fe07": [{"text": ["Conversion rate over time: "]}], "data-957aec6d2574b50e8211a956f6065ffe": [{"text": ["referral decreasing markedly since 2010"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/4_3p.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Chapter-5---Think-like-a-designer">Chapter 5 - Think like a designer<a name="5"></a><a class="anchor-link" href="#Chapter-5---Think-like-a-designer"></a></h2><p><em>"Where do you want your audience to look?"</em> - Cole Nussbaumer Knaflic</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Exercise-4---Design-in-style-(Inspired)">Exercise 4 - Design in style (Inspired)<a name="5.4"></a><a class="anchor-link" href="#Exercise-4---Design-in-style-(Inspired)"></a></h3><p>This exercise revolves around integrating brand design into graphs. While the author in the book focuses on creating a graph with a Coke and Light Coke theme, our approach takes it a step further. We will delve into various color inspirations using the most colorful graph thus far, which is the one from exercise 4.2.</p>
<p>We will separate the exercise into four categories: Accessibility, Branding, Paintings, and Nature.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Loading-data">Loading data<a class="anchor-link" href="#Loading-data"></a></h4><p>This is the same data as exercise 4.2.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[117]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Data\4.2 EXERCISE.xlsx"</span><span class="p">,</span> <span class="n">usecols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">skipfooter</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">table</span><span class="p">[</span><span class="s1">'Brands'</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">'Unnamed: 1'</span><span class="p">]</span>
<span class="n">table</span><span class="p">[</span><span class="s1">'Change'</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">'$ Vol </span><span class="si">% c</span><span class="s1">hange'</span><span class="p">]</span>

<span class="n">table</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Unnamed: 1'</span><span class="p">,</span> <span class="s1">'$ Vol </span><span class="si">% c</span><span class="s1">hange'</span><span class="p">],</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">table</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[117]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>spacing for dot plot</th>
<th>Brands</th>
<th>Change</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>Fran's Recipe</td>
<td>-0.14</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>Wholesome Goodness</td>
<td>-0.13</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>Lifestyle</td>
<td>-0.10</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>Coat protection</td>
<td>-0.09</td>
</tr>
<tr>
<th>4</th>
<td>4</td>
<td>Diet Lifestyle</td>
<td>-0.08</td>
</tr>
<tr>
<th>5</th>
<td>5</td>
<td>Feline Basics</td>
<td>-0.05</td>
</tr>
<tr>
<th>6</th>
<td>6</td>
<td>Lifestyle Plus</td>
<td>-0.04</td>
</tr>
<tr>
<th>7</th>
<td>7</td>
<td>Feline Freedom</td>
<td>-0.02</td>
</tr>
<tr>
<th>8</th>
<td>8</td>
<td>Feline Gold</td>
<td>0.01</td>
</tr>
<tr>
<th>9</th>
<td>9</td>
<td>Feline Platinum</td>
<td>0.01</td>
</tr>
<tr>
<th>10</th>
<td>10</td>
<td>Feline Instinct</td>
<td>0.02</td>
</tr>
<tr>
<th>11</th>
<td>11</td>
<td>Feline Pro</td>
<td>0.03</td>
</tr>
<tr>
<th>12</th>
<td>12</td>
<td>Farm Fresh Tasties</td>
<td>0.04</td>
</tr>
<tr>
<th>13</th>
<td>13</td>
<td>Feline Royal</td>
<td>0.05</td>
</tr>
<tr>
<th>14</th>
<td>14</td>
<td>Feline Focus</td>
<td>0.09</td>
</tr>
<tr>
<th>15</th>
<td>15</td>
<td>Feline Grain Free</td>
<td>0.09</td>
</tr>
<tr>
<th>16</th>
<td>16</td>
<td>Feline Silver</td>
<td>0.12</td>
</tr>
<tr>
<th>17</th>
<td>17</td>
<td>Nutri Balance</td>
<td>0.16</td>
</tr>
<tr>
<th>18</th>
<td>18</td>
<td>Farm Fresh Basics</td>
<td>0.17</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="The-original-graph">The original graph<a class="anchor-link" href="#The-original-graph"></a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[118]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">decreased_most</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">"Change"</span><span class="p">)</span>
<span class="n">increased_most</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">"Change"</span><span class="p">)</span>

<span class="n">brands_decreased</span> <span class="o">=</span> <span class="n">decreased_most</span><span class="p">[</span><span class="s2">"Brands"</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">brands_increased</span> <span class="o">=</span> <span class="n">increased_most</span><span class="p">[</span><span class="s2">"Brands"</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">conditions_decreased</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">'datum.Brands == "</span><span class="si">{</span><span class="n">brand</span><span class="si">}</span><span class="s1">"'</span> <span class="k">for</span> <span class="n">brand</span> <span class="ow">in</span> <span class="n">brands_decreased</span><span class="p">]</span>
<span class="n">condition_decreased</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"(</span><span class="si">{</span><span class="s1">'|'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conditions_decreased</span><span class="p">)</span><span class="si">}</span><span class="s2">)"</span>

<span class="n">conditions_increased</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">'datum.Brands == "</span><span class="si">{</span><span class="n">brand</span><span class="si">}</span><span class="s1">"'</span> <span class="k">for</span> <span class="n">brand</span> <span class="ow">in</span> <span class="n">brands_increased</span><span class="p">]</span>
<span class="n">condition_increased</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"(</span><span class="si">{</span><span class="s1">'|'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conditions_increased</span><span class="p">)</span><span class="si">}</span><span class="s2">)"</span>

<span class="n">chart_gray</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">"#c6c6c6"</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">orient</span> <span class="o">=</span> <span class="s2">"top"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">chart_oranges_mix</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">orient</span> <span class="o">=</span> <span class="s2">"top"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_decreased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#ec7c30"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#efb284"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Fran's Recipe"</span><span class="p">,</span>
                <span class="s2">"Wholesome Goodness"</span><span class="p">,</span>
                <span class="s2">"Lifestyle"</span><span class="p">,</span>
                <span class="s2">"Coat protection"</span><span class="p">,</span>
                <span class="s2">"Diet Lifestyle"</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">chart_blue_mix</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">orient</span> <span class="o">=</span> <span class="s2">"top"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_increased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#4772b8"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#91a9d5"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Feline Focus"</span><span class="p">,</span>
                <span class="s2">"Feline Grain Free"</span><span class="p">,</span>
                <span class="s2">"Feline Silver"</span><span class="p">,</span>
                <span class="s2">"Nutri Balance"</span><span class="p">,</span>
                <span class="s2">"Farm Fresh Basics"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">label1_gray</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#c6c6c6"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">207</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span> <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">label2_gray</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"right"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#c6c6c6"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">192</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span> <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">label_oranges</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">207</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_decreased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#ec7c30"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#efb284"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Fran's Recipe"</span><span class="p">,</span>
                <span class="s2">"Wholesome Goodness"</span><span class="p">,</span>
                <span class="s2">"Lifestyle"</span><span class="p">,</span>
                <span class="s2">"Coat protection"</span><span class="p">,</span>
                <span class="s2">"Diet Lifestyle"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>


<span class="n">label_blue</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"right"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">192</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_increased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#4772b8"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#91a9d5"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Feline Focus"</span><span class="p">,</span>
                <span class="s2">"Feline Grain Free"</span><span class="p">,</span>
                <span class="s2">"Feline Silver"</span><span class="p">,</span>
                <span class="s2">"Nutri Balance"</span><span class="p">,</span>
                <span class="s2">"Farm Fresh Basics"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">title_bw</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Cat food brands:"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">270</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">title_bw_bold</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Lifestyle line brands decline"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">78</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">270</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">title_bw_bold_2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"mixed results in sales year-over-year"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">78</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">270</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">subtitle_bw</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"YEAR-OVER-YEAR % CHANGE IN VOLUME ($)"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"gray"</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">decreased_orange</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"DECREASED"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">220</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#ec7c30"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">increased_blue</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"INCREASED"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">220</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#4772b8"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">separation</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"|"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">220</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#c6c6c6"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">original</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">chart_gray</span>
    <span class="o">+</span> <span class="n">chart_oranges_mix</span>
    <span class="o">+</span> <span class="n">chart_blue_mix</span>
    <span class="o">+</span> <span class="n">label1_gray</span>
    <span class="o">+</span> <span class="n">label2_gray</span>
    <span class="o">+</span> <span class="n">label_oranges</span>
    <span class="o">+</span> <span class="n">label_blue</span>
    <span class="o">+</span> <span class="n">title_bw</span>
    <span class="o">+</span> <span class="n">title_bw_bold_2</span>
    <span class="o">+</span> <span class="n">subtitle_bw</span>
    <span class="o">+</span> <span class="n">decreased_orange</span>
    <span class="o">+</span> <span class="n">increased_blue</span>
    <span class="o">+</span> <span class="n">separation</span>
<span class="p">)</span>

<span class="n">original</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[118]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-f8d1c0a8a5ee47ba8ce09055f99ebabd.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-f8d1c0a8a5ee47ba8ce09055f99ebabd.vega-embed details,
  #altair-viz-f8d1c0a8a5ee47ba8ce09055f99ebabd.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-f8d1c0a8a5ee47ba8ce09055f99ebabd"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-f8d1c0a8a5ee47ba8ce09055f99ebabd") {
      outputDiv = document.getElementById("altair-viz-f8d1c0a8a5ee47ba8ce09055f99ebabd");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "bar", "color": "#c6c6c6", "size": 15}, "encoding": {"x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Fran's Recipe\"|datum.Brands == \"Wholesome Goodness\")", "value": "#ec7c30"}, "value": "#efb284"}, "x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Fran's Recipe", "Wholesome Goodness", "Lifestyle", "Coat protection", "Diet Lifestyle"]}}]}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Farm Fresh Basics\"|datum.Brands == \"Nutri Balance\")", "value": "#4772b8"}, "value": "#91a9d5"}, "x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Feline Focus", "Feline Grain Free", "Feline Silver", "Nutri Balance", "Farm Fresh Basics"]}}]}, {"data": {"name": "data-0cc3663d469e54c83c8449d2705bfe37"}, "mark": {"type": "text", "align": "left", "color": "#c6c6c6", "fontWeight": 700}, "encoding": {"text": {"field": "Brands", "type": "nominal"}, "x": {"value": 207}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-ec5f7c8dc3e548f95008aa754a246610"}, "mark": {"type": "text", "align": "right", "color": "#c6c6c6", "fontWeight": 700}, "encoding": {"text": {"field": "Brands", "type": "nominal"}, "x": {"value": 192}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-0cc3663d469e54c83c8449d2705bfe37"}, "mark": {"type": "text", "align": "left", "fontWeight": 700}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Fran's Recipe\"|datum.Brands == \"Wholesome Goodness\")", "value": "#ec7c30"}, "value": "#efb284"}, "text": {"field": "Brands", "type": "nominal"}, "x": {"value": 207}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Fran's Recipe", "Wholesome Goodness", "Lifestyle", "Coat protection", "Diet Lifestyle"]}}]}, {"data": {"name": "data-ec5f7c8dc3e548f95008aa754a246610"}, "mark": {"type": "text", "align": "right", "fontWeight": 700}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Farm Fresh Basics\"|datum.Brands == \"Nutri Balance\")", "value": "#4772b8"}, "value": "#91a9d5"}, "text": {"field": "Brands", "type": "nominal"}, "x": {"value": 192}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Feline Focus", "Feline Grain Free", "Feline Silver", "Nutri Balance", "Farm Fresh Basics"]}}]}, {"data": {"name": "data-61ed60cd51bbea95a6d688536e3e2c35"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": -200, "dy": -270, "fontWeight": "normal", "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-3250e3b759259a267385e6508eb69b35"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": -78, "dy": -270, "fontWeight": 700, "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-ba11cdcb5208607813ec99b1dd569bab"}, "mark": {"type": "text", "align": "left", "color": "gray", "dx": -200, "dy": -250, "fontWeight": "normal", "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-3ecb015f60fd260c79b4fc4b31f64dd1"}, "mark": {"type": "text", "align": "left", "color": "#ec7c30", "dx": -80, "dy": -220, "fontWeight": 700, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-57e7b42d682c5889d2d5910745e9ec89"}, "mark": {"type": "text", "align": "left", "color": "#4772b8", "dx": 20, "dy": -220, "fontWeight": 700, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-f20e0fb6a7aa96b3235c63a327f85e9f"}, "mark": {"type": "text", "align": "left", "color": "#c6c6c6", "dx": 3, "dy": -220, "fontWeight": 700, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-0cc3663d469e54c83c8449d2705bfe37": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}], "data-ec5f7c8dc3e548f95008aa754a246610": [{"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-61ed60cd51bbea95a6d688536e3e2c35": [{"text": ["Cat food brands:"]}], "data-3250e3b759259a267385e6508eb69b35": [{"text": ["mixed results in sales year-over-year"]}], "data-ba11cdcb5208607813ec99b1dd569bab": [{"text": ["YEAR-OVER-YEAR % CHANGE IN VOLUME ($)"]}], "data-3ecb015f60fd260c79b4fc4b31f64dd1": [{"text": ["DECREASED"]}], "data-57e7b42d682c5889d2d5910745e9ec89": [{"text": ["INCREASED"]}], "data-f20e0fb6a7aa96b3235c63a327f85e9f": [{"text": ["|"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Accessibility">Accessibility<a class="anchor-link" href="#Accessibility"></a></h4><p>How do we assess the accessibility of the graph palette?</p>
<h5 id="Colorblind">Colorblind<a class="anchor-link" href="#Colorblind"></a></h5><p>First, we can start by checking if the original colors are accessible to people with color blindness. The online tool <a href="https://davidmathlogic.com/colorblind/#%23D81B60-%231E88E5-%23FFC107-%23004D40">Coloring for Colorblindness</a> helps simulate how your selected color palette appears to viewers with protanopia, deuteranopia (both being the inability to tell the difference between red and green), and tritanopia (inability to tell the difference between blue and green, purple and red, and yellow and pink), respectively.</p>
<p>The image below shows that our initial palette can be distinguished by those with these visual deficiency. The website also offers some famous colorblind friendly palette, such as the <a href="https://www.nature.com/articles/nmeth.1618">Wong palette</a>.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><img alt="Alt text" src="./Images/colorblind.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h5 id="Black-and-White">Black and White<a class="anchor-link" href="#Black-and-White"></a></h5><p>Although the complete inability to distinguish colors is very rare, having a black and white version of your graph can be beneficial in certain situations, such as when intending to print it in a newspaper or an article. By using the Microsoft Photos App, we can preview how our visualization would appear without colors.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><img alt="Alt text" src="./Images/bw.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Since the top and bottom colors can not be distinguished easily, we can create a new black and white palette.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[119]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Same graph as before, but</span>
<span class="c1"># with colors in the black and white spectrum</span>

<span class="n">chart_gray</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">"#666666"</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">orient</span> <span class="o">=</span> <span class="s2">"top"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">chart_light_gray_mix</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">orient</span> <span class="o">=</span> <span class="s2">"top"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_decreased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#bbbbbb"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#999999"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Fran's Recipe"</span><span class="p">,</span>
                <span class="s2">"Wholesome Goodness"</span><span class="p">,</span>
                <span class="s2">"Lifestyle"</span><span class="p">,</span>
                <span class="s2">"Coat protection"</span><span class="p">,</span>
                <span class="s2">"Diet Lifestyle"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">chart_black_mix</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">orient</span> <span class="o">=</span> <span class="s2">"top"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="nb">format</span> <span class="o">=</span> <span class="s2">"%"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_increased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"black"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#333333"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Feline Focus"</span><span class="p">,</span>
                <span class="s2">"Feline Grain Free"</span><span class="p">,</span>
                <span class="s2">"Feline Silver"</span><span class="p">,</span>
                <span class="s2">"Nutri Balance"</span><span class="p">,</span>
                <span class="s2">"Farm Fresh Basics"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">label1_gray</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#666666"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">207</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span> <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">label2_gray</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"right"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"#666666"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">192</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span> <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">label_light_gray</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">207</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_decreased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#bbbbbb"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#999999"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Fran's Recipe"</span><span class="p">,</span>
                <span class="s2">"Wholesome Goodness"</span><span class="p">,</span>
                <span class="s2">"Lifestyle"</span><span class="p">,</span>
                <span class="s2">"Coat protection"</span><span class="p">,</span>
                <span class="s2">"Diet Lifestyle"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>


<span class="n">label_black</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="s2">"Change"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"right"</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">192</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_increased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"black"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#333333"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Feline Focus"</span><span class="p">,</span>
                <span class="s2">"Feline Grain Free"</span><span class="p">,</span>
                <span class="s2">"Feline Silver"</span><span class="p">,</span>
                <span class="s2">"Nutri Balance"</span><span class="p">,</span>
                <span class="s2">"Farm Fresh Basics"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">title_bw</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Cat food brands:"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
        <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> 
        <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> 
        <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">270</span><span class="p">,</span> 
        <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span> 
        <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">decreased_light_gray</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"DECREASED"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> 
        <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> 
        <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> 
        <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">220</span><span class="p">,</span>
        <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> 
        <span class="n">color</span> <span class="o">=</span> <span class="s2">"#999999"</span>
        <span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">increased_black</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"INCREASED"</span><span class="p">]}]})</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> 
        <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> 
        <span class="n">dx</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> 
        <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">220</span><span class="p">,</span> 
        <span class="n">fontWeight</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> 
        <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span>
        <span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">black_and_white</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">chart_gray</span>
    <span class="o">+</span> <span class="n">chart_light_gray_mix</span>
    <span class="o">+</span> <span class="n">chart_black_mix</span>
    <span class="o">+</span> <span class="n">label1_gray</span>
    <span class="o">+</span> <span class="n">label2_gray</span>
    <span class="o">+</span> <span class="n">label_light_gray</span>
    <span class="o">+</span> <span class="n">label_black</span>
    <span class="o">+</span> <span class="n">title_bw</span>
    <span class="o">+</span> <span class="n">title_bw_bold_2</span>
    <span class="o">+</span> <span class="n">subtitle_bw</span>
    <span class="o">+</span> <span class="n">decreased_light_gray</span>
    <span class="o">+</span> <span class="n">increased_black</span>
    <span class="o">+</span> <span class="n">separation</span>
<span class="p">)</span>

<span class="n">black_and_white</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[119]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-7bd721dfc1e44da5b359e84624ad97b0.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-7bd721dfc1e44da5b359e84624ad97b0.vega-embed details,
  #altair-viz-7bd721dfc1e44da5b359e84624ad97b0.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-7bd721dfc1e44da5b359e84624ad97b0"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-7bd721dfc1e44da5b359e84624ad97b0") {
      outputDiv = document.getElementById("altair-viz-7bd721dfc1e44da5b359e84624ad97b0");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "bar", "color": "#666666", "size": 15}, "encoding": {"x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Fran's Recipe\"|datum.Brands == \"Wholesome Goodness\")", "value": "#bbbbbb"}, "value": "#999999"}, "x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Fran's Recipe", "Wholesome Goodness", "Lifestyle", "Coat protection", "Diet Lifestyle"]}}]}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Farm Fresh Basics\"|datum.Brands == \"Nutri Balance\")", "value": "black"}, "value": "#333333"}, "x": {"axis": {"format": "%", "grid": false, "labelColor": "#888888", "orient": "top", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Feline Focus", "Feline Grain Free", "Feline Silver", "Nutri Balance", "Farm Fresh Basics"]}}]}, {"data": {"name": "data-0cc3663d469e54c83c8449d2705bfe37"}, "mark": {"type": "text", "align": "left", "color": "#666666", "fontWeight": 700}, "encoding": {"text": {"field": "Brands", "type": "nominal"}, "x": {"value": 207}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-ec5f7c8dc3e548f95008aa754a246610"}, "mark": {"type": "text", "align": "right", "color": "#666666", "fontWeight": 700}, "encoding": {"text": {"field": "Brands", "type": "nominal"}, "x": {"value": 192}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}}, {"data": {"name": "data-0cc3663d469e54c83c8449d2705bfe37"}, "mark": {"type": "text", "align": "left", "fontWeight": 700}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Fran's Recipe\"|datum.Brands == \"Wholesome Goodness\")", "value": "#bbbbbb"}, "value": "#999999"}, "text": {"field": "Brands", "type": "nominal"}, "x": {"value": 207}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Fran's Recipe", "Wholesome Goodness", "Lifestyle", "Coat protection", "Diet Lifestyle"]}}]}, {"data": {"name": "data-ec5f7c8dc3e548f95008aa754a246610"}, "mark": {"type": "text", "align": "right", "fontWeight": 700}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Farm Fresh Basics\"|datum.Brands == \"Nutri Balance\")", "value": "black"}, "value": "#333333"}, "text": {"field": "Brands", "type": "nominal"}, "x": {"value": 192}, "y": {"field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Feline Focus", "Feline Grain Free", "Feline Silver", "Nutri Balance", "Farm Fresh Basics"]}}]}, {"data": {"name": "data-61ed60cd51bbea95a6d688536e3e2c35"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": -200, "dy": -270, "fontWeight": "normal", "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-3250e3b759259a267385e6508eb69b35"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": -78, "dy": -270, "fontWeight": 700, "size": 16}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-ba11cdcb5208607813ec99b1dd569bab"}, "mark": {"type": "text", "align": "left", "color": "gray", "dx": -200, "dy": -250, "fontWeight": "normal", "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-3ecb015f60fd260c79b4fc4b31f64dd1"}, "mark": {"type": "text", "align": "left", "color": "#999999", "dx": -80, "dy": -220, "fontWeight": 700, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-57e7b42d682c5889d2d5910745e9ec89"}, "mark": {"type": "text", "align": "left", "color": "black", "dx": 20, "dy": -220, "fontWeight": 700, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}, {"data": {"name": "data-f20e0fb6a7aa96b3235c63a327f85e9f"}, "mark": {"type": "text", "align": "left", "color": "#c6c6c6", "dx": 3, "dy": -220, "fontWeight": 700, "size": 11}, "encoding": {"text": {"field": "text", "type": "nominal"}}}], "data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-0cc3663d469e54c83c8449d2705bfe37": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}], "data-ec5f7c8dc3e548f95008aa754a246610": [{"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}], "data-61ed60cd51bbea95a6d688536e3e2c35": [{"text": ["Cat food brands:"]}], "data-3250e3b759259a267385e6508eb69b35": [{"text": ["mixed results in sales year-over-year"]}], "data-ba11cdcb5208607813ec99b1dd569bab": [{"text": ["YEAR-OVER-YEAR % CHANGE IN VOLUME ($)"]}], "data-3ecb015f60fd260c79b4fc4b31f64dd1": [{"text": ["DECREASED"]}], "data-57e7b42d682c5889d2d5910745e9ec89": [{"text": ["INCREASED"]}], "data-f20e0fb6a7aa96b3235c63a327f85e9f": [{"text": ["|"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Branding">Branding<a class="anchor-link" href="#Branding"></a></h4><p>Branding is a really important aspect of marketing. Most companies have set color palettes, logos and design. Tools such as <a href="https://imagecolorpicker.com/">Image Color Picker</a> and <a href="https://color.adobe.com/pt/create/image">Adobe Color</a> can help you extract and implement those official palettes into themed data visualizations. For the following graphs, we will not use labeling or titles, as it will not represent the cat food brands and be used only as a canvas for the palettes.</p>
<h5 id="Cookie-Clicker">Cookie Clicker<a class="anchor-link" href="#Cookie-Clicker"></a></h5><p><a href="https://orteil.dashnet.org/cookieclicker/">Cookie Clicker</a> is an idle game created by the French programmer Orteil, and it has been open in a separate tab baking and accumulating cookies throughout the entirety of this project. Hence, it only seems fitting to pay homage with a dedicated color palette!</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[120]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Orange middle (for the orange milk in the game)</span>
<span class="n">chart_middle</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">"#ee8241"</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Dark brown top (for the chocolate chips)</span>
<span class="n">chart_up</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_decreased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#4a251d"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#64433a"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Fran's Recipe"</span><span class="p">,</span>
                <span class="s2">"Wholesome Goodness"</span><span class="p">,</span>
                <span class="s2">"Lifestyle"</span><span class="p">,</span>
                <span class="s2">"Coat protection"</span><span class="p">,</span>
                <span class="s2">"Diet Lifestyle"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Light brown bottom (for the cookie dough)</span>
<span class="n">chart_down</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_increased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#81532d"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#c0a681"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Feline Focus"</span><span class="p">,</span>
                <span class="s2">"Feline Grain Free"</span><span class="p">,</span>
                <span class="s2">"Feline Silver"</span><span class="p">,</span>
                <span class="s2">"Nutri Balance"</span><span class="p">,</span>
                <span class="s2">"Farm Fresh Basics"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">cookie_clicker</span> <span class="o">=</span> <span class="n">chart_middle</span> <span class="o">+</span> <span class="n">chart_down</span> <span class="o">+</span> <span class="n">chart_up</span>

<span class="n">cookie_clicker</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[120]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-b76fa92d035345c380327f1ca5df93ae.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-b76fa92d035345c380327f1ca5df93ae.vega-embed details,
  #altair-viz-b76fa92d035345c380327f1ca5df93ae.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-b76fa92d035345c380327f1ca5df93ae"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-b76fa92d035345c380327f1ca5df93ae") {
      outputDiv = document.getElementById("altair-viz-b76fa92d035345c380327f1ca5df93ae");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "bar", "color": "#ee8241", "size": 15}, "encoding": {"x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Farm Fresh Basics\"|datum.Brands == \"Nutri Balance\")", "value": "#81532d"}, "value": "#c0a681"}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Feline Focus", "Feline Grain Free", "Feline Silver", "Nutri Balance", "Farm Fresh Basics"]}}]}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Fran's Recipe\"|datum.Brands == \"Wholesome Goodness\")", "value": "#4a251d"}, "value": "#64433a"}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Fran's Recipe", "Wholesome Goodness", "Lifestyle", "Coat protection", "Diet Lifestyle"]}}]}], "data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Game screenshot that inspired the color palette:</p>
<p><img alt="Alt text" src="./Images/cookieclicker.jpg"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h5 id="Google-Maps">Google Maps<a class="anchor-link" href="#Google-Maps"></a></h5><p>One of the most distinctive brand designs is the vibrant Google palette, widely employed in various apps associated with the company. Inspired by the Google Maps logo, which features precisely five colors, we will demonstrate how our graph looks when incorporating this design.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[122]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Green middle</span>
<span class="n">chart_middle</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">"#34A852"</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Red and yellow top</span>
<span class="n">chart_up</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_decreased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#EA4335"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#FABB04"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Fran's Recipe"</span><span class="p">,</span>
                <span class="s2">"Wholesome Goodness"</span><span class="p">,</span>
                <span class="s2">"Lifestyle"</span><span class="p">,</span>
                <span class="s2">"Coat protection"</span><span class="p">,</span>
                <span class="s2">"Diet Lifestyle"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Blue and light blue bottom</span>
<span class="n">chart_down</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_increased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#1A73E8"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#4285F4"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Feline Focus"</span><span class="p">,</span>
                <span class="s2">"Feline Grain Free"</span><span class="p">,</span>
                <span class="s2">"Feline Silver"</span><span class="p">,</span>
                <span class="s2">"Nutri Balance"</span><span class="p">,</span>
                <span class="s2">"Farm Fresh Basics"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">google</span> <span class="o">=</span> <span class="n">chart_middle</span> <span class="o">+</span> <span class="n">chart_down</span> <span class="o">+</span> <span class="n">chart_up</span>

<span class="n">google</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[122]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-d573cb337de14d3094a65e94595dd012.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-d573cb337de14d3094a65e94595dd012.vega-embed details,
  #altair-viz-d573cb337de14d3094a65e94595dd012.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-d573cb337de14d3094a65e94595dd012"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-d573cb337de14d3094a65e94595dd012") {
      outputDiv = document.getElementById("altair-viz-d573cb337de14d3094a65e94595dd012");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "bar", "color": "#34A852", "size": 15}, "encoding": {"x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Farm Fresh Basics\"|datum.Brands == \"Nutri Balance\")", "value": "#1A73E8"}, "value": "#4285F4"}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Feline Focus", "Feline Grain Free", "Feline Silver", "Nutri Balance", "Farm Fresh Basics"]}}]}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Fran's Recipe\"|datum.Brands == \"Wholesome Goodness\")", "value": "#EA4335"}, "value": "#FABB04"}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Fran's Recipe", "Wholesome Goodness", "Lifestyle", "Coat protection", "Diet Lifestyle"]}}]}], "data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Google maps logo used for reference:</p>
<p><img alt="Alt text" src="./Images/googlemapslogo.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Paintings">Paintings<a class="anchor-link" href="#Paintings"></a></h4><p>Artist spend their lives dedicated to the study of colors and how we as humans perceive them. We can draw inspiration from their work when searching to evoke a specific emotion through our visualizations.</p>
<h5 id="Starry-Night-by-Vincent-Van-Gogh">Starry Night by Vincent Van Gogh<a class="anchor-link" href="#Starry-Night-by-Vincent-Van-Gogh"></a></h5>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[123]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Light blue middle</span>
<span class="n">chart_middle</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">"#7B95A6"</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Yellow tones top for the stars</span>
<span class="n">chart_up</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_decreased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#A65D05"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#D9B13B"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Fran's Recipe"</span><span class="p">,</span>
                <span class="s2">"Wholesome Goodness"</span><span class="p">,</span>
                <span class="s2">"Lifestyle"</span><span class="p">,</span>
                <span class="s2">"Coat protection"</span><span class="p">,</span>
                <span class="s2">"Diet Lifestyle"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Blue tones bottom for the sky</span>
<span class="n">chart_down</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_increased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#0B1E38"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#304F8C"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Feline Focus"</span><span class="p">,</span>
                <span class="s2">"Feline Grain Free"</span><span class="p">,</span>
                <span class="s2">"Feline Silver"</span><span class="p">,</span>
                <span class="s2">"Nutri Balance"</span><span class="p">,</span>
                <span class="s2">"Farm Fresh Basics"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">starry_night</span> <span class="o">=</span> <span class="n">chart_middle</span> <span class="o">+</span> <span class="n">chart_down</span> <span class="o">+</span> <span class="n">chart_up</span>

<span class="n">starry_night</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[123]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-0f24f153fba74f91914b546a409f0515.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-0f24f153fba74f91914b546a409f0515.vega-embed details,
  #altair-viz-0f24f153fba74f91914b546a409f0515.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-0f24f153fba74f91914b546a409f0515"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-0f24f153fba74f91914b546a409f0515") {
      outputDiv = document.getElementById("altair-viz-0f24f153fba74f91914b546a409f0515");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "bar", "color": "#7B95A6", "size": 15}, "encoding": {"x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Farm Fresh Basics\"|datum.Brands == \"Nutri Balance\")", "value": "#0B1E38"}, "value": "#304F8C"}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Feline Focus", "Feline Grain Free", "Feline Silver", "Nutri Balance", "Farm Fresh Basics"]}}]}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Fran's Recipe\"|datum.Brands == \"Wholesome Goodness\")", "value": "#A65D05"}, "value": "#D9B13B"}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Fran's Recipe", "Wholesome Goodness", "Lifestyle", "Coat protection", "Diet Lifestyle"]}}]}], "data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Painting that inspired the palette:</p>
<p><img alt="Alt text" src="./Images/starry_night.jpg"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h5 id="A-Cuca-by-Tarsila-do-Amaral">A Cuca by Tarsila do Amaral<a class="anchor-link" href="#A-Cuca-by-Tarsila-do-Amaral"></a></h5>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[124]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Green middle for the plants</span>
<span class="n">chart_middle</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">"#034001"</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Blue and green top for the plants and pond</span>
<span class="n">chart_up</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_decreased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#0339A6"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#067302"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Fran's Recipe"</span><span class="p">,</span>
                <span class="s2">"Wholesome Goodness"</span><span class="p">,</span>
                <span class="s2">"Lifestyle"</span><span class="p">,</span>
                <span class="s2">"Coat protection"</span><span class="p">,</span>
                <span class="s2">"Diet Lifestyle"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Yellow and orange bottom for the Cuca</span>
<span class="n">chart_down</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_increased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#F25C05"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#F29F05"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Feline Focus"</span><span class="p">,</span>
                <span class="s2">"Feline Grain Free"</span><span class="p">,</span>
                <span class="s2">"Feline Silver"</span><span class="p">,</span>
                <span class="s2">"Nutri Balance"</span><span class="p">,</span>
                <span class="s2">"Farm Fresh Basics"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">cuca</span> <span class="o">=</span> <span class="n">chart_middle</span> <span class="o">+</span> <span class="n">chart_down</span> <span class="o">+</span> <span class="n">chart_up</span>

<span class="n">cuca</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[124]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-6e12c7b48a31475cb6e100a9258cb891.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-6e12c7b48a31475cb6e100a9258cb891.vega-embed details,
  #altair-viz-6e12c7b48a31475cb6e100a9258cb891.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-6e12c7b48a31475cb6e100a9258cb891"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-6e12c7b48a31475cb6e100a9258cb891") {
      outputDiv = document.getElementById("altair-viz-6e12c7b48a31475cb6e100a9258cb891");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "bar", "color": "#034001", "size": 15}, "encoding": {"x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Farm Fresh Basics\"|datum.Brands == \"Nutri Balance\")", "value": "#F25C05"}, "value": "#F29F05"}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Feline Focus", "Feline Grain Free", "Feline Silver", "Nutri Balance", "Farm Fresh Basics"]}}]}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Fran's Recipe\"|datum.Brands == \"Wholesome Goodness\")", "value": "#0339A6"}, "value": "#067302"}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Fran's Recipe", "Wholesome Goodness", "Lifestyle", "Coat protection", "Diet Lifestyle"]}}]}], "data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Painting that inspired the palette:</p>
<p><img alt="Alt text" src="./Images/cuca.webp"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h5 id="The-Great-Wave-Off-Kanagawa-by-Hokusai">The Great Wave Off Kanagawa by Hokusai<a class="anchor-link" href="#The-Great-Wave-Off-Kanagawa-by-Hokusai"></a></h5>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[125]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Light blue for the waves</span>
<span class="n">chart_middle</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">"#8FBABF"</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Beige top for the sky and boats</span>
<span class="n">chart_up</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_decreased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#E0C6A3"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#D9B779"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Fran's Recipe"</span><span class="p">,</span>
                <span class="s2">"Wholesome Goodness"</span><span class="p">,</span>
                <span class="s2">"Lifestyle"</span><span class="p">,</span>
                <span class="s2">"Coat protection"</span><span class="p">,</span>
                <span class="s2">"Diet Lifestyle"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Darker blue for the waves</span>
<span class="n">chart_down</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_increased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#010326"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#010B40"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Feline Focus"</span><span class="p">,</span>
                <span class="s2">"Feline Grain Free"</span><span class="p">,</span>
                <span class="s2">"Feline Silver"</span><span class="p">,</span>
                <span class="s2">"Nutri Balance"</span><span class="p">,</span>
                <span class="s2">"Farm Fresh Basics"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">wave</span> <span class="o">=</span> <span class="n">chart_middle</span> <span class="o">+</span> <span class="n">chart_down</span> <span class="o">+</span> <span class="n">chart_up</span>

<span class="n">wave</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[125]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-ffa2f59f8415404b84555cb5acf9b315.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-ffa2f59f8415404b84555cb5acf9b315.vega-embed details,
  #altair-viz-ffa2f59f8415404b84555cb5acf9b315.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-ffa2f59f8415404b84555cb5acf9b315"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-ffa2f59f8415404b84555cb5acf9b315") {
      outputDiv = document.getElementById("altair-viz-ffa2f59f8415404b84555cb5acf9b315");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "bar", "color": "#8FBABF", "size": 15}, "encoding": {"x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Farm Fresh Basics\"|datum.Brands == \"Nutri Balance\")", "value": "#010326"}, "value": "#010B40"}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Feline Focus", "Feline Grain Free", "Feline Silver", "Nutri Balance", "Farm Fresh Basics"]}}]}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Fran's Recipe\"|datum.Brands == \"Wholesome Goodness\")", "value": "#E0C6A3"}, "value": "#D9B779"}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Fran's Recipe", "Wholesome Goodness", "Lifestyle", "Coat protection", "Diet Lifestyle"]}}]}], "data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Painting that inspired the palette:</p>
<p><img alt="Alt text" src="./Images/great_wave.jpg"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Nature">Nature<a class="anchor-link" href="#Nature"></a></h4><p>Inspired by the use of imagery of roses in the works of <a href="https://theresamarierhyne.com/Theresa-Marie_Rhynes_Viewpoint/Applying_Color_Chapter.html">Theresa-Marie Rhyne</a>, we will extract the color palette from pictures of nature.</p>
<h5 id="Sunset">Sunset<a class="anchor-link" href="#Sunset"></a></h5><p>This picture was taken by Sergio Mena Ferraira and can be found <a href="https://unsplash.com/pt-br/fotografias/ondas-do-oceano-batendo-na-costa-durante-o-por-do-sol-N5sC8zZUgy4">here</a>.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[126]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Bright orange middle for the sun</span>
<span class="n">chart_middle</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">"#FF9200"</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Purple tones top for the sky</span>
<span class="n">chart_up</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_decreased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#AA4650"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#FD4044"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Fran's Recipe"</span><span class="p">,</span>
                <span class="s2">"Wholesome Goodness"</span><span class="p">,</span>
                <span class="s2">"Lifestyle"</span><span class="p">,</span>
                <span class="s2">"Coat protection"</span><span class="p">,</span>
                <span class="s2">"Diet Lifestyle"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Orange tones bottom for the sky</span>
<span class="n">chart_down</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_increased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#FA4210"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#FD7E37"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Feline Focus"</span><span class="p">,</span>
                <span class="s2">"Feline Grain Free"</span><span class="p">,</span>
                <span class="s2">"Feline Silver"</span><span class="p">,</span>
                <span class="s2">"Nutri Balance"</span><span class="p">,</span>
                <span class="s2">"Farm Fresh Basics"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">sunset</span> <span class="o">=</span> <span class="n">chart_middle</span> <span class="o">+</span> <span class="n">chart_down</span> <span class="o">+</span> <span class="n">chart_up</span>

<span class="n">sunset</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[126]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-363b7580c4ac41e0bea441dc455e1b30.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-363b7580c4ac41e0bea441dc455e1b30.vega-embed details,
  #altair-viz-363b7580c4ac41e0bea441dc455e1b30.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-363b7580c4ac41e0bea441dc455e1b30"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-363b7580c4ac41e0bea441dc455e1b30") {
      outputDiv = document.getElementById("altair-viz-363b7580c4ac41e0bea441dc455e1b30");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "bar", "color": "#FF9200", "size": 15}, "encoding": {"x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Farm Fresh Basics\"|datum.Brands == \"Nutri Balance\")", "value": "#FA4210"}, "value": "#FD7E37"}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Feline Focus", "Feline Grain Free", "Feline Silver", "Nutri Balance", "Farm Fresh Basics"]}}]}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Fran's Recipe\"|datum.Brands == \"Wholesome Goodness\")", "value": "#AA4650"}, "value": "#FD4044"}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Fran's Recipe", "Wholesome Goodness", "Lifestyle", "Coat protection", "Diet Lifestyle"]}}]}], "data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Picture that inspired the palette:</p>
<p><img alt="Alt text" src="./Images/sunset.webp"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h5 id="Forest">Forest<a class="anchor-link" href="#Forest"></a></h5><p>This picture was taken by Sam Abell and can be found <a href="https://education.nationalgeographic.org/resource/forest-biome/">here</a>.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[127]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Light green middle from leaves</span>
<span class="n">chart_middle</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">"#5C7346"</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Lighter green top from leaves</span>
<span class="n">chart_up</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_decreased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#ABD9A9"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#83A66A"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Fran's Recipe"</span><span class="p">,</span>
                <span class="s2">"Wholesome Goodness"</span><span class="p">,</span>
                <span class="s2">"Lifestyle"</span><span class="p">,</span>
                <span class="s2">"Coat protection"</span><span class="p">,</span>
                <span class="s2">"Diet Lifestyle"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Dark green and brown bottom from leaves and tree trunk</span>
<span class="n">chart_down</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Change"</span><span class="p">,</span> 
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
            <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="n">condition_increased</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#140F09"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#3B401B"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Brands"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Feline Focus"</span><span class="p">,</span>
                <span class="s2">"Feline Grain Free"</span><span class="p">,</span>
                <span class="s2">"Feline Silver"</span><span class="p">,</span>
                <span class="s2">"Nutri Balance"</span><span class="p">,</span>
                <span class="s2">"Farm Fresh Basics"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">forest</span> <span class="o">=</span> <span class="n">chart_middle</span> <span class="o">+</span> <span class="n">chart_down</span> <span class="o">+</span> <span class="n">chart_up</span>

<span class="n">forest</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[127]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-750887c1193d44ce89ac302c3159fb3b.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-750887c1193d44ce89ac302c3159fb3b.vega-embed details,
  #altair-viz-750887c1193d44ce89ac302c3159fb3b.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-750887c1193d44ce89ac302c3159fb3b"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-750887c1193d44ce89ac302c3159fb3b") {
      outputDiv = document.getElementById("altair-viz-750887c1193d44ce89ac302c3159fb3b");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "bar", "color": "#5C7346", "size": 15}, "encoding": {"x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Farm Fresh Basics\"|datum.Brands == \"Nutri Balance\")", "value": "#140F09"}, "value": "#3B401B"}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Feline Focus", "Feline Grain Free", "Feline Silver", "Nutri Balance", "Farm Fresh Basics"]}}]}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"condition": {"test": "(datum.Brands == \"Fran's Recipe\"|datum.Brands == \"Wholesome Goodness\")", "value": "#ABD9A9"}, "value": "#83A66A"}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Fran's Recipe", "Wholesome Goodness", "Lifestyle", "Coat protection", "Diet Lifestyle"]}}]}], "data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Picture that inspired the palette:</p>
<p><img alt="Alt text" src="./Images/forest.jpg"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Interactivity">Interactivity<a class="anchor-link" href="#Interactivity"></a></h4><p>For interactivity, we will empower the user to customize the palette of the graph without requiring any knowledge of Altair.</p>
<p>We have devised five charts, each representing a distinct color in this visualization. Additionally, we've provided a space where the viewer can select the hue in the spectrum or input the RGB, HSL or the hex code for each chart.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[128]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Create the color parameters, with default in the original graph</span>
<span class="n">color_one</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s2">"#ec7c30"</span><span class="p">,</span> <span class="n">bind</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding</span><span class="p">(</span><span class="nb">input</span> <span class="o">=</span> <span class="s1">'color'</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'First color: '</span><span class="p">))</span>
<span class="n">color_two</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s2">"#efb284"</span><span class="p">,</span> <span class="n">bind</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding</span><span class="p">(</span><span class="nb">input</span> <span class="o">=</span> <span class="s1">'color'</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'Second color: '</span><span class="p">))</span>
<span class="n">color_three</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s2">"#c6c6c6"</span><span class="p">,</span> <span class="n">bind</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding</span><span class="p">(</span><span class="nb">input</span> <span class="o">=</span> <span class="s1">'color'</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'Third color: '</span><span class="p">))</span>
<span class="n">color_four</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s2">"#91a9d5"</span><span class="p">,</span> <span class="n">bind</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding</span><span class="p">(</span><span class="nb">input</span> <span class="o">=</span> <span class="s1">'color'</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'Fourth color: '</span><span class="p">))</span>
<span class="n">color_five</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="s2">"#4772b8"</span><span class="p">,</span> <span class="n">bind</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding</span><span class="p">(</span><span class="nb">input</span> <span class="o">=</span> <span class="s1">'color'</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'Fifth color: '</span><span class="p">))</span>

<span class="c1"># First two bars</span>
<span class="n">chart_one</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span> 
        <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span>
        <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s2">"Change"</span><span class="p">,</span> 
        <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
        <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">color_one</span>
    <span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s1">'Brands'</span><span class="p">,</span> <span class="n">oneOf</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s1">'Brands'</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
    <span class="p">))</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span>
    <span class="n">color_one</span>
<span class="p">)</span>

<span class="c1"># Three next bars</span>
<span class="n">chart_two</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span> 
        <span class="n">size</span> <span class="o">=</span> <span class="mi">15</span>
        <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s2">"Change"</span><span class="p">,</span> 
        <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
        <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">color_two</span>
<span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s1">'Brands'</span><span class="p">,</span> <span class="n">oneOf</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s1">'Brands'</span><span class="p">][</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]))</span>
    <span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span>
    <span class="n">color_two</span>
<span class="p">)</span>                                         

<span class="c1"># Middle bars</span>
<span class="n">chart_three</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">table</span>
    <span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s2">"Change"</span><span class="p">,</span> 
        <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
        <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">color_three</span>
<span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s1">'Brands'</span><span class="p">,</span> <span class="n">oneOf</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s1">'Brands'</span><span class="p">][</span><span class="mi">5</span><span class="p">:</span><span class="mi">14</span><span class="p">]))</span>
    <span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span>
    <span class="n">color_three</span>
<span class="p">)</span>        
    
<span class="c1"># Three bars after the middle</span>
<span class="n">chart_four</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">table</span>
    <span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s2">"Change"</span><span class="p">,</span> 
        <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
        <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">color_four</span>
<span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s1">'Brands'</span><span class="p">,</span> <span class="n">oneOf</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s1">'Brands'</span><span class="p">][</span><span class="mi">14</span><span class="p">:</span><span class="mi">17</span><span class="p">]))</span>
    <span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span>
    <span class="n">color_four</span>
<span class="p">)</span>      

<span class="c1"># Last two bars</span>
<span class="n">chart_five</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
    <span class="n">table</span>
    <span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
        <span class="s2">"Change"</span><span class="p">,</span> 
        <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">]),</span> 
        <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Brands"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">color_five</span>
<span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s1">'Brands'</span><span class="p">,</span> <span class="n">oneOf</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s1">'Brands'</span><span class="p">][</span><span class="mi">17</span><span class="p">:</span><span class="mi">19</span><span class="p">]))</span>
    <span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span>
    <span class="n">color_five</span>
<span class="p">)</span>      

<span class="n">interactive_colors</span> <span class="o">=</span> <span class="n">chart_one</span> <span class="o">+</span> <span class="n">chart_two</span> <span class="o">+</span> <span class="n">chart_three</span> <span class="o">+</span> <span class="n">chart_four</span> <span class="o">+</span> <span class="n">chart_five</span>
<span class="n">interactive_colors</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">400</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[128]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-e91c27b1c5394d45b99cff6386b8bab4.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-e91c27b1c5394d45b99cff6386b8bab4.vega-embed details,
  #altair-viz-e91c27b1c5394d45b99cff6386b8bab4.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-e91c27b1c5394d45b99cff6386b8bab4"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-e91c27b1c5394d45b99cff6386b8bab4") {
      outputDiv = document.getElementById("altair-viz-e91c27b1c5394d45b99cff6386b8bab4");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"value": {"expr": "param_6"}}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Fran's Recipe", "Wholesome Goodness"]}}]}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"value": {"expr": "param_7"}}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Lifestyle", "Coat protection", "Diet Lifestyle"]}}]}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"value": {"expr": "param_8"}}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Feline Basics", "Lifestyle Plus", "Feline Freedom", "Feline Gold", "Feline Platinum", "Feline Instinct", "Feline Pro", "Farm Fresh Tasties", "Feline Royal"]}}]}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"value": {"expr": "param_9"}}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Feline Focus", "Feline Grain Free", "Feline Silver"]}}]}, {"mark": {"type": "bar", "size": 15}, "encoding": {"color": {"value": {"expr": "param_10"}}, "x": {"axis": null, "field": "Change", "scale": {"domain": [-0.2, 0.2]}, "title": null, "type": "quantitative"}, "y": {"axis": null, "field": "Brands", "sort": null, "type": "nominal"}}, "transform": [{"filter": {"field": "Brands", "oneOf": ["Nutri Balance", "Farm Fresh Basics"]}}]}], "data": {"name": "data-9ee411e192bdf834e5a77b44a346fa8f"}, "params": [{"name": "param_6", "bind": {"input": "color", "name": "First color: "}, "value": "#ec7c30"}, {"name": "param_7", "bind": {"input": "color", "name": "Second color: "}, "value": "#efb284"}, {"name": "param_8", "bind": {"input": "color", "name": "Third color: "}, "value": "#c6c6c6"}, {"name": "param_9", "bind": {"input": "color", "name": "Fourth color: "}, "value": "#91a9d5"}, {"name": "param_10", "bind": {"input": "color", "name": "Fifth color: "}, "value": "#4772b8"}], "width": 400, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-9ee411e192bdf834e5a77b44a346fa8f": [{"spacing for dot plot": 0, "Brands": "Fran's Recipe", "Change": -0.13999999999999999}, {"spacing for dot plot": 1, "Brands": "Wholesome Goodness", "Change": -0.13}, {"spacing for dot plot": 2, "Brands": "Lifestyle", "Change": -0.1}, {"spacing for dot plot": 3, "Brands": "Coat protection", "Change": -0.09}, {"spacing for dot plot": 4, "Brands": "Diet Lifestyle", "Change": -0.08}, {"spacing for dot plot": 5, "Brands": "Feline Basics", "Change": -0.05}, {"spacing for dot plot": 6, "Brands": "Lifestyle Plus", "Change": -0.04}, {"spacing for dot plot": 7, "Brands": "Feline Freedom", "Change": -0.019999999999999997}, {"spacing for dot plot": 8, "Brands": "Feline Gold", "Change": 0.01}, {"spacing for dot plot": 9, "Brands": "Feline Platinum", "Change": 0.01}, {"spacing for dot plot": 10, "Brands": "Feline Instinct", "Change": 0.02}, {"spacing for dot plot": 11, "Brands": "Feline Pro", "Change": 0.03}, {"spacing for dot plot": 12, "Brands": "Farm Fresh Tasties", "Change": 0.04}, {"spacing for dot plot": 13, "Brands": "Feline Royal", "Change": 0.05}, {"spacing for dot plot": 14, "Brands": "Feline Focus", "Change": 0.09}, {"spacing for dot plot": 15, "Brands": "Feline Grain Free", "Change": 0.09}, {"spacing for dot plot": 16, "Brands": "Feline Silver", "Change": 0.12}, {"spacing for dot plot": 17, "Brands": "Nutri Balance", "Change": 0.16}, {"spacing for dot plot": 18, "Brands": "Farm Fresh Basics", "Change": 0.17}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="Chapter-6---Tell-a-story">Chapter 6 - Tell a story<a name="6"></a><a class="anchor-link" href="#Chapter-6---Tell-a-story"></a></h2><p><em>"Data in a spreadsheet or facts on a slide arent things that naturally stick with
us  they are easily forgotten. Stories, on the other hand, are memorable."</em> - Cole Nussbaumer Knaflic</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h3 id="Exercise-6---Differentiate-between-live-&amp;-standalone-stories-">Exercise 6 - Differentiate between live &amp; standalone stories <a name="6.6"></a><a class="anchor-link" href="#Exercise-6---Differentiate-between-live-&amp;-standalone-stories-"></a></h3><p>The objective of this exercise is to know how to create visualizations depending in the situation you are going to present them, being that a live presentation or a printed graph. Here, we will be creating a series of charts ready to be in a slide show, demonstrating the ideas step by step.</p>
<p>There is one standalone graph at the end, but the texts will not be inserted due to that process being presented earlier.</p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Loading-the-data">Loading the data<a class="anchor-link" href="#Loading-the-data"></a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[129]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Loading the table considering Excel formatting</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Data\6.6 EXERCISE.xlsx"</span><span class="p">,</span> <span class="n">usecols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">skipfooter</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">table</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[129]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Unnamed: 2</th>
<th>Unnamed: 3</th>
<th>Internal</th>
<th>External</th>
<th>Overall</th>
<th>Goal</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Jan</td>
<td>2019-01-01</td>
<td>47.6</td>
<td>44.8</td>
<td>45.05</td>
<td>60</td>
</tr>
<tr>
<th>1</th>
<td>Feb</td>
<td>2019-02-01</td>
<td>37.9</td>
<td>48.5</td>
<td>47.25</td>
<td>60</td>
</tr>
<tr>
<th>2</th>
<td>Mar</td>
<td>2019-03-01</td>
<td>17.6</td>
<td>49.5</td>
<td>46.15</td>
<td>60</td>
</tr>
<tr>
<th>3</th>
<td>Apr</td>
<td>2019-04-01</td>
<td>18.6</td>
<td>55.2</td>
<td>50.35</td>
<td>60</td>
</tr>
<tr>
<th>4</th>
<td>May</td>
<td>2019-05-01</td>
<td>40.6</td>
<td>56.5</td>
<td>55.55</td>
<td>60</td>
</tr>
<tr>
<th>5</th>
<td>Jun</td>
<td>2019-06-01</td>
<td>28.8</td>
<td>60.7</td>
<td>53.85</td>
<td>60</td>
</tr>
<tr>
<th>6</th>
<td>Jul</td>
<td>2019-07-01</td>
<td>27.1</td>
<td>44.2</td>
<td>42.85</td>
<td>60</td>
</tr>
<tr>
<th>7</th>
<td>Aug</td>
<td>2019-08-01</td>
<td>36.9</td>
<td>29.0</td>
<td>31.15</td>
<td>60</td>
</tr>
<tr>
<th>8</th>
<td>Sep</td>
<td>2019-09-01</td>
<td>37.1</td>
<td>61.2</td>
<td>59.15</td>
<td>60</td>
</tr>
<tr>
<th>9</th>
<td>Oct</td>
<td>2019-10-01</td>
<td>25.9</td>
<td>44.9</td>
<td>41.55</td>
<td>60</td>
</tr>
<tr>
<th>10</th>
<td>Nov</td>
<td>2019-11-01</td>
<td>51.2</td>
<td>76.6</td>
<td>71.85</td>
<td>60</td>
</tr>
<tr>
<th>11</th>
<td>Dec</td>
<td>2019-12-01</td>
<td>40.6</td>
<td>34.7</td>
<td>36.15</td>
<td>60</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[130]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Rename columns</span>
<span class="n">table</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'Unnamed: 2'</span><span class="p">:</span> <span class="s1">'Month'</span><span class="p">,</span> <span class="s1">'Unnamed: 3'</span><span class="p">:</span> <span class="s1">'Date'</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Drop useless information</span>
<span class="n">table</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Date'</span><span class="p">,</span> <span class="s1">'Goal'</span><span class="p">,</span> <span class="s1">'Overall'</span><span class="p">],</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create long-format version</span>
<span class="n">melted_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Month'</span><span class="p">],</span> <span class="n">var_name</span> <span class="o">=</span> <span class="s1">'Metric'</span><span class="p">,</span> <span class="n">value_name</span> <span class="o">=</span> <span class="s1">'Value'</span><span class="p">)</span>
<span class="n">melted_table</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[130]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Month</th>
<th>Metric</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Jan</td>
<td>Internal</td>
<td>47.6</td>
</tr>
<tr>
<th>1</th>
<td>Feb</td>
<td>Internal</td>
<td>37.9</td>
</tr>
<tr>
<th>2</th>
<td>Mar</td>
<td>Internal</td>
<td>17.6</td>
</tr>
<tr>
<th>3</th>
<td>Apr</td>
<td>Internal</td>
<td>18.6</td>
</tr>
<tr>
<th>4</th>
<td>May</td>
<td>Internal</td>
<td>40.6</td>
</tr>
<tr>
<th>5</th>
<td>Jun</td>
<td>Internal</td>
<td>28.8</td>
</tr>
<tr>
<th>6</th>
<td>Jul</td>
<td>Internal</td>
<td>27.1</td>
</tr>
<tr>
<th>7</th>
<td>Aug</td>
<td>Internal</td>
<td>36.9</td>
</tr>
<tr>
<th>8</th>
<td>Sep</td>
<td>Internal</td>
<td>37.1</td>
</tr>
<tr>
<th>9</th>
<td>Oct</td>
<td>Internal</td>
<td>25.9</td>
</tr>
<tr>
<th>10</th>
<td>Nov</td>
<td>Internal</td>
<td>51.2</td>
</tr>
<tr>
<th>11</th>
<td>Dec</td>
<td>Internal</td>
<td>40.6</td>
</tr>
<tr>
<th>12</th>
<td>Jan</td>
<td>External</td>
<td>44.8</td>
</tr>
<tr>
<th>13</th>
<td>Feb</td>
<td>External</td>
<td>48.5</td>
</tr>
<tr>
<th>14</th>
<td>Mar</td>
<td>External</td>
<td>49.5</td>
</tr>
<tr>
<th>15</th>
<td>Apr</td>
<td>External</td>
<td>55.2</td>
</tr>
<tr>
<th>16</th>
<td>May</td>
<td>External</td>
<td>56.5</td>
</tr>
<tr>
<th>17</th>
<td>Jun</td>
<td>External</td>
<td>60.7</td>
</tr>
<tr>
<th>18</th>
<td>Jul</td>
<td>External</td>
<td>44.2</td>
</tr>
<tr>
<th>19</th>
<td>Aug</td>
<td>External</td>
<td>29.0</td>
</tr>
<tr>
<th>20</th>
<td>Sep</td>
<td>External</td>
<td>61.2</td>
</tr>
<tr>
<th>21</th>
<td>Oct</td>
<td>External</td>
<td>44.9</td>
</tr>
<tr>
<th>22</th>
<td>Nov</td>
<td>External</td>
<td>76.6</td>
</tr>
<tr>
<th>23</th>
<td>Dec</td>
<td>External</td>
<td>34.7</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="The-graph">The graph<a class="anchor-link" href="#The-graph"></a></h4><p>First, we will plot the normal graph.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[131]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Line chart</span>
<span class="n">line</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">melted_table</span><span class="p">,</span> 
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Time to fill"</span><span class="p">,</span> 
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> 
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span> 
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span> 
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="p">)</span>
<span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">()</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"TIME TO FILL (DAYS)"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span> <span class="c1"># y-axis goes from 0 to 90</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"black"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Goal line</span>
<span class="n">goal</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">()</span><span class="o">.</span><span class="n">mark_rule</span><span class="p">(</span>
    <span class="n">strokeDash</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="c1"># Dashed</span>
    <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="s2">"Jan"</span><span class="p">),</span> <span class="c1"># From January</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="s2">"Dec"</span><span class="p">),</span> <span class="c1"># To December</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="c1"># At value 60</span>
        <span class="p">)</span>


<span class="c1"># Label at the end of the line</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span>
    <span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> 
    <span class="n">dx</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Month"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="s2">"max"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">,</span> <span class="n">aggregate</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"argmax"</span><span class="p">:</span> <span class="s2">"Month"</span><span class="p">}),</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">)</span>
    <span class="p">)</span>


<span class="n">final</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">goal</span> <span class="o">+</span> <span class="n">label</span>

<span class="n">final</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[131]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-0c69010f8f874076a444ee6fabdecbda.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-0c69010f8f874076a444ee6fabdecbda.vega-embed details,
  #altair-viz-0c69010f8f874076a444ee6fabdecbda.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-0c69010f8f874076a444ee6fabdecbda"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-0c69010f8f874076a444ee6fabdecbda") {
      outputDiv = document.getElementById("altair-viz-0c69010f8f874076a444ee6fabdecbda");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["black"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "empty"}, "mark": {"type": "rule", "strokeDash": [4, 4]}, "encoding": {"x": {"datum": "Jan"}, "x2": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "text", "align": "left", "dx": 3}, "encoding": {"text": {"field": "Metric", "type": "nominal"}, "x": {"aggregate": "max", "field": "Month", "sort": null, "type": "nominal"}, "y": {"aggregate": {"argmax": "Month"}, "field": "Value", "type": "quantitative"}}}], "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-6be002fba83fd1263731108823ae7ed6": [{"Month": "Jan", "Metric": "Internal", "Value": 47.6}, {"Month": "Feb", "Metric": "Internal", "Value": 37.9}, {"Month": "Mar", "Metric": "Internal", "Value": 17.6}, {"Month": "Apr", "Metric": "Internal", "Value": 18.6}, {"Month": "May", "Metric": "Internal", "Value": 40.6}, {"Month": "Jun", "Metric": "Internal", "Value": 28.8}, {"Month": "Jul", "Metric": "Internal", "Value": 27.1}, {"Month": "Aug", "Metric": "Internal", "Value": 36.9}, {"Month": "Sep", "Metric": "Internal", "Value": 37.1}, {"Month": "Oct", "Metric": "Internal", "Value": 25.900000000000002}, {"Month": "Nov", "Metric": "Internal", "Value": 51.2}, {"Month": "Dec", "Metric": "Internal", "Value": 40.6}, {"Month": "Jan", "Metric": "External", "Value": 44.800000000000004}, {"Month": "Feb", "Metric": "External", "Value": 48.5}, {"Month": "Mar", "Metric": "External", "Value": 49.5}, {"Month": "Apr", "Metric": "External", "Value": 55.2}, {"Month": "May", "Metric": "External", "Value": 56.5}, {"Month": "Jun", "Metric": "External", "Value": 60.7}, {"Month": "Jul", "Metric": "External", "Value": 44.2}, {"Month": "Aug", "Metric": "External", "Value": 29.0}, {"Month": "Sep", "Metric": "External", "Value": 61.2}, {"Month": "Oct", "Metric": "External", "Value": 44.900000000000006}, {"Month": "Nov", "Metric": "External", "Value": 76.60000000000001}, {"Month": "Dec", "Metric": "External", "Value": 34.7}], "empty": [{}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>Once again, we encounter the challenge of Altair considering September as the maximum value for months, given its alphabetical order, even when using <code>Sorted = None</code>. We will solve this by defining x as December and filtering the data.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[132]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Updated label</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s1">'left'</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="s1">'Dec'</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">'Value'</span><span class="p">),</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s1">'Metric'</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
    <span class="c1"># Only December values</span>
    <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Month</span> <span class="o">==</span> <span class="s1">'Dec'</span><span class="p">)</span> 
<span class="p">)</span>

<span class="c1"># Label for the goal line</span>
<span class="n">label_goal</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span>  <span class="p">[</span> <span class="s2">"GOAL"</span><span class="p">]}]})</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s1">'left'</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="s1">'Dec'</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span>
<span class="p">)</span>

<span class="n">final_original</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">goal</span> <span class="o">+</span> <span class="n">label</span> <span class="o">+</span> <span class="n">label_goal</span>

<span class="n">final_original</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[132]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-45e18445f3e9453a8d05ea6cbf3e5cde.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-45e18445f3e9453a8d05ea6cbf3e5cde.vega-embed details,
  #altair-viz-45e18445f3e9453a8d05ea6cbf3e5cde.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-45e18445f3e9453a8d05ea6cbf3e5cde"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-45e18445f3e9453a8d05ea6cbf3e5cde") {
      outputDiv = document.getElementById("altair-viz-45e18445f3e9453a8d05ea6cbf3e5cde");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["black"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "empty"}, "mark": {"type": "rule", "strokeDash": [4, 4]}, "encoding": {"x": {"datum": "Jan"}, "x2": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"text": {"field": "Metric", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": "(datum.Month === 'Dec')"}]}, {"data": {"name": "data-1c9c9f22d63ae067ce41697727fed58b"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"text": {"field": "text", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"datum": 60}}}], "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-6be002fba83fd1263731108823ae7ed6": [{"Month": "Jan", "Metric": "Internal", "Value": 47.6}, {"Month": "Feb", "Metric": "Internal", "Value": 37.9}, {"Month": "Mar", "Metric": "Internal", "Value": 17.6}, {"Month": "Apr", "Metric": "Internal", "Value": 18.6}, {"Month": "May", "Metric": "Internal", "Value": 40.6}, {"Month": "Jun", "Metric": "Internal", "Value": 28.8}, {"Month": "Jul", "Metric": "Internal", "Value": 27.1}, {"Month": "Aug", "Metric": "Internal", "Value": 36.9}, {"Month": "Sep", "Metric": "Internal", "Value": 37.1}, {"Month": "Oct", "Metric": "Internal", "Value": 25.900000000000002}, {"Month": "Nov", "Metric": "Internal", "Value": 51.2}, {"Month": "Dec", "Metric": "Internal", "Value": 40.6}, {"Month": "Jan", "Metric": "External", "Value": 44.800000000000004}, {"Month": "Feb", "Metric": "External", "Value": 48.5}, {"Month": "Mar", "Metric": "External", "Value": 49.5}, {"Month": "Apr", "Metric": "External", "Value": 55.2}, {"Month": "May", "Metric": "External", "Value": 56.5}, {"Month": "Jun", "Metric": "External", "Value": 60.7}, {"Month": "Jul", "Metric": "External", "Value": 44.2}, {"Month": "Aug", "Metric": "External", "Value": 29.0}, {"Month": "Sep", "Metric": "External", "Value": 61.2}, {"Month": "Oct", "Metric": "External", "Value": 44.900000000000006}, {"Month": "Nov", "Metric": "External", "Value": 76.60000000000001}, {"Month": "Dec", "Metric": "External", "Value": 34.7}], "empty": [{}], "data-1c9c9f22d63ae067ce41697727fed58b": [{"text": ["GOAL"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/6_6a.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Empty-graph">Empty graph<a class="anchor-link" href="#Empty-graph"></a></h4><p>We can start our presentation with only the skeleton of our visualization.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[133]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Create a graph with full transparency</span>
<span class="n">empty</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">melted_table</span><span class="p">,</span> 
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Time to fill"</span><span class="p">,</span> 
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> 
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span> 
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span> 
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="p">)</span>
        <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">opacity</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># Minimum opacity</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
            <span class="p">)</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"TIME TO FILL (DAYS)"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">graph_1</span> <span class="o">=</span> <span class="n">empty</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">graph_1</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[133]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-41996a5bcc034a2f9fdb81548d689f15.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-41996a5bcc034a2f9fdb81548d689f15.vega-embed details,
  #altair-viz-41996a5bcc034a2f9fdb81548d689f15.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-41996a5bcc034a2f9fdb81548d689f15"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-41996a5bcc034a2f9fdb81548d689f15") {
      outputDiv = document.getElementById("altair-viz-41996a5bcc034a2f9fdb81548d689f15");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "line", "opacity": 0}, "encoding": {"x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "title": "2019", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "sort": null, "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-6be002fba83fd1263731108823ae7ed6": [{"Month": "Jan", "Metric": "Internal", "Value": 47.6}, {"Month": "Feb", "Metric": "Internal", "Value": 37.9}, {"Month": "Mar", "Metric": "Internal", "Value": 17.6}, {"Month": "Apr", "Metric": "Internal", "Value": 18.6}, {"Month": "May", "Metric": "Internal", "Value": 40.6}, {"Month": "Jun", "Metric": "Internal", "Value": 28.8}, {"Month": "Jul", "Metric": "Internal", "Value": 27.1}, {"Month": "Aug", "Metric": "Internal", "Value": 36.9}, {"Month": "Sep", "Metric": "Internal", "Value": 37.1}, {"Month": "Oct", "Metric": "Internal", "Value": 25.900000000000002}, {"Month": "Nov", "Metric": "Internal", "Value": 51.2}, {"Month": "Dec", "Metric": "Internal", "Value": 40.6}, {"Month": "Jan", "Metric": "External", "Value": 44.800000000000004}, {"Month": "Feb", "Metric": "External", "Value": 48.5}, {"Month": "Mar", "Metric": "External", "Value": 49.5}, {"Month": "Apr", "Metric": "External", "Value": 55.2}, {"Month": "May", "Metric": "External", "Value": 56.5}, {"Month": "Jun", "Metric": "External", "Value": 60.7}, {"Month": "Jul", "Metric": "External", "Value": 44.2}, {"Month": "Aug", "Metric": "External", "Value": 29.0}, {"Month": "Sep", "Metric": "External", "Value": 61.2}, {"Month": "Oct", "Metric": "External", "Value": 44.900000000000006}, {"Month": "Nov", "Metric": "External", "Value": 76.60000000000001}, {"Month": "Dec", "Metric": "External", "Value": 34.7}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/6_6b.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Add-the-goal-line">Add the goal line<a class="anchor-link" href="#Add-the-goal-line"></a></h4><p>We can do this by adding already existing graphs.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[134]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">graph_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">empty</span> <span class="o">+</span> <span class="n">goal</span> <span class="o">+</span> <span class="n">label_goal</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">graph_2</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[134]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-b2f3efa853d34ca7a2b00ba391bc8030.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-b2f3efa853d34ca7a2b00ba391bc8030.vega-embed details,
  #altair-viz-b2f3efa853d34ca7a2b00ba391bc8030.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-b2f3efa853d34ca7a2b00ba391bc8030"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-b2f3efa853d34ca7a2b00ba391bc8030") {
      outputDiv = document.getElementById("altair-viz-b2f3efa853d34ca7a2b00ba391bc8030");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "line", "opacity": 0}, "encoding": {"x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "title": "2019", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "sort": null, "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "empty"}, "mark": {"type": "rule", "strokeDash": [4, 4]}, "encoding": {"x": {"datum": "Jan"}, "x2": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "data-1c9c9f22d63ae067ce41697727fed58b"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"text": {"field": "text", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"datum": 60}}}], "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-6be002fba83fd1263731108823ae7ed6": [{"Month": "Jan", "Metric": "Internal", "Value": 47.6}, {"Month": "Feb", "Metric": "Internal", "Value": 37.9}, {"Month": "Mar", "Metric": "Internal", "Value": 17.6}, {"Month": "Apr", "Metric": "Internal", "Value": 18.6}, {"Month": "May", "Metric": "Internal", "Value": 40.6}, {"Month": "Jun", "Metric": "Internal", "Value": 28.8}, {"Month": "Jul", "Metric": "Internal", "Value": 27.1}, {"Month": "Aug", "Metric": "Internal", "Value": 36.9}, {"Month": "Sep", "Metric": "Internal", "Value": 37.1}, {"Month": "Oct", "Metric": "Internal", "Value": 25.900000000000002}, {"Month": "Nov", "Metric": "Internal", "Value": 51.2}, {"Month": "Dec", "Metric": "Internal", "Value": 40.6}, {"Month": "Jan", "Metric": "External", "Value": 44.800000000000004}, {"Month": "Feb", "Metric": "External", "Value": 48.5}, {"Month": "Mar", "Metric": "External", "Value": 49.5}, {"Month": "Apr", "Metric": "External", "Value": 55.2}, {"Month": "May", "Metric": "External", "Value": 56.5}, {"Month": "Jun", "Metric": "External", "Value": 60.7}, {"Month": "Jul", "Metric": "External", "Value": 44.2}, {"Month": "Aug", "Metric": "External", "Value": 29.0}, {"Month": "Sep", "Metric": "External", "Value": 61.2}, {"Month": "Oct", "Metric": "External", "Value": 44.900000000000006}, {"Month": "Nov", "Metric": "External", "Value": 76.60000000000001}, {"Month": "Dec", "Metric": "External", "Value": 34.7}], "empty": [{}], "data-1c9c9f22d63ae067ce41697727fed58b": [{"text": ["GOAL"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/6_6c.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Create-the-first-data-point">Create the first data point<a class="anchor-link" href="#Create-the-first-data-point"></a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[135]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Point for january</span>
<span class="n">point_jan</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">()</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'black'</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">opacity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="s1">'Jan'</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="n">melted_table</span><span class="p">[</span><span class="s2">"Value"</span><span class="p">][</span><span class="mi">12</span><span class="p">]))</span>

<span class="c1"># Create opaque versions of the goal line and label</span>
<span class="n">goal_opaque</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">()</span><span class="o">.</span><span class="n">mark_rule</span><span class="p">(</span><span class="n">strokeDash</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="s1">'Jan'</span><span class="p">),</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="s1">'Dec'</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span>
    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="p">)</span>

<span class="n">label_goal_opaque</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">({</span><span class="s2">"values"</span><span class="p">:</span> <span class="p">[{</span><span class="s2">"text"</span><span class="p">:</span>  <span class="p">[</span> <span class="s2">"GOAL"</span><span class="p">]}]})</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s1">'left'</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="s1">'Dec'</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s2">"text:N"</span><span class="p">,</span>
    <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
<span class="p">)</span>  

<span class="n">graph_3</span> <span class="o">=</span> <span class="p">(</span><span class="n">empty</span> <span class="o">+</span> <span class="n">goal_opaque</span> <span class="o">+</span> <span class="n">label_goal_opaque</span> <span class="o">+</span> <span class="n">point_jan</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">graph_3</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[135]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-f3d6de807fa4463aac3fc0d657b57be8.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-f3d6de807fa4463aac3fc0d657b57be8.vega-embed details,
  #altair-viz-f3d6de807fa4463aac3fc0d657b57be8.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-f3d6de807fa4463aac3fc0d657b57be8"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-f3d6de807fa4463aac3fc0d657b57be8") {
      outputDiv = document.getElementById("altair-viz-f3d6de807fa4463aac3fc0d657b57be8");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "line", "opacity": 0}, "encoding": {"x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "title": "2019", "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "sort": null, "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "empty"}, "mark": {"type": "rule", "strokeDash": [4, 4]}, "encoding": {"opacity": {"value": 0.4}, "x": {"datum": "Jan"}, "x2": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "data-1c9c9f22d63ae067ce41697727fed58b"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"opacity": {"value": 0.4}, "text": {"field": "text", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "empty"}, "mark": {"type": "point", "color": "black", "filled": true, "opacity": 1, "size": 50}, "encoding": {"x": {"datum": "Jan"}, "y": {"datum": 44.800000000000004}}}], "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-6be002fba83fd1263731108823ae7ed6": [{"Month": "Jan", "Metric": "Internal", "Value": 47.6}, {"Month": "Feb", "Metric": "Internal", "Value": 37.9}, {"Month": "Mar", "Metric": "Internal", "Value": 17.6}, {"Month": "Apr", "Metric": "Internal", "Value": 18.6}, {"Month": "May", "Metric": "Internal", "Value": 40.6}, {"Month": "Jun", "Metric": "Internal", "Value": 28.8}, {"Month": "Jul", "Metric": "Internal", "Value": 27.1}, {"Month": "Aug", "Metric": "Internal", "Value": 36.9}, {"Month": "Sep", "Metric": "Internal", "Value": 37.1}, {"Month": "Oct", "Metric": "Internal", "Value": 25.900000000000002}, {"Month": "Nov", "Metric": "Internal", "Value": 51.2}, {"Month": "Dec", "Metric": "Internal", "Value": 40.6}, {"Month": "Jan", "Metric": "External", "Value": 44.800000000000004}, {"Month": "Feb", "Metric": "External", "Value": 48.5}, {"Month": "Mar", "Metric": "External", "Value": 49.5}, {"Month": "Apr", "Metric": "External", "Value": 55.2}, {"Month": "May", "Metric": "External", "Value": 56.5}, {"Month": "Jun", "Metric": "External", "Value": 60.7}, {"Month": "Jul", "Metric": "External", "Value": 44.2}, {"Month": "Aug", "Metric": "External", "Value": 29.0}, {"Month": "Sep", "Metric": "External", "Value": 61.2}, {"Month": "Oct", "Metric": "External", "Value": 44.900000000000006}, {"Month": "Nov", "Metric": "External", "Value": 76.60000000000001}, {"Month": "Dec", "Metric": "External", "Value": 34.7}], "empty": [{}], "data-1c9c9f22d63ae067ce41697727fed58b": [{"text": ["GOAL"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/6_6d.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Updating-for-the-first-half-of-the-year">Updating for the first half of the year<a class="anchor-link" href="#Updating-for-the-first-half-of-the-year"></a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[136]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Create the line until June</span>
<span class="n">partial_line1</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">melted_table</span><span class="p">,</span> 
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Time to fill"</span><span class="p">,</span> 
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> 
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span> 
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span> 
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="p">))</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">()</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span>
                <span class="c1"># We need to set all months as a domain</span>
                <span class="c1"># to make sure they appear in the axis</span>
                <span class="n">domain</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">"Jan"</span><span class="p">,</span>
                    <span class="s2">"Feb"</span><span class="p">,</span>
                    <span class="s2">"Mar"</span><span class="p">,</span>
                    <span class="s2">"Apr"</span><span class="p">,</span>
                    <span class="s2">"May"</span><span class="p">,</span>
                    <span class="s2">"Jun"</span><span class="p">,</span>
                    <span class="s2">"Jul"</span><span class="p">,</span>
                    <span class="s2">"Aug"</span><span class="p">,</span>
                    <span class="s2">"Sep"</span><span class="p">,</span>
                    <span class="s2">"Oct"</span><span class="p">,</span>
                    <span class="s2">"Nov"</span><span class="p">,</span>
                    <span class="s2">"Dec"</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"TIME TO FILL (DAYS)"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">]),</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="s2">"black"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="c1"># Filter only half of the year</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Month"</span><span class="p">,</span> <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Jan"</span><span class="p">,</span> <span class="s2">"Feb"</span><span class="p">,</span> <span class="s2">"Mar"</span><span class="p">,</span> <span class="s2">"Apr"</span><span class="p">,</span> <span class="s2">"May"</span><span class="p">,</span> <span class="s2">"Jun"</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Point for June</span>
<span class="n">point_jun</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">()</span>
    <span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span> <span class="mi">1</span> <span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="s2">"Jun"</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="n">melted_table</span><span class="p">[</span><span class="s2">"Value"</span><span class="p">][</span><span class="mi">17</span><span class="p">]))</span>
<span class="p">)</span>

<span class="n">graph_4</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">partial_line1</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Metric</span> <span class="o">==</span> <span class="s2">"External"</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">goal_opaque</span>
    <span class="o">+</span> <span class="n">label_goal_opaque</span>
    <span class="o">+</span> <span class="n">point_jun</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">graph_4</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[136]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-076f340d437c48eeb84422853c5cd66a.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-076f340d437c48eeb84422853c5cd66a.vega-embed details,
  #altair-viz-076f340d437c48eeb84422853c5cd66a.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-076f340d437c48eeb84422853c5cd66a"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-076f340d437c48eeb84422853c5cd66a") {
      outputDiv = document.getElementById("altair-viz-076f340d437c48eeb84422853c5cd66a");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["black"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "scale": {"domain": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]}, "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": {"field": "Month", "oneOf": ["Jan", "Feb", "Mar", "Apr", "May", "Jun"]}}, {"filter": "(datum.Metric === 'External')"}]}, {"data": {"name": "empty"}, "mark": {"type": "rule", "strokeDash": [4, 4]}, "encoding": {"opacity": {"value": 0.4}, "x": {"datum": "Jan"}, "x2": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "data-1c9c9f22d63ae067ce41697727fed58b"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"opacity": {"value": 0.4}, "text": {"field": "text", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "empty"}, "mark": {"type": "point", "color": "black", "filled": true, "opacity": 1, "size": 50}, "encoding": {"x": {"datum": "Jun"}, "y": {"datum": 60.7}}}], "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-6be002fba83fd1263731108823ae7ed6": [{"Month": "Jan", "Metric": "Internal", "Value": 47.6}, {"Month": "Feb", "Metric": "Internal", "Value": 37.9}, {"Month": "Mar", "Metric": "Internal", "Value": 17.6}, {"Month": "Apr", "Metric": "Internal", "Value": 18.6}, {"Month": "May", "Metric": "Internal", "Value": 40.6}, {"Month": "Jun", "Metric": "Internal", "Value": 28.8}, {"Month": "Jul", "Metric": "Internal", "Value": 27.1}, {"Month": "Aug", "Metric": "Internal", "Value": 36.9}, {"Month": "Sep", "Metric": "Internal", "Value": 37.1}, {"Month": "Oct", "Metric": "Internal", "Value": 25.900000000000002}, {"Month": "Nov", "Metric": "Internal", "Value": 51.2}, {"Month": "Dec", "Metric": "Internal", "Value": 40.6}, {"Month": "Jan", "Metric": "External", "Value": 44.800000000000004}, {"Month": "Feb", "Metric": "External", "Value": 48.5}, {"Month": "Mar", "Metric": "External", "Value": 49.5}, {"Month": "Apr", "Metric": "External", "Value": 55.2}, {"Month": "May", "Metric": "External", "Value": 56.5}, {"Month": "Jun", "Metric": "External", "Value": 60.7}, {"Month": "Jul", "Metric": "External", "Value": 44.2}, {"Month": "Aug", "Metric": "External", "Value": 29.0}, {"Month": "Sep", "Metric": "External", "Value": 61.2}, {"Month": "Oct", "Metric": "External", "Value": 44.900000000000006}, {"Month": "Nov", "Metric": "External", "Value": 76.60000000000001}, {"Month": "Dec", "Metric": "External", "Value": 34.7}], "empty": [{}], "data-1c9c9f22d63ae067ce41697727fed58b": [{"text": ["GOAL"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/6_6e.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Rest-of-the-year-with-points">Rest of the year with points<a class="anchor-link" href="#Rest-of-the-year-with-points"></a></h4><p>We will complete the line for the rest of the year, highlighting some points.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[137]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Condition for External points</span>
<span class="n">points_condition</span> <span class="o">=</span> <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Metric</span> <span class="o">==</span> <span class="s2">"External"</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Month</span> <span class="o">==</span> <span class="s2">"Aug"</span><span class="p">)</span>
    <span class="o">|</span> <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Month</span> <span class="o">==</span> <span class="s2">"Sep"</span><span class="p">)</span>
    <span class="o">|</span> <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Month</span> <span class="o">==</span> <span class="s2">"Oct"</span><span class="p">)</span>
    <span class="o">|</span> <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Month</span> <span class="o">==</span> <span class="s2">"Nov"</span><span class="p">)</span>
    <span class="o">|</span> <span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Month</span> <span class="o">==</span> <span class="s2">"Dec"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Define the points</span>
<span class="n">points</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">opacity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">"Month"</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="s2">"Value"</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
            <span class="c1"># Color depends if it achieved the Goal</span>
            <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Value</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#f6792c"</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">"#187cae"</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># Only for the points in the condition</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">points_condition</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">graph_5</span> <span class="o">=</span> <span class="p">(</span>
    <span class="c1"># We can filter the line directly</span>
    <span class="n">line</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Metric</span> <span class="o">==</span> <span class="s2">"External"</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">goal_opaque</span>
    <span class="o">+</span> <span class="n">label_goal_opaque</span>
    <span class="o">+</span> <span class="n">points</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>

<span class="n">graph_5</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[137]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-38a34b5a366d4658a3177e2cde84c256.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-38a34b5a366d4658a3177e2cde84c256.vega-embed details,
  #altair-viz-38a34b5a366d4658a3177e2cde84c256.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-38a34b5a366d4658a3177e2cde84c256"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-38a34b5a366d4658a3177e2cde84c256") {
      outputDiv = document.getElementById("altair-viz-38a34b5a366d4658a3177e2cde84c256");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["black"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": "(datum.Metric === 'External')"}]}, {"data": {"name": "empty"}, "mark": {"type": "rule", "strokeDash": [4, 4]}, "encoding": {"opacity": {"value": 0.4}, "x": {"datum": "Jan"}, "x2": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "data-1c9c9f22d63ae067ce41697727fed58b"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"opacity": {"value": 0.4}, "text": {"field": "text", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "point", "filled": true, "opacity": 1, "size": 50}, "encoding": {"color": {"condition": {"test": "(datum.Value > 60)", "value": "#f6792c"}, "value": "#187cae"}, "x": {"field": "Month", "sort": null, "type": "nominal"}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": "((datum.Metric === 'External') && (((((datum.Month === 'Aug') || (datum.Month === 'Sep')) || (datum.Month === 'Oct')) || (datum.Month === 'Nov')) || (datum.Month === 'Dec')))"}]}], "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-6be002fba83fd1263731108823ae7ed6": [{"Month": "Jan", "Metric": "Internal", "Value": 47.6}, {"Month": "Feb", "Metric": "Internal", "Value": 37.9}, {"Month": "Mar", "Metric": "Internal", "Value": 17.6}, {"Month": "Apr", "Metric": "Internal", "Value": 18.6}, {"Month": "May", "Metric": "Internal", "Value": 40.6}, {"Month": "Jun", "Metric": "Internal", "Value": 28.8}, {"Month": "Jul", "Metric": "Internal", "Value": 27.1}, {"Month": "Aug", "Metric": "Internal", "Value": 36.9}, {"Month": "Sep", "Metric": "Internal", "Value": 37.1}, {"Month": "Oct", "Metric": "Internal", "Value": 25.900000000000002}, {"Month": "Nov", "Metric": "Internal", "Value": 51.2}, {"Month": "Dec", "Metric": "Internal", "Value": 40.6}, {"Month": "Jan", "Metric": "External", "Value": 44.800000000000004}, {"Month": "Feb", "Metric": "External", "Value": 48.5}, {"Month": "Mar", "Metric": "External", "Value": 49.5}, {"Month": "Apr", "Metric": "External", "Value": 55.2}, {"Month": "May", "Metric": "External", "Value": 56.5}, {"Month": "Jun", "Metric": "External", "Value": 60.7}, {"Month": "Jul", "Metric": "External", "Value": 44.2}, {"Month": "Aug", "Metric": "External", "Value": 29.0}, {"Month": "Sep", "Metric": "External", "Value": 61.2}, {"Month": "Oct", "Metric": "External", "Value": 44.900000000000006}, {"Month": "Nov", "Metric": "External", "Value": 76.60000000000001}, {"Month": "Dec", "Metric": "External", "Value": 34.7}], "empty": [{}], "data-1c9c9f22d63ae067ce41697727fed58b": [{"text": ["GOAL"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/6_6f.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Focus-on-the-internal">Focus on the internal<a class="anchor-link" href="#Focus-on-the-internal"></a></h4><p>Now we will lighten the external line to bring focus on the internal data.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[138]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># External line with less opacity</span>
<span class="n">external_opaque</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">melted_table</span><span class="p">,</span> 
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Time to fill"</span><span class="p">,</span> 
            <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> 
            <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span> 
            <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span> 
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">mark_line</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"TIME TO FILL (DAYS)"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="s2">"black"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span> <span class="c1"># Set transparency</span>
    <span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span>
    <span class="c1"># Filter data</span>
    <span class="p">)</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Metric</span> <span class="o">==</span> <span class="s2">"External"</span><span class="p">)</span>


<span class="c1"># Label with less opacity</span>
<span class="n">label_opaque</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="s2">"Dec"</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">),</span>
        <span class="n">opacity</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">((</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Month</span> <span class="o">==</span> <span class="s2">"Dec"</span><span class="p">))</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Metric</span> <span class="o">==</span> <span class="s2">"External"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Point for January in the Internal line</span>
<span class="n">point_jan2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">()</span>
    <span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">opacity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="s2">"Jan"</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="n">melted_table</span><span class="p">[</span><span class="s2">"Value"</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
<span class="p">)</span>

<span class="n">graph_6</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">external_opaque</span> <span class="o">+</span> <span class="n">label_opaque</span> <span class="o">+</span> <span class="n">goal_opaque</span> <span class="o">+</span> <span class="n">label_goal_opaque</span> <span class="o">+</span> <span class="n">point_jan2</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">graph_6</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[138]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-826f4ed736d74752b6faf8f9234fb828.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-826f4ed736d74752b6faf8f9234fb828.vega-embed details,
  #altair-viz-826f4ed736d74752b6faf8f9234fb828.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-826f4ed736d74752b6faf8f9234fb828"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-826f4ed736d74752b6faf8f9234fb828") {
      outputDiv = document.getElementById("altair-viz-826f4ed736d74752b6faf8f9234fb828");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["black"]}, "type": "nominal"}, "opacity": {"value": 0.4}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": "(datum.Metric === 'External')"}]}, {"mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"opacity": {"value": 0.4}, "text": {"field": "Metric", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": "(datum.Month === 'Dec')"}, {"filter": "(datum.Metric === 'External')"}]}, {"mark": {"type": "rule", "strokeDash": [4, 4]}, "encoding": {"opacity": {"value": 0.4}, "x": {"datum": "Jan"}, "x2": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "data-1c9c9f22d63ae067ce41697727fed58b"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"opacity": {"value": 0.4}, "text": {"field": "text", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"datum": 60}}}, {"mark": {"type": "point", "color": "black", "filled": true, "opacity": 1, "size": 50}, "encoding": {"x": {"datum": "Jan"}, "y": {"datum": 47.6}}}], "data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-6be002fba83fd1263731108823ae7ed6": [{"Month": "Jan", "Metric": "Internal", "Value": 47.6}, {"Month": "Feb", "Metric": "Internal", "Value": 37.9}, {"Month": "Mar", "Metric": "Internal", "Value": 17.6}, {"Month": "Apr", "Metric": "Internal", "Value": 18.6}, {"Month": "May", "Metric": "Internal", "Value": 40.6}, {"Month": "Jun", "Metric": "Internal", "Value": 28.8}, {"Month": "Jul", "Metric": "Internal", "Value": 27.1}, {"Month": "Aug", "Metric": "Internal", "Value": 36.9}, {"Month": "Sep", "Metric": "Internal", "Value": 37.1}, {"Month": "Oct", "Metric": "Internal", "Value": 25.900000000000002}, {"Month": "Nov", "Metric": "Internal", "Value": 51.2}, {"Month": "Dec", "Metric": "Internal", "Value": 40.6}, {"Month": "Jan", "Metric": "External", "Value": 44.800000000000004}, {"Month": "Feb", "Metric": "External", "Value": 48.5}, {"Month": "Mar", "Metric": "External", "Value": 49.5}, {"Month": "Apr", "Metric": "External", "Value": 55.2}, {"Month": "May", "Metric": "External", "Value": 56.5}, {"Month": "Jun", "Metric": "External", "Value": 60.7}, {"Month": "Jul", "Metric": "External", "Value": 44.2}, {"Month": "Aug", "Metric": "External", "Value": 29.0}, {"Month": "Sep", "Metric": "External", "Value": 61.2}, {"Month": "Oct", "Metric": "External", "Value": 44.900000000000006}, {"Month": "Nov", "Metric": "External", "Value": 76.60000000000001}, {"Month": "Dec", "Metric": "External", "Value": 34.7}], "data-1c9c9f22d63ae067ce41697727fed58b": [{"text": ["GOAL"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/6_6g.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="First-months-of-the-year">First months of the year<a class="anchor-link" href="#First-months-of-the-year"></a></h4><p>Similarly to the External line, we will plot the first months for Internal - this time stopping at April.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[139]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Line for the first four months</span>
<span class="n">partial_line2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">melted_table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Time to fill"</span><span class="p">,</span> <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">()</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span>
                <span class="n">domain</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">"Jan"</span><span class="p">,</span>
                    <span class="s2">"Feb"</span><span class="p">,</span>
                    <span class="s2">"Mar"</span><span class="p">,</span>
                    <span class="s2">"Apr"</span><span class="p">,</span>
                    <span class="s2">"May"</span><span class="p">,</span>
                    <span class="s2">"Jun"</span><span class="p">,</span>
                    <span class="s2">"Jul"</span><span class="p">,</span>
                    <span class="s2">"Aug"</span><span class="p">,</span>
                    <span class="s2">"Sep"</span><span class="p">,</span>
                    <span class="s2">"Oct"</span><span class="p">,</span>
                    <span class="s2">"Nov"</span><span class="p">,</span>
                    <span class="s2">"Dec"</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"TIME TO FILL (DAYS)"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">]),</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"black"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span><span class="n">field</span> <span class="o">=</span> <span class="s2">"Month"</span><span class="p">,</span> <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Jan"</span><span class="p">,</span> <span class="s2">"Feb"</span><span class="p">,</span> <span class="s2">"Mar"</span><span class="p">,</span> <span class="s2">"Apr"</span><span class="p">])</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Point for April</span>
<span class="n">point_apr</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">()</span>
    <span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">opacity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="s2">"Apr"</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="n">melted_table</span><span class="p">[</span><span class="s2">"Value"</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span>
<span class="p">)</span>

<span class="n">graph_7</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">partial_line2</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Metric</span> <span class="o">==</span> <span class="s2">"Internal"</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">goal_opaque</span>
    <span class="o">+</span> <span class="n">label_goal_opaque</span>
    <span class="o">+</span> <span class="n">point_apr</span>
    <span class="o">+</span> <span class="n">external_opaque</span>
    <span class="o">+</span> <span class="n">label_opaque</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>

<span class="n">graph_7</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[139]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-8d97230a01194f00942c8beac57772f8.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-8d97230a01194f00942c8beac57772f8.vega-embed details,
  #altair-viz-8d97230a01194f00942c8beac57772f8.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-8d97230a01194f00942c8beac57772f8"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-8d97230a01194f00942c8beac57772f8") {
      outputDiv = document.getElementById("altair-viz-8d97230a01194f00942c8beac57772f8");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["black"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "scale": {"domain": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]}, "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": {"field": "Month", "oneOf": ["Jan", "Feb", "Mar", "Apr"]}}, {"filter": "(datum.Metric === 'Internal')"}]}, {"data": {"name": "empty"}, "mark": {"type": "rule", "strokeDash": [4, 4]}, "encoding": {"opacity": {"value": 0.4}, "x": {"datum": "Jan"}, "x2": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "data-1c9c9f22d63ae067ce41697727fed58b"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"opacity": {"value": 0.4}, "text": {"field": "text", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "empty"}, "mark": {"type": "point", "color": "black", "filled": true, "opacity": 1, "size": 50}, "encoding": {"x": {"datum": "Apr"}, "y": {"datum": 18.6}}}, {"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["black"]}, "type": "nominal"}, "opacity": {"value": 0.4}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": "(datum.Metric === 'External')"}]}, {"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"opacity": {"value": 0.4}, "text": {"field": "Metric", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": "(datum.Month === 'Dec')"}, {"filter": "(datum.Metric === 'External')"}]}], "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-6be002fba83fd1263731108823ae7ed6": [{"Month": "Jan", "Metric": "Internal", "Value": 47.6}, {"Month": "Feb", "Metric": "Internal", "Value": 37.9}, {"Month": "Mar", "Metric": "Internal", "Value": 17.6}, {"Month": "Apr", "Metric": "Internal", "Value": 18.6}, {"Month": "May", "Metric": "Internal", "Value": 40.6}, {"Month": "Jun", "Metric": "Internal", "Value": 28.8}, {"Month": "Jul", "Metric": "Internal", "Value": 27.1}, {"Month": "Aug", "Metric": "Internal", "Value": 36.9}, {"Month": "Sep", "Metric": "Internal", "Value": 37.1}, {"Month": "Oct", "Metric": "Internal", "Value": 25.900000000000002}, {"Month": "Nov", "Metric": "Internal", "Value": 51.2}, {"Month": "Dec", "Metric": "Internal", "Value": 40.6}, {"Month": "Jan", "Metric": "External", "Value": 44.800000000000004}, {"Month": "Feb", "Metric": "External", "Value": 48.5}, {"Month": "Mar", "Metric": "External", "Value": 49.5}, {"Month": "Apr", "Metric": "External", "Value": 55.2}, {"Month": "May", "Metric": "External", "Value": 56.5}, {"Month": "Jun", "Metric": "External", "Value": 60.7}, {"Month": "Jul", "Metric": "External", "Value": 44.2}, {"Month": "Aug", "Metric": "External", "Value": 29.0}, {"Month": "Sep", "Metric": "External", "Value": 61.2}, {"Month": "Oct", "Metric": "External", "Value": 44.900000000000006}, {"Month": "Nov", "Metric": "External", "Value": 76.60000000000001}, {"Month": "Dec", "Metric": "External", "Value": 34.7}], "empty": [{}], "data-1c9c9f22d63ae067ce41697727fed58b": [{"text": ["GOAL"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/6_6h.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Add-May">Add May<a class="anchor-link" href="#Add-May"></a></h4><p>After showing the decrease in time to fill in the first months, we can now add the next one (May) to show an increase.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[140]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Line with May added</span>

<span class="n">partial_line3</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">melted_table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Time to fill"</span><span class="p">,</span> <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">()</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span>
                <span class="n">domain</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">"Jan"</span><span class="p">,</span>
                    <span class="s2">"Feb"</span><span class="p">,</span>
                    <span class="s2">"Mar"</span><span class="p">,</span>
                    <span class="s2">"Apr"</span><span class="p">,</span>
                    <span class="s2">"May"</span><span class="p">,</span>
                    <span class="s2">"Jun"</span><span class="p">,</span>
                    <span class="s2">"Jul"</span><span class="p">,</span>
                    <span class="s2">"Aug"</span><span class="p">,</span>
                    <span class="s2">"Sep"</span><span class="p">,</span>
                    <span class="s2">"Oct"</span><span class="p">,</span>
                    <span class="s2">"Nov"</span><span class="p">,</span>
                    <span class="s2">"Dec"</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"TIME TO FILL (DAYS)"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"black"</span><span class="p">,</span> <span class="s2">"black"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Month"</span><span class="p">,</span> <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Jan"</span><span class="p">,</span> <span class="s2">"Feb"</span><span class="p">,</span> <span class="s2">"Mar"</span><span class="p">,</span> <span class="s2">"Apr"</span><span class="p">,</span> <span class="s2">"May"</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Point for May</span>
<span class="n">point_may</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">()</span>
    <span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">opacity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="s2">"May"</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="n">melted_table</span><span class="p">[</span><span class="s2">"Value"</span><span class="p">][</span><span class="mi">4</span><span class="p">]))</span>
<span class="p">)</span>

<span class="n">graph_8</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">partial_line3</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Metric</span> <span class="o">==</span> <span class="s2">"Internal"</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">goal_opaque</span>
    <span class="o">+</span> <span class="n">label_goal_opaque</span>
    <span class="o">+</span> <span class="n">point_may</span>
    <span class="o">+</span> <span class="n">external_opaque</span>
    <span class="o">+</span> <span class="n">label_opaque</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">graph_8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[140]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-a76a86ddc5b5442bbaeb4f0498379213.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-a76a86ddc5b5442bbaeb4f0498379213.vega-embed details,
  #altair-viz-a76a86ddc5b5442bbaeb4f0498379213.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-a76a86ddc5b5442bbaeb4f0498379213"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-a76a86ddc5b5442bbaeb4f0498379213") {
      outputDiv = document.getElementById("altair-viz-a76a86ddc5b5442bbaeb4f0498379213");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["black", "black"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "scale": {"domain": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]}, "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": {"field": "Month", "oneOf": ["Jan", "Feb", "Mar", "Apr", "May"]}}, {"filter": "(datum.Metric === 'Internal')"}]}, {"data": {"name": "empty"}, "mark": {"type": "rule", "strokeDash": [4, 4]}, "encoding": {"opacity": {"value": 0.4}, "x": {"datum": "Jan"}, "x2": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "data-1c9c9f22d63ae067ce41697727fed58b"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"opacity": {"value": 0.4}, "text": {"field": "text", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "empty"}, "mark": {"type": "point", "color": "black", "filled": true, "opacity": 1, "size": 50}, "encoding": {"x": {"datum": "May"}, "y": {"datum": 40.6}}}, {"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["black"]}, "type": "nominal"}, "opacity": {"value": 0.4}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": "(datum.Metric === 'External')"}]}, {"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"opacity": {"value": 0.4}, "text": {"field": "Metric", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": "(datum.Month === 'Dec')"}, {"filter": "(datum.Metric === 'External')"}]}], "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-6be002fba83fd1263731108823ae7ed6": [{"Month": "Jan", "Metric": "Internal", "Value": 47.6}, {"Month": "Feb", "Metric": "Internal", "Value": 37.9}, {"Month": "Mar", "Metric": "Internal", "Value": 17.6}, {"Month": "Apr", "Metric": "Internal", "Value": 18.6}, {"Month": "May", "Metric": "Internal", "Value": 40.6}, {"Month": "Jun", "Metric": "Internal", "Value": 28.8}, {"Month": "Jul", "Metric": "Internal", "Value": 27.1}, {"Month": "Aug", "Metric": "Internal", "Value": 36.9}, {"Month": "Sep", "Metric": "Internal", "Value": 37.1}, {"Month": "Oct", "Metric": "Internal", "Value": 25.900000000000002}, {"Month": "Nov", "Metric": "Internal", "Value": 51.2}, {"Month": "Dec", "Metric": "Internal", "Value": 40.6}, {"Month": "Jan", "Metric": "External", "Value": 44.800000000000004}, {"Month": "Feb", "Metric": "External", "Value": 48.5}, {"Month": "Mar", "Metric": "External", "Value": 49.5}, {"Month": "Apr", "Metric": "External", "Value": 55.2}, {"Month": "May", "Metric": "External", "Value": 56.5}, {"Month": "Jun", "Metric": "External", "Value": 60.7}, {"Month": "Jul", "Metric": "External", "Value": 44.2}, {"Month": "Aug", "Metric": "External", "Value": 29.0}, {"Month": "Sep", "Metric": "External", "Value": 61.2}, {"Month": "Oct", "Metric": "External", "Value": 44.900000000000006}, {"Month": "Nov", "Metric": "External", "Value": 76.60000000000001}, {"Month": "Dec", "Metric": "External", "Value": 34.7}], "empty": [{}], "data-1c9c9f22d63ae067ce41697727fed58b": [{"text": ["GOAL"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/6_6i.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Add-months-until-September">Add months until September<a class="anchor-link" href="#Add-months-until-September"></a></h4><p>Here we can see a small dip, before the data rising again.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[141]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Line until September</span>
<span class="n">partial_line4</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">melted_table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Time to fill"</span><span class="p">,</span> <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">()</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span>
                <span class="n">domain</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">"Jan"</span><span class="p">,</span>
                    <span class="s2">"Feb"</span><span class="p">,</span>
                    <span class="s2">"Mar"</span><span class="p">,</span>
                    <span class="s2">"Apr"</span><span class="p">,</span>
                    <span class="s2">"May"</span><span class="p">,</span>
                    <span class="s2">"Jun"</span><span class="p">,</span>
                    <span class="s2">"Jul"</span><span class="p">,</span>
                    <span class="s2">"Aug"</span><span class="p">,</span>
                    <span class="s2">"Sep"</span><span class="p">,</span>
                    <span class="s2">"Oct"</span><span class="p">,</span>
                    <span class="s2">"Nov"</span><span class="p">,</span>
                    <span class="s2">"Dec"</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"TIME TO FILL (DAYS)"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"black"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Month"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Jan"</span><span class="p">,</span> <span class="s2">"Feb"</span><span class="p">,</span> <span class="s2">"Mar"</span><span class="p">,</span> <span class="s2">"Apr"</span><span class="p">,</span> <span class="s2">"May"</span><span class="p">,</span> <span class="s2">"Jun"</span><span class="p">,</span> <span class="s2">"Jul"</span><span class="p">,</span> <span class="s2">"Aug"</span><span class="p">,</span> <span class="s2">"Sep"</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Point for September</span>
<span class="n">point_sep</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">()</span>
    <span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">opacity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="s2">"Sep"</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="n">melted_table</span><span class="p">[</span><span class="s2">"Value"</span><span class="p">][</span><span class="mi">8</span><span class="p">]))</span>
<span class="p">)</span>

<span class="n">graph_9</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">partial_line4</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Metric</span> <span class="o">==</span> <span class="s2">"Internal"</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">goal_opaque</span>
    <span class="o">+</span> <span class="n">label_goal_opaque</span>
    <span class="o">+</span> <span class="n">point_sep</span>
    <span class="o">+</span> <span class="n">external_opaque</span>
    <span class="o">+</span> <span class="n">label_opaque</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>

<span class="n">graph_9</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[141]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-0987c9c7ddfb4c45b61a1eda532edf12.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-0987c9c7ddfb4c45b61a1eda532edf12.vega-embed details,
  #altair-viz-0987c9c7ddfb4c45b61a1eda532edf12.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-0987c9c7ddfb4c45b61a1eda532edf12"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-0987c9c7ddfb4c45b61a1eda532edf12") {
      outputDiv = document.getElementById("altair-viz-0987c9c7ddfb4c45b61a1eda532edf12");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["black"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "scale": {"domain": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]}, "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": {"field": "Month", "oneOf": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep"]}}, {"filter": "(datum.Metric === 'Internal')"}]}, {"data": {"name": "empty"}, "mark": {"type": "rule", "strokeDash": [4, 4]}, "encoding": {"opacity": {"value": 0.4}, "x": {"datum": "Jan"}, "x2": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "data-1c9c9f22d63ae067ce41697727fed58b"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"opacity": {"value": 0.4}, "text": {"field": "text", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "empty"}, "mark": {"type": "point", "color": "black", "filled": true, "opacity": 1, "size": 50}, "encoding": {"x": {"datum": "Sep"}, "y": {"datum": 37.1}}}, {"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["black"]}, "type": "nominal"}, "opacity": {"value": 0.4}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": "(datum.Metric === 'External')"}]}, {"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"opacity": {"value": 0.4}, "text": {"field": "Metric", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": "(datum.Month === 'Dec')"}, {"filter": "(datum.Metric === 'External')"}]}], "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-6be002fba83fd1263731108823ae7ed6": [{"Month": "Jan", "Metric": "Internal", "Value": 47.6}, {"Month": "Feb", "Metric": "Internal", "Value": 37.9}, {"Month": "Mar", "Metric": "Internal", "Value": 17.6}, {"Month": "Apr", "Metric": "Internal", "Value": 18.6}, {"Month": "May", "Metric": "Internal", "Value": 40.6}, {"Month": "Jun", "Metric": "Internal", "Value": 28.8}, {"Month": "Jul", "Metric": "Internal", "Value": 27.1}, {"Month": "Aug", "Metric": "Internal", "Value": 36.9}, {"Month": "Sep", "Metric": "Internal", "Value": 37.1}, {"Month": "Oct", "Metric": "Internal", "Value": 25.900000000000002}, {"Month": "Nov", "Metric": "Internal", "Value": 51.2}, {"Month": "Dec", "Metric": "Internal", "Value": 40.6}, {"Month": "Jan", "Metric": "External", "Value": 44.800000000000004}, {"Month": "Feb", "Metric": "External", "Value": 48.5}, {"Month": "Mar", "Metric": "External", "Value": 49.5}, {"Month": "Apr", "Metric": "External", "Value": 55.2}, {"Month": "May", "Metric": "External", "Value": 56.5}, {"Month": "Jun", "Metric": "External", "Value": 60.7}, {"Month": "Jul", "Metric": "External", "Value": 44.2}, {"Month": "Aug", "Metric": "External", "Value": 29.0}, {"Month": "Sep", "Metric": "External", "Value": 61.2}, {"Month": "Oct", "Metric": "External", "Value": 44.900000000000006}, {"Month": "Nov", "Metric": "External", "Value": 76.60000000000001}, {"Month": "Dec", "Metric": "External", "Value": 34.7}], "empty": [{}], "data-1c9c9f22d63ae067ce41697727fed58b": [{"text": ["GOAL"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/6_6j.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Add-November">Add November<a class="anchor-link" href="#Add-November"></a></h4><p>Here we can see another increase.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[142]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Create line until November</span>
<span class="n">partial_line5</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">melted_table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Time to fill"</span><span class="p">,</span> <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">()</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span>
                <span class="n">domain</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">"Jan"</span><span class="p">,</span>
                    <span class="s2">"Feb"</span><span class="p">,</span>
                    <span class="s2">"Mar"</span><span class="p">,</span>
                    <span class="s2">"Apr"</span><span class="p">,</span>
                    <span class="s2">"May"</span><span class="p">,</span>
                    <span class="s2">"Jun"</span><span class="p">,</span>
                    <span class="s2">"Jul"</span><span class="p">,</span>
                    <span class="s2">"Aug"</span><span class="p">,</span>
                    <span class="s2">"Sep"</span><span class="p">,</span>
                    <span class="s2">"Oct"</span><span class="p">,</span>
                    <span class="s2">"Nov"</span><span class="p">,</span>
                    <span class="s2">"Dec"</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"TIME TO FILL (DAYS)"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"black"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">FieldOneOfPredicate</span><span class="p">(</span>
            <span class="n">field</span> <span class="o">=</span> <span class="s2">"Month"</span><span class="p">,</span>
            <span class="n">oneOf</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"Jan"</span><span class="p">,</span>
                <span class="s2">"Feb"</span><span class="p">,</span>
                <span class="s2">"Mar"</span><span class="p">,</span>
                <span class="s2">"Apr"</span><span class="p">,</span>
                <span class="s2">"May"</span><span class="p">,</span>
                <span class="s2">"Jun"</span><span class="p">,</span>
                <span class="s2">"Jul"</span><span class="p">,</span>
                <span class="s2">"Aug"</span><span class="p">,</span>
                <span class="s2">"Sep"</span><span class="p">,</span>
                <span class="s2">"Oct"</span><span class="p">,</span>
                <span class="s2">"Nov"</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Point for November</span>
<span class="n">point_nov</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">()</span>
    <span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"black"</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">opacity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="s2">"Nov"</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="n">melted_table</span><span class="p">[</span><span class="s2">"Value"</span><span class="p">][</span><span class="mi">10</span><span class="p">]))</span>
<span class="p">)</span>

<span class="n">graph_10</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">partial_line5</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Metric</span> <span class="o">==</span> <span class="s2">"Internal"</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">goal_opaque</span>
    <span class="o">+</span> <span class="n">label_goal_opaque</span>
    <span class="o">+</span> <span class="n">point_nov</span>
    <span class="o">+</span> <span class="n">external_opaque</span>
    <span class="o">+</span> <span class="n">label_opaque</span>
<span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>

<span class="n">graph_10</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[142]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-61bc18141068487a85a4cb9f6386b902.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-61bc18141068487a85a4cb9f6386b902.vega-embed details,
  #altair-viz-61bc18141068487a85a4cb9f6386b902.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-61bc18141068487a85a4cb9f6386b902"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-61bc18141068487a85a4cb9f6386b902") {
      outputDiv = document.getElementById("altair-viz-61bc18141068487a85a4cb9f6386b902");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["black"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "scale": {"domain": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]}, "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": {"field": "Month", "oneOf": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov"]}}, {"filter": "(datum.Metric === 'Internal')"}]}, {"data": {"name": "empty"}, "mark": {"type": "rule", "strokeDash": [4, 4]}, "encoding": {"opacity": {"value": 0.4}, "x": {"datum": "Jan"}, "x2": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "data-1c9c9f22d63ae067ce41697727fed58b"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"opacity": {"value": 0.4}, "text": {"field": "text", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "empty"}, "mark": {"type": "point", "color": "black", "filled": true, "opacity": 1, "size": 50}, "encoding": {"x": {"datum": "Nov"}, "y": {"datum": 51.2}}}, {"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["black"]}, "type": "nominal"}, "opacity": {"value": 0.4}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": "(datum.Metric === 'External')"}]}, {"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"opacity": {"value": 0.4}, "text": {"field": "Metric", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": "(datum.Month === 'Dec')"}, {"filter": "(datum.Metric === 'External')"}]}], "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-6be002fba83fd1263731108823ae7ed6": [{"Month": "Jan", "Metric": "Internal", "Value": 47.6}, {"Month": "Feb", "Metric": "Internal", "Value": 37.9}, {"Month": "Mar", "Metric": "Internal", "Value": 17.6}, {"Month": "Apr", "Metric": "Internal", "Value": 18.6}, {"Month": "May", "Metric": "Internal", "Value": 40.6}, {"Month": "Jun", "Metric": "Internal", "Value": 28.8}, {"Month": "Jul", "Metric": "Internal", "Value": 27.1}, {"Month": "Aug", "Metric": "Internal", "Value": 36.9}, {"Month": "Sep", "Metric": "Internal", "Value": 37.1}, {"Month": "Oct", "Metric": "Internal", "Value": 25.900000000000002}, {"Month": "Nov", "Metric": "Internal", "Value": 51.2}, {"Month": "Dec", "Metric": "Internal", "Value": 40.6}, {"Month": "Jan", "Metric": "External", "Value": 44.800000000000004}, {"Month": "Feb", "Metric": "External", "Value": 48.5}, {"Month": "Mar", "Metric": "External", "Value": 49.5}, {"Month": "Apr", "Metric": "External", "Value": 55.2}, {"Month": "May", "Metric": "External", "Value": 56.5}, {"Month": "Jun", "Metric": "External", "Value": 60.7}, {"Month": "Jul", "Metric": "External", "Value": 44.2}, {"Month": "Aug", "Metric": "External", "Value": 29.0}, {"Month": "Sep", "Metric": "External", "Value": 61.2}, {"Month": "Oct", "Metric": "External", "Value": 44.900000000000006}, {"Month": "Nov", "Metric": "External", "Value": 76.60000000000001}, {"Month": "Dec", "Metric": "External", "Value": 34.7}], "empty": [{}], "data-1c9c9f22d63ae067ce41697727fed58b": [{"text": ["GOAL"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/6_6k.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Add-December">Add December<a class="anchor-link" href="#Add-December"></a></h4><p>Adding the final month we can see that, despise having a last dip, the Internal time to fill finished the year higher than the External.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[143]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Define point for December</span>
<span class="n">point_dec</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">()</span><span class="o">.</span><span class="n">mark_point</span><span class="p">(</span><span class="n">filled</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'black'</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">opacity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="s1">'Dec'</span><span class="p">),</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="n">melted_table</span><span class="p">[</span><span class="s2">"Value"</span><span class="p">][</span><span class="mi">11</span><span class="p">]))</span>

<span class="c1"># Add existing graphs</span>
<span class="n">graph_11</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Metric</span> <span class="o">==</span> <span class="s1">'Internal'</span><span class="p">)</span> <span class="o">+</span> <span class="n">label</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Metric</span> <span class="o">==</span> <span class="s1">'Internal'</span><span class="p">)</span> <span class="o">+</span>
           <span class="n">goal_opaque</span> <span class="o">+</span> <span class="n">label_goal_opaque</span> <span class="o">+</span> <span class="n">point_dec</span> <span class="o">+</span>
           <span class="n">external_opaque</span> <span class="o">+</span> <span class="n">label_opaque</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">graph_11</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[143]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-f7dc11d50f47489bb25db62af89b12d7.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-f7dc11d50f47489bb25db62af89b12d7.vega-embed details,
  #altair-viz-f7dc11d50f47489bb25db62af89b12d7.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-f7dc11d50f47489bb25db62af89b12d7"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-f7dc11d50f47489bb25db62af89b12d7") {
      outputDiv = document.getElementById("altair-viz-f7dc11d50f47489bb25db62af89b12d7");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["black"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": "(datum.Metric === 'Internal')"}]}, {"mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"text": {"field": "Metric", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": "(datum.Month === 'Dec')"}, {"filter": "(datum.Metric === 'Internal')"}]}, {"mark": {"type": "rule", "strokeDash": [4, 4]}, "encoding": {"opacity": {"value": 0.4}, "x": {"datum": "Jan"}, "x2": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "data-1c9c9f22d63ae067ce41697727fed58b"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"opacity": {"value": 0.4}, "text": {"field": "text", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"datum": 60}}}, {"mark": {"type": "point", "color": "black", "filled": true, "opacity": 1, "size": 50}, "encoding": {"x": {"datum": "Dec"}, "y": {"datum": 40.6}}}, {"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["black"]}, "type": "nominal"}, "opacity": {"value": 0.4}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}, "transform": [{"filter": "(datum.Metric === 'External')"}]}, {"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"opacity": {"value": 0.4}, "text": {"field": "Metric", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": "(datum.Month === 'Dec')"}, {"filter": "(datum.Metric === 'External')"}]}], "data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-6be002fba83fd1263731108823ae7ed6": [{"Month": "Jan", "Metric": "Internal", "Value": 47.6}, {"Month": "Feb", "Metric": "Internal", "Value": 37.9}, {"Month": "Mar", "Metric": "Internal", "Value": 17.6}, {"Month": "Apr", "Metric": "Internal", "Value": 18.6}, {"Month": "May", "Metric": "Internal", "Value": 40.6}, {"Month": "Jun", "Metric": "Internal", "Value": 28.8}, {"Month": "Jul", "Metric": "Internal", "Value": 27.1}, {"Month": "Aug", "Metric": "Internal", "Value": 36.9}, {"Month": "Sep", "Metric": "Internal", "Value": 37.1}, {"Month": "Oct", "Metric": "Internal", "Value": 25.900000000000002}, {"Month": "Nov", "Metric": "Internal", "Value": 51.2}, {"Month": "Dec", "Metric": "Internal", "Value": 40.6}, {"Month": "Jan", "Metric": "External", "Value": 44.800000000000004}, {"Month": "Feb", "Metric": "External", "Value": 48.5}, {"Month": "Mar", "Metric": "External", "Value": 49.5}, {"Month": "Apr", "Metric": "External", "Value": 55.2}, {"Month": "May", "Metric": "External", "Value": 56.5}, {"Month": "Jun", "Metric": "External", "Value": 60.7}, {"Month": "Jul", "Metric": "External", "Value": 44.2}, {"Month": "Aug", "Metric": "External", "Value": 29.0}, {"Month": "Sep", "Metric": "External", "Value": 61.2}, {"Month": "Oct", "Metric": "External", "Value": 44.900000000000006}, {"Month": "Nov", "Metric": "External", "Value": 76.60000000000001}, {"Month": "Dec", "Metric": "External", "Value": 34.7}], "data-1c9c9f22d63ae067ce41697727fed58b": [{"text": ["GOAL"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/6_6l.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Final-graph">Final graph<a class="anchor-link" href="#Final-graph"></a></h4><p>We can now exhibit a final graph with all the values and the External lines colored blue.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[144]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Line chart with External colored blue</span>
<span class="n">line_color</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span>
        <span class="n">melted_table</span><span class="p">,</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span>
            <span class="s2">"Time to fill"</span><span class="p">,</span> <span class="n">fontSize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="n">fontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mark_line</span><span class="p">()</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span>
            <span class="s2">"Month"</span><span class="p">,</span>
            <span class="n">sort</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">labelAngle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"start"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span><span class="p">,</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"2019"</span>
        <span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span>
            <span class="s2">"Value"</span><span class="p">,</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Axis</span><span class="p">(</span>
                <span class="n">grid</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">titleAnchor</span> <span class="o">=</span> <span class="s2">"end"</span><span class="p">,</span>
                <span class="n">labelColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleColor</span> <span class="o">=</span> <span class="s2">"#888888"</span><span class="p">,</span>
                <span class="n">titleFontWeight</span> <span class="o">=</span> <span class="s2">"normal"</span>
            <span class="p">),</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">"TIME TO FILL (DAYS)"</span><span class="p">,</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>
        <span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#1d779c"</span><span class="p">,</span> <span class="s2">"#676767"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Labeling with External colored blue</span>
<span class="n">label_color</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">melted_table</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span> <span class="o">=</span> <span class="s2">"left"</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
    <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="p">(</span><span class="s2">"Dec"</span><span class="p">),</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">"Value"</span><span class="p">),</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">"Metric"</span><span class="p">),</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span>
            <span class="s2">"Metric"</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="nb">range</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#1d779c"</span><span class="p">,</span> <span class="s2">"#676767"</span><span class="p">]),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">transform_filter</span><span class="p">((</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">Month</span> <span class="o">==</span> <span class="s2">"Dec"</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">graph_12</span> <span class="o">=</span> <span class="p">(</span><span class="n">line_color</span> <span class="o">+</span> <span class="n">goal_opaque</span> <span class="o">+</span> <span class="n">label_goal_opaque</span> <span class="o">+</span> <span class="n">label_color</span><span class="p">)</span><span class="o">.</span><span class="n">configure_view</span><span class="p">(</span>
    <span class="n">stroke</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
<span class="n">graph_12</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[144]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/html" tabindex="0">
<style>
  #altair-viz-b9b27cebe2904d4e97e69c045d390b81.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-b9b27cebe2904d4e97e69c045d390b81.vega-embed details,
  #altair-viz-b9b27cebe2904d4e97e69c045d390b81.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-b9b27cebe2904d4e97e69c045d390b81"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-b9b27cebe2904d4e97e69c045d390b81") {
      outputDiv = document.getElementById("altair-viz-b9b27cebe2904d4e97e69c045d390b81");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.15.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.15.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300, "stroke": null}}, "layer": [{"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "line"}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#1d779c", "#676767"]}, "type": "nominal"}, "x": {"axis": {"labelAngle": 0, "labelColor": "#888888", "ticks": false, "titleAnchor": "start", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Month", "sort": null, "title": "2019", "type": "nominal"}, "y": {"axis": {"grid": false, "labelColor": "#888888", "titleAnchor": "end", "titleColor": "#888888", "titleFontWeight": "normal"}, "field": "Value", "scale": {"domain": [0, 90]}, "title": "TIME TO FILL (DAYS)", "type": "quantitative"}}, "title": {"text": "Time to fill", "anchor": "start", "fontSize": 18, "fontWeight": "normal", "offset": 10}}, {"data": {"name": "empty"}, "mark": {"type": "rule", "strokeDash": [4, 4]}, "encoding": {"opacity": {"value": 0.4}, "x": {"datum": "Jan"}, "x2": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "data-1c9c9f22d63ae067ce41697727fed58b"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"opacity": {"value": 0.4}, "text": {"field": "text", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"datum": 60}}}, {"data": {"name": "data-6be002fba83fd1263731108823ae7ed6"}, "mark": {"type": "text", "align": "left", "dx": 4}, "encoding": {"color": {"field": "Metric", "legend": null, "scale": {"range": ["#1d779c", "#676767"]}, "type": "nominal"}, "text": {"field": "Metric", "type": "nominal"}, "x": {"datum": "Dec"}, "y": {"field": "Value", "type": "quantitative"}}, "transform": [{"filter": "(datum.Month === 'Dec')"}]}], "width": 500, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-6be002fba83fd1263731108823ae7ed6": [{"Month": "Jan", "Metric": "Internal", "Value": 47.6}, {"Month": "Feb", "Metric": "Internal", "Value": 37.9}, {"Month": "Mar", "Metric": "Internal", "Value": 17.6}, {"Month": "Apr", "Metric": "Internal", "Value": 18.6}, {"Month": "May", "Metric": "Internal", "Value": 40.6}, {"Month": "Jun", "Metric": "Internal", "Value": 28.8}, {"Month": "Jul", "Metric": "Internal", "Value": 27.1}, {"Month": "Aug", "Metric": "Internal", "Value": 36.9}, {"Month": "Sep", "Metric": "Internal", "Value": 37.1}, {"Month": "Oct", "Metric": "Internal", "Value": 25.900000000000002}, {"Month": "Nov", "Metric": "Internal", "Value": 51.2}, {"Month": "Dec", "Metric": "Internal", "Value": 40.6}, {"Month": "Jan", "Metric": "External", "Value": 44.800000000000004}, {"Month": "Feb", "Metric": "External", "Value": 48.5}, {"Month": "Mar", "Metric": "External", "Value": 49.5}, {"Month": "Apr", "Metric": "External", "Value": 55.2}, {"Month": "May", "Metric": "External", "Value": 56.5}, {"Month": "Jun", "Metric": "External", "Value": 60.7}, {"Month": "Jul", "Metric": "External", "Value": 44.2}, {"Month": "Aug", "Metric": "External", "Value": 29.0}, {"Month": "Sep", "Metric": "External", "Value": 61.2}, {"Month": "Oct", "Metric": "External", "Value": 44.900000000000006}, {"Month": "Nov", "Metric": "External", "Value": 76.60000000000001}, {"Month": "Dec", "Metric": "External", "Value": 34.7}], "empty": [{}], "data-1c9c9f22d63ae067ce41697727fed58b": [{"text": ["GOAL"]}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p><em>Visualization as depicted in the book:</em></p>
<p><img alt="Alt text" src="./Images/6_6m.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>The exercise still presents a graph to be used as a summarization of the ones above. However, instead of replicating it, we will focus on creating an animation with the visualizations we already have.</p>
<p><em>Last graph from the book:</em></p>
<p><img alt="Alt text" src="./Images/6_6n.png"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h4 id="Animation">Animation<a class="anchor-link" href="#Animation"></a></h4><p>For our animation, we will leave Altair and use <code>ipywidgets</code>. The code is as follows.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[145]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># List of the graphs</span>
<span class="n">graphs</span> <span class="o">=</span> <span class="p">[</span><span class="n">graph_1</span><span class="p">,</span> <span class="n">graph_2</span><span class="p">,</span> <span class="n">graph_3</span><span class="p">,</span> <span class="n">graph_4</span><span class="p">,</span> <span class="n">graph_5</span><span class="p">,</span> <span class="n">graph_6</span><span class="p">,</span> <span class="n">graph_7</span><span class="p">,</span> <span class="n">graph_8</span><span class="p">,</span> <span class="n">graph_9</span><span class="p">,</span> <span class="n">graph_10</span><span class="p">,</span> <span class="n">graph_11</span><span class="p">,</span> <span class="n">graph_12</span><span class="p">]</span>

<span class="c1"># Create function</span>
<span class="k">def</span> <span class="nf">demo</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">graphs</span><span class="p">):</span>
        <span class="n">chart</span> <span class="o">=</span> <span class="n">graphs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">chart</span> <span class="o">=</span> <span class="kc">None</span> 
    <span class="n">display</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>

<span class="c1"># Create the animation</span>
<span class="n">interact</span><span class="p">(</span><span class="n">demo</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Play</span><span class="p">(</span>
    <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nb">min</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nb">max</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
    <span class="n">step</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">"Press play"</span><span class="p">,</span>
    <span class="n">interval</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain" tabindex="0">
<pre>interactive(children=(Play(value=0, description='Press play', interval=2000, max=11), Output()), _dom_classes=</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[145]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain" tabindex="0">
<pre>&lt;function __main__.demo(i)&gt;</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>It is important to note, however, that the application above only works in Live Kernels (therefore not running on an HTML file). For that reason, we will upload a GIF of a screen recording.</p>
<p><em>GIF for the animation:</em></p>
<p><img alt="Alt text" src="./Images/graph_gif.gif"/></p>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<h2 id="The-end-:)">The end :)<a class="anchor-link" href="#The-end-:)"></a></h2><h4 id="Cell-to-create-the-.html">Cell to create the .html<a class="anchor-link" href="#Cell-to-create-the-.html"></a></h4>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput" data-mime-type="text/markdown">
<p>This code was created by Sren Fuglede Jrgensen and can be found <a href="https://github.com/jupyter/nbconvert/issues/699#issuecomment-372441219">here</a>. Please make sure any changes are saved before running this cell.</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper" tabindex="0">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In[]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'index.ipynb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">nb_file</span><span class="p">:</span>
    <span class="n">nb_contents</span> <span class="o">=</span> <span class="n">nb_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="c1"># Convert using the ordinary exporter</span>
<span class="n">notebook</span> <span class="o">=</span> <span class="n">nbformat</span><span class="o">.</span><span class="n">reads</span><span class="p">(</span><span class="n">nb_contents</span><span class="p">,</span> <span class="n">as_version</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># HTML Export</span>
<span class="n">html_exporter</span> <span class="o">=</span> <span class="n">nbconvert</span><span class="o">.</span><span class="n">HTMLExporter</span><span class="p">()</span>
<span class="n">body</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="n">html_exporter</span><span class="o">.</span><span class="n">from_notebook_node</span><span class="p">(</span><span class="n">notebook</span><span class="p">)</span>

<span class="c1"># Create a dict mapping all image attachments to their base64 representations</span>
<span class="n">images</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">notebook</span><span class="p">[</span><span class="s1">'cells'</span><span class="p">]:</span>
    <span class="k">if</span> <span class="s1">'attachments'</span> <span class="ow">in</span> <span class="n">cell</span><span class="p">:</span>
        <span class="n">attachments</span> <span class="o">=</span> <span class="n">cell</span><span class="p">[</span><span class="s1">'attachments'</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">filename</span><span class="p">,</span> <span class="n">attachment</span> <span class="ow">in</span> <span class="n">attachments</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">mime</span><span class="p">,</span> <span class="n">base64</span> <span class="ow">in</span> <span class="n">attachment</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">images</span><span class="p">[</span><span class="sa">f</span><span class="s1">'attachment:</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">'</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'data:</span><span class="si">{</span><span class="n">mime</span><span class="si">}</span><span class="s1">;base64,</span><span class="si">{</span><span class="n">base64</span><span class="si">}</span><span class="s1">'</span>

<span class="c1"># Fix up the HTML and write it to disk</span>
<span class="k">for</span> <span class="n">src</span><span class="p">,</span> <span class="n">base64</span> <span class="ow">in</span> <span class="n">images</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s1">'src="</span><span class="si">{</span><span class="n">src</span><span class="si">}</span><span class="s1">"'</span><span class="p">,</span> <span class="sa">f</span><span class="s1">'src="</span><span class="si">{</span><span class="n">base64</span><span class="si">}</span><span class="s1">"'</span><span class="p">)</span>

<span class="c1"># Write HTML to file</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'index.html'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">html_output_file</span><span class="p">:</span>
    <span class="n">html_output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</main>
</body>
</html>
